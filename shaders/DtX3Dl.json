{
    "Shader": {
        "info": {
            "date": "1672622900",
            "description": "Detects if a point is in a triangle.",
            "flags": 0,
            "hasliked": 0,
            "id": "DtX3Dl",
            "likes": 1,
            "name": "Is Inside Triangle?",
            "published": 3,
            "tags": [
                "triangles"
            ],
            "usePreview": 0,
            "username": "raymarchingenthusiast",
            "viewed": 201
        },
        "renderpass": [
            {
                "code": "struct Vert {\n    vec3 col;\n};\n\nstruct Triangle2 {\n    vec2 a;\n    vec2 b;\n    vec2 c;\n};\n\nstruct Triangle3 {\n    vec3 a;\n    vec3 b;\n    vec3 c;\n};\n\nvec2 CalcUv(vec2 p, Triangle2 tp, Triangle2 tuv) {\n    float w1p1 = (tp.b.y-tp.c.y)*(p.x-tp.c.x)+(tp.c.x-tp.b.x)*(p.y-tp.c.y);\n    float w1p2 = (tp.b.y-tp.c.y)*(tp.a.x-tp.c.x)+(tp.c.x-tp.b.x)*(tp.a.y-tp.c.y);\n    float w1 = w1p1/w1p2;\n    \n    float w2p1 = (tp.c.y-tp.a.y)*(p.x-tp.c.x)+(tp.a.x-tp.c.x)*(p.y-tp.c.y);\n    float w2p2 = (tp.b.y-tp.c.y)*(tp.a.x-tp.c.x)+(tp.c.x-tp.b.x)*(tp.a.y-tp.c.y);\n    float w2 = w2p1/w2p2;\n    \n    float w3 = 1. - w1 - w2;\n    \n    return w1*tuv.a + w2*tuv.b + w3*tuv.c;\n}\n\nfloat area(Triangle2 tri) {\n    return (tri.a.x*(tri.b.y-tri.c.y) + tri.b.x*(tri.c.y-tri.a.y) + tri.c.x*(tri.a.y-tri.b.y))/2.;\n}\n\n/*bool isInside(vec2 p, Triangle2 tri) {\n    float abc = area(tri);\n    float pab = area(Triangle2(p,tri.a,tri.b));\n    float pac = area(Triangle2(p,tri.a,tri.c));\n    float pbc = area(Triangle2(p,tri.b,tri.c));\n    return abs(abc - (pab + pac + pbc)) < .0001;\n}*/\n\nbool isInside(vec2 p, Triangle2 tri) {\n    float s = (tri.a.x-tri.c.x)*(p.y-tri.c.y)-(tri.a.y-tri.c.y)*(p.x-tri.c.x);\n    float t = (tri.b.x-tri.a.x)*(p.y-tri.a.y)-(tri.b.y-tri.a.y)*(p.x-tri.a.x);\n    \n    if((s<0.) != (t<0.) && s != 0. && t  != 0.) return false;\n    \n    float d = (tri.c.x-tri.b.x) * (p.y - tri.b.y) - (tri.c.y - tri.b.y) * (p.x - tri.b.x);\n    return d == 0. || (d<0.) == (s+t <= 0.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord + (iMouse.xy-iResolution.xy/2.)) / iResolution.xy;\n    if(iMouse.xy == vec2(0.)) uv = fragCoord / iResolution.xy;\n    Triangle2 ts[2];\n    Triangle2 uvs[2];\n    \n    ts[0] = Triangle2(vec2(0.,0.),vec2(0.,1.),vec2(1.,0.));\n    uvs[0] = Triangle2(vec2(0.,0.),vec2(0.,1.),vec2(1.,0.));\n    ts[1] = Triangle2(vec2(1.,0.),vec2(1.,1.),vec2(0.,1.));\n    uvs[1] = Triangle2(vec2(1.,0.),vec2(1.,1.),vec2(0.,1.));\n    \n    fragColor = vec4(0.,0.,.3,1.);\n    for(int i = 0; i < ts.length(); i++) {\n        if(isInside(uv,ts[i])) {\n            vec2 textureUv = CalcUv(uv,ts[i],uvs[i]);\n            \n            vec3 col = texture(iChannel0,textureUv).xyz;\n        \n            fragColor = vec4(col,1.);\n            if(textureUv.x>1.||textureUv.x<0.||textureUv.y>1.||textureUv.y<0.) fragColor = vec4(.15,.15,3.,1.);\n        }\n    }\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 8,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}