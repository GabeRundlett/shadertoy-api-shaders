{
    "Shader": {
        "info": {
            "date": "1573634244",
            "description": "a simple paper fan",
            "flags": 0,
            "hasliked": 0,
            "id": "tdyXRm",
            "likes": 12,
            "name": "Paper fan",
            "published": 3,
            "tags": [
                "unknown"
            ],
            "usePreview": 0,
            "username": "SnowYuki",
            "viewed": 484
        },
        "renderpass": [
            {
                "code": "#define PI 3.14159\n\nmat2 rotate2d(float a){\n    return mat2(cos(a),-sin(a),sin(a),cos(a));\n}\n\nfloat box(vec2 st,vec2 p,vec2 size){\n    return step(p.x,st.x)*step(p.y,st.y)*step(st.x,p.x + size.x)*step(st.y,p.y + size.y);\n}\n\nvec3 drawFan(vec2 st,vec2 fanP,float size,vec3 rawColor,float open_f){\n    vec2 pst = st;\n    pst -= fanP;\n    vec3 color = rawColor;\n    float a = atan(pst.y,pst.x);\n    a = a/PI;\n    a *= 10.0;\n    a = a;\n    float pct = 1.0 - abs(fract(a) - 0.5)*2.0;\n    pct = 1.0 - pct*0.05;\n    float openArea = step(open_f*10.0,a);\n    pct *= openArea;\n    float dArea = step(length(pst),pct*size);\n    color = mix(color,vec3(1.0),dArea);\n    \n    float fanSize = 0.7*size;\n    pst -= vec2(0.0,0.24);\n    vec3 texColor = texture(iChannel0,st + pst).xyz;\n    pst *= vec2(1.0,1.5);\n    float dPic = 1.0 - smoothstep(0.05*fanSize,1.0*fanSize,length(pst));\n    color = mix(color,texColor,dPic*openArea);\n    \n    float dShadow = (fract(a) - 0.5)*2.0;\n    dShadow = clamp(dShadow,0.0,1.0);\n    color = mix(color,vec3(0.0),dShadow*dArea*0.27);\n    \n    return color;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.y;\n    vec2 pst = uv;\n    float u_time = iTime;\n\n    vec3 color = vec3(0.7,0.7,0.5);\n    \n    float fold_time = 0.5;\n    float open_time = 1.5;\n    float close_time = 0.15;\n    float duration = fold_time*2.0 + open_time + close_time;\n    float open_f = 1.0;\n    open_f = abs(mod(u_time/fold_time + (open_time/2.0+close_time+fold_time),duration/fold_time)-duration/2.0/fold_time) - close_time/2.0/fold_time;\n    open_f = 1.0 - clamp(open_f,0.0,1.0);\n    \n    pst = uv;\n    pst -= vec2(0.7,0.3);\n    float dbox = box(pst,vec2(-0.5,-0.014),vec2(0.53,0.028));\n    color = mix(color,vec3(0.75,0.47,0.109),dbox);\n    \n    vec2 fanP = vec2(0.7,0.3);\n    color = drawFan(uv,fanP,0.5,color,open_f);\n    \n    pst = rotate2d(open_f*PI)*pst;\n    dbox = box(pst,vec2(-0.03,-0.014),vec2(0.53,0.028));\n    color = mix(color,vec3(0.75,0.47,0.109),dbox);\n    \n    fragColor = vec4(color,1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 5,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/8de3a3924cb95bd0e95a443fff0326c869f9d4979cd1d5b6e94e2a01f5be53e9.jpg"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}