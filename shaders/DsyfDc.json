{
    "Shader": {
        "info": {
            "date": "1698764544",
            "description": "Properly managed image & display gamma corrections and accurate perceptual lightness correlate.\nOther examples aren't quite what i consider complete, so here's my mine!\nClick & Shift!\n[url=https://www.shadertoy.com/playlist/fXjyRd]GEOMETRY PLAYLIST[/url]",
            "flags": 16,
            "hasliked": 0,
            "id": "DsyfDc",
            "likes": 3,
            "name": "Lightness & Gamma Fundamentals",
            "published": 3,
            "tags": [
                "desaturate",
                "relative",
                "luminance",
                "gamma",
                "gray",
                "brightness",
                "grey",
                "visual",
                "uniform",
                "correct",
                "luma",
                "ciecam02",
                "lightness",
                "percept"
            ],
            "usePreview": 0,
            "username": "domrally",
            "viewed": 144
        },
        "renderpass": [
            {
                "code": "/// by Dom Mandy in 2023\n\n\n/* Decode color from compressed to linear space.\nDo this 1st to image textures before using them.\nImages are encoded in the nonlinear srgb color space.\nThe rgb components need to be linear for filters and effects. */\nvec3 rgb(vec4 srgb) { return mix(srgb / 12.92, pow((srgb + .055) / 1.055, vec4(2.4)), step(.04045, srgb)).rgb; }\n\n\n/* Prepare the gamma for a computer monitor.\nDo this after processing and before sending to the display.\nDisplay adapters expect a nonlinear correction of 1 / 2.2 */\nvec4 gamma(vec3 rgb) { return vec4(pow(rgb, vec3(1) / 2.2), 1); }\n\n\n/* Map 3D color to 1D greyscale using CIE standards from 2002 (as opposed to the commonly used 1976 method).\nThe impact of surroundings is 59% for viewing television.\nThe average relative luminance of an image field is 20% for typically lit scenes.\nEye cone responsivities relative to srgb & rescaling for perceptually uniform lightness gradient */\nfloat lightness(vec3 rgb) { return pow(dot(rgb, vec3(.2126, .7152, .0722)), .59 * (1.48 + sqrt(.2))); }\n\n\n/* Demonstration of color management from image to display output. */\nvoid mainImage(out vec4 pixel, vec2 uv) {\n    vec4 raw = texture(iChannel0, uv /= iResolution.xy);\n\n    // almost always start by linearizing the compressed rgb texture\n    vec3 colorful = rgb(raw),\n         greyscale = vec3(lightness(colorful));\n    \n    // click to drag color|grey boundary\n    uv = round(uv + mix(.5 * sin(-iTime), .5 * (iResolution.x - 2. * iMouse.x) / iResolution.x, max(0., sign(iMouse.z))));\n    vec3 mixed = mix(\n        // correct\n        mix(colorful, greyscale, uv.x),\n        // incorrect\n        mix(raw.rgb, vec3(length(raw.rgb) / sqrt(3.)), uv.x),\n        // hold shift to see incorrect render\n        texelFetch(iChannel1, ivec2(16, 0), 0).x\n    );\n    \n    // almost always end by converting from abstract linear image to hardware scale\n    pixel = gamma(mixed);\n}\n\n\n/*\nFURTHER READING\n\ncolor modeling\n\nhttps://en.wikipedia.org/wiki/Lightness#2002\nhttps://en.wikipedia.org/wiki/SRGB#Transformation\nhttps://en.wikipedia.org/wiki/CIECAM02#Parameter_decision_table\nhttps://en.wikipedia.org/wiki/Gamma_correction#Computer_displays\nhttps://en.wikipedia.org/wiki/Relative_luminance#Relative_luminance_and_perceptual_spaces\nhttps://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale\n\nvisual perception\n\nhttps://en.wikipedia.org/wiki/Cone_cell\nhttps://en.wikipedia.org/wiki/Color_vision\n*/\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "video",
                        "id": 12,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/a/e81e818ac76a8983d746784b423178ee9f6cdcdf7f8e8d719341a6fe2d2ab303.webm"
                    },
                    {
                        "channel": 1,
                        "ctype": "keyboard",
                        "id": 33,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/presets/tex00.jpg"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}