{
    "Shader": {
        "info": {
            "date": "1467593786",
            "description": "[SH16A] Challenge. This is work in progress. For now no change to code flow / algorithm is made.",
            "flags": 0,
            "hasliked": 0,
            "id": "4tcGRr",
            "likes": 2,
            "name": "[SH16A] Reinder",
            "published": 3,
            "tags": [
                "challenge",
                "codesize",
                "sh16a"
            ],
            "usePreview": 0,
            "username": "reinder",
            "viewed": 1407
        },
        "renderpass": [
            {
                "code": "// Changes:\n// Applying P_Malins comment (C *= T*V(1.2,1.02,.66)+(y+N).y*V(1,1.4,2)/8.;) -> 713 char\n// I don't know why, but I could remove the max(0.,dot at the lighting equation -> 714 char\n// Make all arguments global (inspired by P_Malin)\n// Applying FabriceNeyret2's comment (identity in calculation of D)\n\n#define V vec3\n#define Q normalize\n#define F for(int i=0;i<64;i++)\n\n#define c F{n=y,T=P.y,m=-2;F l=length(q=P-V(i/5-2,s,i-2-i/5*5))-s,i<28&&l<T?T=l,m=i/2,n=Q(q):q,s+=g*=-1.;P+=T*d;}\n\nvoid mainImage( out vec4 f, vec2 p ) {\n\tint m; float T, s=.4, g=.15, l,h=.5;\n    V C, d, D, N, n, q=iResolution, y = V(0,1,0),\n    P = V( .851, 2, -2.8768 );\n    \n    D = d = mat3( d = Q(cross(N = -Q(.2*y+P),y)),cross(d,N), N ) * Q(V(p-q.xy*h,q.y));\n    \n    c\n    \n    N=n,q=mod(ceil(P),2.),C=P*P,\n\t\n    C = m<0?\n    \tsmoothstep( 0.,h,max(C.x,C.z)<2.25?length(fract(P.xz+h)-h):2.)*        \n       \tV(q.x==q.z?.4:h*texture( iChannel0,.1*P.xz).x) : V(100-8*m,3*m,6*m)*.01;     \n\n\td = Q(V(-6,7,-5));\n    P += .01*d;\n    \n    c\n    \n    T = m<-1?dot(N,d):0.;    \n\t\n    f=sqrt(C*(T*V(1.2,1.02,.66)+(y+N).y*V(1,1.4,2)/8.)+pow(max(0.,dot(reflect( D, N ), d)),16.)*T).xyzz;\n}\n\n/*\n\n#define V vec3\n#define Q normalize\n\nV C, P, n, q=iResolution, y = V(0,1,0);\nfloat t, m, T, M, s, g=.15, l;\n\nvoid c( V o, V d ) {\n    t=.01,s=.4;\n    for( int i=0; i<64; i++ ) {\n\t\tP=o+d*t,\n\t    n = y,\n        T = P.y, M = -2.;        \n        for( int i=0;i<28;i++) {\n            l=length(q = P - V( i/5-2,s, i-2-i/5*5)) - s;\n            if( l < T ) \n                T = l, M = float(i/2), n = Q(q);\n            s += g*=-1.;\n\t\t}\n        t += T;\n\t    m = M;\n    }\n}\n\nvoid mainImage( out vec4 f, vec2 p ) {\n    V o = V( cos(5.),1,sin(5.) )*3.-y,\n        N = -Q(.2*y+o),\n        d = Q(cross(N,y)),        \n\t\tL = Q(V(-6,7,-5));\n    \n    c(o,d = mat3( d,cross(d,N), N ) * Q(V((p+p-q.xy)/q.y,2)));  \n    \n    N=n,q=ceil(P),C=abs(P),\n\t\n    C = m>=0.?V(-8,3,6)*.01*m+y.yxx:\n    \tsmoothstep( 0.,.5,length(fract(P.xz+.5)-.5)+step(1.5,max(C.x,C.z)))*        \n       \tV(mod(q.x+q.z,2.)<.5?.4:.5*texture( iChannel0,.1*P.xz).x);     \n    \n    c(P, L);\n    \n    t = max(0.,dot(N, L)) * step(m,-.5);    \n\t\n    C *= t*V(1.2,1.02,.66)+(1.+N.y)*V(1,1.4,2)/8.;\n    \n    f=sqrt(C.xyzz+pow(max(0.,dot(reflect( d, N ), L)),16.)*t);\n}\n\n*/",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 30,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}