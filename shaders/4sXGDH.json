{
    "Shader": {
        "info": {
            "date": "1368333236",
            "description": "Sprite animation: 6x10, 4 colors, 8 frames; 1 frame is defined by 5 numbers; One number contains 12px (24bit); 2 bit per pixel. Click+drag mouse to change landing zone and direction.",
            "flags": 0,
            "hasliked": 0,
            "id": "4sXGDH",
            "likes": 56,
            "name": "Lemminvade",
            "published": 3,
            "tags": [
                "2d",
                "mouse",
                "music",
                "animation",
                "sprite",
                "beatsync",
                "lemmings"
            ],
            "usePreview": 1,
            "username": "movAX13h",
            "viewed": 5543
        },
        "renderpass": [
            {
                "code": "// created by movAX13h, May 2013\n\n#define I_HAVE_NO_WEB_AUDIO 0\n\nstruct Frame\n{\n\tfloat s1,s2,s3,s4,s5; // slices\n};\n\nFrame frame(Frame frames[8], int id) \n{\n    return frames[id];\n}\n\t\nfloat slice(Frame frame, int id)\n{\n\tif (id == 0) return frame.s1;\n\tif (id == 1) return frame.s2;\n\tif (id == 2) return frame.s3;\n\tif (id == 3) return frame.s4;\n\treturn frame.s5;\n}\n\nint sprite(Frame frame, vec2 p)\n{\n\tint d = 0;\n\tp = floor(p);\n\tif (clamp(p.x,0.0,5.0) == p.x && clamp(p.y,0.0,9.0) == p.y)\n\t{\n        int s = int(p.y / 2.0);\n        float o = float(s)*12.0;\n        float k = ((p.x + p.y*6.0) - o)*2.0;\n        float n = slice(frame, s);\n        if (int(mod(n/(pow(2.0,k)),2.0)) == 1) d += 2;\n        if (int(mod(n/(pow(2.0,k+1.0)),2.0)) == 1) d++;\n\t}\n\treturn d;\n}\n\nfloat invader(vec2 p, float n, float d)\n{\n\tp.x = abs(p.x);\n\tp.y = -floor(p.y - 5.0);\n\tif (p.x <= 2.0) \n\t{\n\t\tif (int(mod(n/(pow(2.0,floor(p.x + p.y*3.0))),2.0)) == 1) return 1.0;\n\t}\n\treturn d;\n}\n\nfloat hash(float n)\n{\n    return fract(sin(n)*43758.5453);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\t// frames\n\tFrame frames[8];\n\tframes[0].s1=2228224.0; frames[0].s2= 721568.0; frames[0].s3=3997948.0; frames[0].s4=16073552.0; frames[0].s5=15790420.0;\n\tframes[1].s1= 655360.0; frames[1].s2=3130040.0; frames[1].s3= 852176.0; frames[1].s4=  328528.0; frames[1].s5=12832084.0;\n\tframes[2].s1=2785280.0; frames[2].s2=1032880.0; frames[2].s3= 852176.0; frames[2].s4=  327888.0; frames[2].s5=  983888.0;\n\tframes[3].s1=2752648.0; frames[3].s2=1032880.0; frames[3].s3= 458960.0; frames[3].s4=  340083.0; frames[3].s5= 3932492.0;\n\tframes[4].s1=2228224.0; frames[4].s2= 721568.0; frames[4].s3= 459004.0; frames[4].s4=  376944.0; frames[4].s5=15790420.0;\n\tframes[5].s1= 655360.0; frames[5].s2=3130040.0; frames[5].s3= 852176.0; frames[5].s4=  327792.0; frames[5].s5=12832084.0;\n\tframes[6].s1=2785280.0; frames[6].s2=3130032.0; frames[6].s3= 458960.0; frames[6].s4=  327888.0; frames[6].s5=  983888.0;\n\tframes[7].s1=2752648.0; frames[7].s2=1032880.0; frames[7].s3=3473616.0; frames[7].s4=  340819.0; frames[7].s5= 3932492.0;\n\t\n\t// time & space\n  #if I_HAVE_NO_WEB_AUDIO\n\tfloat time = iTime*1.89;\n  #else\n\tfloat time = iChannelTime[1]*1.89-0.08;\n  #endif\n\t\n\tfloat mouse = iMouse.x;\n\tif (mouse < 10.0 || mouse > iResolution.x-10.0) mouse = iResolution.x*0.68;\n\t\n\tvec2 p = fragCoord.xy * 0.25;\n\tp.y = - p.y;\n\n\tvec3 col = vec3(0.0, 0.0, 0.1);\n\tvec3 colors[4];\n\t\n\t// ground\n\tcolors[0] = vec3(0.38, 0.0, 0.06); colors[1] = vec3(0.57, 0.14, 0.07); colors[2] = vec3(0.79, 0.33, 0.08); colors[3] = vec3(0.9, 0.51, 0.13);\n\t\n\tfloat f = floor(-iResolution.y*0.125 + 11.0);\n\tint i = int(4.0*texture(iChannel0, floor(p)*0.005 + vec2(0.2,0.5)).r);\n\tcol = mix(col, colors[i], step(f, p.y));\n\n\t// swirl\n\tfloat h = smoothstep(2.0, 60.0, abs(fragCoord.x-mouse));\n\tvec2 q = p;\n\tq.x += floor((1.0-h)*(5.0*sin(0.1*p.y + time) + 3.0*sin(0.07*p.y + time + 2.0)));\n\t\n    // background\n\ti = int(4.0*texture(iChannel0, floor(q)*0.003).r);\n\th = 1.2*smoothstep(f, f*4.0, q.y+sin(time + q.x*0.3)*5.0);\n\tcol = mix(col, colors[i], h);\n\t\n\t// grass\n\tcolors[0] = vec3(0.44, 0.57, 0.0); colors[1] = vec3(0.13, 0.39, 0.13);\n\t\n\tvec2 g = floor(p);\n\tfloat d = f - g.y;\n\th = floor(hash(g.x)*2.3);\n\tg.y += h;\n\ti = int(abs(sin(-h*0.2+d*0.6+0.3))*2.0);\n\tcol = mix(col, colors[i], 1.0 - step(3.0, abs(g.y-f-2.0)));\n\n\t// lemmings\n\tcolors[0] = vec3(0.0); colors[1] = vec3(0.0, 0.73, 0.0); colors[2] = vec3(0.26, 0.26, 0.92); colors[3] = vec3(1.0, 1.0, 1.0);\n\tp.y += 9.0-f;\n\tif (iMouse.z > 0.0) p.x *= 1.0 - 2.0 * step(fragCoord.x, mouse);\n\telse p.x *= 1.0 - 2.0 * step(mouse, fragCoord.x);\n\tp.x = mod(p.x + floor(time*4.0), 12.0);\n\t\n\tf = length(fragCoord.xy-vec2(mouse, max(iResolution.y *0.5 - 30.0, fragCoord.y)));\n\tp.y += floor(60.0*(smoothstep(40.0, 0.0, floor(f)))); // elevation\n\ti = sprite(frame(frames, int(mod(floor(time*4.0+1.0), 8.0))), p);\n\th = smoothstep(10.0, 120.0, abs(fragCoord.x-mouse));\n\tcol = mix(col, colors[i], h*min(1.0, float(i)));\n\n\t// beam\n\tfloat r = 10.0*sin(p.y*0.1 + time*2.0);\n\th = smoothstep(180.0, 10.0, f-r);\n\tcol += h*0.6;\n\n\t#if 0\n\th *= smoothstep(120.0, 10.0, r); col *= h;\n\t#endif\n\n\t// invaders\n\tp = 0.25*(fragCoord.xy - vec2(mouse, iResolution.y));\n\tp.x += sin(p.y*0.15 - time*3.0)*2.0;\n\tp.y += time*(1.0 - 2.0 * step(0.1, iMouse.z))*15.0;\n\n\tq.x = p.x;\n\tq.y = mod(p.y, 20.0);\n\t\n\tfloat t = floor(time * 0.5);\n\th = mod(hash(floor(p.y/20.0)),33554430.0);\n\tf = invader(floor(q), h, 0.0) * smoothstep(iResolution.y*0.6, iResolution.y, fragCoord.y);\n\tcol = mix(col, vec3(1.0), f);\n\t\n\tfragColor = vec4(col, 1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 10,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/92d7758c402f0927011ca8d0a7e40251439fba3a1dac26f5b8b62026323501aa.jpg"
                    },
                    {
                        "channel": 1,
                        "ctype": "music",
                        "id": 19,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "clamp"
                        },
                        "src": "/media/a/a6a1cf7a09adfed8c362492c88c30d74fb3d2f4f7ba180ba34b98556660fada1.mp3"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}