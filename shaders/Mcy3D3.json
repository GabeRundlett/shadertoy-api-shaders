{
    "Shader": {
        "info": {
            "date": "1713348622",
            "description": "Phone box - no connection! (mouseable)",
            "flags": 0,
            "hasliked": 0,
            "id": "Mcy3D3",
            "likes": 24,
            "name": "Phone Home",
            "published": 3,
            "tags": [
                "cloud",
                "water",
                "phonebox"
            ],
            "usePreview": 1,
            "username": "dr2",
            "viewed": 492
        },
        "renderpass": [
            {
                "code": "#define XH(Cg)if(SA<VW){VW=SA; IY=Cg;}\n#define Zs(Cg)if(SA<VW){VW=SA; IY=Cg; LM=Kb;}\n#define KN min(DA,0)\nvec3 CB,LM,Bu,Rk;float Ez,Jt,RW,TH,Vs,Em;int IY,DA;const int Of=1,KJ=2,DR=3,Hn=4,Mu=5,FC=6;const float ZN=3.1415927,VJ=1.7320508;float Dj(vec2 Wr,vec2 Go){vec2 SA;SA=abs(Wr)-Go;return min(max(SA.x,SA.y),0.)+length(max(SA,0.));}float GF(vec2 Wr,vec2 Go,float QT){return length(max(abs(Wr)-Go,0.))-QT;}float EU(vec3 Wr,float Pi,float La){return max(length(Wr.xy)-Pi,abs(Wr.z)-La);}float Iq(vec3 Wr,vec3 Go,float Zw){return length(vec2(length(max(abs(Wr.xy)-Go.xy,0.))-Go.z,Wr.z))-Zw;}float Sn(float DV,float FG,float Pi){float La;La=clamp(0.5+0.5*(FG-DV)/Pi,0.,1.);return mix(FG-La*Pi,DV,La);}float QC(float DV,float FG,float Pi){return-Sn(-DV,-FG,Pi);}float OR(float WI,float YK,float Ai,float DE){return(1.-smoothstep(YK-Ai,YK+Ai,DE))*smoothstep(WI-Ai,WI+Ai,DE);}mat3 AQ(float Nc,float LZ){vec2 UG,Rg,HZ;UG=vec2(Nc,LZ);Rg=cos(UG);HZ=sin(UG);return mat3(Rg.y,0.,-HZ.y,0.,1.,0.,HZ.y,0.,Rg.y)*mat3(1.,0.,0.,0.,Rg.x,-HZ.x,0.,HZ.x,Rg.x);}vec2 ED(vec2 Kb,float BL){vec2 QP;QP=sin(BL+vec2(0.5*ZN,0.));return vec2(dot(Kb,vec2(QP.x,-QP.y)),dot(Kb.yx,QP));}const float UC=43758.54;float ML(vec2 Wr){return fract(sin(mod(dot(Wr,vec2(37.,39.)),2.*ZN))*UC);}vec2 Ow(float Wr){return fract(sin(mod(Wr+vec2(0.,1.),2.*ZN))*UC);}vec2 Qh(vec2 Wr){vec2 Wn=vec2(37.,39.);return fract(sin(mod(dot(Wr,Wn)+vec2(0.,Wn.x),2.*ZN))*UC);}vec4 RS(vec3 Wr){vec3 XY=vec3(37.,39.,41.);return fract(sin(mod(dot(Wr,XY)+vec4(0.,XY.xy,XY.x+XY.y),2.*ZN))*UC);}float GW(float Wr){vec2 FX;float PQ,AM;PQ=floor(Wr);AM=fract(Wr);AM=AM*AM*(3.-2.*AM);FX=Ow(PQ);return mix(FX.x,FX.y,AM);}float IH(vec2 Wr){vec2 FX,PQ,AM;PQ=floor(Wr);AM=fract(Wr);AM=AM*AM*(3.-2.*AM);FX=mix(Qh(PQ),Qh(PQ+vec2(0.,1.)),AM.y);return mix(FX.x,FX.y,AM.x);}float Ks(vec3 Wr){vec4 FX;vec3 PQ,AM;PQ=floor(Wr);AM=fract(Wr);AM*=AM*(3.-2.*AM);FX=mix(RS(PQ),RS(PQ+vec3(0.,0.,1.)),AM.z);return mix(mix(FX.x,FX.y,AM.x),mix(FX.z,FX.w,AM.x),AM.y);}float Qy(float Wr){float ON,BL;ON=0.;BL=1.;for(int RB=0;RB<5;RB++){ON+=BL*GW(Wr);BL*=0.5;Wr*=2.;}return ON*(1./1.9375);}float Sj(vec2 Wr){float ON,BL;ON=0.;BL=1.;for(int RB=0;RB<5;RB++){ON+=BL*IH(Wr);BL*=0.5;Wr*=2.;}return ON*(1./1.9375);}float TU(vec3 Wr){float ON,BL;ON=0.;BL=1.;for(int RB=0;RB<5;RB++){ON+=BL*Ks(Wr);BL*=0.5;Wr*=2.;}return ON*(1./1.9375);}float VF(vec3 Wr){float ON,BL;ON=0.;BL=1.;for(int RB=0;RB<3;RB++){ON+=BL*Ks(Wr);BL*=0.5;Wr*=2.;}return ON*(1./1.75);}float Xq(vec3 Wr,vec3 Ae){vec3 Go;float BL;Go=vec3(0.);BL=1.;for(int RB=0;RB<5;RB++){Go+=BL*vec3(IH(Wr.yz),IH(Wr.zx),IH(Wr.xy));BL*=0.5;Wr*=2.;}return dot(Go,abs(Ae));}vec3 Jc(vec3 Wr,vec3 Ae,float ON){vec4 Ck;vec3 g;vec2 Lr=vec2(0.1,0.);for(int RB=KN;RB<4;RB++)Ck[RB]=Xq(Wr+((RB<2)?((RB==0)?Lr.xyy:Lr.yxy):((RB==2)?Lr.yyx:Lr.yyy)),Ae);g=Ck.xyz-Ck.w;return normalize(Ae+ON*(g-Ae*dot(Ae,g)));}vec2 By(vec2 Wr){vec3 Pv,Up,Bd;Pv.xz=vec2((1./VJ)*Wr.x-(1./3.)*Wr.y,(2./3.)*Wr.y);Pv.y=-Pv.x-Pv.z;Up=floor(Pv+0.5);Bd=abs(Up-Pv);Up-=step(Bd.yzx,Bd)*step(Bd.zxy,Bd)*dot(Up,vec3(1.));return Up.xz;}vec2 TD(vec2 La){return vec2(VJ*(La.x+0.5*La.y),1.5*La.y);}vec2 Jp[7],Av[7];void WZ(){vec3 Lr=vec3(1.,0.,-1.);Jp[0]=Lr.yy;Jp[1]=Lr.xy;Jp[2]=Lr.yx;Jp[3]=Lr.xz;Jp[4]=Lr.zy;Jp[5]=Lr.yz;Jp[6]=Lr.zx;for(int Tm=0;Tm<7;Tm++)Av[Tm]=TD(Jp[Tm]);}vec4 Vo(vec2 Wr){vec4 JK,YO;vec2 PQ,AM,SA,Xd;float Dw;Dw=0.7;PQ=By(Wr);AM=Wr-TD(PQ);JK=vec4(4.);YO=vec4(4.);for(int Tm=KN;Tm<7;Tm++){Xd=Qh(PQ+Jp[Tm]);SA=Av[Tm]+Dw*(0.4+0.6*Xd.x)*sin(2.*ZN*(Xd.y-0.5)+vec2(0.5*ZN,0.))-AM;JK.w=dot(SA,SA);if(JK.w<JK.x){JK=JK.wxyw;YO=vec4(SA,Xd);}else JK=(JK.w<JK.y)?JK.xwyw:((JK.w<JK.z)?JK.xyww:JK);}JK.xyz=sqrt(JK.xyz);return vec4(Sn(JK.y,JK.z,0.3)-JK.x,YO.xy,ML(YO.zw));}float Yc(vec3 Wr,float VW){vec3 Kb;float SA,CO,XL;Wr-=Rk;Wr/=Em;VW/=Em;Kb=Wr;Kb.y-=2.6;XL=length(vec3(Kb.x,Kb.y+1.3,Kb.z));SA=max(GF(Kb.xz,vec2(1.02),0.03),-Dj(Kb.xz,vec2(0.99)));SA=max(max(SA,abs(Kb.y-0.5)-3.),XL-4.);SA=max(SA,min(0.015-abs(Dj(vec2(Kb.y+0.1,Kb.z),vec2(2.11,0.93))),Kb.x-1.02));Kb.xz=(abs(Kb.x)<abs(Kb.z))?Kb.xz:Kb.zx;SA=max(SA,min(min(0.45-abs(fract(Kb.y)-0.5),2.-abs(Kb.y)),min(0.85-abs(Kb.x),abs(abs(Kb.x)-0.55)-0.05)));Zs(Of);Kb=Wr;SA=max(abs(XL-4.02)-0.02,max(Dj(Kb.xz,vec2(1.2)),-Kb.y+3.1));Zs(KJ);Kb=Wr;SA=max(GF(Kb.xz,vec2(0.98),0.03),abs(Kb.y-0.1)-0.1);Zs(DR);Kb=Wr-vec3(1.02,2.6,-0.55);SA=Iq(Kb,vec3(0.08,0.15,0.04),0.03);Zs(Hn);return 0.9*Em*VW;}float NO(vec3 Wr){vec4 My;vec3 Kb;float VW,SA,La;VW=Ez;Kb=Wr;Kb.y-=TH-0.5;SA=0.9*EU(Kb.xzy,Vs,1.3);XH(Mu);VW=Yc(Wr,VW);if(EU((Wr+vec3(0.,-2.,0.)).xzy,10.,2.)<VW){My=Vo(0.5*Wr.xz);La=1.5*max(Sn(0.6,QC(0.,My.x,0.6),0.3)*(1.+My.w)*(1.-dot(My.yz,My.yz)),0.)+3.;SA=0.5*(Wr.y-La*(1.-0.01*dot(Wr.xz,Wr.xz)));XH(FC);}return VW;}float SV(vec3 Bh,vec3 QT){float Ul,SA;Ul=0.;for(int RB=KN;RB<120;RB++){SA=NO(Bh+Ul*QT);Ul+=SA;if(SA<0.0005||Ul>Ez)break;}return Ul;}vec3 Pz(vec3 Wr){vec4 Ck;vec2 Lr;Lr=5e-4*vec2(1.,-1.);for(int RB=KN;RB<4;RB++){Ck[RB]=NO(Wr+((RB<2)?((RB==0)?Lr.xxx:Lr.xyy):((RB==2)?Lr.yxy:Lr.yyx)));}Ck.x=-Ck.x;return normalize(2.*Ck.yzw-dot(Ck,vec4(1.)));}float Le(vec3 Wr){vec3 Kb;float SA;Wr-=Rk;Wr/=Em;Kb=Wr;SA=max(Dj(Kb.xz,vec2(1.)),abs(Kb.y-2.6)-2.);return Em*SA;}float OA(vec3 Bh,vec3 QT){float Ul,SA;Ul=0.;for(int RB=KN;RB<60;RB++){SA=Le(Bh+Ul*QT);Ul+=SA;if(SA<0.0005||Ul>Ez)break;}return Ul;}vec3 MP(vec3 Wr){vec4 Ck;vec2 Lr;Lr=5e-4*vec2(1.,-1.);for(int RB=KN;RB<4;RB++){Ck[RB]=Le(Wr+((RB<2)?((RB==0)?Lr.xxx:Lr.xyy):((RB==2)?Lr.yxy:Lr.yyx)));}Ck.x=-Ck.x;return normalize(2.*Ck.yzw-dot(Ck,vec4(1.)));}float WM(vec2 Wr){mat2 Nx=mat2(0.8,-0.6,0.6,0.8);vec4 HI,Hr;vec2 Kb,FX,Ql;float BT,Tq,La;Kb=0.5*Wr+vec2(0.,Jt);La=0.6*sin(dot(Kb,vec2(-0.05,1.)))+0.45*sin(dot(Kb,vec2(0.1,1.2)))+0.3*sin(dot(Kb,vec2(-0.2,1.4)));Kb=Wr;BT=1.;Tq=1.;Ql=RW*vec2(1.,-1.);for(int RB=KN;RB<3;RB++){Kb*=Nx;HI=Kb.xyxy*BT+Ql.xxyy;FX=vec2(IH(HI.xy),IH(HI.zw));HI+=2.*FX.xxyy-1.;Hr=(1.-abs(sin(HI)))*(abs(sin(HI))+abs(cos(HI)));FX=1.-sqrt(Hr.xz*Hr.yw);FX*=FX;FX*=FX;La+=Tq*dot(FX,FX);BT*=2.;Tq*=0.5;}return La;}\nvec3 Yx(vec3 Wr,float SA){vec3 PU;vec2 Lr;Lr=vec2(max(0.01,0.005*SA*SA),0.);Wr*=0.5;PU.xz=0.5*(WM(Wr.xz)-vec2(WM(Wr.xz+Lr.xy), WM(Wr.xz+Lr.yx)));PU.y=Lr.x;return normalize(PU);}vec3 Df(vec3 Bh,vec3 QT){vec3 Wr,Kb,ZJ,JX,Nt;float Zb,GB,Im,GS,Pe,Ko,Go,ID,Fh,JK,CO;int Fl;Fl=60;GB=300.;Im=1./300.;GS=0.015;Zb=0.7;Nt=mix(vec3(0.7,0.75,1.),vec3(0.4,0.38,0.38),1.-max(QT.y,0.));JX=Nt;if(QT.y>0.){Zb=clamp(Zb,0.,1.);Wr=Bh+Bu;Wr.xz+=(GB-Wr.y)*QT.xz/QT.y;Wr.y=GB;CO=1./(Im*QT.y*(2.-QT.y)*float(Fl));Pe=0.;Ko=0.;Go=0.;ID=0.;for(int RB=KN;RB<Fl;RB++){Kb=Wr+Go*QT;ID+=GS*max(Zb-TU(vec3(3.,4.,3.)*0.003*Kb),0.);Fh=(1.-Ko)*ID;Pe+=Fh*(Kb.y-GB)*Im;Ko+=Fh;Go+=CO;if(Ko>0.95)break;}JK=max(dot(QT,CB),0.);Pe+=min((1.-Ko)*pow(JK,3.),1.);ZJ=vec3(0.9,0.9,1.)*(1.3*Pe+0.1);JX=clamp(mix(Nt+vec3(0.4)*(pow(JK,8.)+0.5*pow(JK,512.)),ZJ,Ko),0.,1.);JX=mix(JX,Nt,pow(1.-QT.y,32.));}return JX;}float EQ(vec3 Bh,vec3 QT){vec3 Wr,Kb;float Zb,GB,Im,GS, Ko,Go,ID,Fh,CO;int Fl;Fl=60;GB=300.;Im=1./300.;GS=0.018;Zb=0.7;if(QT.y>0.){Zb=clamp(Zb,0.,1.);Wr=Bh+Bu;Wr.xz+=(GB-Wr.y)*QT.xz/QT.y;Wr.y=GB;CO=1./(Im*QT.y*(2.-QT.y)*float(Fl));Ko=0.;Go=0.;ID=0.;for(int RB=KN;RB<Fl;RB+=6){Kb=Wr+Go*QT;ID+=GS*max(Zb-VF(vec3(3.,4.,3.)*0.003*Kb),0.);Fh=(1.-Ko)*ID;Ko+=Fh;Go+=CO;if(Ko>0.95)break;}}else Ko=0.;return clamp(1.-Ko,0.,1.);}float HE(vec3 Bh,vec3 QT){vec3 Wr,Kb;float SA,Go,CO,JK,FT;JK=0.1*smoothstep(0.6,0.8,dot(QT,CB));FT=0.;if(JK>0.){Wr=Bh+100.*QT/max(QT.y,0.05);CO=5./max(QT.y,0.05);Go=0.;for(int RB=KN;RB<16;RB++){Kb=Wr+Go*QT;FT+=JK*(1.-FT)*smoothstep(0.8,1.,EQ(Kb,CB));Go+=CO;if(Kb.y>400.||FT>0.95)break;}}return FT;}vec3 NK(vec3 Bh,vec3 QT){vec3 JX;float a,g;g=1.2*HE(Bh,QT);a=atan(QT.x,-QT.z);if(QT.y<0.02*Qy(32.*a)+0.005)JX=mix(vec3(0.25,0.25,0.27),vec3(0.3,0.3,0.33),0.5+0.5*dot(normalize(QT.xz),-normalize(CB.xz)))*(1.-0.3*Sj(128.*vec2(a,QT.y)))+vec3(0.3,0.2,0.1)*g;else JX=Df(Bh,QT)+vec3(1.,0.8,0.6)*g;return JX;}vec3 Ng(vec2 Wr,vec2 g){vec2 Kb,TY,Zf;Kb=Wr*g;if(2.*floor(0.5*floor(Kb.y))!=floor(Kb.y))Kb.x+=0.5;TY=smoothstep(0.05,0.1,abs(fract(Kb+0.5)-0.5));Kb=fract(Kb)-0.5;Zf=0.3*smoothstep(0.3,0.5,abs(Kb.xy))*sign(Kb.xy);if(abs(Kb.x)<abs(Kb.y))Zf.x=0.;else Zf.y=0.;return vec3(Zf.x,0.8+0.2*TY.x*TY.y,Zf.y);}float UX(vec2 Wr){vec2 Kb;float SA,r;r=length(Wr);SA=max(min(0.06-abs(0.1-abs(r-0.8)),Wr.y),min(0.06-abs(Wr.y),1.1-abs(Wr.x)));Kb=ED(Wr,2.*ZN*floor(16.*((r>0.)?atan(Wr.y,-Wr.x)/(2.*ZN):0.)+0.5)/16.);SA=max(SA,min(min(0.06-abs(Kb.y),0.2-abs(Kb.x+1.1)),Wr.y+0.1));Kb.x+=1.5;SA=max(SA,min(0.1-length(Kb),Wr.y+0.1));return SA;}vec4 Md(vec3 Bh,inout vec3 PU,out vec2 Oj){vec4 My,LI;vec3 Wa;float a;Oj=vec2(0.);if(IY==Mu){a=atan(Bh.z,-Bh.x)/(2.*ZN);if(Bh.y>TH){if(dot(normalize(Bh.xz),PU.xz)>0.9){LI=vec4(0.9,0.7,0.5,0.05);LI*=0.5+0.5*Sj(vec2(32.*a,4.*Bh.y));Wa=Ng(vec2(a,Bh.y+0.05),vec2(30.,3.));LI*=Wa.y;if(Wa.x==0.){PU.y+=Wa.z;PU.xz*=sqrt(1.-PU.y*PU.y);}else PU.xz=ED(PU.xz,-Wa.x);}else LI=vec4(0.4,0.3,0.2,0.05);Oj=vec2(50.,1.);}else{LI=vec4(1.,0.8,0.2,0.05);LI*=0.7*(0.5+0.5*Sj(vec2(64.*a,4.*Bh.y)));Oj=vec2(10.,5.);}}else if(IY==FC){My=Vo(Bh.xz);Oj=vec2(2.,5.);LI=0.7*mix(vec4(1.,0.7,0.2,0.),vec4(0.9,0.8,0.5,0.),0.5*Ks(8.*(1.+My.w)*Bh)+0.5*My.w)*(0.7+0.3*smoothstep(0.,0.4,Bh.y));}else if(IY==Of){LI=vec4(1.,0.2,0.,0.2);if(abs(LM.y-2.25)<0.15)LI*=0.7;LI=mix(LI,vec4(1.,0.,0.,-1.),smoothstep(-0.01,0.01,UX(8.*(LM.xy-vec2(0.,2.15)))));Oj=vec2(64.,1.);}else if(IY==KJ){LI=vec4(0.6,0.6,0.6,0.2);Oj=vec2(64.,0.2);}else if(IY==DR){LI=(LM.y>0.1)?vec4(0.3,0.4,0.3,0.):vec4(0.3,0.,0.,0.);Oj=vec2(64.,0.5);}else if(IY==Hn){LI=vec4(0.8,0.8,0.2,0.2);}return LI;}vec3 Lv(vec3 Bh,vec3 QT){vec4 LI;vec3 PU,JX,CS,SE;vec2 Oj;float Gk,JG,HV;bool Vb;WZ();TH=4.;Vs=3.;Em=1.5;Rk=vec3(0.,4.8,0.);RW=0.2*Jt;Bu=Jt*vec3(-15.,0.,5.);Vb=false;CS=Bh;SE=QT;JG=(QT.y<0.)?-Bh.y/QT.y:Ez;for(int Tm=KN;Tm<2;Tm++){Gk=SV(Bh,QT);if(Tm==0&&JG<min(Gk,Ez)){Vb=true;Bh+=JG*QT;PU=Yx(Bh,JG);QT=reflect(QT,PU);Bh+=0.01*QT;}else break;}if(Gk<Ez){Bh+=QT*Gk;PU=Pz(Bh);LI=Md(Bh,PU,Oj);if(Oj.x>0.)PU=Jc(Oj.x*Bh,PU,Oj.y);if(LI.a>=0.){JX=LI.rgb*(0.2+0.2*max(dot(CB*vec3(-1.,1.,-1.),PU),0.)+0.8*max(dot(CB,PU),0.))+LI.a*pow(max(dot(CB,reflect(QT,PU)),0.),32.);}else{JX=LI.rgb*(0.3+0.7*max(-dot(QT,PU),0.));}}else if(QT.y<0.){Vb=true;JG=-Bh.y/QT.y;Bh+=JG*QT;JX=NK(Bh,reflect(QT,Yx(Bh,JG)));}else{JX=NK(Bh,QT);}if(Vb){JX=mix(mix(vec3(0.01,0.01,0.),vec3(0.,0.05,0.05),smoothstep(0.4,0.6,Sj(0.5*Bh.xz))),0.5*JX,1.-pow(abs(QT.y),4.));}Bh=CS;QT=SE;HV=OA(Bh,QT);if(HV<min(Ez,Gk)){Bh+=QT*HV;PU=MP(Bh);QT=reflect(QT,PU);JX=mix(0.9*JX,NK(Bh,QT),0.2+0.8*pow(1.-abs(dot(PU,QT)),5.));}return clamp(JX,0.,1.);}void mainImage(out vec4 Cx,in vec2 Ei){mat3 RF;vec4 Yt;vec3 Bh,QT,JX;vec2 SR,Az;float Nc,LZ,Fp,Xu;\nDA=iFrame;SR=iResolution.xy;Az=2.*Ei.xy/SR-1.;Az.x*=SR.x/SR.y;Jt=iTime;Yt=iMouse;Yt.xy=Yt.xy/SR-0.5;\nEz=100.;LZ=0.2*ZN;Nc=0.;if(Yt.z>0.){LZ+=3.*ZN*Yt.x;Nc+=0.5*ZN*Yt.y;}else{LZ+=2.*ZN*(2.*mod(floor(0.01*Jt),2.)-1.)*OR(0.25,0.75,0.1,mod(0.01*Jt,1.));}Nc=clamp(Nc,-0.2*ZN,-0.01*ZN);RF=AQ(Nc,LZ);Fp=4.-0.8*cos(2.*LZ);Bh=RF*vec3(0.,7.,-50.);CB=normalize(vec3(0.1,0.5,1.));float BP=1.;JX=vec3(0.);Xu=2.*mod(dot(mod(floor(0.5*(Az+1.)*SR),2.),vec2(1.)),2.)-1.;for(float BL=float(KN);BL<BP;BL++){QT=RF*normalize(vec3(Az+step(1.5,BP)*ED(vec2(0.5/SR.y,0.),Xu*(0.667*BL+0.5)*ZN),Fp));JX+=(1./BP)*Lv(Bh,QT);}Cx=vec4(JX,1.);}\n",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}