{
    "Shader": {
        "info": {
            "date": "1490519372",
            "description": "#5 - Epitrochoid",
            "flags": 0,
            "hasliked": 0,
            "id": "4dBcRz",
            "likes": 5,
            "name": "[ Famous curves ] - #5",
            "published": 3,
            "tags": [
                "2d",
                "curve",
                "blend",
                "rotation",
                "path",
                "parametric",
                "epitrochoid"
            ],
            "usePreview": 0,
            "username": "Yrai",
            "viewed": 608
        },
        "renderpass": [
            {
                "code": "\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n\n/*\n   Epitrochoid facts:\n  --------------------\n\t- (a) The circle of radius b rolls on the outside of the circle of radius a. The point P is at a\n\t\t  distance c from the center of the circle of radius b.\n\n*/\n\n#define res_            iResolution\n#define time_           iTime\n#define trace_len_      322\n#define eps_            .2\n\n#define crot(a)  mat2(cos(a),-sin(a),sin(a),cos(a))\n\nvec2  domain(vec2 uv, float s);\nvec2  parametric(float t);\nfloat trace(vec2 p, float t);\nfloat _union_chamfer(float a, float b, float r);\n\nvoid mainImage(out vec4 o, vec2 f) {\n\tvec2 p = domain(f, 6.);\n    vec2 np = f / res_.xy;\n    \n  \tp *= crot(time_*.2);\n    \n    // t -> [0., 5.]\n    float t = time_ * sign(sin(time_));\n    \n    // Epitrochoid traces\n    float dtrace = smoothstep(0.19, 0.01, trace(p, t));\n    // Axis\n    float ax = min(\n        smoothstep(0., 0.02, abs(p.x)),\n        smoothstep(0., 0.02, abs(p.y))\n    );\n    // Origin\n    float org = smoothstep(0.09, 0., length(p)-.01);\n    \n    // Palette \n    vec3 gray   = vec3(.2);\n    vec3 white  = vec3(5.);\n    \n    // Shading\n    vec3 c  = vec3(0.);\n    c = mix(c, gray, fract(1.-ax));\n    c = mix(c, white, org);\n    \n    c = mix(c, vec3(1.), dtrace);\n\tc = mix(c, vec3(1., 0., 0.), dtrace/length(p*2.2)*3.);\n    c.b += dtrace*p.x;\n    \n    o = vec4(c, 1.);\n}\nfloat _union_chamfer(float a, float b, float r) {\n\treturn min(min(a, b), (a - r + b)*sqrt(0.5));\n}\n\n\nvec2 parametric(float t) {\n    t /= atan(t, 2.*t);\n\tfloat a = 2.;\n    float b = 1.2;\n    float c = 1.9;\n    return vec2( (a+b)*cos(t) - c*cos((a/b + 1.) * t), (a+b)*sin(t) - c*sin((a/b + 1.) * t) );\n}\n\nfloat trace(vec2 p, float t) {\n    float d = 1e10;\n    float e = 0.;\n    for(int i = 0; i < trace_len_; i++) {\n    \td  = _union_chamfer(d, distance(p, parametric(t-e)), parametric(t).y * .15);\n        e += eps_; \n    }\n    return d;\n}\n\nvec2 domain(vec2 uv, float s) {\n    return (2. * uv.xy - res_.xy) / res_.y * s;\n}\n\n",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}