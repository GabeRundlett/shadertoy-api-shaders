{
    "Shader": {
        "info": {
            "date": "1635954519",
            "description": "the 7 bars have increasing bulge.\nNote that the exp-based smooth min must be protected for robustness.\n\nmouse controls camera.",
            "flags": 0,
            "hasliked": 0,
            "id": "fl3GDr",
            "likes": 12,
            "name": "smin in raymarching",
            "published": 3,
            "tags": [
                "raymarching",
                "sdf",
                "short"
            ],
            "usePreview": 0,
            "username": "FabriceNeyret2",
            "viewed": 394
        },
        "renderpass": [
            {
                "code": "#define rot(a)        mat2(cos(a+vec4(0,11,33,0)))                // rotation\n\n//#define smin(a,b,k)   log( exp(k*(a)) + exp(k*(b)) ) / k        // smooth min\n  #define smin(a,b, k)  ( -k*min(a,b) > 4. ? min(a,b) : log( exp(k*(a)) + exp(k*(b)) ) / k )\n\n//#define cyl(a,b)      max( length(a)-.1, abs(b) -3. )           // cylinder\n#define cyl(a,b)        max( abs(length(a)-.1)-.01, abs(b) -3. )  // hollow cylinder\n\nvoid mainImage(out vec4 O, vec2 U)\n{\n    float t=9., s; \n    vec3  R = iResolution, d, Y = vec3(0,1,0),\n          D = normalize(vec3((U+U-R.xy)/R.y, -3.)),   // ray direction\n          p = vec3(0,0,8), q,a,                       // marching point along ray \n          M = iMouse.z > 0. ? iMouse.xyz/R -.5: vec3(10,12,0)/1e2*cos(iTime+vec3(0,11,0))+vec3(0,.12,0); \n\n    for ( O=vec4(1); O.x > 0. && t > .005; O-=.005 ) {\n        q = p,\n        q.yz *= rot(.5-6.3*M.y),                      // rotations\n        q.xz *= rot(-6.3*M.x),\n        a = abs(q),\n        t = min(9., max( max(a.x,a.z)-1., a.y-2.) ),  // 3 same bulge\n        s = min(      cyl(q.xy-   Y.xy, q.z+.3),\n                 min( cyl(q.xy-.5*Y.xy, q.z-.3),\n                      cyl(q.xy        , q.z-.9)\n               )    ),\n        t = smin( t, s , -10.);\n        t = max(t, - min( min( length(q.xy + .5*Y.xy), length(q.xy + Y.xy) ),\n                               length(q.xy +1.5*Y.xy) ) + .13 );\n        for ( float j= 0.; j< 7.; j ++ )              // rack with varying bulge\n           t = smin( t, cyl(q.zy-(j-3.)/1.7*Y.xy, q.x+.3*(j-3.)/2. ) , -(4.+j) );\n\n\n        p += .25*t*D;                                 // step forward = dist to obj\n    }\n                                                      // material\n    O *= 1.2* texture(iChannel0, a.x>max(a.y/2.,a.z) ? a.yz : a.y/2.>max(a.x,a.z) ? a.xz : a.xy );\n}\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 1,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}