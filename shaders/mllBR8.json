{
    "Shader": {
        "info": {
            "date": "1692623389",
            "description": "Water and air are continuous volumetric material, but many are made of opaque particles ( pigments, foliage... ).\nTrap: the volume density or the mass density tell nothing about transparency: same volume split in smaller particles is more opaque.\n",
            "flags": 0,
            "hasliked": 0,
            "id": "mllBR8",
            "likes": 12,
            "name": "volumetric trap #1: \"density\"",
            "published": 3,
            "tags": [
                "volumetric",
                "2tweets",
                "tuto",
                "short"
            ],
            "usePreview": 0,
            "username": "FabriceNeyret2",
            "viewed": 301
        },
        "renderpass": [
            {
                "code": "// === volumetric trap: even at constant amount, size matters. \n//     consider number density rather than volume density.\n\n// see also:   volumetric trap #2: \"Ti*𝛙*To\"    https://www.shadertoy.com/view/mtsfR8\n//             volumetric trap #3: dens vs occl https://www.shadertoy.com/view/clsfRN\n\n\n#define S(v,r) smoothstep( 2./R.y, -2./R.y, length(v) - r )\n\nvoid mainImage( out vec4 O, vec2 u )\n{\n    vec2  R = iResolution.xy, F,I,\n          U = ( u+u - R ) / R.y;\n\n    float i = pow( 1.3, ceil((U.y+1.06)/.1) ); // partic radius = .1/i , total occluders volume = cst \n                                               // → number density ρ ~ i³ , partic cross section σ = πr² ~ 1/i²\n                                               // → T = exp( -σρL ) ~ exp( - i L )   \n                                               // ( proof: dI = -I*σρ → dI/I = -σρ → log(I)=-σρx → I = exp(-σρL)  )\n    O = vec4(sqrt(                                   // to sRGB\n              U.x < 0.                       \n                ?  F = fract(U*i), I = floor(U*i),   // --- left: draw particles ( 2D slice in 3D volume )\n                   S( ( F -.9 + .8*fract(1e4*sin(I*mat2(R,71.-R)+i)) ) /i, .1/i )  \n                : 1. - exp( -i/40. )                 // --- right: corresponding opacity\n            ));\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}