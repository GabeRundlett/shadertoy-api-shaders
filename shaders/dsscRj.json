{
    "Shader": {
        "info": {
            "date": "1687015750",
            "description": "It's an eye",
            "flags": 0,
            "hasliked": 0,
            "id": "dsscRj",
            "likes": 30,
            "name": "ðŸ‘€",
            "published": 3,
            "tags": [
                "eye"
            ],
            "usePreview": 1,
            "username": "SnoopethDuckDuck",
            "viewed": 248
        },
        "renderpass": [
            {
                "code": "#define res iResolution.xy\n#define pi 3.14159\n#define tanh2(a) ((exp2(a)-1.)/(exp2(a)+1.))\n#define thc(a,b) tanh2((a)*cos(b))/tanh2(a)\n#define ths(a,b) tanh2((a)*sin(b))/tanh2(a)\n#define Dir(a) vec2(cos(a),sin(a))\n#define rot(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n#define ss(a, b) smoothstep(-a/res.y, a/res.y, b)\n\nfloat h11(float p) {\n    p = fract(p * .1031);\n    p *= p + 33.33;\n    p *= p + p;\n    return fract(p);\n}\n\nvoid mainImage( out vec4 O, in vec2 px )\n{\n    vec2 uv = (px - 0.5 * res) / res.y;\n    vec2 ouv = uv;\n    float t = iTime;\n    \n    // Intro zoom\n    uv *= mix(9., 1., tanh(t));\n    \n    // Two eyes\n    if (iMouse.z > 0.) {\n        uv *= 1.5;\n        uv.x = sign(uv.x) * (abs(uv.x)-0.65);   \n    }\n    \n    vec3 col = vec3(0);\n       \n    float r1mn = 0.1 - 0.5 * (step(12., t) - step(19., t)); // 0.1 -> -0.4, looks cool  \n    float r1mx = 0.36;\n    float rosc = .5 + .5 * thc(7., t);\n    float r1 = mix(r1mn, r1mx, rosc);\n    float r2 = 0.49; // 0.5\n    \n    float a = atan(uv.y, uv.x);\n    float d = length(uv);\n    float dr = (d - r1) / (r2 - r1); // rescaled d to [r1,r2] range\n         \n    // store pcol stuff\n    vec3 col2 = vec3(0);\n    \n    float n = 17.;\n    for (float i = n-1.; i >= 0.; i--) {\n        // Split into regions by angle\n        a += pi / n;\n        float sc = floor(0.25*i)+7.;\n        float fa = fract(sc*a/pi + 0.4*cos(3.*d+a*i - 0.08*t)) - 0.5; \n        float ia = floor(sc*a/pi) + 0.5;\n            \n        // mix stuff (?) between r1, r2\n        float osc = (.5+.5*thc(80. * (r2-r1)*(r2-r1), 0.25*pi*h11(i+ia)+ 12.*dr));\n        float r3 = 0.02 + 0.05/cosh(-2.*dr)* osc\n                 + 0.15 /cosh(-34.*abs(d-r1));\n        r3 *= 1.25 - 0.5 * h11(ia);\n         \n        // mix between inner and outer color\n        vec3 pcol = .5 + .5 * cos(2.*pi*(0.4*i/n + 0.45*vec3(0.2,1,2)/3.));\n        vec3 pcol2 = .5 + .5 * cos(2.*pi*(0.8*i/n + 0.*vec3(0.2,1,2)/3.));\n        pcol2 = vec3(2,1.3,0.5) * clamp(1.-dr,0.,1.);       \n        \n        pcol = mix(pcol, mix(pcol2, pcol, 0.*dr*dr+0.9*exp(-3.*dr)), 0.8);\n        pcol = clamp(pcol, 0., 1.);\n        \n        float s = smoothstep(0., 0.04, r3 /d - abs(fa));\n        col = mix(col, pcol, s);       \n    }\n    \n    // Redden and lighten\n    col = mix(col, vec3(1), 0.12/cosh(100.*max(0., 0.8 * r2 - d)));\n    col = mix(col, vec3(1,0.4,0), 0.16/cosh(10.*max(0., 0.8 * r2 - d)));\n    \n    // Apply tint outside eye\n    vec3 tint = mix(vec3(0), vec3(1, .55, .2), 1. / cosh(4.*max(0., d-r2)));\n    col = mix(col, tint * col, 0.4 / cosh(100.*max(0., r2-d))); // do 1. - 1./...\n    \n    // Darken pupil\n    col *= 0.28+0.72 / cosh(200.*max(0.,r1-d));\n    \n    // Blue noise texture\n    float tx = texture(iChannel0,0.5*vec2(a/pi, dr)).r;\n    col *= mix(1., 0.5 + tx, exp(-1.5*dr));\n    \n    // Background bars\n    col *= .65+.35*smoothstep(-0.2, 0.2, 0.65- abs(uv*rot(pi/4.)).x);\n   \n    // Pupil reflections\n    float l = max(0., length(uv - vec2(r1/sqrt(2.)-0.04))-0.015);\n    col = mix(col, vec3(1), exp(-5.*sqrt(l)));\n    float l2 =max(0., length(uv - vec2(0.6,-1)*r1/sqrt(1.+.6*.6))-0.005);\n    col = mix(col, vec3(1), exp(-7.*sqrt(l2)));\n    \n    // Arc reflection\n    float arc = exp(0.4-20.*(abs(d - mix(r1, r2, 0.5))));\n    arc *= clamp((uv*rot(pi/4.)).y + 0., 0., 1.);\n    col += 0.4 * arc;\n\n    // Video\n    vec3 vid = texture(iChannel1, (uv+0.5)).rrr;\n    vec3 vid2 = texture(iChannel2, (uv+0.5)).rrr;\n    vid = mix(col, mix(vid,vid2,rosc), max(0.2 * tanh(0.05*max(0.,t-8.)), step(15., t)));\n    col = mix(vid, col, smoothstep(0., 0.1, d - r1+0.1));\n    \n    // Gamma and saturate\n    col = pow(col, vec3(1./1.2));\n    col *= 1.06;\n    \n    // Clicky\n    if (iMouse.z > 0.)\n        col *= 1.-1. / cosh(100. * abs(ouv.x));\n    \n    O = vec4(col, 1);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "video",
                        "id": 11,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/a/c3a071ecf273428bc72fc72b2dd972671de8da420a2d4f917b75d20e1c24b34c.ogv"
                    },
                    {
                        "channel": 1,
                        "ctype": "video",
                        "id": 29,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/3405e48f74815c7baa49133bdc835142948381fbe003ad2f12f5087715731153.ogv"
                    },
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 14854,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/cb49c003b454385aa9975733aff4571c62182ccdda480aaba9a8d250014f00ec.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}