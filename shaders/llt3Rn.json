{
    "Shader": {
        "info": {
            "date": "1467734416",
            "description": "Well, here is my try. I'm getting 0.11% difference with Resemble.js",
            "flags": 0,
            "hasliked": 0,
            "id": "llt3Rn",
            "likes": 1,
            "name": "[SH16A] Challenge Accepted",
            "published": 3,
            "tags": [
                "challenge",
                "sizecoding",
                "shadertoycompetition"
            ],
            "usePreview": 0,
            "username": "mu6k",
            "viewed": 650
        },
        "renderpass": [
            {
                "code": "#define N normalize\n#define F for( int i=0; i<64; i++ )\n#define R iResolution\n\nvec2 M( vec3 p )\n{\n    vec2 r=vec2(p.y,13.);\n    float s;\n    for(int y=0;y<5;y++)\n        for(int x=0;x<5;x++){\n            float s=.4-.15*mod(float(x+y),2.)\n                , d=length(p-vec3(float(x)-2.,s,float(y)-2.))-s\n                , t=float((x*5+y)/2);\n            if (d<r.x)r=vec2(d,t);\n        }\n    return r;\n}\n\nvoid mainImage( out vec4 C, vec2 O )\n{\n\tvec3 \n        o = vec3( 3.*cos(5.), 2, 3.*sin(5.) ), \n        w = N(vec3(0,-.2,0)-o),\n\t    u = N( vec3(-w.z,0.,w.x) );\n\tvec3 d = mat3( u, N( vec3(-u.z*w.y, -u.x*w.z + u.z*w.x, u.x*w.y) ), w ) \n        * N( vec3((-1.+O/R.xy*2.)*vec2(R.x/R.y,1.),2.0) ),\n        p=o;\n\n    // render\t\n    float t=.0,m;\n    \n    //primary ray\n    F\n    {\n        vec2 q = M( p );\n        t += q.x;\n        m = q.y;\n        p = o+d*t;\n    }\n\n    vec3 \n    \t//compute normal\n        e = vec3(.001,0,0),\n        n = N(vec3(\n            M(p+e.xyy).x - M(p-e.xyy).x,\n            M(p+e.yxy).x - M(p-e.yxy).x,\n            M(p+e.yyx).x - M(p-e.yyx).x )),\n        //sphere material\n        c = vec3(1.-m*.08, m*.03, m*.06);\n\n    //floor material\n    if( m>=12.5 ) \n    {\n        if( mod(p.z,2.)<1. ^^ mod(p.x,2.)>1. )\n            c = vec3(.4);\n        else\n            c = .5*texture( iChannel0, (floor(25.6*p.xz + vec2(37.,17.))+ 0.5)/256., -100. ).yyy;\n\n        if( max( abs(p.x), abs(p.z)) < 1.5 )\n            c *= smoothstep(.0,.5,length(mod(p.xz+.5,1.)-.5));\n\n    }\n\n    vec3 l = N(vec3(-.6,.7,-.5));\n    \n    //secondary ray (shadow)\n    t=.01,m=1.;\n    F\n        t += M( p+l*t ).x;\n    if( t<=2.5 )m=.0;\n\n    // lighitng        \n    float f = clamp(dot(n, l ),0.,m);\n\n    //mix\n    c=c*(1.2*f*vec3(1,.85,.55) + .25*(1.0+n.y)*vec3(.5,.7,1)) + pow(clamp( dot(reflect(d,n), l ),0.,1.),16.)*f;\n\n    C=vec4(sqrt(c),1);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 30,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}