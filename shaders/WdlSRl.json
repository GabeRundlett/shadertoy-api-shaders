{
    "Shader": {
        "info": {
            "date": "1551885153",
            "description": "https://www.shadertoy.com/view/4l2BW3\nhas utility for an [offline shadertoy] and i keep seeing this being requested on shadertoy discussions.\nits VERY hacky\ncopy commonTabText into a html file, you can figure this out;open any html file in a text editor",
            "flags": 1,
            "hasliked": 0,
            "id": "WdlSRl",
            "likes": 6,
            "name": "offlineShadertoy tS325-216k.html",
            "published": 3,
            "tags": [
                "notextures",
                "offline",
                "hacky",
                "nofont"
            ],
            "usePreview": 0,
            "username": "ollj",
            "viewed": 1110
        },
        "renderpass": [
            {
                "code": "//main feature here is the whole HTML code in the commontab\n//when copied into a html file,you get an offlineShadertoy.html\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    ;uv=fract(uv*3.);\n\n    // Time varying pixel color\n    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));\n\n    // Output to screen\n    fragColor = vec4(col,1.0);\n}\n\n\n/*\n\ni made 2 html files that are [offline shadertoy]\nself  : https://www.shadertoy.com/view/WdlSRl\nparent: https://www.shadertoy.com/view/3slSRl\nthe html code is in the common-tab of these domains.\n\nboth are a messy hacky crippled reverse-engineered conversions.\ncurrently in [heavy testing] stage.\nboth have no codemirror , and are single .html files to edit in a text editor\nif you have a bug in the opengl code, it will nto tell you the right line number within your html file, but it will describe the error.\n\none version only has the imageBuffer and Webaudio (in webgl and webgl2), mouseIn and webm Out.\nand is <61 k in size, can hack a quick 64k demo in [offline shadertoy] with this, has a working volume slider!\n\nthe other version is 220k small and has working features:\n- Webgl, webgl2, with all extensions that shadertoy lists.\n- mouseIn\n- KeyboardIn\n- opengl to webaudio [44,22,11]kHz\n- 4 double buffers whos previous frame can be loaded via texture(ichanel0,uv.xy)\n- Webm recording\n- fullscreen\n- audio syncs nicely with video for 180 seconds, pausing&resuming the audio desyncs it with the video.\n- can still change settings of buffers (thugh my ui is a bit crippled,it may have starting issues like an old car)\nnot managed to make work, but may just work with minor tweaks:\n- soundCloud in (may change a link to a local source somewhere, i didnt look into the httpreq part of that)\n- imageIn (same issue, can not use ANY texture, as these are streamed)\n- videoin (works not, just like ImagweIn...)\n- EnvMap\n- texture3d\n- Buff3d\n- webvr, code is still in, untested, be the forst to try Webvr shadertoy on a plane!\n\n(actually may be easy to add a 5th... double buffer to make up for lack of textureStreaming)\nso, it doesnt give you fast foutierTransformed ideal blue noise buffers, but a bayer matrix is fine , too.\n\ni still need to figure out how to fix its most basic UI issues, its html tables for now, just for simplicity.\n, with all my hacky gluelogic that i bridged over the httpReq and json code\n, i barely know what my [offline shadertoy] can and can not do.\n\nthe boilerplates of both files can [easily] be optimized and made roughly half as big, but the art is to not brak anything while crunching it.\n\n/**/",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "/*   //remove this line from the html documentm and the very last line of it\n\n\n\n\n\n\n<!DOCTYPE html>\n<html><head><title></title>\n<script>\nvar gVol=0.1//volume scalar, .1 for noisy square waves.\nvar cVer=\"tS326\"//aka:[run5v2] mess of 216k, 4 doubolebuffers + keyin, will test 500 shaders codes with this canvas to see its limits\n//scripts are segmented for priority and contextual string-concatenation of fragment shader code\n//moved to top because it sets opengl context modes,kinda important to debug.\nvar wMs=[\"experimental-webgl\",\"webgl\",\"experimental-webgl2\",\"webgl2\"]\n//var wMs=[\"webgl2\"]\nvar wM=3;//try version wMs[wM],and if that is not supported,diminish wM and retry.\n\n//this is an attempt at an offline-shadertoy\n//- uses code from [shadertoy.com] as of 2018-08, which uses [piLibs 2014-2017]\n//- - currently as 200k single html, instead of its >2000k source material (with icons)\n//- runs in webgl and webgl2 , as set by this script part.\n//- MouseIn andKeyboardIn, as in shadertoy.com\n//- webvr code is left in, but may not work at all, i can not test this.\n//- 4 buffers can refer to their DoubleBuffers of the last frame, and do some fluidDynamics by cross-referencing each other\n//- a 5th Image composites a final image to be displayed each frame, it can not refer to its previous frame image\n//- fullscreen mode (sadly rescales the buffers, and there is no backbuffer translation)\n//- a record button outputs to .webm\n//- a 6th Image is used for Webaudio fmSynthesis, [3,6,12] minutes of audio on [reset] are not realtime-dynamic (besides a volumeNode)\n//- - not dynamic means we can not make a realtime keyboard-instrument, only scripted static sequences\n//- - funniest thing with this is to define a gradient that visibly chages over time\n//- - , to be also parsed as fmSynthMusic in its timeNow state, using [audiovisual] commontab code.\n//for simplicity\n//- no codemirror editor, thats a 200k monster, use notepad++ or notepad2\n//- no error handling, optimism asserts competent coder, opengl syntax errors are alert()ed (poorly)\n//- minimalistic style without icons, to keep it small and simple\n//- no online functionality (streaming media, community), sadly ALL static texture buffers are [ahref=] and also too large for this\n//- - i may include some methods to do some texture-like stuff, at least all the bayer-matrix functions\n//- i have plans to add a lot of useful html sliders\n//- the ui is a work in progress, and a mess, klick the [soundCodeToggle] button to resolve many issues.\n\nfunction piCreateGlContext(cv,useAlpha,useDepth,usePreserveBuffer,useSupersampling){var opts=\n {alpha:useAlpha\n ,depth:useDepth\n ,stencil:false\n ,premultipliedAlpha:false\n ,antialias:useSupersampling\n ,preserveDrawingBuffer:usePreserveBuffer\n ,powerPreference:\"high-performance\"};//\"low_power\",\"high_performance\",\"default\"\n ;m=null\n ;while(wM>-1&&!m){m=cv.getContext(wMs[wM--],opts)}\n ;wM++\n ;return m;}\nvar CoMi=\"on\"//\"on\" \"off\"\nfunction gei(a){return document.getElementById(a);}\nfunction get(a){return gei(a).textContent;}//stringConcatenationExample:var striii=\"aaaa\"+get('o')+\"tail\"\nfunction set(a,b){gei(a).textContent=b;}//yeah needs to be this, can not use [c=set(a);c=d]\n\n\n//6 code snippets below are plain text opengl fragment shader bodies\n//their head and tail depend on context and oppenGL version\n//, this is a glue-logic concatenation-puzzle\n\n</script><!--opengl commontab code is shared by all 5 shaders, and as such it can not refer to any ichannelN\n, as these depend on the outerContext of the commonTab--><script id=\"o\">\n\n#define PHI (sqrt(5.)*.5+.5)\n//set tempo (pitch stays constant)\n//#define tempo PHI\n//#define tempo 1.\n#define tempo (PHI+(mix(0.,.05,cos(t))))//i know this is not good in terms of calculus derivatives\n//its lazy and experimental for now\n\n//uncomment below line to make tempo constant.\n//#define tempo 1.\n\n//parent     : https://www.shadertoy.com/view/4t3fDN\n//grandparent: https://www.shadertoy.com/view/ldXBzH\n//I like how ldXBzH does sequencing with a note key and some chords of different instruments\n//its not a good general solution, but i already have that one in mind.\n\n\n//you see time on the x-axis, frequency on the y axis\n//- white bars/dots indicate TimeNow and tempo\n//- rainbow indicates a piano roll melody with 4 voices\n\n//you hear is 3 upper voices, oscillating over a random melody, by a differential over time\n//and a 4th lowest voice oscillates ebetween 2 keys by its antiderivative (so it never reverses)\n//- i admit, having 1/4 melodies as its differential over time is semi-nauseating.\n\n//the dynamic tempo over time only gets more confusing after 33 seconds\n//, when the piano roll starts to reverse regularily\n\n//drunk DJ-DNancarow spins a piano-sheet with an oscillating cosine()-differential\n//A mod() melody can adjust tempo (over time) \n//while keeping pitches constant \n//- works without fourier transform, because instruments are a top-level function\n//- , and not baked as a aum of cosines onto vinyl (low level code begs for tricky inversions)\n//AND its lowest voice even stays in a constant oscillation over time (scaled by time)\n//- (that means, the up-down-never halts, because it is somehow set by a derivative or the time shift)\n\n//i am not exactly shure how all of this works\n//,but i know some ways to improve it (so it would work well with sine-wave-instruments)\n//,but that add more branches or mod(), and i want to keep this simple.\n\n//the white dot sets the tempo, its the tempo of the lowest voice.\n//the tempo of the 3 upper voices is shown as background 4th voice visuals do not match the audio)\n//the 3 upper voices are placed over time, with the differntial of the tempo (the white dot)\n//that makes it pan backwards regularily, after 33 seconds.\n\n\n#define vec1 float\n\n#define viewZoom 4.\n#define fra(u)(u-.5*iResolution.xy)*viewZoom/iResolution.y\n#define frc(u)(u-.5*r.xy)*viewZoom/r.y\n#define Aa min(iResolution.x,iResolution.y)\n#define Cc min(r.x,r.y)\n#define cC 1./Cc\n#define aA 1./Aa\nvec2 cs(float a){return vec2(cos(a),sin(a));}\n\n#define Phi (sqrt(5.)*.5+.5)\n#define phi (sqrt(5.)*.5-.5)\n#define pi acos(-1.)\n#define sat(a) clamp(a,0.,1.)\n#define dd(a) dot(a,a)\n#define u2(a) ((a)*2.-1.)\n#define u5(a) ((a)*.5+.5)\n#define sat(a) clamp(a,0.,1.)\n#define pow2 exp2\n#define ss(a,b) smoothstep(b,-b,a)\n#define TT(d) mod(mod(time,1.0)-d,1.0)\n#define trunc(a) float(int(a))\n#define ma0(a) max(0.,a)\nvec2 fr(float a){return vec2(fract(a),floor(a));}\nfloat su(vec4 a){return a.x+a.y+a.z+a.w;}\n\n#define HASHSCALE1 .1031\nfloat hash1(float p\n){vec3 q=fract(vec3(p)*HASHSCALE1)\n ;q+=dot(q,q.yzx+19.19)\n ;return fract((q.x+q.y)*q.z);}\nint rand1To8(float t){return int(hash1(t)*8.);}\n\n//https://www.shadertoy.com/view/ldXBzH\n//instrument subroutines\n\n//this is a messy family of functions that are only almost identical:\n//so, which one to use depends a lot on contextual shifts\n//i came to the conclusion that it is smart to defer the pow() that is needed for equal temperment harmony\n//the trick is that you accumulate waveforms in a stride of 12 semitones\n//this way you only need a semitone LUT, and NEVER need to do any pow() (except to construct the LUT)\n//this decapitates all these [frontload]ing functions\nfloat n2f      (float n){return 55.*pow(     2.,(n- 3.)/12.);}//frontload equal temerpent\nvec4 n2f        (vec4  n){return 55.*pow(vec4(2),(n- 3.)/12.);}//frontload equal temerpent\nfloat noteFreq (int   n){return n2f(float(n+39));}\nfloat noteKeyA (float n){n=mod(n,8.)\n ;if(n==0.)return 1046.5 ;if(n==1.)return 1174.66;if(n==2.)return 1318.51;if(n==3.)return 1396.91\n ;if(n==4.)return 1567.98;if(n==5.)return 1760.00;if(n==6.)return 1975.53;return 2093.;}\n//float noteKeyA (float n){float[] notes = float[](1046.5,1174.66,1318.51,1396.91,1567.98,1760.,1975.53, 2093.); \n//                         return notes[int(n)%8];}//this could use https://www.shadertoy.com/view/Xl3BD4\n//above is base 66, below is base 440.\nvec4   noteMIDI(vec4   n){return 440.*pow(vec4(2),(n-69.)/12.);}\nfloat noteMIDI (float n){return 440.*pow(     2.,(n-69.)/12.);}\nfloat calcHertz(float n){return 440.*pow(     2.,(n    )/12.);}\n//i know a better way to do this, i just never implemented its stride of 12, with a loop within a loop.\n\n//subroutines for //https://www.shadertoy.com/view/ldXBzH\nfloat ix(float o,float idx){return exp2(o)*noteKeyA(idx);}\nfloat ox(float t,float o,float idx){return ix(o,idx)*fract(t/2.)*pi*.8;}\n\n//instruments //https://www.shadertoy.com/view/ldXBzH\nfloat note(float k, float o,  float t){return sin(ox(t,o,k));}\nfloat noteSaw(float k, float o, float t){return tan(note(k,o,t));}\nfloat noteSquare(float idx, float o, float t\n){float a=floor(fract(t*2.)*2.+1.)*fract(t*.5)*.1\n ;return 3.*(fract(a*ix(o,idx))-.5);}\n\n//play melody of parent (longer notes), or own melody (faster)\n#define parentMelody\n\n\n//melody() returns a frequencyKey for input time [t], it has no chords (that would need a loop)\n//melody()  could define a break as a note with an inaudible frequency.\n//melody() generates the high-pitch melody (shown in blue/green), it includes a 3x [hashed metre].\n//AFTER doing t=mod(t*notelength,period), we tap noise at [t]\n//we do       t=mod(t*notelength,period) 3 times, with hashed variation for random note length sequences.\n//can you imagine this [hashed metre] as instructions for a drummer?\n//to go full [colnon nancarrow], and [aperiodic] we could implement\n//... 3 [period]s that are different [[quadratic field]s that share no [coprime]s]\n//a lof of jazz-scaling issues are solvable by tapping a noise(hash()) and not just a hash()\n//as in, sclaing a noise preserves features, whreas scaling a ahsh likely does not (in small enough rasters)\n#ifdef parentMelody\nfloat melody(float t//https://www.shadertoy.com/view/ldXBzH\n){float note\n ;t=mod(t,64.)< 32. ? mod(t,32.0)-94. : t //longest interval is 32. long\n ;float s=floor(2.*hash1(floor(t*2.+241.)))+1.//we tap the same hash with 3 different linearEquation offsets.\n ;t*=.25*s//optionall (jazz variation) makes many notes shorter, but riginal melody gets lost in scaling a hash\n ;if(s==2.&& hash1(floor(t*4.0+738.))>.7)t*=2.//speeding up time makes shorter notes\n ;float r=hash1(floor(t-3280.))\n ;if(r<=.8);r=floor(mod(t*((r<.4)?-4.:4.),8.))//some segments are split into half as long intervals.\n ;return r;}\n#else\nfloat melody(float t//https://www.shadertoy.com/view/4t3fDN\n){t = mod(t,64.)< 32. ? mod(t,32.0)-94. : t\n ;float s=floor(2.*hash1(floor(t*2.+241.)))+1.0\n ;t*=mix(1.,4.,smoothstep(0.,1.,s-2.))\n ;s=hash1(floor(t*4.+738.))\n ;t*=mix(1.,2.,step(s-.7,0.))//smoothstep(0.,1.,s-.7)) //smoother alternatice\n ;//t*=.5*s //even shorter notes, starts to sound WAY too noisy, because our hash is just that, not a noise\n ;float r=hash1(floor(t-3280.))\n ;if(r<=.8);r=float(mod(t*4.*mix(1.,-1.,step(.4,r)),8.))//the high melody\n ;return r;}\n#endif\n\n//av() returns 4 frequencies.xyzw for any input time [t]\n//av() wraps the melody(), procedurally generated, seeded with a rand1To8() hash\n//av() is used by [image] AND [audio] contexts/Port() functions, this defines [audiovisual]\nvec4 av(float t\n){float i=4.\n ;float l = mod(t,64.)< 32. ? 4. : 32.\n ;float d=floor(melody(t)+24.)\n ;float j =float(rand1To8(mod(floor(t*2./i),l)-900.))\n ;float c=floor(fract(2.*t+2.)*2.)*8./tempo-16.     //this cancels out tempo modifiers.\n //this makes the lowest voice tempo-derivative (it keeps playing an [up-down] even while tempo is [pausing])\n ;return vec4(j+vec3(4,9,c),d)///.xyz are a base-chord. .w is a melody\n ;}\n//a more useful AV() function would be much different, this is a simple 4 note av()\n\nfloat orchestrate(float t//audible mono uses av(), the 4 outputs of av are played by an orchestra of instruments\n){float c=0.\n ;vec4 nn=(floor(av(t*tempo))) //floor() removes at least the noteStart crackle\n //this is oblivious about distance to note start/end, so it can only use saw/sdquare waves\n //all else will sound worse due to c0 discontinuities\n // but in square and saw waves we have periodic c0 discontinuities (at node end), so it is less noticable. \n //to remove these discoontinuities\n //, we need to calculate distanceToNoteEnd and add one branch, which we just do not do here.\n ;c+=.2*noteSaw(nn.w,2.,t)//sin(6.2831*nn.w*t);\n ;c+=.8*(noteSquare((nn.z+0.),0.,t)*.3\n           +noteSaw((nn.y+2.),1.,t)*.3\n           +noteSaw((nn.x+4.),0.,t)*.3)\n ;return c;}\n//i know how to fix the c0 continuity issue, without an adsr envelope, only with modulo arithmetic.\n//i just never implemented it, it needs a melody function that also retuens\n//distanceToNoteStart && distanceToNoteEnd\n//and that is a little bit trickier to get sometimes.\n\nfloat mi(vec4 a){return min(min(a.x,a.y),min(a.z,a.w));}\n\n\n//rgba colorspace matrices (rainbow gradients and porterDuff)\n#define ab012(a,b)(a+b*vec3(0,1,2))//desaturation.rgb kernel;b scales offset\n//rainbow*()ro from purple to purple for range[0..1],this makes ab012()desaturate into semi-gaussian scattering.\nvec3 rainbowt(float a,float b){return abs(u2(fract(ab012(a,b))));}//triangle rainbow with offsets,desaturates colors for small b\nvec3 rainbowt(float a){return rainbowt(-a,1./3.);}\nvec3 rainbows(float a,float b){return u5(cos(2.*pi*ab012(a,b)));}//sine rainbow with offsets,desaturates colors for small b\nvec3 rainbows(float a){return rainbows(-a,1./3.);}\n#define ToRgb(w) return c.z*mix(vec3(1.),sat(w(-c.x)),c.y);}\nvec3 rainbows(vec3 c){ToRgb(rainbows)//3 tri waves, most blurry  , fast and precise cos-mix (blurriest because it is only linear)\nvec3 rainbowt(vec3 c){ToRgb(rainbowt)//3 cos waves, medium blurry, linear-mix not identical to hsv2rgb ,but close\n//hsv2rgb uses a capped triangle-wave, as such it appears to be the brighttest/sharpest because at any moment only 2/3 colors swap.\n#define hsv2rgb(c) c.z*mix(vec3(1),sat(abs(fract(c.x+vec3(3,2,1)/3.)*6.-3.)-1.),c.y)\n//below is inverse of above, it swivels quite a lot, i think i once made this much smarter!, like in 2008, but code is lost\n#define rgb2hsv2(a,b,c,d,e,f) mx(vec4(a,b),vec4(c,d),st(e,f))\n#define rgb2hsv3(K) rgb2hsv2(a.zy,K.wz,a.yz,K.xy,a.z,a.y)\n#define rgb2hsv4(P) rgb2hsv2(P.xyw,a.x,a.x,P.yzx,P.x,a.x)\n#define rgb2hsv5(D,q) abx(vec2(q.w-q.y,D)/(vec2(6.*D,q.x)+1e-10)+vec2(q.z,0))\n#define rgb2hsv6(q) vec3(rgb2hsv5((q.x-min(q.w,q.y)),q),q.x)\n#define rgb2hsv(a) rgb2hsv6(rgb2hsv4(rgb2hsv3((vec4(0,-1,2,-3)/3.))))//https://www.shadertoy.com/view/MdGfWm\n//common legacy namespaces\n#define hsv2rgbR     rainbowt //3 tri waves, most blurry, fast and precise, considder for mobile\n#define angleToColor rainbows //3 cos waves, medium blurry\n//hsv2rgb() most commonly implies a [capped triangle waveform]\n//vec3 HsvToRgb(vec3 c){vec3 p;p=abs(fract(c.xxx+vec3(3,2,1)/3.)*6.-3.);return c.z*mix(vec3(1),sat(p-1.),c.y);}\n//porter duff alpha compositing:\n//i do not define ut ..., because its a too short namespace to be spent on a define.\nvec4 ut(vec4 a,vec1 b){return a*(1.-b);}//#define ut(a,b) (a*(1.-b))\n//note; colors atop of identical color is a too easy debugging culpit.\n//note,that atop may returns the alpha of a,and not the alpha max(a,b)\nvec4 pdOut(vec4 a,vec4 b){return ut(b,a.w);}\nvec4 pdOver(vec4 a,vec4 b){return ut(b,a.w)+a;}\nvec4 pdAtop(vec4 a,vec4 b){return ut(b,a.w)+a*b.w;}\nvec4 pdXor(vec4 a,vec4 b){return ut(b,a.w)+ut(a,b.w);}\n\n//colorNote() visualitzes chords of 4 notes as rainbow with 1 hue foreach key/pitch\n//[n] is 4 notes at time [t] set by av(t+u.x) , y is uv.y\nvec4 colorNote(vec4 n, float y\n){vec4 b=vec4(mi(abs(n-y)))      //union of 4 gradients is used as mask\n ;b=1.-1./((b+.5)*(b-.5))//optional glow, is silly when it just does along one domain.\n ;b=sat(b)\n ;vec4 c=vec4(rainbows(y*.02),1.)//unmasked rainbow, might want to use any hu\n \n ;//vec4 c=vec4(1.-sat(vec3(y,.5+.5*cos(y/.8),1.-y)),1)//alternative lazy experimental gradient,periods dont match well\n ;b=pdOut(b,c)//porterDuff() compositing is used as masking operator.\n ;//b=sat(b)//sat() is not needed as frontend, but needed if this is used within a larger context.\n ;return b\n ;}//you likely wanted a non-gradient, well that just adds some y=fract(y*s)*v  y=floor(y*z)*w rasterization.\n\n//port functions are entry points with different IO-contexts\nvec2 Port(float t){return vec2(orchestrate(t));}//port for audio fm synth only does audio (passenger foprt)\nvec4 Port(float t,vec2 u,vec3 r,vec4 m           //port for visuals has more parameters    (cargo port)\n){u=u.xy/r.xy\n //that is, speedOPfSound!=speedOfLight, use mouse to adjust for delay/DopplerEffect caused by distance/movement\n //rule of thumb: a distance of +1000 meters adds a latency of +3 seconds to audio (within 1atm density).\n ;vec4 c=av((t+(u.x-.5))*tempo)\n ;c.w=floor(c.w)\n ;c=colorNote(c,u.y*60.-20.)\n ;float delay=1.\n ;if(u.y>.1)c=max(c,smoothstep(.01,-.01,abs(u.x-m.x/r.x)))\n ;else      c=max(c,smoothstep(.01,-.01,abs(u.x-.5     )))\n ;          c=max(c,smoothstep(.01,-.01,length(u-vec2((tempo-1.),.1))-.01))\n ;return c;}\n\n//i like to use the (turm) convention for the 4 most common vec[1..4]\nvec4 testMouse(float t,vec2 u,vec3 r,vec4 m//3 centred circles\n){u=frc(u);m.xy=frc(m.xy);m.zw=frc(m.zw)\n ;vec3 d=vec3(dd(u-m.xy),dd(u),dd(u-m.zw))\n ;d=sqrt(d) \n ;d=ss(abs(d-.1)-cC,cC*22.)\n ;return vec4(d,1);}\n \nvec4 testMouse2(float t,vec2 u,vec3 r,vec4 m//3 circles that spin over time\n){u=frc(u);m.xy=frc(m.xy);m.zw=frc(m.zw)\n ;u+=cs(t)*.1\n ;vec3 d=vec3(dd(u-m.xy),dd(u),dd(u-m.zw))\n ;d=sqrt(d)\n ;d=ss(abs(d-.1)-cC,cC*22.)\n ;return vec4(d,1);}\n\n</script><!--SoundTab code translates into a 512x512px image that translates to [12..3] minutes of webaudio stereo audio [44100..11025]Hz\nSoundTab code can not be refered to by any iChannelN\n--><script id=\"s\">\n\nvec2 mainSound( in int samp,float t\n){vec2 c=vec2(sin(6.2831*440.*t)*exp(-3.0*t))\n ;c+=Port(t)                    *min(t,.5)\n ;return c;}\n\n</script><!--Image tab code is the dinal composite of the code below, can not refer to its previous frame DoubleBuffer\nImageTab code can not be refered to by any iChannelN\n--><script id=\"i\">\nvoid mainImage(out vec4 fragColor,in vec2 u\n){vec2 s=Port(1.)\n ;vec4 c=testMouse(iTime,u,iResolution,iMouse)\n ;c=mix(c,Port(iTime,u,iResolution.xyz,iMouse),.5)\n \n ;vec4 c0=texture(iChannel0,u/iResolution.xy)\n ;vec4 c1=texture(iChannel1,u/iResolution.xy)\n ;vec4 c2=texture(iChannel2,u/iResolution.xy)\n ;vec4 c3=texture(iChannel3,u/iResolution.xy)\n ;c0=mix(c0,c1,.5);c2=mix(c2,c3,.5);c0=mix(c0,c2,.5)//trilin mix of 4\n ;c=mix(c,c0,.2)\n ;c=sat(c*2.)\n ;fragColor=c\n ;}\n\n//4 taps below exist as 4 DoubleBuffers, they can read the state that they have been in during the previous frame/\n//with 1 DoubleBuffer you can to IncrementalAveraging or a GameOfLife\n//with 2 double buffers you can do (realtime) FastFourierTransform (in low resolution)\n//with 1-4 DoubleBuffers you can do a [diegetic UI]\n//with 2-4 DoubleBuffers you can do FluidDynamics/errosion (a buffer feedback loop)\n//common default buffLinkageSetup:\n//- iChannel0 refers to the BufN that is -1 of oneself (ichan0 of BufA refers to BufD)\n//- iChannel1 refers to the BufN that is +0 == oneself (ichan1 of BufB refers to BufB)\n//- iChannel2 refers to the BufN that is +1 of oneself (ichan2 of BufD refers to BufA)\n//- this covers most accumulator cases, and includes a 4-buffer-loop for fluidDynamics\n//- iChannel3 should be [KeyIn], ir a staic buffer image?\n//- anbove default setting is encoded below, and can be overwritten.\n</script><!--BuffA tab code--><script id=\"a\">\nvoid mainImage(out vec4 fragColor,in vec2 u){\n ;vec4 c=testMouse2(iTime*(phi+0.),u,iResolution,iMouse)\n ;vec4 c0=texture(iChannel1,(u+1.)/iResolution.xy)\n ;vec4 k=texture(iChannel3,u/iResolution.xy)//keyin funnscreen\n ;c+=c0*.99+k*.1\n ;fragColor=c;\n ;}\n</script></script><!--BuffB tab code--><script id=\"b\">\nvoid mainImage(out vec4 fragColor,in vec2 u){\n ;vec4 c=testMouse2(iTime*(phi+1.),u,iResolution,iMouse)\n ;vec4 c0=texture(iChannel1,(u+vec2(-1,1))/iResolution.xy)\n ;vec4 k=texture(iChannel3,u/iResolution.xy)//keyin funnscreen\n ;c+=c0*.99+k*.1\n ;fragColor=c;\n ;}\n</script></script><!--BuffC tab code--><script id=\"c\">\nvoid mainImage(out vec4 fragColor,in vec2 u){\n ;vec4 c=testMouse2(iTime*(phi+2.),u,iResolution,iMouse)\n ;vec4 c0=texture(iChannel1,(u-1.)/iResolution.xy)\n ;vec4 k=texture(iChannel3,u/iResolution.xy)//keyin funnscreen\n ;c+=c0*.99+k*.1\n ;fragColor=c;\n ;}\n</script></script><!--BuffD tab code--><script id=\"d\">\nvoid mainImage(out vec4 fragColor,in vec2 u){\n ;vec4 c=testMouse2(iTime*(phi+3.),u,iResolution,iMouse)\n ;vec4 c0=texture(iChannel1,(u-vec2(-1,1))/iResolution.xy)\n ;vec4 k=texture(iChannel3,u/iResolution.xy)//keyin funnscreen\n ;c+=c0*.99+k*.1\n ;fragColor=c;\n ;}\n \n</script><!--end of plain text Opengl body code, start of css-style--><style>\n\ndiv#content{overflow:hidden;}\n\nbody,player{color:#000;position:absolute\n ;top:0px;left:0px;width:100%;height:100%;padding:0;margin:0;}\n\ndiv#player{top:0px;left:0px;width:800px;height:474px;position:relative;\n    padding-left:0px;padding-right:0px;margin-left:0px;margin-right:0px;}\n\n.playerBar{height:24px;bottom:0px;position:absolute;}\n\n\n.playerCanvas{left:0px;top:0px;width:100%;height:450px;cursor:pointer;position:absolute;}\n//space matters here ,its odd\n.playerCanvas_full-screen{width:100%;height:100%;}\n//space matters here ,its odd\n.playerCanvas:full-screen{width:100%;height:100%;}\n//space matters here ,its odd\n.playerCanvas:fullscreen{width:100%;height:100%;}\n//space matters here ,its odd\n.playerCanvas:-webkit-full-screen{width:100%;height:100%;}\n//space matters here ,its odd\n.playerCanvas:-moz-full-screen{width:100%;height:100%;}\n//space matters here ,its odd\n.playerCanvas:-ms-fullscreen{width:100%;height:100%;}\n\n.inputSelector{display:inline-block;background-color:#000}\n.inputSelector:hover{background-color:#000}\n\n.inputSampler{}\n.inputSampler.visible{height:100px;}\n.inputSelectorControls{\n    background-color:#fff;\n    height:24px;\n    margin:0px;\n    padding:0px;\n    bottom:2px;\n    position:absolute;}\n\n\ndiv#editorWrapper.errorNo{box-shadow:0px 0px 0px 3px #040;\n    animation:errorNoAnimation 1s linear 0 1 forwards;\n    -webkit-animation:errorNoAnimation 1s linear 0 1 forwards;\n    -moz-animation:errorNoAnimation 1s linear 0 1 forwards;}\n\ndiv#editor{\n    padding-left:0;padding-right:0;margin-left:0;margin-right:0;\n    top:0px;left:0px;width:100%;height:476px;\n    position:relative;\n}\n\n\ndiv#textures{}\n\n.tab{  background-color:#888;  float:left;  width:128px;  height:28px;  position:relative;}\n\n.tabAddSelect{    position:relative;    -webkit-appearance:none;    -moz-appearance:none;    appearance:none;    outline:0;}\n.tab:hover{background-color:#b86;}\n.tab.selected{color:#fff;background-color:#fb3;}\n\ndiv#pickTexture_image{     z-index:1000;     width:960px;     height:320px;     position:absolute;}\n\n.mySoundCloudURLBox{    background-color:#fff;    position:absolute;    opacity:0;}\n\n.classSBV{//visibility:visible;    opacity:1;}\n\n.inputThumbnail{cursor:pointer;width:96px;height:96px;}\n\n.inputSelector {margin-right:13px;width:160px;height:114px;}\n.inputSampler {width:160px;}\n.inputSelectorControls{width:160px;}\n.inputThumbnail{width:70px;height:70px;}\n.inputInfoColumn{padding-left:0px;}\n\ndiv#pickTexture_image{width:700px;height:500px;}\n.divAsset{width:180px;height:70px;padding:8px;margin-top:6px;margin-left:6px;}\n\n\n.tab{width:55px;height:20px;}\n\ninput:-moz-placeholder,textarea:-moz-placeholder{\tfont-style:italic;}\ninput.placeholder-text,textarea.placeholder-text{\tfont-style:italic;}\n\n@font-face{font-family:Lobster;src:url(\"/img/lobster.otf\")format(\"opentype\");}\n\n\na.headerLinks:hover{background-color:#555;color:#f82;}\n\n\na#headerTitle:hover{color:#f82;}\n\na.option:hover{color:#f82;}\n\na.regular{text-decoration:none}\n\na.regular:hover{color:#f82;}\n\na.user{text-decoration:none;}\n\na.user:hover{color:#f82;}\n\n.uiButton{\n background-color:#eee;\n    width:22px;\n    height:22px;\n    position:absolute;\n    cursor:pointer;\n}\n\n.uiButton:hover{box-shadow:inset 0px 0px 1px 1px #808080,0px 0px 1px 1px #888;}\n.uiButton:hover{box-shadow:inset 0px 0px 1px 1px #808080,0px 0px 1px 1px #888;}\n\n.dialog{\n    background-color:#eee;\n    color:#000;\n    border:1px solid #000;\n    padding:0px;\n    margin:0px;\n    text-align:left;\n    overflow:hidden;\n    user-select:text;\n    -moz-user-select:-moz-text;\n    -webkit-user-select:text;\n    z-index:1000;\n    visibility:hidden;\n    opacity:0;\n}\n\n.dialogHeader\n{\n    left:0px;\n    top:0px;\n    width:100%;\n    height:32px;\n    position:absolute;\n    background-color:#888;\n    cursor:move;\n}\n\n.dialogTitle{\n    left:12px;\n    top:4px;\n    position:absolute;\n    padding:0px;\n    margin:0px;\n    color:#000;\n    font-size:1.5em;\n    text-align:left;\n    user-select:none;\n    -moz-user-select:-moz-none;\n    -webkit-user-select:none;}\n\n.dialogOverlay{z-index:1000;\n    visibility:hidden;\n    opacity:0;\n    left:0px;\n    top:0px;\n    padding:0px;\n    margin:0px;\n    width:100%;\n    height:100%;\n    position:absolute;\n    background-color:rgba(0,0,0,.4);}\n\n\n\n.dialogCloseButton{\n    width:22px;\n    height:22px;\n    position:absolute;\n    cursor:pointer;\n}\n\n\n\n.dialogContentButtons{\n     padding:0;\n     border:0;\n     text-align:justify;\n     left:24px;\n     bottom:40px;\n     position:absolute;}\n\n.dialogButton{\n    text-align:center;\n    vertical-align:middle;\n    marginLeft:12px;\n    display:inline-block;\n    font-weight:bold;\n    cursor:pointer;\n    padding-bottom:5px;\n    padding-top:4px;\n    padding-left:8px;\n    padding-right:8px;\n    margin-left:4px;\n    margin-right:4px;\n    text-decoration:none;\n    color:#000;\n    width:80px;\n}\n\n\n.dialogCloseButton:hover{box-shadow:inset 0px 0px 4px 2px #fff,0px 0px 4px 2px #fff;}\n\n.dialogContent{\n    color:inherit;\n    overflow:auto;\n    width:100%;\n    height:100%;\n    left:0px;\n    top:32px;\n    position:absolute\n}\n\n.dialogContentBody\n{\n    color:inherit;\n    width:100%;\n    height:auto;\n    padding-top:24px;\n    padding-bottom:24px;\n    padding-left:24px;\n    padding-right:24px;\n    text-align:left;\n}\n\n.formButton\n{\n    font-weight:bold;\n\tcolor:#fff;\n\tborder:none;\n    text-align:center;\n\tbackground-color:#888;\n\tpadding-left:8px;\n\tpadding-right:8px;\n\tpadding-top:4px;\n\tpadding-bottom:4px;\n    cursor:pointer;\n    min-width:80px;\n    box-sizing:border-box;\n}\n\n\n.inputForm{resize:none;text-align:left;\n    background-color:#eee;outline:none;\n    border:1px solid #888;color:inherit;box-sizing:border-box;}\n\n\n.transparentPannel{background-color:rgba(64,64,64,0.1);padding:16px;}\n\nbody {font-size:9px;}\n\n.navigation{text-align:center;width:100%;}\n\n</style><script>\n\"use strict\"\n\n//piLibs 2015-2017-https://iquilezles.org/www/material/piLibs/piLibs.htm\n//piFile\n\nfunction piFile(binaryDataArrayBuffer\n){var mDataView=binaryDataArrayBuffer\n ;var mOffset=0\n ;var me={}\n ;me.mDummy=0\n ;me.Seek=function(off){mOffset=off;}\n ;me.ReadUInt8=function(){var res=(new Uint8Array(mDataView,mOffset))[0];mOffset+=1;return res;}\n ;me.ReadUInt16=function(){var res=(new Uint16Array(mDataView,mOffset))[0];mOffset+=2;return res;}\n ;me.ReadUInt32=function(){var res=(new Uint32Array(mDataView,mOffset))[0];mOffset+=4;return res;}\n ;me.ReadUInt64=function(){return me.ReadUInt32()+(me.ReadUInt32()<<32);}\n ;me.ReadFloat32=function(){var res=(new Float32Array(mDataView,mOffset))[0];mOffset+=4;return res;}\n ;me.ReadFloat32Array=function(n\n ){var src=new Float32Array(mDataView,mOffset)\n  ;var res=[];for(var i=0;i<n;i++){res[i]=src[i];}\n  ;mOffset+=4*n\n  ;return res;}\n ;me.ReadFloat32ArrayNative=function(n){var src=new Float32Array(mDataView,mOffset);mOffset+=4*n;return src;}\n ;return me;}\n\nfunction piMesh(){this.mChunks=[];this.mPrimitiveType=0;this.mVertexFormat=null;}\n\npiMesh.prototype.destroy=function(){}\n\npiMesh.prototype.scale=function(x,y,z\n){var stride=this.mVertexFormat.mStride/4\n ;for(var j=0;j<this.mChunks.length;j++\n ){var nv=this.mChunks[j].mNumVertices\n  ;for(var i=0;i<nv;i++\n  ){this.mChunks[j].mVerts[stride*i+0]*=x\n   ;this.mChunks[j].mVerts[stride*i+1]*=y\n   ;this.mChunks[j].mVerts[stride*i+2]*=z;}}}\n\npiMesh.prototype.translate=function(x,y,z\n){var stride=this.mVertexFormat.mStride/4\n ;for(var j=0;j<this.mChunks.length;j++\n ){var nv=this.mChunks[j].mNumVertices\n  ;for(var i=0;i<nv;i++\n  ){this.mChunks[j].mVerts[stride*i+0]+=x\n   ;this.mChunks[j].mVerts[stride*i+1]+=y\n   ;this.mChunks[j].mVerts[stride*i+2]+=z;}}}\n\npiMesh.prototype.GPULoad=function(renderer\n){for(var i=0;i<this.mChunks.length;i++\n ){var vbo=renderer.CreateVertexArray(this.mChunks[i].mVerts,renderer.BUFTYPE.STATIC)\n  ;if(vbo==null)return false\n  ;var ibo=renderer.CreateIndexArray(this.mChunks[i].mIndices,renderer.BUFTYPE.STATIC)\n  ;if(ibo==null)return false\n  ;this.mChunks[i].mVBO=vbo\n  ;this.mChunks[i].mIBO=ibo;}    return true;}\n\npiMesh.prototype.GPURender=function(renderer,positions\n){\n ;var num=this.mChunks.length\n ;for(var i=0;i<num;i++\n ){renderer.AttachVertexArray(this.mChunks[i].mVBO,this.mVertexFormat,positions)\n  ;renderer.AttachIndexArray(this.mChunks[i].mIBO)\n  ;renderer.DrawPrimitive(renderer.PRIMTYPE.TRIANGLES,this.mChunks[i].mNumFaces*3,true,1)\n  ;renderer.DetachIndexArray(this.mChunks[i].mIBO)\n  ;renderer.DetachVertexArray(this.mChunks[i].mVBO,this.mVertexFormat);}}\n\n//piLibs 2014-2017-https://iquilezles.org/www/material/piLibs/piLibs.htm\n//piRenderer\n\nfunction piRenderer(\n){var mGL=null\n ;var mBindedShader=null\n ;var mIs20=false\n ;var mFloat32Textures\n ;var mFloat32Filter\n ;var mFloat16Textures\n ;var mDrawBuffers\n ;var mDepthTextures\n ;var mDerivatives\n ;var mFloat32Filter\n ;var mFloat16Filter\n ;var mShaderTextureLOD\n ;var mAnisotropic\n ;var mRenderToFloat32F\n ;var mVBO_Quad=null\n ;var mVBO_Tri=null\n ;var mVBO_CubePosNor=null\n ;var mVBO_CubePos=null\n ;var mShaderHeader=[\"\",\"\"]\n ;var me={}\n ;me.CLEAR    ={Color:1,Zbuffer:2,Stencil:4}\n ;me.TEXFMT   ={C4I8:0,C1I8:1,C1F16:2,C4F16:3,C1F32:4,C4F32:5,Z16:6,Z24:7,Z32:8}\n ;me.TEXWRP   ={CLAMP:0,REPEAT:1}\n ;me.BUFTYPE  ={STATIC:0,DYNAMIC:1}\n ;me.RENDSTGATE={WIREFRAME:0,FRONT_FACE:1,CULL_FACE:2,DEPTH_TEST:3,ALPHA_TO_COVERAGE:4}\n ;me.TEXTYPE  ={T2D:0,T3D:1,CUBEMAP:2}\n ;me.FILTER   ={NONE:0,LINEAR:1,MIPMAP:2,NONE_MIPMAP:3}\n ;me.TYPE     ={UINT8:0,UINT16:1,UINT32:2,FLOAT16:3,FLOAT32:4,FLOAT64:5}\n ;var iFormatPI2GL=function(format){if(mIs20\n     ){if(format===me.TEXFMT.C4I8)return{mGLFormat:mGL.RGBA8  ,mGLExternal:mGL.RGBA,mGLType:mGL.UNSIGNED_BYTE}\n else if(format===me.TEXFMT.C1I8)return{mGLFormat:mGL.R8      ,mGLExternal:mGL.RED ,mGLType:mGL.UNSIGNED_BYTE}\n else if(format===me.TEXFMT.C1F16)return{mGLFormat:mGL.R16F   ,mGLExternal:mGL.RED ,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C4F16)return{mGLFormat:mGL.RGBA16F,mGLExternal:mGL.RGBA,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C1F32)return{mGLFormat:mGL.R32F   ,mGLExternal:mGL.RED ,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C4F32)return{mGLFormat:mGL.RGBA32F,mGLExternal:mGL.RGBA,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.Z16)return{mGLFormat:mGL.DEPTH_COMPONENT16 ,mGLExternal:mGL.DEPTH_COMPONENT,mGLType:mGL.UNSIGNED_SHORT}\n else if(format===me.TEXFMT.Z24)return{mGLFormat:mGL.DEPTH_COMPONENT24 ,mGLExternal:mGL.DEPTH_COMPONENT,mGLType:mGL.UNSIGNED_SHORT}\n else if(format===me.TEXFMT.Z32)return{mGLFormat:mGL.DEPTH_COMPONENT32F,mGLExternal:mGL.DEPTH_COMPONENT,mGLType:mGL.UNSIGNED_SHORT}\n}else{if(format===me.TEXFMT.C4I8)return{mGLFormat:mGL.RGBA      ,mGLExternal:mGL.RGBA     ,mGLType:mGL.UNSIGNED_BYTE}\n else if(format===me.TEXFMT.C1I8)return{mGLFormat:mGL.LUMINANCE ,mGLExternal:mGL.LUMINANCE,mGLType:mGL.UNSIGNED_BYTE}\n else if(format===me.TEXFMT.C1F16)return{mGLFormat:mGL.LUMINANCE,mGLExternal:mGL.LUMINANCE,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C4F16)return{mGLFormat:mGL.RGBA     ,mGLExternal:mGL.RGBA     ,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C1F32)return{mGLFormat:mGL.LUMINANCE,mGLExternal:mGL.RED      ,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.C4F32)return{mGLFormat:mGL.RGBA     ,mGLExternal:mGL.RGBA     ,mGLType:mGL.FLOAT}\n else if(format===me.TEXFMT.Z16)return{mGLFormat:mGL.DEPTH_COMPONENT,mGLExternal:mGL.DEPTH_COMPONENT,mGLType:mGL.UNSIGNED_SHORT}}\n return null;}\n\n ;me.Initialize=function(gl\n ){mGL=gl\n  ;mIs20=!(gl instanceof WebGLRenderingContext)\n  ;if(mIs20\n  ){mFloat32Textures=mFloat16Textures=mDerivatives=mDrawBuffers=mDepthTextures =mShaderTextureLOD=true\n   ;mFloat32Filter  =mGL.getExtension('OES_texture_float_linear')\n   ;mFloat16Filter  =mGL.getExtension('OES_texture_half_float_linear')\n   ;mAnisotropic=mGL.getExtension('EXT_texture_filter_anisotropic')\n   ;mRenderToFloat32F=mGL.getExtension('EXT_color_buffer_float')\n  ;}else\n   {mFloat32Textures=mGL.getExtension('OES_texture_float')\n   ;mFloat32Filter  =mGL.getExtension('OES_texture_float_linear')\n   ;mFloat16Textures=mGL.getExtension('OES_texture_half_float')\n   ;mFloat16Filter  =mGL.getExtension('OES_texture_half_float_linear')\n   ;mDerivatives    =mGL.getExtension('OES_standard_derivatives')\n   ;mDrawBuffers    =mGL.getExtension('WEBGL_draw_buffers')\n   ;mDepthTextures  =mGL.getExtension('WEBGL_depth_texture')\n   ;mShaderTextureLOD=mGL.getExtension('EXT_shader_texture_lod')\n   ;mAnisotropic    =mGL.getExtension('EXT_texture_filter_anisotropic')\n   ;mRenderToFloat32F=mFloat32Textures;}\n  ;var maxTexSize=mGL.getParameter(mGL.MAX_TEXTURE_SIZE)\n  ;var maxCubeSize=mGL.getParameter(mGL.MAX_CUBE_MAP_TEXTURE_SIZE)\n  ;var maxRenderbufferSize=mGL.getParameter(mGL.MAX_RENDERBUFFER_SIZE)\n  ;var extensions=mGL.getSupportedExtensions()\n  ;var textureUnits=mGL.getParameter(mGL.MAX_TEXTURE_IMAGE_UNITS)\n  ;var ph=\"precision highp \"\n  ;console.log(\"WebGL (2.0=\"+mIs20+\"):\" \n   +\" F32 Textures:\"+((mFloat32Textures!=null)? \"yes\":\"no\")\n   +\",F16 Textures:\"+((mFloat16Textures!=null)? \"yes\":\"no\")\n   +\",Depth Textures:\"+((mDepthTextures!=null)? \"yes\":\"no\")\n   +\",Anisotropic Textures:\"+((mAnisotropic!=null)? \"yes\":\"no\")\n   +\",MRT:\"+((mDrawBuffers!=null)? \"yes\":\"no\")\n   +\",Render to 32F:\"+((mRenderToFloat32F!=null)? \"yes\":\"no\")\n   +\",Shader Texture LOD:\"+((mShaderTextureLOD!=null)? \"yes\":\"no\")\n   +\",Texture Units:\"+textureUnits \n   +\",Max Texture Size:\"+maxTexSize \n   +\",Max Render Buffer Size:\"+maxRenderbufferSize \n   +\",Max Cubemap Size:\"+maxCubeSize)   //+\",Extensions:\"+extensions)\n  ;//if(mDerivatives!=null)mGL.hint(mDerivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,mGL.NICEST)\n  ;mVBO_Quad=mGL.createBuffer();mGL.bindBuffer(mGL.ARRAY_BUFFER,mVBO_Quad);mGL.bufferData(mGL.ARRAY_BUFFER //quad-buffer is used by sound webaudio buffer, FUCK THAT\n  ,new Float32Array([-1.0,-1.0,1.0,-1.0,-1.0,1.0,1.0,-1.0,1.0,1.0,-1.0,1.0]),mGL.STATIC_DRAW);mGL.bindBuffer(mGL.ARRAY_BUFFER,null)\n  ;mVBO_Tri=mGL.createBuffer();mGL.bindBuffer(mGL.ARRAY_BUFFER,mVBO_Tri);mGL.bufferData(mGL.ARRAY_BUFFER//screenspace filling triangle\n  ,new Float32Array([-1.0,-1.0,3.0,-1.0,-1.0,3.0]),mGL.STATIC_DRAW);mGL.bindBuffer(mGL.ARRAY_BUFFER,null)   \n  ;mShaderHeader[0]=\"\"\n  ;var es300for100=\"float round(float x){return floor(x+0.5);}\\n\"\n   +\"vec2 round(vec2 x){return floor(x+0.5);}\\n\"\n   +\"vec3 round(vec3 x){return floor(x+0.5);}\\n\"\n   +\"vec4 round(vec4 x){return floor(x+0.5);}\\n\"\n   +\"float trunc(float x,float n){return floor(x*n)/n;}\\n\"\n   +\"mat3 transpose(mat3 m){return mat3(m[0].x,m[1].x,m[2].x,m[0].y,m[1].y,m[2].y,m[0].z,m[1].z,m[2].z);}\\n\"\n   +\"float determinant(in mat2 m){return m[0][0]*m[1][1]-m[0][1]*m[1][0];}\\n\"\n   +\"float determinant(mat4 m){float b00=m[0][0]*m[1][1]-m[0][1]*m[1][0],b01=m[0][0]*m[1][2]-m[0][2]*m[1][0],b02=m[0][0]*m[1][3]-m[0][3]*m[1][0],b03=m[0][1]*m[1][2]-m[0][2]*m[1][1],b04=m[0][1]*m[1][3]-m[0][3]*m[1][1],b05=m[0][2]*m[1][3]-m[0][3]*m[1][2],b06=m[2][0]*m[3][1]-m[2][1]*m[3][0],b07=m[2][0]*m[3][2]-m[2][2]*m[3][0],b08=m[2][0]*m[3][3]-m[2][3]*m[3][0],b09=m[2][1]*m[3][2]-m[2][2]*m[3][1],b10=m[2][1]*m[3][3]-m[2][3]*m[3][1],b11=m[2][2]*m[3][3]-m[2][3]*m[3][2];return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;}\\n\"\n   +\"mat2 inverse(mat2 m){float det=determinant(m);return mat2(m[1][1],-m[0][1],-m[1][0],m[0][0])/det;}\\n\"\n   +\"mat4 inverse(mat4 m){float inv0=m[1].y*m[2].z*m[3].w-m[1].y*m[2].w*m[3].z-m[2].y*m[1].z*m[3].w+m[2].y*m[1].w*m[3].z+m[3].y*m[1].z*m[2].w-m[3].y*m[1].w*m[2].z;float inv4=-m[1].x*m[2].z*m[3].w+m[1].x*m[2].w*m[3].z+m[2].x*m[1].z*m[3].w-m[2].x*m[1].w*m[3].z-m[3].x*m[1].z*m[2].w+m[3].x*m[1].w*m[2].z;float inv8=m[1].x*m[2].y*m[3].w-m[1].x*m[2].w*m[3].y-m[2].x *m[1].y*m[3].w+m[2].x *m[1].w*m[3].y+m[3].x*m[1].y*m[2].w-m[3].x*m[1].w*m[2].y;float inv12=-m[1].x *m[2].y*m[3].z+m[1].x *m[2].z*m[3].y +m[2].x *m[1].y*m[3].z-m[2].x *m[1].z*m[3].y-m[3].x*m[1].y*m[2].z+m[3].x*m[1].z*m[2].y;float inv1=-m[0].y*m[2].z*m[3].w+m[0].y*m[2].w*m[3].z+m[2].y *m[0].z*m[3].w-m[2].y *m[0].w*m[3].z-m[3].y*m[0].z*m[2].w+m[3].y*m[0].w*m[2].z;float inv5=m[0].x *m[2].z*m[3].w-m[0].x *m[2].w*m[3].z-m[2].x *m[0].z*m[3].w+m[2].x *m[0].w*m[3].z+m[3].x*m[0].z*m[2].w-m[3].x*m[0].w*m[2].z;float inv9=-m[0].x *m[2].y*m[3].w+m[0].x *m[2].w*m[3].y+m[2].x *m[0].y*m[3].w-m[2].x *m[0].w*m[3].y-m[3].x*m[0].y*m[2].w+m[3].x*m[0].w*m[2].y;float inv13=m[0].x *m[2].y*m[3].z-m[0].x *m[2].z*m[3].y-m[2].x *m[0].y*m[3].z+m[2].x *m[0].z*m[3].y+m[3].x*m[0].y*m[2].z-m[3].x*m[0].z*m[2].y;float inv2=m[0].y *m[1].z*m[3].w-m[0].y *m[1].w*m[3].z-m[1].y *m[0].z*m[3].w+m[1].y *m[0].w*m[3].z+m[3].y*m[0].z*m[1].w-m[3].y*m[0].w*m[1].z;float inv6=-m[0].x *m[1].z*m[3].w+m[0].x *m[1].w*m[3].z+m[1].x *m[0].z*m[3].w-m[1].x *m[0].w*m[3].z-m[3].x*m[0].z*m[1].w+m[3].x*m[0].w*m[1].z;float inv10=m[0].x *m[1].y*m[3].w-m[0].x *m[1].w*m[3].y-m[1].x *m[0].y*m[3].w+m[1].x *m[0].w*m[3].y+m[3].x*m[0].y*m[1].w-m[3].x*m[0].w*m[1].y;float inv14=-m[0].x *m[1].y*m[3].z+m[0].x *m[1].z*m[3].y+m[1].x *m[0].y*m[3].z-m[1].x *m[0].z*m[3].y-m[3].x*m[0].y*m[1].z+m[3].x*m[0].z*m[1].y;float inv3=-m[0].y*m[1].z*m[2].w+m[0].y*m[1].w*m[2].z+m[1].y*m[0].z*m[2].w-m[1].y*m[0].w*m[2].z-m[2].y*m[0].z*m[1].w+m[2].y*m[0].w*m[1].z;float inv7=m[0].x*m[1].z*m[2].w-m[0].x*m[1].w*m[2].z-m[1].x*m[0].z*m[2].w+m[1].x*m[0].w*m[2].z+m[2].x*m[0].z*m[1].w-m[2].x*m[0].w*m[1].z;float inv11=-m[0].x*m[1].y*m[2].w+m[0].x*m[1].w*m[2].y+m[1].x*m[0].y*m[2].w-m[1].x*m[0].w*m[2].y-m[2].x*m[0].y*m[1].w+m[2].x*m[0].w*m[1].y;float inv15=m[0].x*m[1].y*m[2].z-m[0].x*m[1].z*m[2].y-m[1].x*m[0].y*m[2].z+m[1].x*m[0].z*m[2].y+m[2].x*m[0].y*m[1].z-m[2].x*m[0].z*m[1].y;float det=m[0].x*inv0+m[0].y*inv4+m[0].z*inv8+m[0].w*inv12;det=1.0/det;return det*mat4(inv0,inv1,inv2,inv3,inv4,inv5,inv6,inv7,inv8,inv9,inv10,inv11,inv12,inv13,inv14,inv15);}\\n\"\n   +\"float sinh(float x){return (exp(x)-exp(-x))/2.;}\\n float cosh(float x){return (exp(x)+exp(-x))/2.;}\\n\"\n   +\"float tanh(float x){return sinh(x)/cosh(x);}\\n float csch(float x){return 1./sinh(x);}\\n\"\n   +\"float coth(float x){return cosh(x)/sinh(x);}\\n float sech(float x){return 1./cosh(x);}\\n\"\n   +\"float atanh(float x){return .5*log((1.+x)/(1.-x));}\\n float asinh(float x){return log(x+sqrt(x*x+1.));}\\n float asech(float x){return log((1.+sqrt(1.-x*x))/x);}\\n\"\n   +\"float acoth(float x){return .5*log((x+1.)/(x-1.));}\\n float acosh(float x){return log(x+sqrt(x*x-1.));}\\n float acsch(float x){return log((1.+sqrt(1.+x*x))/x);}\\n\"\n  ;var prec=\"#ifdef GL_ES\\n\"+ph+\"float;\\n\" +\"precision highp int;\\n\"\n  ;var v300=\"#version 300 es\\n\"\n  ;var v300e=\"precision mediump sampler3D;\\n\"+\"#endif\\n\"\n  ;if(mIs20)mShaderHeader[0]+=v300+prec+v300e\n  ;else    mShaderHeader[0]+=prec+\"#endif\\n\"+es300for100\n  ;mShaderHeader[1]=\"\"\n  ;if(mIs20){mShaderHeader[1]+=v300+prec+v300e\n  ;}else\n   {if(mDerivatives){mShaderHeader[1]+=\"#ifdef GL_OES_standard_derivatives\\n#extension GL_OES_standard_derivatives:enable\\n#endif\\n\";}\n   ;if(mShaderTextureLOD){mShaderHeader[1]+=\"#extension GL_EXT_shader_texture_lod:enable\\n\";} \n   ;var t4=\"vec4 texture\"\n   ;var ts=t4+\"(sampler\"\n   ;var tc=\"){return textureCube(s,c\"\n   ;var sa=\"(sampler2D s,vec2 c,\"\n   ;var r2=\"){return texture2D\"\n   ;mShaderHeader[1]+=\"#ifdef GL_ES\\n\"+ph+\"float;\\n\"+ph+\"int;\\n\"+\"#endif\\n\"\n   +ts+\"2D   s,vec2 c\"+r2+\"(s,c);}\\n\"+ts+\"2D   s,vec2 c,float b\"+r2+\"(s,c,b);}\\n\"\n   +ts+\"Cube s,vec3 c\"+tc+\");}\\n\"    +ts+\"Cube s,vec3 c,float b\"+tc+\",b);}\\n\"\n   +es300for100\n   ;if(mShaderTextureLOD){mShaderHeader[1]\n    +=t4+\"Lod\"+sa+\"float b         \"+r2+\"LodEXT(s,c,b);}\\n\"\n    + t4+\"Grad\"+sa+\"vec2 dx,vec2 dy\"+r2+\"GradEXT(s,c,dx,dy);}\\n\"}}return true;}\n ;\n ;me.GetCaps=function(\n ){return{mIsGL20:mIs20\n  ,mFloat32Textures:mFloat32Textures!=null\n  ,mFloat16Textures:mFloat16Textures!=null\n      ,mDrawBuffers:mDrawBuffers!=null\n    ,mDepthTextures:mDepthTextures!=null\n      ,mDerivatives:mDerivatives!=null\n ,mShaderTextureLOD:mShaderTextureLOD!=null};}\n ;\n ;me.CheckErrors=function(\n ){var error=mGL.getError()\n  ;if(error!=mGL.NO_ERROR\n  ){for(var prop in mGL\n   ){if(typeof mGL[prop]=='number'\n    ){if(mGL[prop]==error){console.log(\"GL Error \"+error+\":\"+prop);break;}   }}}}\n ;\n ;me.Clear=function(flags,ccolor,cdepth,cstencil\n ){var mode=0\n  ;if(flags & 1){mode |=mGL.COLOR_BUFFER_BIT;mGL.clearColor(ccolor[0],ccolor[1],ccolor[2],ccolor[3]);}\n  ;if(flags & 2){mode |=mGL.DEPTH_BUFFER_BIT;mGL.clearDepth(cdepth);}\n  ;if(flags & 4){mode |=mGL.STENCIL_BUFFER_BIT;mGL.clearStencil(cstencil);}\n  ;mGL.clear(mode);}\n ;\n ;me.CreateTexture=function(type,xres,yres,format,filter,wrap,buffer\n ){if(mGL===null)return null\n  ;var id=mGL.createTexture()\n  ;var glFoTy=iFormatPI2GL(format)\n  ;var glWrap=mGL.REPEAT;if(wrap===me.TEXWRP.CLAMP)glWrap=mGL.CLAMP_TO_EDGE\n  ;if(type===me.TEXTYPE.T2D\n  ){mGL.bindTexture(mGL.TEXTURE_2D,id)\n   ;mGL.texImage2D(mGL.TEXTURE_2D,0,glFoTy.mGLFormat,xres,yres,0,glFoTy.mGLExternal,glFoTy.mGLType,buffer)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_S,glWrap)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_T,glWrap)\n   ;if(filter===me.FILTER.NONE\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST)\n   ;}   else if(filter===me.FILTER.LINEAR\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n   ;}else if(filter===me.FILTER.MIPMAP\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR_MIPMAP_LINEAR)\n    ;mGL.generateMipmap(mGL.TEXTURE_2D)\n   ;}   else \n    {mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST_MIPMAP_LINEAR)\n    ;mGL.generateMipmap(mGL.TEXTURE_2D);}\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;}else if(type===me.TEXTYPE.T3D\n   ){if(mIs20\n    ){mGL.bindTexture(mGL.TEXTURE_3D,id)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_BASE_LEVEL,0)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAX_LEVEL,Math.log2(xres))\n     ;if(filter===me.FILTER.NONE\n     ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n      ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST)\n     ;}else if(filter===me.FILTER.LINEAR\n      ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n       ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n      ;}else if(filter===me.FILTER.MIPMAP\n      ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n       ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR_MIPMAP_LINEAR)\n      ;}else{mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n       ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST_MIPMAP_LINEAR)\n       ;mGL.generateMipmap(mGL.TEXTURE_3D);}\n      ;mGL.texImage3D(mGL.TEXTURE_3D,0,glFoTy.mGLFormat,xres,yres,yres,0,glFoTy.mGLExternal,glFoTy.mGLType,buffer)\n      ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_R,glWrap)\n      ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_S,glWrap)\n      ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_T,glWrap)\n      ;if(filter===me.FILTER.MIPMAP)mGL.generateMipmap(mGL.TEXTURE_3D)\n      ;mGL.bindTexture(mGL.TEXTURE_3D,null)\n     ;}else{return null;}}else\n  {mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,id)\n  ;mGL.texParameteri(mGL.TEXTURE_CUBE_MAP,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n  ;mGL.texParameteri(mGL.TEXTURE_CUBE_MAP,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n  ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null);}\n ;return{mObjectID:id,mXres:xres,mYres:yres,mFormat:format,mType:type,mFilter:filter,mWrap:wrap,mVFlip:false};}\n ;me.CreateTextureFromImage=function(type,image,format,filter,wrap,flipY\n ){if(mGL===null)return null\n  ;var id=mGL.createTexture()\n  ;var glFoTy=iFormatPI2GL(format)\n  ;var glWrap=mGL.REPEAT;if(wrap===me.TEXWRP.CLAMP)glWrap=mGL.CLAMP_TO_EDGE\n  ;if(type===me.TEXTYPE.T2D\n  ){mGL.bindTexture(mGL.TEXTURE_2D,id)\n   ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,flipY)\n   ;mGL.pixelStorei(mGL.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false)\n   ;if(mIs20)mGL.pixelStorei(mGL.UNPACK_COLORSPACE_CONVERSION_WEBGL,mGL.NONE)\n   ;mGL.texImage2D(mGL.TEXTURE_2D,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_S,glWrap)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_T,glWrap)\n   ;if(filter===me.FILTER.NONE\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST)\n    ;}       else if(filter===me.FILTER.LINEAR\n    ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n     ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n    ;}else if(filter===me.FILTER.MIPMAP\n    ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n     ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR_MIPMAP_LINEAR)\n     ;mGL.generateMipmap(mGL.TEXTURE_2D)\n    ;}       else\n    {mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n     ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST_MIPMAP_LINEAR)\n     ;mGL.generateMipmap(mGL.TEXTURE_2D);}\n    ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n    ;}else if(type===me.TEXTYPE.T3D){return null;}else\n   {mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,id)\n   ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,flipY)\n   ;mGL.texParameteri(mGL.TEXTURE_CUBE_MAP,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n   ;mGL.texParameteri(mGL.TEXTURE_CUBE_MAP,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n   ;mGL.activeTexture(mGL.TEXTURE0)\n   ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,id)\n   ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,flipY)\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_X,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[0])\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_X,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[1])\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_Y,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,(flipY?image[3]:image[2]))\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,(flipY?image[2]:image[3]))\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_Z,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[4])\n   ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[5])\n   ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null);}\n  ;return{mObjectID:id,mXres:image.width,mYres:image.height,mFormat:format,mType:type,mFilter:filter,mWrap:wrap,mVFlip:flipY};}\n ;\n ;me.SetSamplerFilter=function(te,filter\n ){if(te.mFilter===filter)return\n  ;var id=te.mObjectID\n  ;if(te.mType===me.TEXTYPE.T2D\n  ){mGL.bindTexture(mGL.TEXTURE_2D,id)\n   ;if(filter===me.FILTER.NONE\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST)\n   ;}else if(filter===me.FILTER.LINEAR\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n   ;}else if(filter===me.FILTER.MIPMAP\n   ){mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR_MIPMAP_LINEAR)\n    ;mGL.generateMipmap(mGL.TEXTURE_2D)\n   ;}else\n    {mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n    ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST_MIPMAP_LINEAR)\n    ;mGL.generateMipmap(mGL.TEXTURE_2D);}\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;}else if(te.mType===me.TEXTYPE.T3D\n   ){mGL.bindTexture(mGL.TEXTURE_3D,id)\n    ;if(filter===me.FILTER.NONE\n    ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST)\n    ;}else if(filter===me.FILTER.LINEAR\n    ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR)\n    ;}else if(filter===me.FILTER.MIPMAP\n    ){mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.LINEAR)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.LINEAR_MIPMAP_LINEAR)\n     ;mGL.generateMipmap(mGL.TEXTURE_3D)\n    ;}else{\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MAG_FILTER,mGL.NEAREST)\n     ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_MIN_FILTER,mGL.NEAREST_MIPMAP_LINEAR)\n     ;mGL.generateMipmap(mGL.TEXTURE_3D);}\n    ;mGL.bindTexture(mGL.TEXTURE_3D,null);}\n   ;te.mFilter=filter;}\n ;\n ;me.SetSamplerWrap=function(te,wrap\n ){if(te.mWrap===wrap)return\n  ;var glWrap=mGL.REPEAT;if(wrap===me.TEXWRP.CLAMP)glWrap=mGL.CLAMP_TO_EDGE\n  ;var id=te.mObjectID\n  ;if(te.mType===me.TEXTYPE.T2D\n  ){mGL.bindTexture(mGL.TEXTURE_2D,id)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_S,glWrap)\n   ;mGL.texParameteri(mGL.TEXTURE_2D,mGL.TEXTURE_WRAP_T,glWrap)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;}else if(te.mType===me.TEXTYPE.T3D\n  ){mGL.bindTexture(mGL.TEXTURE_3D,id)\n   ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_R,glWrap)\n   ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_S,glWrap)\n   ;mGL.texParameteri(mGL.TEXTURE_3D,mGL.TEXTURE_WRAP_T,glWrap)\n   ;mGL.bindTexture(mGL.TEXTURE_3D,null);}\n  ;te.mWrap=wrap;};\n ;\n ;me.SetSamplerVFlip=function(te,vflip,image\n ){if(te.mVFlip===vflip)return\n  ;var id=te.mObjectID\n  ;if(te.mType===me.TEXTYPE.T2D\n  ){if(image!=null\n   ){mGL.activeTexture(mGL.TEXTURE0)\n    ;mGL.bindTexture(mGL.TEXTURE_2D,id)\n    ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,vflip)\n    ;var glFoTy=iFormatPI2GL(te.mFormat)\n    ;mGL.texImage2D(mGL.TEXTURE_2D,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image)\n    ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;}}else if(te.mType===me.TEXTYPE.CUBEMAP\n  ){if(image!=null\n   ){var glFoTy=iFormatPI2GL(te.mFormat)\n    ;mGL.activeTexture(mGL.TEXTURE0)\n    ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,id)\n    ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,vflip)\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_X,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[0])\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_X,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[1])\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_Y,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,(vflip?image[3]:image[2]))\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,(vflip?image[2]:image[3]))\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_POSITIVE_Z,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[4])\n    ;mGL.texImage2D(mGL.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image[5])\n    ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null);}}\n  ;te.mVFlip=vflip;}\n ;\n ;me.CreateMipmaps=function(te\n ){if(te.mType===me.TEXTYPE.T2D\n  ){mGL.activeTexture(mGL.TEXTURE0)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,te.mObjectID)\n   ;mGL.generateMipmap(mGL.TEXTURE_2D)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null);}}\n ;me.UpdateTexture=function(tex,x0,y0,xres,yres,buffer\n ){var glFoTy=iFormatPI2GL(tex.mFormat)\n  ;if(tex.mType===me.TEXTYPE.T2D\n  ){mGL.activeTexture(mGL.TEXTURE0)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,tex.mObjectID)\n   ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,tex.mVFlip)\n   ;mGL.texSubImage2D(mGL.TEXTURE_2D,0,x0,y0,xres,yres,glFoTy.mGLExternal,glFoTy.mGLType,buffer)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null);}}\n ;\n ;me.UpdateTextureFromImage=function(tex,image\n ){var glFoTy=iFormatPI2GL(tex.mFormat)\n  ;if(tex.mType===me.TEXTYPE.T2D\n  ){mGL.activeTexture(mGL.TEXTURE0)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,tex.mObjectID)\n   ;mGL.pixelStorei(mGL.UNPACK_FLIP_Y_WEBGL,tex.mVFlip)\n   ;mGL.texImage2D(mGL.TEXTURE_2D,0,glFoTy.mGLFormat,glFoTy.mGLExternal,glFoTy.mGLType,image)\n   ;mGL.bindTexture(mGL.TEXTURE_2D,null);}};\n ;\n ;me.DestroyTexture=function(te){mGL.deleteTexture(te.mObjectID);};\n ;\n ;me.AttachTextures=function(num,t0,t1,t2,t3\n ){if(num>0&&t0!=null\n  ){mGL.activeTexture(mGL.TEXTURE0)\n         ;if(t0.mType===me.TEXTYPE.T2D)mGL.bindTexture(mGL.TEXTURE_2D,t0.mObjectID)\n   ;else if(t0.mType===me.TEXTYPE.T3D)mGL.bindTexture(mGL.TEXTURE_3D,t0.mObjectID)\n   ;else if(t0.mType===me.TEXTYPE.CUBEMAP)mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,t0.mObjectID);}\n  ;if(num>1&&t1!=null\n  ){mGL.activeTexture(mGL.TEXTURE1)\n         ;if(t1.mType===me.TEXTYPE.T2D)mGL.bindTexture(mGL.TEXTURE_2D,t1.mObjectID)\n   ;else if(t1.mType===me.TEXTYPE.T3D)mGL.bindTexture(mGL.TEXTURE_3D,t1.mObjectID)\n   ;else if(t1.mType===me.TEXTYPE.CUBEMAP)mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,t1.mObjectID);}\n  ;if(num>2&&t2!=null\n  ){mGL.activeTexture(mGL.TEXTURE2)\n         ;if(t2.mType===me.TEXTYPE.T2D)mGL.bindTexture(mGL.TEXTURE_2D,t2.mObjectID)\n   ;else if(t2.mType===me.TEXTYPE.T3D)mGL.bindTexture(mGL.TEXTURE_3D,t2.mObjectID)\n   ;else if(t2.mType===me.TEXTYPE.CUBEMAP)mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,t2.mObjectID);}\n ;if(num>3&&t3!=null\n ){mGL.activeTexture(mGL.TEXTURE3)\n         ;if(t3.mType===me.TEXTYPE.T2D)mGL.bindTexture(mGL.TEXTURE_2D,t3.mObjectID)\n   ;else if(t3.mType===me.TEXTYPE.T3D)mGL.bindTexture(mGL.TEXTURE_3D,t3.mObjectID)\n   ;else if(t3.mType===me.TEXTYPE.CUBEMAP)mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,t3.mObjectID);}}\n ;me.DettachTextures=function(\n ){mGL.activeTexture(mGL.TEXTURE0)\n  ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null)\n  ;mGL.activeTexture(mGL.TEXTURE1)\n  ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null)\n  ;mGL.activeTexture(mGL.TEXTURE2)\n  ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null)\n  ;mGL.activeTexture(mGL.TEXTURE3)\n  ;mGL.bindTexture(mGL.TEXTURE_2D,null)\n  ;mGL.bindTexture(mGL.TEXTURE_CUBE_MAP,null);}\n ;\n ;me.CreateRenderTarget=function(color0,color1,color2,color3,depth,wantZbuffer\n ){var id=mGL.createFramebuffer()\n  ;mGL.bindFramebuffer(mGL.FRAMEBUFFER,id)\n  ;if(depth===null\n  ){if(wantZbuffer===true\n   ){var zb=mGL.createRenderbuffer()\n    ;mGL.bindRenderbuffer(mGL.RENDERBUFFER,zb)\n    ;mGL.renderbufferStorage(mGL.RENDERBUFFER,mGL.DEPTH_COMPONENT16,color0.mXres,color0.mYres)\n    ;mGL.framebufferRenderbuffer(mGL.FRAMEBUFFER,mGL.DEPTH_ATTACHMENT,mGL.RENDERBUFFER,zb)\n  ;}}else{mGL.framebufferTexture2D(mGL.FRAMEBUFFER,mGL.DEPTH_ATTACHMENT,mGL.TEXTURE_2D,depth.mObjectID,0);}\n  ;if(color0 !=null)mGL.framebufferTexture2D(mGL.FRAMEBUFFER,mGL.COLOR_ATTACHMENT0,mGL.TEXTURE_2D,color0.mObjectID,0)\n  ;if(mGL.checkFramebufferStatus(mGL.FRAMEBUFFER)!=mGL.FRAMEBUFFER_COMPLETE)return null\n  ;mGL.bindRenderbuffer(mGL.RENDERBUFFER,null)\n  ;mGL.bindFramebuffer(mGL.FRAMEBUFFER,null)\n  ;return{mObjectID:id};}\n ;\n ;me.DestroyRenderTarget=function(tex){mGL.deleteFramebuffer(tex.mObjectID);}\n ;\n ;me.SetRenderTarget=function(tex\n ){if(tex===null)mGL.bindFramebuffer(mGL.FRAMEBUFFER,null);else mGL.bindFramebuffer(mGL.FRAMEBUFFER,tex.mObjectID);}\n ;\n ;me.CreateRenderTargetNew=function(wantColor0,wantZbuffer,xres,yres,samples\n ){var id=mGL.createFramebuffer()\n  ;mGL.bindFramebuffer(mGL.FRAMEBUFFER,id)\n  ;if(wantZbuffer===true\n  ){var zb=mGL.createRenderbuffer()\n   ;mGL.bindRenderbuffer(mGL.RENDERBUFFER,zb)\n   ;if(samples==1)mGL.renderbufferStorage(mGL.RENDERBUFFER,mGL.DEPTH_COMPONENT16,xres,yres)\n   ;else          mGL.renderbufferStorageMultisample(mGL.RENDERBUFFER,samples,mGL.DEPTH_COMPONENT16,xres,yres)\n   ;mGL.framebufferRenderbuffer(mGL.FRAMEBUFFER,mGL.DEPTH_ATTACHMENT,mGL.RENDERBUFFER,zb);}\n  ;if(wantColor0\n  ){var cb=mGL.createRenderbuffer()\n   ;mGL.bindRenderbuffer(mGL.RENDERBUFFER,cb)\n   ;if(samples==1)mGL.renderbufferStorage(mGL.RENDERBUFFER,mGL.RGBA8,xres,yres)\n            ;else mGL.renderbufferStorageMultisample(mGL.RENDERBUFFER,samples,mGL.RGBA8,xres,yres)\n   ;mGL.framebufferRenderbuffer(mGL.FRAMEBUFFER,mGL.COLOR_ATTACHMENT0,mGL.RENDERBUFFER,cb);}\n   ;if(mGL.checkFramebufferStatus(mGL.FRAMEBUFFER)!=mGL.FRAMEBUFFER_COMPLETE){return null;}\n   ;mGL.bindRenderbuffer(mGL.RENDERBUFFER,null)\n   ;mGL.bindFramebuffer(mGL.FRAMEBUFFER,null)\n   ;return{mObjectID:id,mXres:xres,mYres:yres};}\n ;\n ;me.BlitRenderTarget=function(dst,src\n ){mGL.bindFramebuffer(mGL.READ_FRAMEBUFFER,src.mObjectID)\n  ;mGL.bindFramebuffer(mGL.DRAW_FRAMEBUFFER,dst.mObjectID)\n  ;mGL.clearBufferfv(mGL.COLOR,0,[0.0,0.0,0.0,1.0])\n  ;mGL.blitFramebuffer(0,0,src.mXres,src.mYres,0,0,src.mXres,src.mYres,mGL.COLOR_BUFFER_BIT,mGL.LINEAR);}\n ;\n ;me.SetViewport=function(vp){mGL.viewport(vp[0],vp[1],vp[2],vp[3]);}\n ;me.SetWriteMask=function(c0,c1,c2,c3,z){mGL.depthMask(z);mGL.colorMask(c0,c0,c0,c0);}\n ;\n ;me.SetState=function(stateName,stateValue\n ){if(stateName===me.RENDSTGATE.WIREFRAME\n  ){if(stateValue)mGL.polygonMode(mGL.FRONT_AND_BACK,mGL.LINE)\n   ;elsemGL.polygonMode(mGL.FRONT_AND_BACK,mGL.FILL)\n  ;}   else if(stateName===me.RENDSTGATE.FRONT_FACE\n  ){if(stateValue)mGL.cullFace(mGL.BACK)\n   ;elsemGL.cullFace(mGL.FRONT)\n  ;}else if(stateName===me.RENDSTGATE.CULL_FACE\n  ){if(stateValue)mGL.enable(mGL.CULL_FACE)\n   ;elsemGL.disable(mGL.CULL_FACE)\n  ;}else if(stateName===me.RENDSTGATE.DEPTH_TEST\n  ){if(stateValue)mGL.enable(mGL.DEPTH_TEST)\n   ;elsemGL.disable(mGL.DEPTH_TEST)\n  ;}else if(stateName===me.RENDSTGATE.ALPHA_TO_COVERAGE\n  ){if(stateValue){mGL.enable(mGL.SAMPLE_ALPHA_TO_COVERAGE)\n  ;}else            {mGL.disable(mGL.SAMPLE_ALPHA_TO_COVERAGE);}}}\n ;\n ;me.SetMultisample=function(v\n ){if(v===true){mGL.enable(mGL.SAMPLE_COVERAGE);mGL.sampleCoverage(1.0,false);}else{mGL.disable(mGL.SAMPLE_COVERAGE);}}\n ;\n ;me.CreateShader=function(vsSource,fsSource\n ){if(mGL===null)return{mProgram:null,mResult:false,mInfo:\"No WebGL\",mHeaderLines:0}\n  ;var te={mProgram:null,mResult:true,mInfo:\"compile success\",mHeaderLines:0,mErrorType:0}\n  ;var vs=mGL.createShader(mGL.VERTEX_SHADER)\n  ;var fs=mGL.createShader(mGL.FRAGMENT_SHADER)\n  ;vsSource=mShaderHeader[0]+vsSource\n  ;fsSource=mShaderHeader[1]+fsSource\n  ;mGL.shaderSource(vs,vsSource)\n  ;mGL.shaderSource(fs,fsSource)\n  ;mGL.compileShader(vs)\n  ;mGL.compileShader(fs)\n  ;if(!mGL.getShaderParameter(vs,mGL.COMPILE_STATUS)\n  ){var infoLog=mGL.getShaderInfoLog(vs)\n   ;alert(\"comilefail2\"+infoLog)\n   ;te.mInfo=infoLog\n   ;te.mErrorType=0\n   ;te.mResult=false\n   ;return te;}\n  ;if(!mGL.getShaderParameter(fs,mGL.COMPILE_STATUS)\n  ){var infoLog=mGL.getShaderInfoLog(fs)\n   ;alert(\"compileFail:\"+infoLog)\n   ;te.mInfo=infoLog\n   ;te.mErrorType=1\n   ;te.mResult=false\n   ;return te;}\n  ;te.mProgram=mGL.createProgram()\n  ;mGL.attachShader(te.mProgram,vs)\n  ;mGL.attachShader(te.mProgram,fs)\n  ;mGL.linkProgram(te.mProgram)\n  ;if(!mGL.getProgramParameter(te.mProgram,mGL.LINK_STATUS)\n  ){var infoLog=mGL.getProgramInfoLog(te.mProgram)\n   ;mGL.deleteProgram(te.mProgram)\n   ;te.mInfo=infoLog\n   ;te.mErrorType=2\n   ;te.mResult=false\n   ;return te;}return te;}\n ;\n ;me.AttachShader=function(shader\n ){if(shader===null){mBindedShader=null;mGL.useProgram(null)\n ;}else{mBindedShader=shader;mGL.useProgram(shader.mProgram);}}\n ;\n ;me.DetachShader=function(){mGL.useProgram(null);}\n ;me.DestroyShader=function(tex){mGL.deleteProgram(tex.mProgram);}\n ;me.GetAttribLocation=function(shader,name){return mGL.getAttribLocation(shader.mProgram,name);}\n ;me.SetShaderConstantLocation=function(shader,name){return mGL.getUniformLocation(shader.mProgram,name);}\n ;me.SetShaderConstantMat4F=function(uname,params,istranspose\n ){var program=mBindedShader\n  ;var pos=mGL.getUniformLocation(program.mProgram,uname)\n  ;if(pos===null)return false\n  ;if(istranspose===false\n  ){var tmp=new Float32Array([params[0],params[4],params[8],params[12],params[1],params[5],params[9],params[13]\n      ,params[2],params[6],params[10],params[14],params[3],params[7],params[11],params[15]])\n   ;mGL.uniformMatrix4fv(pos,false,tmp)\n  ;}else mGL.uniformMatrix4fv(pos,false,new Float32Array(params))\n  ;return true;}\n ;\n ;me.SetShaderConstant1F_Pos=function(pos,x){mGL.uniform1f(pos,x);return true;}\n ;\n ;me.SetShaderConstant1F=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform1f(pos,x)\n  ;return true;}\n ;me.SetShaderConstant1I=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform1i(pos,x)\n  ;return true;}\n ;\n ;me.SetShaderConstant2F=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform2fv(pos,x)\n  ;return true;}\n ;\n ;me.SetShaderConstant3F=function(uname,x,y,z\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform3f(pos,x,y,z)\n  ;return true;}\n ;\n ;me.SetShaderConstant1FV=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform1fv(pos,new Float32Array(x))\n  ;return true;}\n ;\n ;me.SetShaderConstant3FV=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform3fv(pos,new Float32Array(x))\n  ;return true;}\n ;\n ;me.SetShaderConstant4FV=function(uname,x\n ){var pos=mGL.getUniformLocation(mBindedShader.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform4fv(pos,new Float32Array(x))\n  ;return true;}\n ;\n ;me.SetShaderTextureUnit=function(uname,unit\n ){var program=mBindedShader\n  ;var pos=mGL.getUniformLocation(program.mProgram,uname)\n  ;if(pos===null)return false\n  ;mGL.uniform1i(pos,unit)\n  ;return true;}\n ;\n ;me.CreateVertexArray=function(data,mode\n ){var id=mGL.createBuffer()\n  ;mGL.bindBuffer(mGL.ARRAY_BUFFER,id)\n  ;if(mode===me.BUFTYPE.STATIC)mGL.bufferData(mGL.ARRAY_BUFFER,data,mGL.STATIC_DRAW)\n  ;else mGL.bufferData(mGL.ARRAY_BUFFER,data,mGL.DYNAMIC_DRAW)\n  ;return{mObject:id};}\n ;\n ;me.CreateIndexArray=function(data,mode\n ){var id=mGL.createBuffer()\n  ;mGL.bindBuffer(mGL.ELEMENT_ARRAY_BUFFER,id)\n  ;if(mode===me.BUFTYPE.STATIC)mGL.bufferData(mGL.ELEMENT_ARRAY_BUFFER,data,mGL.STATIC_DRAW)\n  ;else mGL.bufferData(mGL.ELEMENT_ARRAY_BUFFER,data,mGL.DYNAMIC_DRAW)\n  ;return{mObject:id};}\n ;\n ;me.DestroyArray=function(tex){mGL.destroyBuffer(tex.mObject);}\n ;\n ;me.AttachVertexArray=function(tex,attribs,pos\n ){var shader=mBindedShader\n  ;mGL.bindBuffer(mGL.ARRAY_BUFFER,tex.mObject)\n  ;var num=attribs.mChannels.length\n  ;var stride=attribs.mStride\n  ;var offset=0\n  ;for(var i=0;i<num;i++\n  ){var id=pos[i]\n   ;mGL.enableVertexAttribArray(id)\n   ;var dtype=mGL.FLOAT\n   ;var dsize=4\n          ;if(attribs.mChannels[i].mType===me.TYPE.UINT8){dtype=mGL.UNSIGNED_BYTE;dsize=1\n   ;}else if(attribs.mChannels[i].mType===me.TYPE.UINT16){dtype=mGL.UNSIGNED_SHORT;dsize=2\n   ;}else if(attribs.mChannels[i].mType===me.TYPE.FLOAT32){dtype=mGL.FLOAT;dsize=4\n   ;}mGL.vertexAttribPointer(id,attribs.mChannels[i].mNumComponents,dtype,attribs.mChannels[i].mNormalize,stride,offset)\n   ;offset+=attribs.mChannels[i].mNumComponents*dsize;}}\n ;\n ;me.AttachIndexArray=function(tex){mGL.bindBuffer(mGL.ELEMENT_ARRAY_BUFFER,tex.mObject);}\n ;me.DetachVertexArray=function(tex,attribs\n ){var num=attribs.mChannels.length\n  ;for(var i=0;i<num;i++)mGL.disableVertexAttribArray(i)\n  ;mGL.bindBuffer(mGL.ARRAY_BUFFER,null);}\n ;me.DetachIndexArray=function(tex){mGL.bindBuffer(mGL.ELEMENT_ARRAY_BUFFER,null);}\n ;me.DrawPrimitive=function(typeOfPrimitive,num,useIndexArray,numInstances\n ){mGL.drawElements(4,num,mGL.UNSIGNED_SHORT,0)}\n \n ;me.DrawFullScreenTriangle_XY=function(v){mGL.bindBuffer(mGL.ARRAY_BUFFER,mVBO_Tri)\n  ;mGL.vertexAttribPointer(v,2,mGL.FLOAT,false,0,0);mGL.enableVertexAttribArray(v)\n  ;mGL.drawArrays(4,0,3);mGL.disableVertexAttribArray(v);mGL.bindBuffer(mGL.ARRAY_BUFFER,null);}\n ;me.DrawUnitQuad_XY=function(v){mGL.bindBuffer(mGL.ARRAY_BUFFER,mVBO_Quad)\n  ;mGL.vertexAttribPointer(v,2,mGL.FLOAT,false,0,0);mGL.enableVertexAttribArray(v)\n  ;mGL.drawArrays(4,0,6);mGL.disableVertexAttribArray(v);mGL.bindBuffer(mGL.ARRAY_BUFFER,null);};\n\n\n\n\nme.SetBlend=function(t\n){if(t\n ){mGL.enable(mGL.BLEND)\n  ;mGL.blendEquationSeparate(mGL.FUNC_ADD,mGL.FUNC_ADD)\n  ;mGL.blendFuncSeparate(mGL.SRC_ALPHA,mGL.ONE_MINUS_SRC_ALPHA,mGL.ONE,mGL.ONE_MINUS_SRC_ALPHA)\n ;}else{mGL.disable(mGL.BLEND);}};\n\nme.GetPixelData=function(data,xres,yres\n){mGL.readPixels(0,0,xres,yres,mGL.RGBA,mGL.UNSIGNED_BYTE,data);};return me;}\n\n//piLibs 2015-2017-https://iquilezles.org/www/material/piLibs/piLibs.htm\n//piVecTypes\nfunction vec3(a,b,c){return[a,b,c];}\nfunction vec4(a,b,c,d){return[a,b,c,d];}\nfunction setFromQuaternion(q\n){var w=q[3]*q[3]\n ;var x=q[0]*q[0]\n ;var y=q[1]*q[1]\n ;var z=q[2]*q[2]\n ;return[   w+x-y-z      ,2.*(q[0]*q[1]-q[3]*q[2]),2.*(q[0]*q[2]+q[3]*q[1]),0\n ,2.*(q[0]*q[1]+q[3]*q[2]),      w-x+y-z           ,2.*(q[1]*q[2]-q[3]*q[0]),0\n ,2.*(q[0]*q[2]-q[3]*q[1]),2.0*(q[1]*q[2]+q[3]*q[0]),w-x-y+z\n ,0,0,0,0,1];}\n\n//actually i can phrase this in a way that matches both, opengl and java?\n//man i just need a better inversion method here.\n//and these use defines or lets!\n//not touching that for a thile\n//boottom line, this chung STAYS IN for now\nfunction invertFast(m){var inv\n =[m[5]*m[10]*m[15]-m[5]*m[11]*m[14]-m[9]*m[6]*m[15]+m[9]*m[7]*m[14]+m[13]*m[6]*m[11]-m[13]*m[7]*m[10]\n ,-m[1]*m[10]*m[15]+m[1]*m[11]*m[14]+m[9]*m[2]*m[15]- m[9]*m[3]*m[14]- m[13]*m[2]*m[11]+m[13]*m[3]*m[10]\n ,m[1]*m[6]*m[15]-m[1]*m[7]*m[14]-m[5]*m[2]*m[15]+m[5]*m[3]*m[14]+m[13]*m[2]*m[7]-m[13]*m[3]*m[6]\n ,-m[1]*m[6]*m[11]+m[1]*m[7]*m[10]+m[5]*m[2]*m[11]- m[5]*m[3]*m[10]- m[9]*m[2]*m[7]+m[9]*m[3]*m[6]\n ,-m[4]*m[10]*m[15]+m[4]*m[11]*m[14]+m[8]*m[6]*m[15]- m[8]*m[7]*m[14]- m[12]*m[6]*m[11]+m[12]*m[7]*m[10]\n ,m[0]*m[10]*m[15]-m[0]*m[11]*m[14]-m[8]*m[2]*m[15]+m[8]*m[3]*m[14]+m[12]*m[2]*m[11]-m[12]*m[3]*m[10]\n ,-m[0]*m[6]*m[15]+m[0]*m[7]*m[14]+m[4]*m[2]*m[15]- m[4]*m[3]*m[14]- m[12]*m[2]*m[7]+m[12]*m[3]*m[6]\n ,m[0]*m[6]*m[11]-m[0]*m[7]*m[10]-m[4]*m[2]*m[11]+m[4]*m[3]*m[10]+m[8]*m[2]*m[7]-m[8]*m[3]*m[6]\n ,m[4]*m[9]*m[15]-m[4]*m[11]*m[13]-m[8]*m[5]*m[15]+m[8]*m[7]*m[13]+m[12]*m[5]*m[11]-m[12]*m[7]*m[9]\n ,-m[0]*m[9]*m[15]+m[0]*m[11]*m[13]+m[8]*m[1]*m[15]- m[8]*m[3]*m[13]- m[12]*m[1]*m[11]+m[12]*m[3]*m[9]\n , m[0]*m[5]*m[15]- m[0]*m[7]*m[13]- m[4]*m[1]*m[15]+m[4]*m[3]*m[13]+m[12]*m[1]*m[7]- m[12]*m[3]*m[5]\n , -m[0]*m[5]*m[11]+m[0]*m[7]*m[9]+m[4]*m[1]*m[11]-  m[4]*m[3]*m[9]-  m[8]*m[1]*m[7]+m[8]*m[3]*m[5]\n , -m[4]*m[9]*m[14]+m[4]*m[10]*m[13]+m[8]*m[5]*m[14]-  m[8]*m[6]*m[13]-  m[12]*m[5]*m[10]+m[12]*m[6]*m[9]\n , m[0]*m[9]*m[14]- m[0]*m[10]*m[13]- m[8]*m[1]*m[14]+m[8]*m[2]*m[13]+m[12]*m[1]*m[10]- m[12]*m[2]*m[9]\n , -m[0]*m[5]*m[14]+m[0]*m[6]*m[13]+m[4]*m[1]*m[14]-  m[4]*m[2]*m[13]-  m[12]*m[1]*m[6]+m[12]*m[2]*m[5]\n , m[0]*m[5]*m[10]- m[0]*m[6]*m[9]- m[4]*m[1]*m[10]+m[4]*m[2]*m[9]+m[8]*m[1]*m[6]- m[8]*m[2]*m[5]]\n ;var d=1./(m[0]*inv[0]+m[1]*inv[4]+m[2]*inv[8]+m[3]*inv[12])\n ;for(var i=0;i<16;i++)inv[i]=inv[i]*d\n ;return inv;}\n\nfunction matMul(a,b\n){var res=[]\n ;for(var i=0;i<4;i++\n ){var x=a[4*i+0];var y=a[4*i+1];var z=a[4*i+2];var w=a[4*i+3]\n  ;res[4*i+0]=x*b[0]+y*b[4]+z*b[8]+w*b[12]\n  ;res[4*i+1]=x*b[1]+y*b[5]+z*b[9]+w*b[13]\n  ;res[4*i+2]=x*b[2]+y*b[6]+z*b[10]+w*b[14]\n  ;res[4*i+3]=x*b[3]+y*b[7]+z*b[11]+w*b[15];}return res;}\n\nfunction matMulpoint(m,v){return[m[0]*v[0]+m[1]*v[1]+m[2]*v[2]+m[3]\n ,m[4]*v[0]+m[5]*v[1]+m[6]*v[2]+m[7]\n ,m[8]*v[0]+m[9]*v[1]+m[10]*v[2]+m[11]];}\n\n//piLibs 2015-2017-https://iquilezles.org/www/material/piLibs/piLibs.htm\n//piWebVR\n\nfunction WebVR(isVREnabledCallback,canvasElement\n){this.mSupportVR=false\n ;this.mHMD=null\n ;var me=this\n ;var listVRDisplays=function(vrdevs\n ){for(var i=0;i<vrdevs.length;i++\n  ){if(vrdevs[i]instanceof VRDisplay\n   ){me.mHMD=vrdevs[i]\n    ;alert(\"WebVR available\")\n    ;console.log(me.mHMD)\n    ;break;}}\n  ;isVREnabledCallback(true)\n  ;me.mSupportVR=true;}\n ;if(navigator.getVRDisplays){navigator.getVRDisplays().then(listVRDisplays);}\n ;isVREnabledCallback(false)\n ;this.mCanvas=canvasElement;}\n\nWebVR.prototype.GetData=function(id\n){var frameData=new VRFrameData()\n ;var s=this.mHMD.getFrameData(frameData)\n ;var p=frameData.pose\n ;var fovL=this.mHMD.getEyeParameters(\"left\")\n ;var fovR=this.mHMD.getEyeParameters(\"right\")\n ;var cPos=p.position?vec3(-p.position[0],-p.position[1],-p.position[2])                     :vec3(0,0,0)\n ,rot=p.orientation?vec4(p.orientation[0],p.orientation[1],p.orientation[2],p.orientation[3]):vec4(0,0,0,0)\n ;rot=setFromQuaternion(rot)\n ;return {mCamera:{mCamera:matMul(invertFast(rot),[1,0,0,cPos[0],0,1,0,cPos[1],0,0,1,cPos[2],0,0,0,1])}\n  ,mLeftEye :{mVP:[0,0,fovL.renderWidth,fovL.renderHeight],mProjection:Array.from(frameData.leftProjectionMatrix),mCamera: Array.from(frameData.leftViewMatrix)}\n  ,mRightEye:{mVP:[fovR.renderWidth/2,0,fovR.renderWidth,fovR.renderHeight],mProjection:Array.from(frameData.rightProjectionMatrix),mCamera:Array.from(frameData.rightViewMatrix)}\n }}\n\nWebVR.prototype.RequestAnimationFrame=function(id){this.mHMD.requestAnimationFrame(id);}\nWebVR.prototype.IsPresenting=function(id){if(this.mHMD.isPresenting){return true;}return false;}\nWebVR.prototype.Finish=function(id){if(this.mHMD.isPresenting){this.mHMD.submitFrame();}}\nWebVR.prototype.Enable=function(id\n){this.mHMD.requestPresent([{source:this.mCanvas}]).then(function(\n ){},function(err){console.log(\"webVR:requestPresent failed.\");});}\nWebVR.prototype.Disable=function(id\n){if(!this.mHMD.isPresenting){return;}\n ;this.mHMD.exitPresent().then(function(){},function(err){console.log(\"webVR:exitPresent failed.\");});}\n\n\n\n//piLibs 2015-2017-https://iquilezles.org/www/material/piLibs/piLibs.htm\n//piWebUtils\n\n//RequestAnimationFrame\nwindow.requestAnimFrame=(function(){return window.requestAnimationFrame    \n||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame\n||window.msRequestAnimationFrame||function(cb){window.setTimeout(cb,1000/60);};})();\n\n\nwindow.getRealTime=(function(){if(\"performance\" in window)return function(){return window.performance.now();}\n           return function(){return (new Date()).getTime();}})();\n\nwindow.URL=window.URL||window.webkitURL;\n\nnavigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;\n\nfunction htmlEntities(str){return str;}\n\n\nvar piGetTime=function(timestamp\n){if(timestamp==0)return \"\" ;return new Date(timestamp*1000).toISOString().substr(0,10);}\n\nfunction piGetCoords(obj){var x=0;var y=0;do    {x+=obj.offsetLeft;y+=obj.offsetTop;}while(obj=obj.offsetParent);return{mX:x,mY:y};}\n\nfunction piGetMouseCoords(ev,canvasElement\n){var pos=piGetCoords(canvasElement)\n ;var mcx=         (ev.pageX-pos.mX)* canvasElement.width/canvasElement.offsetWidth\n ;var mcy=canvasElement.height-(ev.pageY-pos.mY)* canvasElement.height/canvasElement.offsetHeight\n ;return{mX:mcx,mY:mcy};}\n\nfunction piGetSourceElement(e){var ele=null;if(e.target)ele=e.target;if(e.srcElement)ele=e.srcElement;return ele;}\n\nfunction piRequestFullScreen(ele\n){if(ele==null)ele=document.documentElement\n ;if(ele.requestFullscreen)ele.requestFullscreen()\n ;else if(ele.msRequestFullscreen)ele.msRequestFullscreen()\n ;else if(ele.mozRequestFullScreen)ele.mozRequestFullScreen()\n ;else if(ele.webkitRequestFullscreen)ele.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);}\n\nfunction piIsFullScreen(\n){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||false;}\n\nfunction piExitFullScreen(\n){if(document.exitFullscreen)document.exitFullscreen()\n ;else if(document.msExitFullscreen)document.msExitFullscreen()\n ;else if(document.mozCancelFullScreen)document.mozCancelFullScreen()\n ;else if(document.webkitExitFullscreen)document.webkitExitFullscreen();}\n\n\n\n\nfunction piCreateAudioContext(\n){var res=null\n ;try    {if(window.AudioContext)res=new AudioContext()\n  ;if(res==null&&window.webkitAudioContext)res=new webkitAudioContext();}catch(e){res=null;}return res;}\n\n\nfunction piCreateFPSCounter(\n){var mFrame\n ;var mTo\n ;var mFPS\n ;var iReset=function(time){mFrame=0;mTo=time;mFPS=60.0;}\n ;var iCount=function(time\n ){mFrame++\n  ;if((time-mTo)>500.0\n  ){mFPS=1000.0*mFrame/(time-mTo)\n   ;mFrame=0\n   ;mTo=time\n   ;return true;}return false;}\n ;var iGetFPS=function(){return mFPS;}\n ;return{Reset:iReset,Count:iCount,GetFPS:iGetFPS};}\n\nfunction piCanMediaRecorded(canvas\n){if(typeof window.MediaRecorder !=='function'||typeof canvas.captureStream !=='function'){return false;}\n    return true;\n}\nfunction piCreateMediaRecorder(isRecordingCallback,canvas\n){if(piCanMediaRecorded(canvas)==false){return null;}\n ;var mediaRecorder=new MediaRecorder(canvas.captureStream())\n ;var chunks=[]\n ;mediaRecorder.ondataavailable=function(e){if(e.data.size>0){chunks.push(e.data);}}\n ;mediaRecorder.onstart=function(){isRecordingCallback(true);}\n ;mediaRecorder.onstop=function(\n ){isRecordingCallback(false)\n  ;let blob   =new Blob(chunks,{type:\"video/webm\"})\n  ;chunks     =[]\n  ;let videoURL=window.URL.createObjectURL(blob)\n  ;let url    =window.URL.createObjectURL(blob)\n  ;let a      =document.createElement(\"a\")\n  ;document.body.appendChild(a)\n  ;a.style    =\"display:none\"\n  ;a.href     =url\n  ;a.download =\"capture.webm\"\n  ;a.click()\n  ;window.URL.revokeObjectURL(url);}\n  ;return mediaRecorder;}\n\n\n\n\nfunction bufferID_to_assetID(id){\n    if(id==0)return 'bufAid';\n    if(id==1)return 'bufBid';//if(id==1)return XsXGR8;\n    if(id==2)return 'bufCid';\n    if(id==3)return 'bufDid'; return 'none';}\nfunction assetID_to_bufferID(id){\n    if(id=='bufAid')return 0;\n    if(id=='bufBid')return 1;//if(id=='XsXGR8')return 1;\n    if(id=='bufCid')return 2;\n    if(id=='bufDid')return 3;return -1;}\n\nfunction EffectPass(renderer,is20,hasShaderTextureLOD,callback,obj,forceMuted,forcePaused,outputGainNode,copyProgram,id)\n{\n    this.mID=id;\n    this.mInputs=[null,null,null,null];\n    this.mOutputs=[null,null,null,null];\n    this.mSource=null;\n    this.mGainNode=outputGainNode;\n\n    this.mRenderer=renderer;\n    this.mProgramCopy=copyProgram;\n\n    this.mType=\"image\";\n    this.mName=\"none\";\n    this.mFrame=0;\n\n    this.mShaderTextureLOD=hasShaderTextureLOD;\n    this.mIs20=is20;\n    this.mTextureCallbackFun=callback;\n    this.mTextureCallbackObj=obj;\n    this.mForceMuted=forceMuted;\n    this.mForcePaused=forcePaused;\n}\n\nEffectPass.prototype.MakeHeader_Image=function()\n{\n    var header=\"\";\n\n    header+=\"uniform vec3      iResolution;\\n\" +\n              \"uniform float     iTime;\\n\" +\n              \"uniform float     iChannelTime[4];\\n\" +\n              \"uniform vec4      iMouse;\\n\" +\n              \"uniform vec4      iDate;\\n\" +\n              \"uniform float     iSampleRate;\\n\" +\n              \"uniform vec3      iChannelResolution[4];\\n\" +\n              \"uniform int       iFrame;\\n\" +\n              \"uniform float     iTimeDelta;\\n\" +\n              \"uniform float     iFrameRate;\\n\";\n\n    header+=\"struct Channel\\n\";\n    header+=\"{\\n\";\n    header+=\"    vec3  resolution;\\n\";\n    header+=\"    float time;\\n\";\n    header+=\"};\\n\";\n    header+=\"uniform Channel iChannel[4];\\n\";\n\n    for(var i=0;i<this.mInputs.length;i++)\n    {\n        var inp=this.mInputs[i];\n             if(inp==null)header+=\"uniform sampler2D iChannel\"+i+\";\\n\";\n        else if(inp.mInfo.mType==\"cubemap\")header+=\"uniform samplerCube iChannel\"+i+\";\\n\";\n        else if(inp.mInfo.mType==\"volume\")header+=\"uniform sampler3D iChannel\"+i+\";\\n\";\n        else header+=\"uniform sampler2D iChannel\"+i+\";\\n\";\n}\n\n\theader+=\"void mainImage(out vec4 c,in vec2 f);\\n\"\n\n    this.mImagePassFooter=\"\";\n    if(this.mIs20)\n        this.mImagePassFooter+=\"\\nout vec4 outColor;\\n\";\n    this.mImagePassFooter+=\"\\nvoid main(void)\" +\n    \"{\" +\n        \"vec4 color=vec4(0.0,0.0,0.0,1.0);\" +\n        \"mainImage(color,gl_FragCoord.xy);\" +\n        \"color.w=1.0;\";\n    if(this.mIs20)\n        this.mImagePassFooter+=\"outColor=color;}\";\n    else\n        this.mImagePassFooter+=\"gl_FragColor=color;}\";\n\n    this.mImagePassFooterVR=\"\\n\" +\n    \"uniform vec4 unViewport;\\n\" +\n    \"uniform vec3 unCorners[5];\\n\";\n    if(this.mIs20)\n        this.mImagePassFooterVR+=\"\\nout vec4 outColor;\\n\";\n    this.mImagePassFooterVR+=\"void main(void)\" +\n    \"{\" +\n        \"vec4 color=vec4(0.0,0.0,0.0,1.0);\" +\n\n        \"vec3 ro=unCorners[4];\" +\n        \"vec2 uv=(gl_FragCoord.xy-unViewport.xy)/unViewport.zw;\"+\n        \"vec3 rd=normalize(mix(mix(unCorners[0],unCorners[1],uv.x),\" +\n \"mix(unCorners[3],unCorners[2],uv.x),uv.y)-ro);\"+\n\n        \"mainVR(color,gl_FragCoord.xy-unViewport.xy,ro,rd);\" +\n        \"color.w=1.0;\"\n    if(this.mIs20)\n        this.mImagePassFooterVR+=\"outColor=color;}\";\n    else\n        this.mImagePassFooterVR+=\"gl_FragColor=color;}\";\n\n    this.mHeader=header;\n    this.mHeaderLength=0;\n}\n\nEffectPass.prototype.MakeHeader_Buffer=function()\n{\n    var header=\"\";\n    \n    header+=\"uniform vec3      iResolution;\\n\" +\n              \"uniform float     iTime;\\n\" +\n              \"uniform float     iChannelTime[4];\\n\" +\n              \"uniform vec4      iMouse;\\n\" +\n              \"uniform vec4      iDate;\\n\" +\n              \"uniform float     iSampleRate;\\n\" +\n              \"uniform vec3      iChannelResolution[4];\\n\" +\n              \"uniform int       iFrame;\\n\" +\n              \"uniform float     iTimeDelta;\\n\" +\n              \"uniform float     iFrameRate;\\n\";\n\n    for(var i=0;i<this.mInputs.length;i++)\n    {\n        var inp=this.mInputs[i];\n             if(inp==null)header+=\"uniform sampler2D iChannel\"+i+\";\\n\";\n        else if(inp.mInfo.mType==\"cubemap\")header+=\"uniform samplerCube iChannel\"+i+\";\\n\";\n        else if(inp.mInfo.mType==\"volume\")header+=\"uniform sampler3D iChannel\"+i+\";\\n\";\n        else header+=\"uniform sampler2D iChannel\"+i+\";\\n\";\n}\n\n\theader+=\"void mainImage(out vec4 c,in vec2 f);\\n\"\n\n    this.mImagePassFooter=\"\";\n    if(this.mIs20)\n        this.mImagePassFooter+=\"\\nout vec4 outColor;\\n\";\n    this.mImagePassFooter+=\"\\nvoid main(void)\\n\" +\n    \"{\" +\n        \"vec4 color=vec4(0.0,0.0,0.0,1.0);\" +\n        \"mainImage(color,gl_FragCoord.xy);\";\n    if(this.mIs20)\n        this.mImagePassFooter +=\"outColor=color;}\";\n    else\n        this.mImagePassFooter +=\"gl_FragColor=color;}\";\n\n    this.mImagePassFooterVR=\"\\n\" +\n    \"uniform vec4 unViewport;\\n\" +\n    \"uniform vec3 unCorners[5];\\n\";\n    if(this.mIs20)\n    this.mImagePassFooterVR+=\"\\nout vec4 outColor;\\n\";\n    this.mImagePassFooterVR+=\"\\nvoid main(void)\\n\" +\n    \"{\" +\n        \"vec4 color=vec4(0.0,0.0,0.0,1.0);\" +\n\n        \"vec3 ro=unCorners[4];\" +\n        \"vec2 uv=(gl_FragCoord.xy-unViewport.xy)/unViewport.zw;\"+\n        \"vec3 rd=normalize(mix(mix(unCorners[0],unCorners[1],uv.x),\" +\n \"mix(unCorners[3],unCorners[2],uv.x),uv.y)-ro);\"+\n\n        \"mainVR(color,gl_FragCoord.xy-unViewport.xy,ro,rd);\";\n    if(this.mIs20)\n        this.mImagePassFooterVR +=\"outColor=color;}\";\n    else\n        this.mImagePassFooterVR +=\"gl_FragColor=color;}\";\n\n    this.mHeader=header;\n    this.mHeaderLength=0;\n}\n\nEffectPass.prototype.MakeHeader_Sound=function()\n{\n    var header=\"\";\n\n    header+=\"uniform float     iChannelTime[4];\\n\" +\n              \"uniform float     iBlockOffset;\\n\" +\n              \"uniform vec4      iDate;\\n\" +\n              \"uniform float     iSampleRate;\\n\" +\n              \"uniform vec3      iChannelResolution[4];\\n\";\n\n    for(var i=0;i<this.mInputs.length;i++)\n    {\n        var inp=this.mInputs[i];\n\n        if(inp!=null&&inp.mInfo.mType==\"cubemap\")\n            header+=\"uniform samplerCube iChannel\"+i+\";\\n\";\n        else\n            header+=\"uniform sampler2D iChannel\"+i+\";\\n\";\n}\n\n    this.mHeader=header;\n    this.mHeaderLength=0;\n}\n\n\nEffectPass.prototype.MakeHeader_Common=function(\n){   var header=\"\"\n ;var headerlength=0\n ;header+=\"uniform vec4      iDate;\\n\" \n +              \"uniform float     iSampleRate;\\n\"\n ;   this.mImagePassFooter=\"\"\n ;if(this.mIs20)        this.mImagePassFooter+=\"\\nout vec4 outColor;\\n\"\n ;this.mImagePassFooter+=\"\\nvoid main(void)\\n\" +    \"{\"\n ;if(this.mIs20)        this.mImagePassFooter+=\"outColor=vec4(0.0);}\"\n ;else        this.mImagePassFooter+=\"gl_FragColor=vec4(0.0);}\"\n ;this.mHeader=header\n ;this.mHeaderLength=headerlength;}\n\nEffectPass.prototype.MakeHeader=function(\n){         if(this.mType==\"image\")this.MakeHeader_Image()\n ;else if(this.mType==\"sound\")this.MakeHeader_Sound()\n ;else if(this.mType==\"buffer\")this.MakeHeader_Buffer()\n ;else if(this.mType==\"common\")this.MakeHeader_Common()\n ;else alert(\"ERROR\");}\n\nEffectPass.prototype.Create_Image=function(wa\n){    this.MakeHeader()\n ;this.mSampleRate=44100\n ;this.mSupportsVR=false\n ;this.mProgram=null\n ;this.mProgramVR=null;}\n \nEffectPass.prototype.Destroy_Image=function(wa){}\n\nEffectPass.prototype.Create_Buffer=function(wa\n){    this.MakeHeader()\n ;   this.mSampleRate=44100\n ;this.mSupportsVR=false\n ;this.mProgram=null\n ;this.mProgramVR=null\n ;}\n \nEffectPass.prototype.Destroy_Buffer=function(wa){}\nEffectPass.prototype.Create_Common=function(wa){    this.MakeHeader();}\nEffectPass.prototype.Destroy_Common=function(wa){}\n\nEffectPass.prototype.Create_Sound=function(wa){\n    this.MakeHeader();\n\n    if(this.mIs20)\n    {\n        this.mSoundPassFooter=\"\\nout vec4 outColor;void main()\" +\n        \"{\" +\n            \"float t=iBlockOffset+((gl_FragCoord.x-0.5)+(gl_FragCoord.y-0.5)*512.0)/iSampleRate;\" +\n            \"vec2 y=mainSound( in int samp,t);\" +\n            \"vec2 v=floor((0.5+0.5*y)*65536.0);\" +\n            \"vec2 vl=mod(v,256.0)/255.0;\" +\n            \"vec2 vh=floor(v/256.0)/255.0;\" +\n            \"outColor=vec4(vl.x,vh.x,vl.y,vh.y);\" +\n        \"}\";\n}\n    else\n    {\n        this.mSoundPassFooter=\"\\nvoid main()\" +\n        \"{\" +\n            \"float t=iBlockOffset+((gl_FragCoord.x-0.5)+(gl_FragCoord.y-0.5)*512.0)/iSampleRate;\" +\n            \"vec2 y=mainSound( in int samp,t);\" +\n            \"vec2 v=floor((0.5+0.5*y)*65536.0);\" +\n            \"vec2 vl=mod(v,256.0)/255.0;\" +\n            \"vec2 vh=floor(v/256.0)/255.0;\" +\n            \"gl_FragColor=vec4(vl.x,vh.x,vl.y,vh.y);\" +\n        \"}\";\n}\n\n    this.mProgram=null;\n\n    this.mSampleRate=44100;\n    this.mPlayTime=60*3;\n    this.mPlaySamples=this.mPlayTime*this.mSampleRate;\n    this.mBuffer=wa.createBuffer(2,this.mPlaySamples,this.mSampleRate);\n\n    //-------------------\n    this.mTextureDimensions=512;\n    this.mRenderTexture=this.mRenderer.CreateTexture(this.mRenderer.TEXTYPE.T2D,\n       this.mTextureDimensions,this.mTextureDimensions,\n       this.mRenderer.TEXFMT.C4I8,\n       this.mRenderer.FILTER.NONE,\n       this.mRenderer.TEXWRP.CLAMP,null);\n    this.mRenderFBO=this.mRenderer.CreateRenderTarget(this.mRenderTexture,null,null,null,null,false);\n\n    //-----------------------------\n\n    //ArrayBufferView pixels;\n    this.mTmpBufferSamples=this.mTextureDimensions*this.mTextureDimensions;\n    this.mData=new Uint8Array(this.mTmpBufferSamples*4);\n\n    this.mPlayNode=null;\n}\n\nEffectPass.prototype.Destroy_Sound=function(wa)\n{\n    if(this.mPlayNode!=null)this.mPlayNode.stop();\n    this.mPlayNode=null;\n    this.mBuffer=null;\n    this.mData=null;\n\n    this.mRenderer.DestroyRenderTarget(this.mRenderFBO);\n    this.mRenderer.DestroyTexture(this.mRenderTexture);\n}\n\nEffectPass.prototype.Create=function(passType,passName,wa)\n{\n    this.mType=passType;\n    this.mName=passName;\n    this.mSource=null;\n\n         if(passType==\"image\")this.Create_Image(wa);\n    else if(passType==\"sound\")this.Create_Sound(wa);\n    else if(passType==\"buffer\")this.Create_Buffer(wa);\n    else if(passType==\"common\")this.Create_Common(wa);\n}\n\nEffectPass.prototype.Destroy=function(wa)\n{\n    this.mSource=null;\n         if(this.mType==\"image\")this.Destroy_Image(wa);\n    else if(this.mType==\"sound\")this.Destroy_Sound(wa);\n    else if(this.mType==\"buffer\")this.Destroy_Buffer(wa);\n    else if(this.mType==\"common\")this.Destroy_Common(wa);\n}\n\nEffectPass.prototype.NewShader_Sound=function(shaderCode,commonShaderCodes)\n{\n    var vsSource=null;\n\n    if(this.mIs20)\n        vsSource=\"layout(location=0)in vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\";\n    else\n        vsSource=\"attribute vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\";\n\n    var fsSource=this.mHeader;\n    for(var i=0;i<commonShaderCodes.length;i++){fsSource+=commonShaderCodes[i]+'\\n';}\n    this.mHeaderLength=fsSource.split(/\\r\\n|\\r|\\n/).length;\n    fsSource+=shaderCode;\n    fsSource+=this.mSoundPassFooter;\n    var res=this.mRenderer.CreateShader(vsSource,fsSource);\n    if(res.mResult==false)\n        return res.mInfo;\n\n    if(this.mProgram!=null)\n        this.mRenderer.DestroyShader(this.mProgram);\n\n    this.mProgram=res;\n\n    this.mFrame=0;//force sound to be regenerated\n\n    return null;\n}\n\nEffectPass.prototype.NewShader_Image=function(shaderCode,commonShaderCodes\n){\n  {var vsSource\n  ;if(this.mIs20)\n            vsSource=\"layout(location=0)in vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n  ;else vsSource=\"attribute vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n  ;var fsSource=this.mHeader\n  ;for(var i=0;i<commonShaderCodes.length;i++){fsSource+=commonShaderCodes[i]+'\\n';}\n  ;fsSource+=shaderCode\n  ;fsSource+=this.mImagePassFooter\n  ;var res=this.mRenderer.CreateShader(vsSource,fsSource)\n  ;if(res.mResult==false){alert(\"newshader fail\"+getShaderInfoLog(res));return res.mInfo}\n  ;if(this.mProgram!=null)this.mRenderer.DestroyShader(this.mProgram)\n  ;this.mProgram=res;}\n ;this.mSupportsVR=false\n ;var n1=shaderCode.indexOf(\"mainVR(\")\n ;var n2=shaderCode.indexOf(\"mainVR (\")\n ;var n3=shaderCode.indexOf(\"mainVR  (\")\n ;if(n1>0||n2>0||n3>0\n ){var vsSourceVR\n  ;if(this.mIs20)vsSourceVR=\"layout(location=0)in vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n  ;else vsSourceVR=\"attribute in vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n  ;var fsSourceVR=this.mHeader\n  ;for(var i=0;i<commonShaderCodes.length;i++){fsSourceVR+=commonShaderCodes[i];}\n  ;fsSourceVR+=shaderCode\n  ;fsSourceVR+=this.mImagePassFooterVR\n  ;var res=this.mRenderer.CreateShader(vsSource,fsSourceVR)\n  ;if(res.mResult==false)return res.mInfo\n  ;if(this.mProgramVR!=null)this.mRenderer.DestroyShader(this.mProgramVR)\n  ;this.mSupportsVR=true;this.mProgramVR=res;}return null;}\n\nEffectPass.prototype.NewShader_Common=function(shaderCode\n){var vsSource\n ;if(this.mIs20)vsSource=\"layout(location=0)in vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n ;else vsSource=\"attribute vec2 pos;void main(){gl_Position=vec4(pos.xy,0.0,1.0);}\"\n ;var fsSource=this.mHeader+shaderCode+this.mImagePassFooter\n ;var res=this.mRenderer.CreateShader(vsSource,fsSource)\n ;if(res.mResult==false)return res.mInfo\n ;if(this.mProgram!=null)this.mRenderer.DestroyShader(this.mProgram)\n ;this.mProgram=res\n ;return null;\n}\n\nEffectPass.prototype.NewShader=function(shaderCode,c\n){if(this.mRenderer==null)return null\n ;var res=null\n       ;if(this.mType==\"sound\")res=this.NewShader_Sound(shaderCode,c)\n ;else if(this.mType==\"image\")res=this.NewShader_Image(shaderCode,c)\n ;else if(this.mType==\"buffer\")res=this.NewShader_Image(shaderCode,c)\n ;else if(this.mType==\"common\")res=this.NewShader_Common(shaderCode)\n ;this.mSource=shaderCode\n ;return res;}\n\n\nEffectPass.prototype.DestroyInput=function(id\n){if(this.mInputs[id]==null)return\n ;if(this.mInputs[id].mInfo.mType==\"texture\"){if(this.mInputs[id].globject!=null)this.mRenderer.DestroyTexture(this.mInputs[id].globject);}\n ;if(this.mInputs[id].mInfo.mType==\"volume\"){if(this.mInputs[id].globject!=null)this.mRenderer.DestroyTexture(this.mInputs[id].globject)\n ;}else if(this.mInputs[id].mInfo.mType==\"webcam\"\n ){this.mInputs[id].video.pause()\n  ;this.mInputs[id].video.src=\"\"\n  ;var tracks=this.mInputs[id].video.stream.getVideoTracks()\n  ;if(tracks)tracks[0].stop()\n  ;this.mInputs[id].video=null\n  ;if(this.mInputs[id].globject!=null)this.mRenderer.DestroyTexture(this.mInputs[id].globject)\n ;}else if(this.mInputs[id].mInfo.mType==\"video\"\n ){this.mInputs[id].video.pause()\n  ;this.mInputs[id].video=null\n  ;if(this.mInputs[id].globject!=null)            this.mRenderer.DestroyTexture(this.mInputs[id].globject)\n ;}else if(this.mInputs[id].mInfo.mType==\"music\"||this.mInputs[id].mInfo.mType==\"musicstream\"\n ){this.mInputs[id].audio.pause()\n  ;this.mInputs[id].audio.mSound.mFreqData=null\n  ;this.mInputs[id].audio.mSound.mWaveData=null\n  ;this.mInputs[id].audio=null\n  ;if(this.mInputs[id].globject!=null)            this.mRenderer.DestroyTexture(this.mInputs[id].globject)\n ;}else if(this.mInputs[id].mInfo.mType==\"cubemap\"){if(this.mInputs[id].globject!=null)this.mRenderer.DestroyTexture(this.mInputs[id].globject)\n ;}else if(this.mInputs[id].mInfo.mType==\"keyboard\"\n ){//if(this.mInputs[id].globject!=null)//commented out in the original\n  ;// this.mRenderer.DestroyTexture(this.mInputs[id].globject)//commented out in the original\n ;}else if(this.mInputs[id].mInfo.mType==\"mic\"\n ){this.mInputs[id].mic=null\n  ;if(this.mInputs[id].globject!=null)this.mRenderer.DestroyTexture(this.mInputs[id].globject)  ;}\n ;this.mInputs[id]=null;}\n\nEffectPass.prototype.TooglePauseInput=function(id\n){var me=this\n ;var inp=this.mInputs[id]\n ;if(inp==null){\n }else if(inp.mInfo.mType==\"texture\" ){\n }else if(inp.mInfo.mType==\"volume\"){\n }else if(inp.mInfo.mType==\"video\"\n ){if(inp.video.mPaused\n  ){ inp.video.play()\n   ;inp.video.mPaused=false\n  ;}else{inp.video.pause();inp.video.mPaused=true;}\n ;return inp.video.mPaused\n ;}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n ){if(inp.audio.mPaused\n  ){inp.audio.play();inp.audio.mPaused=false\n   ;}else{inp.audio.pause();inp.audio.mPaused=true;}\n  ;return inp.audio.mPaused;}\n ;return null;}\n\nEffectPass.prototype.StopInput=function(id\n){var inp=this.mInputs[id]\n ;if(inp==null){\n ;}else if(inp.mInfo.mType==\"texture\"){\n ;}else if(inp.mInfo.mType==\"volume\"){\n ;}else if(inp.mInfo.mType==\"video\"){if(inp.video.mPaused==false){inp.video.pause();inp.video.mPaused=true;}return inp.video.mPaused\n ;}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n ){if(inp.audio.mPaused==false){inp.audio.pause();inp.audio.mPaused=true;}return inp.audio.mPaused;}\n  ;return null;}\n\nEffectPass.prototype.ResumeInput=function(id\n){var inp=this.mInputs[id]\n ;if(inp==null){\n ;}else if(inp.mInfo.mType==\"texture\"){\n ;}else if(inp.mInfo.mType==\"volume\"){\n ;}else if(inp.mInfo.mType==\"video\"){if(inp.video.mPaused){inp.video.play();inp.video.mPaused=false;}return inp.video.mPaused\n ;}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n ){if(inp.audio.mPaused){inp.audio.play();inp.audio.mPaused=false;}return inp.audio.mPaused;}\n ;return null;}\n\nEffectPass.prototype.RewindInput=function(id\n){var me=this\n ;var inp=this.mInputs[id]\n ;if(inp==null){\n ;}else if(inp.mInfo.mType==\"texture\"){\n ;}else if(inp.mInfo.mType==\"volume\"){\n ;}else if(inp.mInfo.mType==\"video\"){if(inp.loaded){inp.video.currentTime=0\n ;}}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n ){if(inp.loaded){inp.audio.currentTime=0;}}}\n\nEffectPass.prototype.MuteInput=function(wa,id\n){var me=this\n ;var inp=this.mInputs[id]\n ;if(inp==null){\n ;}else if(inp.mInfo.mType==\"texture\"){\n ;}else if(inp.mInfo.mType==\"volume\"){\n ;}else if(inp.mInfo.mType==\"video\"\n ){if(inp.video.mMuted\n  ){inp.video.muted=false\n   ;//inp.video.volume=100\n   ;inp.video.mMuted=false\n  ;}else{inp.video.muted=true\n   ;//inp.video.volume=0\n   ;inp.video.mMuted=true;}\n  ;return inp.video.mMuted\n ;}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n ){if(inp.audio.mMuted\n  ){if(wa!=null)inp.audio.mSound.mGain.gain.value=gVol\n   ;inp.audio.mMuted=false\n  ;}else{if(wa!=null)inp.audio.mSound.mGain.gain.value=0.0;inp.audio.mMuted=true;}\n  ;return inp.audio.mMuted;}\n ;return null;}\n\nEffectPass.prototype.UpdateInputs=function(wa,forceUpdate,keyboard\n){//alert(\"EffectPass.prototype.UpdateInputs\"+ wa+\" \"+ forceUpdate+\" \\n keyboard.mData=\\n\"+keyboard.mData)\n ;for(var i=0;i<this.mInputs.length;i++\n ){var inp=this.mInputs[i]\n  ;if(inp==null\n  ){if(forceUpdate\n   ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,null,false,0,0,-1.0,this.mID)\n ;}}else if(inp.mInfo.mType==\"texture\"){if(inp.loaded&&forceUpdate\n  ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.image,true,1,1,-1.0,this.mID)\n ;}}else if(inp.mInfo.mType==\"volume\" ){if(inp.loaded&&forceUpdate\n  ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.mPreview,true,1,1,-1.0,this.mID)\n ;}}else if(inp.mInfo.mType==\"cubemap\"){if(inp.loaded&&forceUpdate\n  ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.image[0],true,2,1,-1.0,this.mID)\n ;}}else if(inp.mInfo.mType==\"keyboard\"\n  ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,{mImage:keyboard.mIcon,mData:keyboard.mData},false,6,0,-1.0,this.mID)\n ;}else if(inp.mInfo.mType==\"video\"\n  ){if(inp.video.readyState===inp.video.HAVE_ENOUGH_DATA\n   ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.video,false,3,1,-1,this.mID)\n ;}}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n  ){if(inp.loaded&&inp.audio.mPaused==false&&inp.audio.mForceMuted==false\n   ){if(wa!=null\n    ){inp.audio.mSound.mAnalyser.getByteFrequencyData(inp.audio.mSound.mFreqData)\n     ;inp.audio.mSound.mAnalyser.getByteTimeDomainData(inp.audio.mSound.mWaveData);}\n    ;if(this.mTextureCallbackFun!=null\n    ){if(inp.mInfo.mType==\"music\")this.mTextureCallbackFun(this.mTextureCallbackObj,i,{wave:(wa==null)?null:inp.audio.mSound.mFreqData},false,4,1,inp.audio.currentTime,this.mID)\n     ;else if(inp.mInfo.mType==\"musicstream\")this.mTextureCallbackFun(this.mTextureCallbackObj,i,{wave:(wa==null)?null:inp.audio.mSound.mFreqData,info:inp.audio.soundcloudInfo},false,8,1,inp.audio.currentTime,this.mID)\n   ;}}else if(inp.loaded==false\n    ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,{wave:null},false,4,0,-1.0,this.mID)\n  ;}}else if(inp.mInfo.mType==\"mic\"\n   ){if(inp.loaded&&inp.mForceMuted==false\n    ){if(wa!=null\n     ){inp.mAnalyser.getByteFrequencyData(inp.mFreqData)\n     ;inp.mAnalyser.getByteTimeDomainData(inp.mWaveData);}\n    ;if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,{wave:((wa==null)?null:inp.mFreqData)},false,5,1,0,this.mID)\n  ;}}else if(inp.mInfo.mType==\"buffer\"\n   ){if(inp.loaded&&forceUpdate\n    ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,{texture:inp.image,data:null},true,9,1,-1.0,this.mID)\n ;}}}}\n\n\nEffectPass.prototype.Sampler2Renderer=function(sampler\n){var filter=this.mRenderer.FILTER.NONE\n ;if(sampler.filter===\"linear\")filter=this.mRenderer.FILTER.LINEAR\n ;if(sampler.filter===\"mipmap\")filter=this.mRenderer.FILTER.MIPMAP\n ;var wrap=this.mRenderer.TEXWRP.REPEAT\n ;if(sampler.wrap===\"clamp\")wrap=this.mRenderer.TEXWRP.CLAMP\n ;var vflip=false\n ;if(sampler.vflip===\"true\")vflip=true\n ;return{mFilter:filter,mWrap:wrap,mVFlip:vflip};}\n\nEffectPass.prototype.GetSamplerVFlip=function(id){var inp=this.mInputs[id];return inp.mInfo.mSampler.vflip;}\n\nEffectPass.prototype.SetSamplerVFlip=function(id,str\n){    var me=this\n ;var renderer=this.mRenderer\n ;var inp=this.mInputs[id]\n ;var filter=false\n ;if(str===\"true\")filter=true\n ;if(inp==null){\n ;}    else if(inp.mInfo.mType==\"texture\"\n ){if(inp.loaded){renderer.SetSamplerVFlip(inp.globject,filter,inp.image);inp.mInfo.mSampler.vflip=str\n ;}}else if(inp.mInfo.mType==\"volume\"){\n ;}else if(inp.mInfo.mType==\"video\"\n ){if(inp.loaded\n  ){renderer.SetSamplerVFlip(inp.globject,filter,inp.image);inp.mInfo.mSampler.vflip=str\n ;}}else if(inp.mInfo.mType==\"cubemap\"\n  ){if(inp.loaded){renderer.SetSamplerVFlip(inp.globject,filter,inp.image);inp.mInfo.mSampler.vflip=str\n ;}}else if(inp.mInfo.mType==\"webcam\"\n  ){if(inp.loaded){renderer.SetSamplerVFlip(inp.globject,filter,null);inp.mInfo.mSampler.vflip=str;}}}\n\nEffectPass.prototype.GetAcceptsVFlip=function(id\n){var inp=this.mInputs[id]\n ;if(inp==null)return false\n ;if(inp.mInfo.mType==\"texture\")return true\n ;if(inp.mInfo.mType==\"video\")return true \n ;if(inp.mInfo.mType==\"cubemap\")return true\n ;if(inp.mInfo.mType==\"webcam\")return true \n ;return false;}\n\nEffectPass.prototype.GetSamplerFilter=function(id\n){var inp=this.mInputs[id];if(inp==null)return;return inp.mInfo.mSampler.filter;}\n\nEffectPass.prototype.SetSamplerFilter=function(id,str,buffers\n){var me=this\n ;var renderer=this.mRenderer\n ;var inp=this.mInputs[id]\n ;var filter=renderer.FILTER.NONE\n ;if(str==\"linear\")filter=renderer.FILTER.LINEAR\n ;if(str==\"mipmap\")filter=renderer.FILTER.MIPMAP\n ;if(inp==null){\n ;}else if(inp.mInfo.mType==\"texture\" ){if(inp.loaded){renderer.SetSamplerFilter(inp.globject,filter);inp.mInfo.mSampler.filter=str\n ;}}else if(inp.mInfo.mType==\"volume\" ){if(inp.loaded){renderer.SetSamplerFilter(inp.globject,filter);inp.mInfo.mSampler.filter=str\n ;}}else if(inp.mInfo.mType==\"video\"  ){if(inp.loaded){renderer.SetSamplerFilter(inp.globject,filter);inp.mInfo.mSampler.filter=str\n ;}}else if(inp.mInfo.mType==\"cubemap\"){if(inp.loaded){renderer.SetSamplerFilter(inp.globject,filter);inp.mInfo.mSampler.filter=str\n ;}}else if(inp.mInfo.mType==\"webcam\" ){if(inp.loaded){renderer.SetSamplerFilter(inp.globject,filter);inp.mInfo.mSampler.filter=str\n ;}}else if(inp.mInfo.mType==\"buffer\"\n ){renderer.SetSamplerFilter(buffers[id].mTexture[0],filter)\n  ;renderer.SetSamplerFilter(buffers[id].mTexture[1],filter)\n  ;inp.mInfo.mSampler.filter=str\n ;}else if(inp.mInfo.mType===\"keyboard\"){inp.mInfo.mSampler.filter=str;}}\n\nEffectPass.prototype.GetAcceptsMipmapping=function(id\n){var inp=this.mInputs[id];if(inp==null)return false;var i=inp.mInfo.mType\n ;if(i==\"texture\"||i==\"volume\"||i==\"cubemap\")return true\n ;if(i==\"video\"||i==\"webcam\"||i==\"buffer\")return this.mIs20\n ;return false;}\n\nEffectPass.prototype.GetAcceptsLinear=function(id\n){var inp=this.mInputs[id];if(inp==null)return false;if(inp.mInfo.mType==\"keyboard\")return false;return true;}\n\nEffectPass.prototype.GetAcceptsWrapRepeat=function(id\n){var inp=this.mInputs[id];if(inp==null)return false;var i=inp.mInfo.mType\n ;if(i==\"texture\"||i==\"volume\")return true;if(i==\"video\"||i==\"webcam\"||i==\"buffer\")return this.mIs20;return false;}\n\nEffectPass.prototype.GetSamplerWrap=function(id){var inp=this.mInputs[id];return inp.mInfo.mSampler.wrap;}\nEffectPass.prototype.SetSamplerWrap=function(id,str,buffers\n){var me=this\n ;var renderer=this.mRenderer\n ;var inp=this.mInputs[id]\n ;var restr=renderer.TEXWRP.REPEAT\n ;if(str==\"clamp\")restr=renderer.TEXWRP.CLAMP\n ;if(inp==null){}else if(inp.mInfo.mType==\"texture\"\n ){if(inp.loaded){renderer.SetSamplerWrap(inp.globject,restr);inp.mInfo.mSampler.wrap=str\n ;}}else if(inp.mInfo.mType==\"volume\" ){if(inp.loaded){renderer.SetSamplerWrap(inp.globject,restr);inp.mInfo.mSampler.wrap=str\n ;}}else if(inp.mInfo.mType==\"video\"  ){if(inp.loaded){renderer.SetSamplerWrap(inp.globject,restr);inp.mInfo.mSampler.wrap=str\n ;}}else if(inp.mInfo.mType==\"cubemap\"){if(inp.loaded){renderer.SetSamplerWrap(inp.globject,restr);inp.mInfo.mSampler.wrap=str\n ;}}else if(inp.mInfo.mType==\"webcam\" ){if(inp.loaded){renderer.SetSamplerWrap(inp.globject,restr);inp.mInfo.mSampler.wrap=str\n ;}}else if(inp.mInfo.mType==\"buffer\"\n ){renderer.SetSamplerWrap(buffers[id].mTexture[0],restr)\n  ;renderer.SetSamplerWrap(buffers[id].mTexture[1],restr)\n  ;inp.mInfo.mSampler.wrap=str;}}\n\nEffect.prototype.GetTexture=function(passid,slot){return this.mPasses[passid].GetTexture(slot);}\nEffect.prototype.NewTexture=function(passid,slot,url\n){return this.mPasses[passid].NewTexture(this.mAudioContext,slot,url,this.mBuffers,this.mKeyboard);}\n\n\nEffectPass.prototype.GetTexture=function(slot){var inp=this.mInputs[slot];if(inp==null)return null;return inp.mInfo;}\nEffectPass.prototype.SetOutputs=function(slot,id){this.mOutputs[slot]=id;}\nEffectPass.prototype.SetOutputsByBufferID=function(slot,id){this.mOutputs[slot]=bufferID_to_assetID(id);}\n\nEffectPass.prototype.returnOrs=function(slot,t){\n  return (this.mInputs[slot]==null)\n  ||((t.mInputs[slot].mInfo.mType!=\"texture\")\n   &&(t.mInputs[slot].mInfo.mType!=\"webcam\")\n   &&(t.mInputs[slot].mInfo.mType!=\"mic\")\n   &&(t.mInputs[slot].mInfo.mType!=\"music\")\n   &&(t.mInputs[slot].mInfo.mType!=\"musicstream\")\n   &&(t.mInputs[slot].mInfo.mType!=\"keyboard\")\n   &&(t.mInputs[slot].mInfo.mType!=\"video\"))\n   ;}\n\nEffectPass.prototype.NewTexture=function(wa,slot,url,buffers,keyboard\n){var me=this\n ;var renderer=this.mRenderer\n ;if(renderer==null)return\n ;var texture=null\n ;if(url==null||url.mType==null\n ){if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(this.mTextureCallbackObj,slot,null,true,0,0,-1.0,me.mID)\n  ;me.DestroyInput(slot)\n  ;me.mInputs[slot]=null\n  ;me.MakeHeader()\n  ;return{mFailed:false,mNeedsShaderCompile:false}\n ;}else if(url.mType==\"texture\"\n ){texture={}\n  ;texture.mInfo=url\n  ;texture.globject=null\n  ;texture.loaded=false\n  ;texture.image=new Image()\n  ;texture.image.crossOrigin=''\n  ;texture.image.onload=function(\n  ){var rti=me.Sampler2Renderer(url.mSampler)\n   ;//O.M.G. IQIQ FIX THIS\n   ;var channels=renderer.TEXFMT.C4I8\n   ;if(url.mID==\"Xdf3zn\"||url.mID==\"4sf3Rn\"||url.mID==\"4dXGzn\"||url.mID==\"4sf3Rr\")channels=renderer.TEXFMT.C1I8\n   ;texture.globject=renderer.CreateTextureFromImage(renderer.TEXTYPE.T2D,texture.image,channels,rti.mFilter,rti.mWrap,rti.mVFlip)\n   ;texture.loaded=true\n   ;if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.image,true,1,1,-1.0,me.mID);}\n  ;texture.image.src=url.mSrc\n  ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n   ;this.DestroyInput(slot)\n   ;this.mInputs[slot]=texture\n   ;this.MakeHeader()\n   ;return returnValue\n  ;}else if(url.mType==\"volume\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.globject=null\n   ;texture.loaded=false\n   ;texture.mImage={mData:null,mXres:1,mYres:0,mZres:0}\n   ;texture.mPreview=new Image()\n   ;texture.mPreview.crossOrigin=''\n   ;var xmlHttp=new XMLHttpRequest()\n   ;if(xmlHttp==null)return{mFailed:true}\n   ;xmlHttp.open('GET',url.mSrc,true)\n   ;xmlHttp.responseType=\"arraybuffer\"\n   ;xmlHttp.onerror=function(){}\n   ;xmlHttp.onload=function(\n   ){var data=xmlHttp.response\n    ;if(!data)return\n    ;var file=piFile(data)\n    ;var signature=file.ReadUInt32()\n    ;texture.mImage.mXres=file.ReadUInt32()\n    ;texture.mImage.mYres=file.ReadUInt32()\n    ;texture.mImage.mZres=file.ReadUInt32()\n    ;var binNumChannels=file.ReadUInt8()\n    ;var binLayout=file.ReadUInt8()\n    ;var binFormat=file.ReadUInt16()\n    ;var format=renderer.TEXFMT.C1I8\n    ;if(binNumChannels==1&&binFormat==0)format=renderer.TEXFMT.C1I8\n    ;else if(binNumChannels==2&&binFormat==0)format=renderer.TEXFMT.C2I8\n    ;else if(binNumChannels==3&&binFormat==0)format=renderer.TEXFMT.C3I8\n    ;else if(binNumChannels==4&&binFormat==0)format=renderer.TEXFMT.C4I8\n    ;else if(binNumChannels==1&&binFormat==10)format=renderer.TEXFMT.C1F32\n    ;else if(binNumChannels==2&&binFormat==10)format=renderer.TEXFMT.C2F32\n    ;else if(binNumChannels==3&&binFormat==10)format=renderer.TEXFMT.C3F32\n    ;else if(binNumChannels==4&&binFormat==10)format=renderer.TEXFMT.C4F32\n    ;else return\n    ;var buffer=new Uint8Array(data,20)//skip 16 bytes (header of .bin)\n    ;var rti=me.Sampler2Renderer(url.mSampler)\n    ;texture.globject=renderer.CreateTexture(renderer.TEXTYPE.T3D,texture.mImage.mXres,texture.mImage.mYres,format,rti.mFilter,rti.mWrap,buffer)\n    ;if(texture.globject==null)return{mFailed:true}\n    ;if(me.mTextureCallbackFun!=null){me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.mPreview,true,1,1,-1.0,me.mID);}\n    ;texture.loaded=true\n    ;texture.mPreview.onload=function(//load icon for it\n    ){if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.mPreview,true,1,1,-1.0,me.mID);}\n    ;texture.mPreview.src=url.mPreviewSrc;}\n   ;xmlHttp.send(\"\")\n   ;var returnValue={mFailed:false,mNeedsShaderCompile:(this.mInputs[slot]==null)||((this.mInputs[slot].mInfo.mType!=\"volume\"))}\n   ;this.DestroyInput(slot)\n   ;this.mInputs[slot]=texture\n   ;this.MakeHeader()\n   ;return returnValue\n  ;}else if(url.mType==\"cubemap\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.globject=null\n   ;texture.loaded=false\n   ;texture.image=[new Image(),new Image(),new Image(),new Image(),new Image(),new Image()]\n   ;texture.loaded=false\n   ;var rti=me.Sampler2Renderer(url.mSampler)\n   ;var numLoaded=0\n   ;for(var i=0;i<6;i++\n   ){texture.image[i].mId=i\n    ;texture.image[i].crossOrigin=''\n    ;texture.image[i].onload=function(\n    ){var id=this.mId\n     ;numLoaded++\n     ;if(numLoaded==6\n     ){texture.globject=renderer.CreateTextureFromImage(renderer.TEXTYPE.CUBEMAP,texture.image,renderer.TEXFMT.C4I8,rti.mFilter,rti.mWrap,rti.mVFlip)\n      ;texture.loaded=true\n      ;if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.image[0],true,2,1,-1.0,me.mID);}}\n    ;if(i==0){texture.image[i].src=url.mSrc\n    ;}else{var n=url.mSrc.lastIndexOf(\".\");texture.image[i].src=url.mSrc.substring(0,n)+\"_\"+i+url.mSrc.substring(n,url.mSrc.length);}}\n  ;var returnValue={mFailed:false,mNeedsShaderCompile:(this.mInputs[slot]==null)||((this.mInputs[slot].mInfo.mType!=\"cubemap\"))}\n  ;this.DestroyInput(slot)\n  ;this.mInputs[slot]=texture\n  ;this.MakeHeader()\n  ;return returnValue\n ;}else if(url.mType===\"webcam\"\n ){texture={}\n  ;texture.mInfo=url\n  ;texture.globject=null\n  ;texture.loaded=false\n  ;texture.video=document.createElement('video')\n  ;\ttexture.video.width=320\n  ;\ttexture.video.height=240\n  ;\ttexture.video.autoplay=true\n  ;\ttexture.video.loop=true\n  ;texture.video.stream=null\n  ;texture.mForceMuted=this.mForceMuted\n  ;texture.mImage=null\n  ;var rti=me.Sampler2Renderer(url.mSampler)\n  ;var loadImageInsteadOfWebCam=function(\n  ){texture.mImage=new Image()\n   ;texture.mImage.onload=function(\n   ){texture.loaded=true\n    ;texture.globject=renderer.CreateTextureFromImage(renderer.TEXTYPE.T2D,texture.mImage,renderer.TEXFMT.C4I8,rti.mFilter,rti.mWrap,rti.mVFlip)\n    ;if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.mImage,true,7,1,-1.0,me.mID);}\n   ;texture.mImage.src=\"/media/previz/webcam.png\";}\n  ;loadImageInsteadOfWebCam()\n  ;if(typeof navigator.getUserMedia !==\"undefined\" &&texture.mForceMuted===false\n  ){texture.video.addEventListener(\"canplay\",function(e\n  ){try{texture.mImage=null\n   ;if(texture.globject!=null)renderer.DestroyTexture(texture.globject)\n   ;texture.globject=renderer.CreateTextureFromImage(renderer.TEXTYPE.T2D,texture.video,renderer.TEXFMT.C4I8,rti.mFilter,rti.mWrap,rti.mVFlip)\n   ;texture.loaded=true\n  ;}catch(e){loadImageInsteadOfWebCam();alert('Your browser can not transfer webcam data to the GPU.');}})\n  ;navigator.getUserMedia({\"video\":{mandatory:{minWidth:640,maxWidth:1280,minHeight:480,maxHeight:720,minFrameRate:30}\n  ,optional:[{minFrameRate:60}]},\"audio\":false}\n  ,function(stream){texture.video.src=window.URL.createObjectURL(stream);texture.video.stream=stream;}\n  ,function(error){loadImageInsteadOfWebCam();alert('Unable to capture WebCam. Please reload the page.');});}\n ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n  ;this.DestroyInput(slot)\n  ;this.mInputs[slot]=texture\n  ;this.MakeHeader()\n  ;return returnValue\n ;}else if(url.mType==\"mic\"\n ){texture={}\n  ;texture.mInfo=url\n  ;texture.globject=null\n  ;texture.loaded=false\n  ;texture.mForceMuted=this.mForceMuted\n  ;texture.mAnalyser=null\n  ;var num=512\n  ;texture.mFreqData=new Uint8Array(num)\n  ;texture.mWaveData=new Uint8Array(num)\n  ;if(wa==null||typeof navigator.getUserMedia===\"undefined\"\n  ){if(!texture.mForceMuted)alert(\"Shadertoy:Web Audio not implement in this browser\")\n   ;texture.mForceMuted=true;}\n  ;if(texture.mForceMuted){\n            texture.globject=renderer.CreateTexture(renderer.TEXTYPE.T2D,num,2,renderer.TEXFMT.C1I8,renderer.FILTER.LINEAR,renderer.TEXWRP.CLAMP,null)\n            texture.loaded=true\n ;}else{navigator.getUserMedia({\"audio\":true},function(stream\n ){texture.globject=renderer.CreateTexture(renderer.TEXTYPE.T2D,512,2,renderer.TEXFMT.C1I8,renderer.FILTER.LINEAR,null)\n  ;texture.mic=wa.createMediaStreamSource(stream)\n  ;texture.mAnalyser=wa.createAnalyser()\n  ;texture.mic.connect(texture.mAnalyser)\n  ;texture.loaded=true;},function(error){alert('Unable open Mic. Please reload the page.');});}\n ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n  ;this.DestroyInput(slot)\n  ;this.mInputs[slot]=texture\n  ;this.MakeHeader()\n  ;return returnValue\n ;}else if(url.mType==\"video\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.globject=null\n   ;texture.loaded=false\n   ;texture.video=document.createElement('video')\n   ;texture.video.loop=true\n   ;texture.video.mPaused=this.mForcePaused\n   ;texture.video.mMuted=this.mForceMuted\n   ;texture.video.muted=this.mForceMuted\n   ;if(this.mForceMuted==true)            texture.video.volume=0\n   ;texture.video.autoplay=false\n   ;texture.video.hasFalled=false\n   ;var rti=me.Sampler2Renderer(url.mSampler)\n   ;texture.video.addEventListener(\"canplay\",function(e\n   ){texture.video.play()\n    ;texture.video.mPaused=false\n    ;texture.globject=renderer.CreateTextureFromImage(renderer.TEXTYPE.T2D,texture.video,renderer.TEXFMT.C4I8,rti.mFilter,rti.mWrap,rti.mVFlip)\n    ;texture.loaded=true\n    ;if(me.mTextureCallbackFun!=null)me.mTextureCallbackFun(me.mTextureCallbackObj,slot,texture.video,true,3,1,-1.0,me.mID);})\n   ;texture.video.addEventListener(\"error\",function(e\n   ){if(texture.video.hasFalled==true){alert(\"Error:cannot load video\");return;}\n    ;var str=texture.video.src\n    ;str=str.substr(0,str.lastIndexOf('.'))+\".mp4\"\n    ;texture.video.src=str\n    ;texture.video.hasFalled=true;})\n   ;texture.video.src=url.mSrc\n   ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n   ;this.DestroyInput(slot)\n   ;this.mInputs[slot]=texture\n   ;this.MakeHeader()\n   ;return returnValue\n  ;}else if(url.mType==\"music\"||url.mType==\"musicstream\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.globject=null\n   ;texture.loaded=false\n   ;texture.audio=document.createElement('audio')\n   ;texture.audio.loop=true\n   ;texture.audio.mMuted=this.mForceMuted\n   ;texture.audio.mForceMuted=this.mForceMuted\n   ;texture.audio.muted=this.mForceMuted\n   ;if(this.mForceMuted==true)texture.audio.volume=0\n   ;texture.audio.autoplay=false\n   ;texture.audio.hasFalled=false\n   ;texture.audio.mPaused=false\n   ;texture.audio.mSound={}\n   ;if(this.mForceMuted==false){if(url.mType==\"musicstream\"&&SC==null\n   ){alert(\"Shadertoy:Soundcloud could not be reached\");texture.audio.mForceMuted=true;}}\n   ;if(wa==null&&this.mForceMuted==false){alert(\"Shadertoy:Web Audio not implement in this browser\");texture.audio.mForceMuted=true;}\n   ;if(texture.audio.mForceMuted\n   ){texture.globject=renderer.CreateTexture(renderer.TEXTYPE.T2D,512,2,renderer.TEXFMT.C1I8,renderer.FILTER.LINEAR,renderer.TEXWRP.CLAMP,null)\n    ;var num=512\n    ;texture.audio.mSound.mFreqData=new Uint8Array(num)\n    ;texture.audio.mSound.mWaveData=new Uint8Array(num)\n    ;texture.loaded=true;}\n   ;texture.audio.addEventListener(\"canplay\",function(\n   ){if(texture==null||texture.audio==null)return\n    ;if(this.mForceMuted)return\n    ;if(texture.loaded===true)return\n    ;texture.globject=renderer.CreateTexture(renderer.TEXTYPE.T2D,512,2,renderer.TEXFMT.C1I8,renderer.FILTER.LINEAR,renderer.TEXWRP.CLAMP,null)\n    ;texture.audio.mSound.mSource =wa.createMediaElementSource(texture.audio)\n    ;texture.audio.mSound.mAnalyser=wa.createAnalyser()\n    ;texture.audio.mSound.mGain    =wa.createGain()\n    ;texture.audio.mSound.mSource.connect(texture.audio.mSound.mAnalyser)\n    ;texture.audio.mSound.mAnalyser.connect(texture.audio.mSound.mGain)\n    ;texture.audio.mSound.mGain.connect(me.mGainNode)\n    ;texture.audio.mSound.mFreqData=new Uint8Array(texture.audio.mSound.mAnalyser.frequencyBinCount)\n    ;texture.audio.mSound.mWaveData=new Uint8Array(texture.audio.mSound.mAnalyser.frequencyBinCount)\n    ;if(texture.audio.mPaused)texture.audio.pause()\n    ;else texture.audio.play()\n    ;texture.loaded=true;})\n   ;texture.audio.addEventListener(\"error\",function(e\n   ){if(this.mForceMuted)return\n    ;if(texture.audio.hasFalled==true){//alert(\"Error:cannot load music\");\n    ;return;}\n    ;var str=texture.audio.src\n    ;str=str.substr(0,str.lastIndexOf('.'))+\".ogg\"\n    ;texture.audio.src=str\n    ;texture.audio.hasFalled=true;})\n   ;if(!texture.audio.mForceMuted\n   ){if(url.mType==\"musicstream\"){SC.resolve(url.mSrc).then(function(song){if(song.streamable==true\n    ){texture.audio.crossOrigin=''\n     ;texture.audio.src=song.stream_url+\"?client_id=\"+SC.client_id\n     ;texture.audio.soundcloudInfo=song\n    ;}else{alert('Shadertoy:Soundcloud-This track cannot be streamed');}}).catch(function(error\n    ){//console.log('Shadertoy:Soundcloud-'+error.message)\n     ;if(me.mTextureCallbackFun!=null){me.mTextureCallbackFun(me.mTextureCallbackObj,slot,{wave:null},false,4,0,-1.0,me.mID);}})\n    ;}else{texture.audio.src=url.mSrc;}}\n  ;if(me.mTextureCallbackFun!=null\n  ){if(url.mType==\"music\")me.mTextureCallbackFun(me.mTextureCallbackObj,slot,{wave:null},false,4,0,-1.0,me.mID)\n   ;else if(url.mType==\"musicstream\")me.mTextureCallbackFun(me.mTextureCallbackObj,slot\n   ,{wave:null,info:texture.audio.soundcloudInfo},false,8,0,-1.0,me.mID);}\n  ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n  ;this.DestroyInput(slot)\n  ;this.mInputs[slot]=texture\n  ;this.MakeHeader()\n  ;return returnValue\n ;}else if(url.mType==\"keyboard\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.globject=null\n   ;texture.loaded=true\n   ;texture.keyboard={}\n   ;if(me.mTextureCallbackFun!=null)\n     me.mTextureCallbackFun(me.mTextureCallbackObj,slot,{mImage:keyboard.mIcon,mData:keyboard.mData},false,6,1,-1.0,me.mID)\n   ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n   ;this.DestroyInput(slot)\n   ;this.mInputs[slot]=texture\n   ;this.MakeHeader()\n   ;return returnValue\n  ;}else if(url.mType==\"buffer\"\n  ){texture={}\n   ;texture.mInfo=url\n   ;texture.image=new Image()\n   ;texture.image.onload=function(\n   ){if(me.mTextureCallbackFun!=null)\n     me.mTextureCallbackFun(me.mTextureCallbackObj,slot,{texture:texture.image,data:null},true,9,1,-1.0,me.mID);}\n   ;texture.image.src=url.mSrc\n   ;texture.id=assetID_to_bufferID(url.mID)\n   ;texture.loaded=true\n   ;var returnValue={mFailed:false,mNeedsShaderCompile:this.returnOrs(slot,this)}\n   ;this.DestroyInput(slot)\n   ;this.mInputs[slot]=texture\n   ;//Setting the passes samplers\n   ;this.SetSamplerFilter(slot,url.mSampler.filter,buffers)\n   ;this.SetSamplerVFlip(slot,url.mSampler.vflip)\n   ;this.SetSamplerWrap(slot,url.mSampler.wrap,buffers)\n   ;this.MakeHeader()\n   ;return returnValue\n  ;}else{alert(\"input type error\");return{mFailed:true};}\n ;return{mFailed:true};}\n\nEffectPass.prototype.Paint_Image=function(vrData,wa,d,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,buffers,keyboard\n){var times=[0.0,0.0,0.0,0.0]\n ;var dates=[d.getFullYear(),//the year (four digits)\n                  d.getMonth(),\t   //the month (from 0-11)\n                  d.getDate(),//the day of the month (from 1-31)\n                  d.getHours()*60.0*60+d.getMinutes()*60+d.getSeconds()+d.getMilliseconds()/1000.0]\n ;var mouse=[ mousePosX,mousePosY,mouseOriX,mouseOriY]\n ;var resos=[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]\n ;var texID=[null,null,null,null]\n ;for(var i=0;i<this.mInputs.length;i++\n ){var inp=this.mInputs[i]\n  ;if(inp==null){}else if(inp.mInfo.mType==\"texture\"\n  ){if(inp.loaded==true\n   ){texID[i]=inp.globject\n    ;resos[3*i+0]=inp.image.width\n    ;resos[3*i+1]=inp.image.height\n    ;resos[3*i+2]=1\n  ;}}else if(inp.mInfo.mType==\"volume\"\n   ){if(inp.loaded==true\n    ){texID[i]=inp.globject\n     ;resos[3*i+0]=inp.mImage.mXres\n     ;resos[3*i+1]=inp.mImage.mYres\n     ;resos[3*i+2]=inp.mImage.mZres\n   ;}}else if(inp.mInfo.mType==\"keyboard\"){texID[i]=keyboard.mTexture\n   ;}else if(inp.mInfo.mType==\"cubemap\"){if(inp.loaded==true)texID[i]=inp.globject\n   ;}else if(inp.mInfo.mType==\"webcam\"\n   ){if(inp.loaded==true\n    ){if(inp.mImage !==null\n     ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.mImage,false,7,1,-1,this.mID)\n      ;texID[i]=inp.globject\n      ;resos[3*i+0]=inp.mImage.width\n      ;resos[3*i+1]=inp.mImage.height\n      ;resos[3*i+2]=1\n     ;}else  if(inp.video.readyState===inp.video.HAVE_ENOUGH_DATA\n     ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.video,false,7,1,-1,this.mID)\n      ;texID[i]=inp.globject\n      ;this.mRenderer.UpdateTextureFromImage(inp.globject,inp.video)\n      ;if(inp.mInfo.mSampler.filter===\"mipmap\")this.mRenderer.CreateMipmaps(inp.globject)\n      ;resos[3*i+0]=inp.video.videoWidth\n      ;resos[3*i+1]=inp.video.videoHeight\n      ;resos[3*i+2]=1\n    ;}}else\n     {texID[i]=null\n     ;resos[3*i+0]=inp.video.width\n     ;resos[3*i+1]=inp.video.height\n     ;resos[3*i+2]=1\n   ;}}else if(inp.mInfo.mType==\"video\"\n   ){if(inp.video.mPaused==false\n    ){if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,inp.video,false,3,1,inp.video.currentTime,this.mID);}\n     ;if(inp.loaded==true\n     ){times[i]=inp.video.currentTime\n      ;texID[i]=inp.globject\n      ;if(inp.video.mPaused==false\n      ){this.mRenderer.UpdateTextureFromImage(inp.globject,inp.video)\n       ;if(inp.mInfo.mSampler.filter===\"mipmap\")this.mRenderer.CreateMipmaps(inp.globject);}\n      ;resos[3*i+0]=inp.video.videoWidth\n      ;resos[3*i+1]=inp.video.videoHeight\n      ;resos[3*i+2]=1\n    ;}}else if(inp.mInfo.mType==\"music\"||inp.mInfo.mType==\"musicstream\"\n    ){if(inp.audio.mPaused==false&&inp.audio.mForceMuted==false&&inp.loaded==true\n     ){if(wa!=null){inp.audio.mSound.mAnalyser.getByteFrequencyData(inp.audio.mSound.mFreqData)\n      ;inp.audio.mSound.mAnalyser.getByteTimeDomainData(inp.audio.mSound.mWaveData);}\n     ;if(this.mTextureCallbackFun!=null\n     ){if(inp.mInfo.mType==\"music\"\n      )this.mTextureCallbackFun(this.mTextureCallbackObj,i,(wa==null)\n      ?null:{wave:inp.audio.mSound.mFreqData},false,4,1,inp.audio.currentTime,this.mID)\n      ;else if(inp.mInfo.mType==\"musicstream\")this.mTextureCallbackFun(this.mTextureCallbackObj,i,(wa==null)\n      ?null:{wave:inp.audio.mSound.mFreqData,info:inp.audio.soundcloudInfo},false,8,1,inp.audio.currentTime,this.mID);}}\n    ;if(inp.loaded==true\n    ){times[i]=inp.audio.currentTime\n     ;texID[i]=inp.globject\n     ;if(inp.audio.mForceMuted==true\n     ){times[i]=10.0+time\n      ;var num=inp.audio.mSound.mFreqData.length\n      ;for(var j=0;j<num;j++\n      ){var x=j/num\n       ;var f=(0.75+0.25*Math.sin(10.0*j+13.0*time))* Math.exp(-3.0*x)\n       ;if(j<3)f=Math.pow(0.50+0.5*Math.sin(6.2831*time),4.0)* (1.0-j/3.0)\n       ;inp.audio.mSound.mFreqData[j]=Math.floor(255.0*f)|0;}\n      ;var num=inp.audio.mSound.mFreqData.length\n      ;for(var j=0;j<num;j++\n      ){var f=0.5+0.15*Math.sin(17.0*time+10.0*6.2831*j/num)* Math.sin(23.0*time+1.9*j/num)\n       ;inp.audio.mSound.mWaveData[j]=Math.floor(255.0*f)|0;}}\n     ;if(inp.audio.mPaused==false\n     ){var waveLen=Math.min(inp.audio.mSound.mWaveData.length,512)\n      ;this.mRenderer.UpdateTexture(inp.globject,0,0,512,1,inp.audio.mSound.mFreqData)\n      ;this.mRenderer.UpdateTexture(inp.globject,0,1,512,1,inp.audio.mSound.mWaveData);}\n     ;resos[3*i+0]=512\n     ;resos[3*i+1]=2\n     ;resos[3*i+2]=1\n   ;}}else if(inp.mInfo.mType==\"mic\"\n    ){if(inp.loaded==false||inp.mForceMuted||wa==null||inp.mAnalyser==null\n     ){times[i]=10.0+time\n      ;var num=inp.mFreqData.length\n      ;for(var j=0;j<num;j++\n      ){var x=j/num\n       ;var f=(0.75+0.25*Math.sin(10.0*j+13.0*time))* Math.exp(-3.0*x)\n       ;if(j<3)f=Math.pow(0.50+0.5*Math.sin(6.2831*time),4.0)* (1.0-j/3.0)\n       ;inp.mFreqData[j]=Math.floor(255.0*f)|0;}\n      ;var num=inp.mFreqData.length\n      ;for(var j=0;j<num;j++\n      ){var f=0.5+0.15*Math.sin(17.0*time+10.0*6.2831*j/num)* Math.sin(23.0*time+1.9*j/num)\n       ;inp.mWaveData[j]=Math.floor(255.0*f)|0\n     ;}}else{inp.mAnalyser.getByteFrequencyData(inp.mFreqData);inp.mAnalyser.getByteTimeDomainData(inp.mWaveData);}\n      ;if(this.mTextureCallbackFun!=null)this.mTextureCallbackFun(this.mTextureCallbackObj,i,{wave:inp.mFreqData},false,5,1,-1,this.mID)\n      ;if(inp.loaded==true\n      ){texID[i]=inp.globject\n       ;var waveLen=Math.min(inp.mWaveData.length,512)\n       ;this.mRenderer.UpdateTexture(inp.globject,0,0,512,1,inp.mFreqData)\n       ;this.mRenderer.UpdateTexture(inp.globject,0,1,waveLen,1,inp.mWaveData)\n       ;resos[3*i+0]=512\n       ;resos[3*i+1]=2\n       ;resos[3*i+2]=1\n     ;}}else if(inp.mInfo.mType===\"buffer\"\n     ){if(inp.loaded===true\n      ){var id=inp.id\n       ;texID[i]=buffers[id].mTexture[buffers[id].mLastRenderDone]\n       ;resos[3*i+0]=xres\n       ;resos[3*i+1]=yres\n       ;resos[3*i+2]=1\n       ;//hack. in webgl2.0 we have samplers,so we don't need this crap here\n       ;var filter=this.mRenderer.FILTER.NONE\n       ;if(inp.mInfo.mSampler.filter===\"linear\")filter=this.mRenderer.FILTER.LINEAR\n       ;else if(inp.mInfo.mSampler.filter===\"mipmap\")filter=this.mRenderer.FILTER.MIPMAP\n       ;this.mRenderer.SetSamplerFilter(texID[i],filter);}\n      ;if(this.mTextureCallbackFun!==null\n      ){this.mTextureCallbackFun(this.mTextureCallbackObj,i,{texture:inp.image,data:buffers[id].mThumbnailBuffer},false,9,1,-1,this.mID);}}}\n   ;this.mRenderer.AttachTextures(4,texID[0],texID[1],texID[2],texID[3])\n   ;var prog=this.mProgram\n   ;if(vrData!=null&&this.mSupportsVR)prog=this.mProgramVR\n   ;this.mRenderer.AttachShader(prog)\n   ;this.mRenderer.SetShaderConstant1F(\"iTime\",time)\n   ;this.mRenderer.SetShaderConstant3F(\"iResolution\",xres,yres,1.0)\n   ;this.mRenderer.SetShaderConstant4FV(\"iMouse\",mouse)\n   ;this.mRenderer.SetShaderConstant1FV(\"iChannelTime\",times)//OBSOLETE\n   ;this.mRenderer.SetShaderConstant4FV(\"iDate\",dates)\n   ;this.mRenderer.SetShaderConstant3FV(\"iChannelResolution\",resos)//OBSOLETE\n   ;this.mRenderer.SetShaderConstant1F(\"iSampleRate\",this.mSampleRate)\n   ;this.mRenderer.SetShaderTextureUnit(\"iChannel0\",0)\n   ;this.mRenderer.SetShaderTextureUnit(\"iChannel1\",1)\n   ;this.mRenderer.SetShaderTextureUnit(\"iChannel2\",2)\n   ;this.mRenderer.SetShaderTextureUnit(\"iChannel3\",3)\n   ;this.mRenderer.SetShaderConstant1I(\"iFrame\",this.mFrame)\n   ;this.mRenderer.SetShaderConstant1F(\"iTimeDelta\",dtime)\n   ;this.mRenderer.SetShaderConstant1F(\"iFrameRate\",fps)\n   ;this.mRenderer.SetShaderConstant1F(\"iChannel[0].time\",times[0])\n   ;this.mRenderer.SetShaderConstant1F(\"iChannel[1].time\",times[1])\n   ;this.mRenderer.SetShaderConstant1F(\"iChannel[2].time\",times[2])\n   ;this.mRenderer.SetShaderConstant1F(\"iChannel[3].time\",times[3])\n   ;this.mRenderer.SetShaderConstant3F(\"iChannel[0].resolution\",resos[0],resos[1],resos[2])\n   ;this.mRenderer.SetShaderConstant3F(\"iChannel[1].resolution\",resos[3],resos[4],resos[5])\n   ;this.mRenderer.SetShaderConstant3F(\"iChannel[2].resolution\",resos[6],resos[7],resos[8])\n   ;this.mRenderer.SetShaderConstant3F(\"iChannel[3].resolution\",resos[9],resos[10],resos[11])\n   ;var l1=this.mRenderer.GetAttribLocation(this.mProgram,\"pos\")\n   ;if((vrData!=null)&&this.mSupportsVR)\n   {for(var i=0;i<2;i++\n   ){var ei=(i==0)? vrData.mLeftEye:vrData.mRightEye\n    ;var vp=[i*xres/2,0,xres/2,yres]\n    ;this.mRenderer.SetViewport(vp)\n    ;var fov=ei.mProjection\n    ;var corA=[-fov[2],-fov[1],-1.0]\n    ;var corB=[ fov[3],-fov[1],-1.0]\n    ;var corC=[ fov[3],fov[0],-1.0]\n    ;var corD=[-fov[2],fov[0],-1.0]\n    ;var apex=[0.0,0.0,0.0]\n    ;var ma=invertFast(ei.mCamera)\n    ;corA=matMulpoint(ma,corA)\n    ;corB=matMulpoint(ma,corB)\n    ;corC=matMulpoint(ma,corC)\n    ;corD=matMulpoint(ma,corD)\n    ;apex=matMulpoint(ma,apex)\n    ;var corners=[corA[0],corA[1],corA[2],corB[0],corB[1],corB[2],corC[0],corC[1],corC[2],corD[0],corD[1],corD[2],apex[0],apex[1],apex[2]]\n    ;this.mRenderer.SetShaderConstant3FV(\"unCorners\",corners)\n    ;this.mRenderer.SetShaderConstant4FV(\"unViewport\",vp)\n    ;this.mRenderer.DrawUnitQuad_XY(l1)\n  ;}}else{this.mRenderer.SetViewport([0,0,xres,yres]);this.mRenderer.DrawFullScreenTriangle_XY(l1);}\n ;this.mRenderer.DettachTextures();}\n\nEffectPass.prototype.Paint_Sound=function(wa,d\n){var dates=[d.getFullYear(),//the year (four digits)\n                d.getMonth(),\t   //the month (from 0-11)\n                  d.getDate(),//the day of the month (from 1-31)\n                  d.getHours()*60.0*60+d.getMinutes()*60+d.getSeconds()]\n ;var resos=[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]\n ;this.mRenderer.SetRenderTarget(this.mRenderFBO)\n ;this.mRenderer.SetViewport([0,0,this.mTextureDimensions,this.mTextureDimensions])\n ;this.mRenderer.AttachShader(this.mProgram)\n ;this.mRenderer.SetBlend(false)\n ;var texID=[null,null,null,null]\n ;for(var i=0;i<this.mInputs.length;i++\n ){var inp=this.mInputs[i]\n  ;if(inp==null){}else if(inp.mInfo.mType==\"texture\"\n  ){if(inp.loaded==true\n   ){texID[i]=inp.globject\n    ;resos[3*i+0]=inp.image.width\n    ;resos[3*i+1]=inp.image.height\n    ;resos[3*i+2]=1\n ;}}else if(inp.mInfo.mType==\"volume\"\n ){if(inp.loaded==true\n  ){texID[i]=inp.globject\n   ;resos[3*i+0]=inp.mImage.mXres\n   ;resos[3*i+1]=inp.mImage.mYres\n   ;resos[3*i+2]=inp.mImage.mZres;}}}\n ;this.mRenderer.AttachTextures(4,texID[0],texID[1],texID[2],texID[3])\n ;var l2=this.mRenderer.SetShaderConstantLocation(this.mProgram,\"iBlockOffset\")\n ;this.mRenderer.SetShaderConstant4FV(\"iDate\",dates)\n ;this.mRenderer.SetShaderConstant3FV(\"iChannelResolution\",resos)\n ;this.mRenderer.SetShaderConstant1F(\"iSampleRate\",this.mSampleRate)\n ;this.mRenderer.SetShaderTextureUnit(\"iChannel0\",0)\n ;this.mRenderer.SetShaderTextureUnit(\"iChannel1\",1)\n ;this.mRenderer.SetShaderTextureUnit(\"iChannel2\",2)\n ;this.mRenderer.SetShaderTextureUnit(\"iChannel3\",3)\n ;var l1=this.mRenderer.GetAttribLocation(this.mProgram,\"pos\")\n ;var numSamples=this.mTmpBufferSamples\n ;var bufL=this.mBuffer.getChannelData(0)//Float32Array\n ;var bufR=this.mBuffer.getChannelData(1)//Float32Array\n ;var numBlocks=this.mPlaySamples/numSamples\n ;for(var j=0;j<numBlocks;j++\n ){var off=j*this.mTmpBufferSamples\n  ;this.mRenderer.SetShaderConstant1F_Pos(l2,off/this.mSampleRate)\n  ;this.mRenderer.DrawUnitQuad_XY(l1)\n  ;this.mRenderer.GetPixelData(this.mData,this.mTextureDimensions,this.mTextureDimensions)\n  ;for(var i=0;i<numSamples;i++\n  ){bufL[off+i]=-1.+2.*(this.mData[4*i+0]+256.*this.mData[4*i+1])/65535.\n   ;bufR[off+i]=-1.+2.*(this.mData[4*i+2]+256.*this.mData[4*i+3])/65535.;}}\n ;this.mRenderer.DetachShader()\n ;this.mRenderer.DettachTextures()\n ;this.mRenderer.SetRenderTarget(null)\n ;if(this.mPlayNode!=null){this.mPlayNode.disconnect();this.mPlayNode.stop();}\n ;this.mPlayNode=wa.createBufferSource()\n ;this.mPlayNode.buffer=this.mBuffer\n ;this.mPlayNode.connect(this.mGainNode)\n ;this.mPlayNode.state=this.mPlayNode.noteOn\n ;this.mPlayNode.start(0);}\n\nEffectPass.prototype.Paint=function(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY\n ,mousePosX,mousePosY,xres,yres,isPaused,bufferID,bufferNeedsMimaps,buffers,keyboard\n){if(this.mType===\"sound\"\n ){if(this.mFrame==0&&!isPaused\n  ){for(var i=0;i<this.mInputs.length;i++\n   ){var inp=this.mInputs[i]\n    ;if(inp==null)continue\n    ;if(inp.mInfo.mType==\"texture\"&&!inp.loaded)return\n    ;if(inp.mInfo.mType==\"cubemap\"&&!inp.loaded)return;}\n   ;this.Paint_Sound(wa,da)\n   ;this.mFrame++\n ;}}else if(this.mType===\"image\"\n ){this.mRenderer.SetRenderTarget(null)\n  ;this.Paint_Image(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,buffers,keyboard)\n  ;this.mFrame++\n ;}else if(this.mType===\"common\"){console.log(\"rendering common\")\n ;}else if(this.mType==\"buffer\"\n ){var buffer=buffers[bufferID]\n  ;var dstID=1-buffer.mLastRenderDone\n  ;this.mRenderer.SetRenderTarget(buffer.mTarget[dstID])\n  ;this.Paint_Image(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,buffers,keyboard)\n  ;if(bufferNeedsMimaps){this.mRenderer.CreateMipmaps(buffer.mTexture[dstID])  ;}//compute mipmaps if needd\n  ;buffers[bufferID].mLastRenderDone=1-buffers[bufferID].mLastRenderDone\n  ;this.mFrame++;}}\n\nEffectPass.prototype.StopOutput_Sound=function(wa  ){if(this.mPlayNode===null)return;this.mPlayNode.disconnect();};\nEffectPass.prototype.ResumeOutput_Sound=function(wa){if(this.mPlayNode===null)return;this.mPlayNode.connect(this.mGainNode);};\nEffectPass.prototype.StopOutput_Image=function(wa){};\nEffectPass.prototype.ResumeOutput_Image=function(wa){};\nEffectPass.prototype.StopOutput=function(wa\n){for(var j=0;j<this.mInputs.length;j++)this.StopInput(j)\n ;if(this.mType==\"sound\")this.StopOutput_Sound(wa)\n ;else this.StopOutput_Image(wa);}\n\nEffectPass.prototype.ResumeOutput=function(wa\n){for(var j=0;j<this.mInputs.length;j++)this.ResumeInput(j)\n ;if(this.mType==\"sound\")         this.ResumeOutput_Sound(wa)\n ;else         this.ResumeOutput_Image(wa);}\n\nfunction Effect(vr,ac,gl,xres,yres,callback,obj,forceMuted,forcePaused\n){this.mCreated=false\n ;this.mRenderer=null\n ;this.mAudioContext=ac\n ;this.mGLContext=gl\n ;this.mWebVR=vr\n ;this.mRenderingStereo=false\n ;this.mXres=xres\n ;this.mYres=yres\n ;this.mForceMuted=forceMuted\n ;if(ac==null)this.mForceMuted=true\n ;this.mForcePaused=forcePaused\n ;this.mGainNode=null\n ;this.mPasses=[]\n ;this.mFrame=0\n ;this.mTextureCallbackFun=callback\n ;this.mTextureCallbackObj=obj\n ;this.mMaxBuffers=4\n ;this.mMaxPasses=this.mMaxBuffers+1+1//some day decouple passes from buffers\n ;this.mBuffers=[]\n ;if(gl==null)return\n ;this.mRenderer=piRenderer()\n ;if(!this.mRenderer.Initialize(gl))return\n ;var caps=this.mRenderer.GetCaps()\n ,i2=this.mIs20=caps.mIsGL20\n ,of=(i2?\"out\":\"gl_Frag\")+\"Color=texture\"\n ,oc=i2?\"out vec4 outColor;\":\"\"\n ,vs1=(i2?\"layout(location=0)in\":\"attribute\")+\" vec2 p;void main(){gl_Position=vec4(p.xy,0,1);}\"\n ;this.mShaderTextureLOD=caps.mShaderTextureLOD\n ;if(ac!=null\n ){this.mGainNode=ac.createGain()\n  ;if(!forceMuted){this.mGainNode.connect(ac.destination);}\n  ;if(this.mForceMuted)this.mGainNode.gain.value=0.0\n  ;else this.mGainNode.gain.value=gVol;}\n ;var res=this.mRenderer.CreateShader(vs1,\"uniform vec4 v;uniform sampler2D t;\"+oc+\"void main(){\"+of+(i2?\"Lod\":\"2D\")+\"(t,gl_FragCoord.xy/v.zw,\"+(i2?\"\":\"-10\")+\"0.0);}\")\n ;if(res.mResult==false){console.log(\"Effect().CreateShader() failed:\"+res.mInfo);return;}\n ;this.mProgramCopy=res \n ;var res=this.mRenderer.CreateShader(vs1,\"uniform vec4 v;uniform sampler2D t;\"+oc+\"void main(){vec2 uv=gl_FragCoord.xy/v.zw;\"+of+(i2?\"\":\"2D\")+\"(t,vec2(uv.x,1.-uv.y));}\")\n ;if(res.mResult==false){console.log(\"CreateShader() Failed:\"+res);return;}\n ;this.mProgramDownscale=res\n ;this.ResizeBuffers(null,null)\n ;var keyboardData=new Uint8Array(256*3)\n ;for(var j=0;j<(256*3);j++){keyboardData[j]=0;}\n ;var kayboardTexture=this.mRenderer.CreateTexture(this.mRenderer.TEXTYPE.T2D,256,3,this.mRenderer.TEXFMT.C1I8,this.mRenderer.FILTER.NONE,this.mRenderer.TEXWRP.CLAMP,null)\n ;var keyboardImage=new Image()\n ;if(callback!=null)keyboardImage.src=\"/keyboard.png\";//don't load PNG if no UI \n ;this.mKeyboard={mData:keyboardData,mTexture:kayboardTexture,mIcon:keyboardImage}\n ;this.mCreated=true;}\n\nEffect.prototype.ResizeBuffers=function(oldXres,oldYres\n){var needCopy=(oldXres!=null&&oldYres!=null)\n ;if(!needCopy    //first time!\n ){var thumnailRes=[256,128]\n  ;for(var i=0;i<this.mMaxBuffers;i++\n  ){this.mBuffers[i]={mTexture:[null,null]\n   ,mTarget: [null,null]\n   ,mLastRenderDone:0\n   ,mThumbnailRenderTarget:null//thumbnailRenderTarget\n   ,mThumbnailTexture:null//thumbnailTexture\n   ,mThumbnailBuffer: null//thumbnailBuffer\n   ,mThumbnailRes:thumnailRes};}}\n ;//Prepare for rendering\n ;if(needCopy\n ){var v=[0,0,Math.min(this.mXres,oldXres),Math.min(this.mYres,oldYres)]\n  ;this.mRenderer.SetBlend(false)\n  ;this.mRenderer.SetViewport(v)\n  ;this.mRenderer.AttachShader(this.mProgramCopy)\n  ;var l1=this.mRenderer.GetAttribLocation(this.mProgramCopy,\"pos\")\n  ;var vOld=[0,0,oldXres,oldYres]\n  ;this.mRenderer.SetShaderConstant4FV(\"v\",vOld);}\n ;//Resize each double buffer\n ;for(var i=0;i<this.mMaxBuffers;i++\n ){var texture1=this.mRenderer.CreateTexture(this.mRenderer.TEXTYPE.T2D\n  ,this.mXres,this.mYres\n  ,this.mRenderer.TEXFMT.C4F32\n  ,(needCopy)? this.mBuffers[i].mTexture[0].mFilter:this.mRenderer.FILTER.NONE\n  ,(needCopy)? this.mBuffers[i].mTexture[0].mWrap  :this.mRenderer.TEXWRP.CLAMP\n  ,null)\n  ;var target1=this.mRenderer.CreateRenderTarget(texture1,null,null,null,null,false)\n  ;var texture2=this.mRenderer.CreateTexture(this.mRenderer.TEXTYPE.T2D\n  ,this.mXres,this.mYres\n  ,this.mRenderer.TEXFMT.C4F32\n  ,(needCopy)? this.mBuffers[i].mTexture[1].mFilter:this.mRenderer.FILTER.NONE\n  ,(needCopy)? this.mBuffers[i].mTexture[1].mWrap  :this.mRenderer.TEXWRP.CLAMP\n  ,null)\n  ;var target2=this.mRenderer.CreateRenderTarget(texture2,null,null,null,null,false)\n  ;if(needCopy){//Copy old buffers 1 to new buffer\n   ;this.mRenderer.SetRenderTarget(target1)\n   ;this.mRenderer.AttachTextures(1,this.mBuffers[i].mTexture[0],null,null,null)\n   ;this.mRenderer.DrawUnitQuad_XY(l1)\n   ;//Copy old buffers 2 to new buffer\n   ;this.mRenderer.SetRenderTarget(target2)\n   ;this.mRenderer.AttachTextures(1,this.mBuffers[i].mTexture[1],null,null,null)\n   ;this.mRenderer.DrawUnitQuad_XY(l1)\n   ;//Deallocate old memory\n   ;this.mRenderer.DestroyTexture(this.mBuffers[i].mTexture[0])\n   ;this.mRenderer.DestroyRenderTarget(this.mBuffers[i].mTarget[0])\n   ;this.mRenderer.DestroyTexture(this.mBuffers[i].mTexture[1])\n   ;this.mRenderer.DestroyRenderTarget(this.mBuffers[i].mTarget[1]);}\n  ;//Store new buffers\n  ;this.mBuffers[i].mTexture=[texture1,texture2],this.mBuffers[i].mTarget=[target1,target2],this.mBuffers[i].mLastRenderDone=0;}\n ;if(needCopy){this.mRenderer.DettachTextures();this.mRenderer.DetachShader();this.mRenderer.SetRenderTarget(null);};}\n\nEffect.prototype.IsEnabledVR=function(){if(this.mRenderingStereo)return true;return false;}\n\nEffect.prototype.EnableVR=function(\n){if(!this.mWebVR.mSupportVR)return\n ;if(this.mRenderingStereo)return\n ;this.mRenderingStereo=true\n ;this.mWebVR.Enable();}\n\nEffect.prototype.DisableVR=function(\n){if(!this.mWebVR.mSupportVR)return\n ;if(!this.mRenderingStereo)return\n ;this.mRenderingStereo=false\n ;this.mWebVR.Disable();}\n\nEffect.prototype.SetOutputs=function(passid,slot,url){this.mPasses[passid].SetOutputs(slot,url);}\nEffect.prototype.SetOutputsByBufferID=function(passid,slot,id){this.mPasses[passid].SetOutputsByBufferID(slot,id);}\nEffect.prototype.GetAcceptsLinear=function(passid,slot){return this.mPasses[passid].GetAcceptsLinear(slot);}\nEffect.prototype.GetAcceptsMipmapping=function(passid,slot){return this.mPasses[passid].GetAcceptsMipmapping(slot);}\nEffect.prototype.GetAcceptsWrapRepeat=function(passid,slot){return this.mPasses[passid].GetAcceptsWrapRepeat(slot);}\nEffect.prototype.GetAcceptsVFlip=function(passid,slot){return this.mPasses[passid].GetAcceptsVFlip(slot);}\nEffect.prototype.SetSamplerFilter=function(passid,slot,str){this.mPasses[passid].SetSamplerFilter(slot,str,this.mBuffers);}\nEffect.prototype.GetSamplerFilter=function(passid,slot){return this.mPasses[passid].GetSamplerFilter(slot);}\nEffect.prototype.SetSamplerWrap=function(passid,slot,str){this.mPasses[passid].SetSamplerWrap(slot,str,this.mBuffers);}\nEffect.prototype.GetSamplerWrap=function(passid,slot){return this.mPasses[passid].GetSamplerWrap(slot);}\nEffect.prototype.SetSamplerVFlip=function(passid,slot,str){this.mPasses[passid].SetSamplerVFlip(slot,str);}\nEffect.prototype.GetHeaderSize=function(passid){return this.mPasses[passid].mHeaderLength;}\n\nEffect.prototype.ToggleVolume=function(\n){this.mForceMuted=!this.mForceMuted\n ;//outp\n ;if(this.mForceMuted)this.mGainNode.gain.value=0.0\n ;else this.mGainNode.gain.value=gVol\n ;//inp\n ;var num=this.mPasses.length\n ;for(var j=0;j<num;j++){for(var i=0;i<this.mPasses[j].mInputs.length;i++){this.MuteInput(j,i);}}\n ;return this.mForceMuted;}\n\nEffect.prototype.SetKeyDown=function(passid,k\n){//alert(\"Effect.prototype.SetKeyDown;\"+passid+\",\"+k)\n ;this.mKeyboard.mData[k+0*256]=255\n ;this.mKeyboard.mData[k+1*256]=255\n ;this.mKeyboard.mData[k+2*256]=255-this.mKeyboard.mData[k+2*256]\n ;this.mRenderer.UpdateTexture(this.mKeyboard.mTexture,0,0,256,3,this.mKeyboard.mData)\n ;var num=this.mPasses.length\n ;for(var j=0;j<num;j++\n ){//alert(\"Effect.prototype.SetKeyDown000;\"+j+\" \")\n  ;for(var i=0;i<this.mPasses[j].mInputs.length;i++\n  ){var inp=this.mPasses[j].mInputs[i]\n   ;if(inp!=null&&inp.mInfo.mType==\"keyboard\"\n   ){//alert(\"Effect.prototype.SetKeyDown;\"+j+\" \"+i)//never happerns MEH!\n   if(this.mTextureCallbackFun!=null\n   )this.mTextureCallbackFun(this.mTextureCallbackObj,i,{mImage:this.mKeyboard.mIcon,mData:this.mKeyboard.mData}\n   ,false,6,1,-1.0,this.mPasses[j].mID);}}}}\n\nEffect.prototype.SetKeyUp=function(passid,k\n){this.mKeyboard.mData[k+0*256]=0\n ;this.mKeyboard.mData[k+1*256]=0\n ;this.mRenderer.UpdateTexture(this.mKeyboard.mTexture,0,0,256,3,this.mKeyboard.mData)\n ;var num=this.mPasses.length\n ;for(var j=0;j<num;j++\n ){for(var i=0;i<this.mPasses[j].mInputs.length;i++\n  ){var inp=this.mPasses[j].mInputs[i]\n   ;if(inp!=null&&inp.mInfo.mType==\"keyboard\"\n   ){if(this.mTextureCallbackFun!=null\n   )this.mTextureCallbackFun(this.mTextureCallbackObj,i,{mImage:this.mKeyboard.mIcon,mData:this.mKeyboard.mData}\n   ,false,6,1,-1.0,this.mPasses[j].mID);}}}}\n\nEffect.prototype.StopOutputs=function(\n){var wa=this.mAudioContext,num=this.mPasses.length\n ;for(var i=0;i<num;i++){this.mPasses[i].StopOutput(wa);}}\n\nEffect.prototype.ResumeOutputs=function(\n){var wa=this.mAudioContext,num=this.mPasses.length\n ;for(var i=0;i<num;i++){this.mPasses[i].ResumeOutput(wa);}}\n\nEffect.prototype.SetSize=function(xres,yres\n){if(xres !==this.mXres||yres !==this.mYres\n ){var oldXres=this.mXres\n  ;var oldYres=this.mYres\n  ;this.mXres=xres\n  ;this.mYres=yres\n  ;this.ResizeBuffers(oldXres,oldYres)\n  ;return true;}\n ;return false;}\n\nEffect.prototype.PauseInput=function(passid,id){return this.mPasses[passid].TooglePauseInput(id);}\nEffect.prototype.MuteInput=function(passid,id){return this.mPasses[passid].MuteInput(this.mAudioContext,id);}\nEffect.prototype.RewindInput=function(passid,id){this.mPasses[passid].RewindInput(id);}\n\nEffect.prototype.UpdateInputs=function(passid,forceUpdate\n){this.mPasses[passid].UpdateInputs(this.mAudioContext,forceUpdate,this.mKeyboard);}\n\nEffect.prototype.ResetTime=function(\n){this.mFrame=0\n ;var num=this.mPasses.length\n ;for(var i=0;i<num;i++\n ){this.mPasses[i].mFrame=0\n  ;for(var j=0;j<this.mPasses[i].mInputs.length;j++)this.mPasses[i].RewindInput(j)}}\n\nEffect.prototype.RequestAnimationFrame=function(id\n){if(this.mRenderingStereo&&this.mWebVR.IsPresenting()){this.mWebVR.RequestAnimationFrame(id);}else{requestAnimFrame(id);}}\n\nEffect.prototype.Paint=function(time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,isPaused\n){var wa=this.mAudioContext\n ;var da=new Date()\n ;var vrData=null\n ;if(this.mRenderingStereo)vrData=this.mWebVR.GetData()\n ;var xres=this.mXres/1\n ;var yres=this.mYres/1\n ;var num=this.mPasses.length\n ;if(this.mFrame==0\n ){for(var i=0;i<this.mMaxBuffers;i++\n ){this.mRenderer.SetRenderTarget(this.mBuffers[i].mTarget[0])\n  ;this.mRenderer.Clear(this.mRenderer.CLEAR.Color,[0.0,0.0,0.0,0.0],1.0,0)\n  ;this.mRenderer.SetRenderTarget(this.mBuffers[i].mTarget[1])\n  ;this.mRenderer.Clear(this.mRenderer.CLEAR.Color,[0.0,0.0,0.0,0.0],1.0,0);}}\n ;for(var i=0;i<num;i++//render sound first\n ){if(this.mPasses[i].mType!=\"sound\")continue\n  ;if(this.mPasses[i].mProgram==null)continue\n  ;this.mPasses[i].Paint(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,isPaused,null\n  ,false,this.mBuffers,this.mKeyboard);}\n ;for(var i=0;i<num;i++//render buffers second\n ){if(this.mPasses[i].mType!=\"buffer\")continue\n  ;if(this.mPasses[i].mProgram==null)continue\n  ;var bufferID=assetID_to_bufferID(this.mPasses[i].mOutputs[0])\n  ;//check if any downstream pass needs mipmaps when reading from this buffer\n  ;var needMipMaps=false\n  ;for(var j=0;j<num;j++\n  ){for(var k=0;k<this.mPasses[j].mInputs.length;k++\n   ){var inp=this.mPasses[j].mInputs[k]\n    ;if(inp!=null&&inp.mInfo.mType==\"buffer\"&&inp.id===bufferID&&inp.mInfo.mSampler.filter===\"mipmap\"){needMipMaps=true;break;}}}\n  ;this.mPasses[i].Paint(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,isPaused\n  ,bufferID,needMipMaps,this.mBuffers,this.mKeyboard);}\n ;for(var i=0;i<num;i++//render image last\n ){if(this.mPasses[i].mType!=\"image\")continue\n  ;if(this.mPasses[i].mProgram==null)continue\n  ;this.mPasses[i].Paint(vrData,wa,da,time,dtime,fps,mouseOriX,mouseOriY,mousePosX,mousePosY,xres,yres,isPaused,null,false,this.mBuffers,this.mKeyboard);}   \n ;for(var k=0;k<256;k++){this.mKeyboard.mData[k+1*256]=0;} //erase keypresses\n ;this.mRenderer.UpdateTexture(this.mKeyboard.mTexture,0,0,256,3,this.mKeyboard.mData)\n ;if(this.mRenderingStereo)this.mWebVR.Finish()\n ;this.mFrame++;}\n\nEffect.prototype.NewShader=function(shaderCode,passid\n){var commonSourceCodes=[]\n ;for(var i=0;i<this.mPasses.length;i++){if(this.mPasses[i].mType==\"common\"){commonSourceCodes.push(this.mPasses[i].mSource);}}\n ;return this.mPasses[passid].NewShader(shaderCode,commonSourceCodes);}\n\nEffect.prototype.GetNumPasses=function(){return this.mPasses.length;}\n\nEffect.prototype.GetNumOfType=function(passtype\n){var id=0;for(var j=0;j<this.mPasses.length;j++){if(this.mPasses[j].mType===passtype){id++;}}return id;}\n\nEffect.prototype.GetPassType=function(id){return this.mPasses[id].mType;}\nEffect.prototype.GetPassName=function(id){return this.mPasses[id].mName;}\n\nEffect.prototype.newPass=function(jobj\n){var numPasses=jobj.renderpass.length\n ;//alert(\"Effect.prototype.newPass  jobj.renderpass.length=\"+jobj.renderpass.length)\n ;if(numPasses<1||numPasses>this.mMaxPasses\n ){return{mFailed:true,mError:\"Incorrect number of passes,wrong shader format\",mShader:null};}\n ;var res=[]\n ;res.mFailed=false\n ;for(var j=0;j<numPasses;j++\n ){var rpass=jobj.renderpass[j]\n  ;this.mPasses[j]=new EffectPass(this.mRenderer,this.mIs20,this.mShaderTextureLOD\n  ,this.mTextureCallbackFun,this.mTextureCallbackObj,this.mForceMuted,this.mForcePaused,this.mGainNode\n  ,this.mProgramDownscale,j)\n  ;//skip sound passes if in thumbnail mode\n  ;if(this.mForceMuted&&rpass.type==\"sound\")continue\n  ;var numInputs=rpass.inputs.length\n  ;for(var i=0;i<4;i++){this.mPasses[j].NewTexture(this.mAudioContext,i,null,null,null);}\n  ;for(var i=0;i<numInputs;i++\n  ){var lid=rpass.inputs[i].channel\n   ;var styp=rpass.inputs[i].type\n   ;var sid=rpass.inputs[i].id\n   ;var ssrc=rpass.inputs[i].filepath\n   ;var psrc=rpass.inputs[i].previewfilepath\n   ;var samp=rpass.inputs[i].sampler\n   ;this.mPasses[j].NewTexture(this.mAudioContext,lid,{mType:styp,mID:sid,mSrc:ssrc,mSampler:samp,mPreviewSrc:psrc}\n   ,this.mBuffers,this.mKeyboard);}\n  ;for(var i=0;i<4;i++){this.mPasses[j].SetOutputs(i,null);}\n  ;var numOutputs=rpass.outputs.length\n  ;for(var i=0;i<numOutputs;i++\n  ){var outputID=rpass.outputs[i].id;var outputCH=rpass.outputs[i].channel;this.mPasses[j].SetOutputs(outputCH,outputID);}\n  ;//create some hardcoded names. This should come from the DB\n  ;var rpassName=\"\"\n  ;if(rpass.type==\"common\")rpassName=\"Common\"\n  ;if(rpass.type==\"sound\")rpassName=\"Sound\"\n  ;if(rpass.type==\"image\")rpassName=\"Image\"\n  ;if(rpass.type==\"buffer\")rpassName=\"Buf \"+String.fromCharCode(65+assetID_to_bufferID(this.mPasses[j].mOutputs[0]))\n  ;this.mPasses[j].Create(rpass.type,rpassName,this.mAudioContext);}\n ;for(var pt=0;pt<4;pt++\n ){for(var j=0;j<numPasses;j++\n  ){var rpass=jobj.renderpass[j]\n   ;if(pt==0&&rpass.type!=\"common\")continue\n   ;if(pt==1&&rpass.type!=\"buffer\")continue\n   ;if(pt==2&&rpass.type!=\"image\")continue\n   ;if(pt==3&&rpass.type!=\"sound\")continue\n   ;//skip sound passes if in thumbnail mode\n   ;if(this.mForceMuted&&rpass.type==\"sound\")continue\n   ;var shaderStr=rpass.code\n   ;var result=this.NewShader(shaderStr,j)\n   ;if(result!=null){res.mFailed=true;res[j]={mFailed:true,mError:result,mShader:shaderStr}\n   ;}else {res[j]={mFailed:false,mError:null,mShader:shaderStr};}}}\n ;return res;}\n\nEffect.prototype.DestroyPass=function(id){this.mPasses[id].Destroy(this.mAudioContext);this.mPasses.splice(id,1);}\n\nEffect.prototype.AddPass=function(passType,passName\n){var shaderStr=null\n ;shaderStr=get('s') //\"vec2 mainSound( in int samp,float time){return vec2(sin(6.2831*\\n440.0*time)*exp(-3.0*time));}\"\n ;var id=this.GetNumPasses()\n ;this.mPasses[id]=new EffectPass(this.mRenderer,this.mIs20,this.mShaderTextureLOD\n ,this.mTextureCallbackFun,this.mTextureCallbackObj,this.mForceMuted,this.mForcePaused,this.mGainNode,this.mProgramDownscale,id)\n ;this.mPasses[id].Create(\"sound\",passName,this.mAudioContext)\n ;//alert(\"Effect.prototype.AddPass id:\"+id)//only does id=6, for sound\n ;var res=this.NewShader(shaderStr,id)\n ;return{mId:id,mShader:shaderStr,mError:res};}\n\n//this should be removed once we have MultiPass 2.0 and passes render to arbitrary buffers\nEffect.prototype.IsBufferPassUsed=function(bufferID\n){for(var j=0;j<this.mPasses.length;j++\n ){if(this.mPasses[j].mType !==\"buffer\")continue\n ;if(this.mPasses[j].mOutputs[0]===bufferID_to_assetID(bufferID))return true;}return false;}\n\nEffect.prototype.calcFlags=function(\n){var efvr=false\n ;var efcam=false\n ;var efSoundi=false\n ;var efSoundo=false\n ;var flagKeyboard=false\n ;var flagMultipass=false\n ;var flagMusicStream=false\n ;var numPasses=this.mPasses.length\n ;for(var j=0;j<numPasses;j++\n ){var pass=this.mPasses[j]\n  ;if(pass.mType==\"sound\")efSoundo=true\n  ;if(pass.mType==\"buffer\")flagMultipass=true\n  ;for(var i=0;i<4;i++\n  ){if(pass.mInputs[i]==null)continue\n   ;if(pass.mInputs[i].mInfo.mType==\"webcam\")efcam=true\n   ;else if(pass.mInputs[i].mInfo.mType==\"keyboard\")flagKeyboard=true\n   ;else if(pass.mInputs[i].mInfo.mType==\"mic\")efSoundi=true\n   ;else if(pass.mInputs[i].mInfo.mType==\"musicstream\")flagMusicStream=true;}\n  ;var n1=pass.mSource.indexOf(\"mainVR(\")\n  ;var n2=pass.mSource.indexOf(\"mainVR (\")\n  ;if(n1>0||n2>0)efvr=true;}\n ;return{mefvr:efvr\n  ,mefcam:efcam\n  ,mefSoundi:efSoundi\n  ,mefSoundo:efSoundo\n  ,mFlagKeyboard:flagKeyboard\n  ,mFlagMultipass:flagMultipass\n  ,mFlagMusicStream:flagMusicStream};}\n\nfunction buildInputsUI(me\n){me.mMarks=null\n ;for(let i=0;i<4;i++\n ){var par=gei(\"texture\"+i) //is a div Id\n  ;var can=gei(\"myUnitCanvas\"+i)//this divUd hasa an onclick handler\n  ;var bar=gei(\"inputSelectorControls\"+i)\n  ;par.onmouseover=function(ev){}\n  ;par.onmouseout=function(ev ){}\n  ;var ww=can.offsetWidth\n  ;var hh=can.offsetHeight\n  ;can.width=ww\n  ;can.height=hh\n  ;can.onclick=function(ev){var passType=me.mEffect.GetPassType(me.mActiveDoc);overlay(i,passType);}\n  ;var z=document.createElement(\"button\")//(\"img\")\n  ;z.src=\"/img/themes/\"+gThemeName+\"/pause.png\"\n  ;z.title=\"pause/resume\"\n  ;z.id=\"myPauseButton\"+i\n  ;z.style.right=\"68px\"\n  ;z.style.top=\"1px\"\n  ;z.className=\"uiButton\"\n  ;z.style.visibility='hidden'\n  ;z.onclick=function(ev\n  ){var ele=piGetSourceElement(ev);var r=me.PauseInput(i);if(r===true)ele.src=\"/img/themes/\"+gThemeName+\"/play.png\";}\n  ;bar.appendChild(z)\n  ;z=document.createElement(\"button\")//(\"img\")\n  ;z.title=\"rewind\"\n  ;z.id=\"myRewindButton\"+i\n  ;z.style.right=\"46px\"\n  ;z.style.top=\"1px\"\n  ;z.className=\"uiButton\"\n  ;z.style.visibility='hidden'\n  ;z.onclick=function(ev){var ele=piGetSourceElement(ev);var r=me.RewindInput(i);}\n  ;bar.appendChild(z)\n  ;z=document.createElement(\"button\")//(\"img\")\n  ;z.title=\"mute\"\n  ;z.id=\"myMuteButton\"+i\n  ;z.style.right=\"24px\"\n  ;z.style.top=\"1px\"\n  ;z.className=\"uiButton\"\n  ;z.style.visibility='hidden'\n  ;z.onclick=function(ev){var ele=piGetSourceElement(ev);var r=me.MuteInput(i)\n   ;if(r===true)ele.src=\"/img/themes/\"+gThemeName+\"/speakerOff.png\";else ele.src=\"/img/themes/\"+gThemeName+\"/speakerOn.png\";}\n  ;bar.appendChild(z)\n  ;z=document.createElement(\"button\")//(\"img\")\n  ;z.src=\"/img/themes/\"+gThemeName+\"/options.png\"\n  ;z.title=\"sampler options\"\n  ;z.id=\"mySamplingButton\"+i\n  ;z.style.right=\"2px\"\n  ;z.style.top=\"1px\"\n  ;z.className=\"uiButton\"\n  ;z.onclick=function(ev\n  ){var ele=piGetSourceElement(ev)\n   ;var sam=gei(\"mySampler\"+i)\n   ;if(sam.className===\"inputSampler visible\"){sam.className=\"inputSampler hidden\"\n   ;}else\n    {var eleSamplerFilter=gei(\"mySamplerFilter\"+i)\n    ;var eleSamplerWrap =gei(\"mySamplerWrap\"+i)\n    ;var eleSamplerVFlip=gei(\"mySamplerVFlip\"+i)\n    ;var eleSamplerVFlipLabel=gei(\"mySamplerVFlipLabel\"+i)\n    ;eleSamplerFilter.value=me.GetSamplerFilter(i)\n    ;eleSamplerWrap.value =me.GetSamplerWrap(i)\n    ;eleSamplerVFlip.checked=(me.GetSamplerVFlip(i)==\"true\")\n    ;//see if this input accepts mipmapping\n    ;var al=me.GetAcceptsLinear(i)\n    ;eleSamplerFilter.options[1].style.display=(al==true)?'inherit':'none'\n    ;var am=me.GetAcceptsMipmapping(i)\n    ;eleSamplerFilter.options[2].style.display=(am==true)?'inherit':'none'\n    ;var ar=me.GetAcceptsWrapRepeat(i)\n    ;eleSamplerWrap.options[1].style.display=(ar==true)?'inherit':'none'\n    ;var av=me.GetAcceptsVFlip(i)\n    ;eleSamplerVFlip.style.display=(av==true)?'inherit':'none'\n    ;eleSamplerVFlipLabel.style.display=(av==true)?'inherit':'none'\n    ;sam.className=\"inputSampler visible\";}}\n  ;bar.appendChild(z);}}\n\nfunction ShaderToy(\n){var editorParent=gei(\"editor\")\n ;var passParent=gei(\"passManager\")\n ;var parentElement=gei(\"player\")\n ;var me=this\n ;this.mPassParent=passParent\n ;this.mNeedsSave=false\n ;this.mAreThereAnyErrors=false\n ;this.mAudioContext=null\n ;this.mCreated=false\n ;this.mGLContext=null\n ;this.mHttpReq=null\n ;this.mEffect=null\n ;this.mTo=null\n ;this.mTOffset=0\n ;this.mCanvas=null\n ;this.mFPS=piCreateFPSCounter()\n ;this.mIsPaused=false\n ;this.mForceFrame=false\n ;this.mInfo=null\n ;this.mActiveDoc=0\n ;this.mIsEditorFullScreen=false\n ;this.mFontSize=0\n ;this.mVR=null\n ;buildInputsUI(this)\n ;var devicePixelRatio=window.devicePixelRatio||1\n ;this.mCanvas=gei(\"demogl\")\n ;this.mCanvas.tabIndex=\"0\"//make it react to keyboard\n ;this.mCanvas.width=this.mCanvas.offsetWidth//* devicePixelRatio\n ;this.mCanvas.height=this.mCanvas.offsetHeight//* devicePixelRatio\n ;this.mHttpReq=new XMLHttpRequest()\n ;this.mTo=getRealTime()\n ;this.mTf=0\n ;this.mRestarted=true\n ;this.mFPS.Reset(this.mTo)\n ;this.mMouseIsDown=false\n ;this.mMouseOriX=0\n ;this.mMouseOriY=0\n ;this.mMousePosX=0\n ;this.mMousePosY=0\n ;this.mGLContext=piCreateGlContext(this.mCanvas,false,false,true,false)//need preserve-buffe to true in order to capture screenshots\n ;if(this.mGLContext==null){}\n ;this.mAudioContext=piCreateAudioContext()\n ;if(this.mAudioContext==null){}\n ;this.mVR=new WebVR(function(b ){},this.mCanvas)\n ;this.mSoundcloudImage=new Image()\n ;this.mSoundcloudImage.src=\"/img/themes/\"+gThemeName+\"/soundcloud.png\"\n ;try {if(typeof SC !==\"undefined\"){SC.client_id='b1275b704badf79d972d51aa4b92ea15';SC.initialize({client_id:SC.client_id});}}catch(e){}\n ;window.onfocus=function(){if(!this.mIsPaused){me.mTOffset=me.mTf;me.mTo=getRealTime();me.mRestarted=true;}}\n ;var refreshCharsAndFlags=function(){setTimeout(refreshCharsAndFlags,1500);}\n ;this.mEditorState={mCursorChange:false,mViewportChange:false,mCodeChange:false}\n ;this.mErrors=new Array()\n ;var ekeys= {}\n ;refreshCharsAndFlags(this)\n ;\n ;this.mCanvas.onmousedown=function(ev\n ){var rect=me.mCanvas.getBoundingClientRect()\n  ;me.mMouseOriX=Math.floor((ev.clientX-rect.left)/(rect.right-rect.left)*me.mCanvas.width)\n  ;me.mMouseOriY=Math.floor(me.mCanvas.height-(ev.clientY-rect.top)/(rect.bottom-rect.top)*me.mCanvas.height)\n  ;me.mMousePosX=me.mMouseOriX\n  ;me.mMousePosY=me.mMouseOriY\n  ;me.mMouseIsDown=true\n  ;if(me.mIsPaused)me.mForceFrame=true;}\n ;\n ;this.mCanvas.onmousemove=function(ev\n ){if(me.mMouseIsDown\n  ){var rect=me.mCanvas.getBoundingClientRect()\n   ;me.mMousePosX=Math.floor((ev.clientX-rect.left)/(rect.right-rect.left)*me.mCanvas.width)\n   ;me.mMousePosY=Math.floor(me.mCanvas.height-(ev.clientY-rect.top)/(rect.bottom-rect.top)*me.mCanvas.height)\n   ;if(me.mIsPaused)me.mForceFrame=true;}}\n ;\n ;this.mCanvas.onmouseup=function(ev\n ){me.mMouseIsDown=false\n  ;me.mMouseOriX=-Math.abs(me.mMouseOriX)\n  ;me.mMouseOriY=-Math.abs(me.mMouseOriY)\n  ;if(me.mIsPaused)me.mForceFrame=true;}\n ;\n ;this.mCanvas.addEventListener(\"keydown\",function(ev\n ){//alert(\"this.mCanvas.addEventListener keydown\"+ev.keyCode)\n  ;me.mEffect.SetKeyDown(me.mActiveDoc,ev.keyCode)\n  ;if(me.mIsPaused)me.mForceFrame=true\n  ;ev.preventDefault();},false)\n ;\n ;this.mCanvas.addEventListener(\"keyup\",function(ev\n ){//alert(\"this.mCanvas.addEventListener keyup\"+ev.keyCode)\n  ;if((ev.keyCode==82)&&ev.altKey){let r=gei(\"myRecord\");r.click();}\n  ;me.mEffect.SetKeyUp(me.mActiveDoc,ev.keyCode)\n  ;if(me.mIsPaused)me.mForceFrame=true\n  ;ev.preventDefault();},false)\n ;\n ;gei(\"myResetButton\").onclick=function(ev){me.resetTime(true);}\n ;gei(\"myPauseButton\").onclick=function(ev){me.pauseTime(true);}\n ;gei(\"myVolume\").onclick=function(ev ){var res=me.mEffect.ToggleVolume();}\n ;gei(\"myVR\").onclick=function(ev){var vr=me.mVR.mSupportVR;if(!vr\n   ){alert(\"WebVR API is not supported in this browser\");}else{if(me.mEffect.IsEnabledVR())me.mEffect.DisableVR();else me.mEffect.EnableVR();}}\n ;var mFullScreenExitHandler=function(){if(piIsFullScreen()){}else{if(me.mVR.mSupportVR){me.mEffect.DisableVR();}}}\n ;this.mCanvas.addEventListener('webkitfullscreenchange',mFullScreenExitHandler,false)\n ;this.mCanvas.addEventListener('mozfullscreenchange',mFullScreenExitHandler,false)\n ;this.mCanvas.addEventListener('fullscreenchange',mFullScreenExitHandler,false)\n ;this.mCanvas.addEventListener('MSFullscreenChange',mFullScreenExitHandler,false)\n ;gei(\"myFullScreen\").onclick=function(ev){piRequestFullScreen(me.mCanvas);me.mCanvas.focus();}//put mouse/keyboard focus on canvas\n ;this.mEffect=new Effect(this.mVR,this.mAudioContext,this.mGLContext,this.mCanvas.width,this.mCanvas.height,null,this,false,false)\n ;if(!this.mEffect.mCreated){this.mIsPaused=true;this.mForceFrame=false;this.mCreated=false;return;}\n ;this.mCanvas.addEventListener(\"webglcontextlost\",function(event\n ){event.preventDefault();me.mIsPaused=true;alert('WebGL implementation crashed');},false);\n ;this.mMediaRecorder=null\n ;gei(\"myRecord\").onclick=function(ev\n ){if(me.mMediaRecorder==null\n  ){me.mMediaRecorder=piCreateMediaRecorder(function(b\n   ){var ele=gei(\"myRecord\")\n    ;if(b){}else{}//currently recording or not\n   ;},me.mCanvas);}\n  ;if(me.mMediaRecorder==null\n  ){let ele=gei(\"myRecord\")\n   ;ele.style.background=\"url('/img/themes/\"+gThemeName+\"/recordDisabled.png')\"\n   ;alert('MediaRecord API is not supported in this browser')\n   ;return;}\n  ;if(me.mMediaRecorder.state==\"inactive\"){me.mMediaRecorder.start()\n  ;}else{me.mMediaRecorder.stop();}}\n ;this.mCreated=true;}\n\nShaderToy.prototype.startRendering=function(\n){var me=this\n ;function renderLoop2(\n ){if(me.mGLContext==null)return\n  ;me.mEffect.RequestAnimationFrame(renderLoop2)\n  ;if(me.mIsPaused&&!me.mForceFrame){me.mEffect.UpdateInputs(me.mActiveDoc,false);return;}\n  ;me.mForceFrame=false\n  ;var time=getRealTime()\n  ;var ltime=0.0\n  ;var dtime=0.0\n  ;if(me.mIsPaused){ltime=me.mTf;dtime=1000.0/60.0\n  ;}else \n   {ltime=me.mTOffset+time-me.mTo\n   ;if(me.mRestarted)dtime=1000.0/60.0\n   ;else dtime=ltime-me.mTf\n   ;me.mTf=ltime;}\n  ;me.mRestarted=false\n  ;var newFPS=me.mFPS.Count(time)\n  ;me.mEffect.Paint(ltime/1000.0,dtime/1000.0,me.mFPS.GetFPS(),me.mMouseOriX,me.mMouseOriY,me.mMousePosX,me.mMousePosY,me.mIsPaused)\n  ;gei(\"myTime\").textContent=(ltime/1000.0).toFixed(2)\n  ;if(me.mIsPaused){\n  ;}else{if(newFPS\n    ){gei(\"myFramerate\").textContent=\" fps:\"+me.mFPS.GetFPS().toFixed(1)+\" ver:\"+wMs[wM];}}}\n ;renderLoop2();}\n\nShaderToy.prototype.resize=function(xres,yres\n){this.mCanvas.setAttribute(\"width\",xres)\n ;this.mCanvas.setAttribute(\"height\",yres)\n ;this.mCanvas.width=xres\n ;this.mCanvas.height=yres\n ;this.mEffect.SetSize(xres,yres)\n ;this.mForceFrame=true;}\n\nShaderToy.prototype.pauseTime=function(doFocusCanvas\n){if(!this.mIsPaused\n ){this.mIsPaused=true;this.mEffect.StopOutputs()\n ;}else\n  {this.mTOffset=this.mTf\n  ;this.mTo=getRealTime()\n  ;this.mIsPaused=false\n  ;this.mRestarted=true\n  ;this.mEffect.ResumeOutputs()\n  ;if(doFocusCanvas)this.mCanvas.focus();}}//put mouse/keyboard focus on canvas\n\nShaderToy.prototype.resetTime=function(doFocusOnCanvas\n){this.mTOffset=0\n ;this.mTo=getRealTime()\n ;this.mTf=0\n ;this.mRestarted=true\n ;this.mFpsTo=this.mTo\n ;this.mFpsFrame=0\n ;this.mForceFrame=true\n ;this.mEffect.ResetTime()\n ;if(doFocusOnCanvas)this.mCanvas.focus();}//put mouse/keyboard focus on canvas\n\nShaderToy.prototype.SetErrorsGlobal=function(areThereAnyErrors,fromScript\n){\n ;var eleWrapper=gei('editorWrapper')\n ;if(areThereAnyErrors==false\n ){this.mForceFrame=true\n  ;if(fromScript==false\n  ){//eleWrapper.classList.remove(\"errorYes\")\n   ;eleWrapper.classList.add(\"errorNo\")\n   ;setTimeout(function(){eleWrapper.classList.remove(\"errorNo\");},500)\n ;}}else{//eleWrapper.classList.add(\"errorYes\")\n ;}}\n\nShaderToy.prototype.PauseInput=function(id){return this.mEffect.PauseInput(this.mActiveDoc,id);}\nShaderToy.prototype.MuteInput=function(id){return this.mEffect.MuteInput(this.mActiveDoc,id);}\nShaderToy.prototype.RewindInput=function(id){this.mEffect.RewindInput(this.mActiveDoc,id);}\n\nShaderToy.prototype.SetTexture=function(slot,url\n){//alert(\"SetTexture of slot:\"+slot)\n ;this.mNeedsSave=true\n ;var res=this.mEffect.NewTexture(this.mActiveDoc,slot,url)\n ;if(res.mFailed==false){gShaderToymPass[this.mActiveDoc].mDirty=res.mNeedsShaderCompile;}}\n\nShaderToy.prototype.GetTexture=function(slot){return this.mEffect.GetTexture(this.mActiveDoc,slot);}\nShaderToy.prototype.GetAcceptsLinear=function(slot){return this.mEffect.GetAcceptsLinear(this.mActiveDoc,slot);}\nShaderToy.prototype.GetAcceptsMipmapping=function(slot){return this.mEffect.GetAcceptsMipmapping(this.mActiveDoc,slot);}\nShaderToy.prototype.GetAcceptsWrapRepeat=function(slot){return this.mEffect.GetAcceptsWrapRepeat(this.mActiveDoc,slot);}\nShaderToy.prototype.GetAcceptsVFlip=function(slot){return this.mEffect.GetAcceptsVFlip(this.mActiveDoc,slot);}\nShaderToy.prototype.SetSamplerFilter=function(slot,str){this.mEffect.SetSamplerFilter(this.mActiveDoc,slot,str);this.mForceFrame=true;}\nShaderToy.prototype.GetSamplerFilter=function(slot){return this.mEffect.GetSamplerFilter(this.mActiveDoc,slot);}\nShaderToy.prototype.SetSamplerWrap=function(slot,str){this.mEffect.SetSamplerWrap(this.mActiveDoc,slot,str);this.mForceFrame=true;}\nShaderToy.prototype.GetSamplerWrap=function(slot){return this.mEffect.GetSamplerWrap(this.mActiveDoc,slot);}\nShaderToy.prototype.SetSamplerVFlip=function(slot,str){this.mEffect.SetSamplerVFlip(this.mActiveDoc,slot,str);this.mForceFrame=true;}\nShaderToy.prototype.GetSamplerVFlip=function(slot){return this.mEffect.GetSamplerVFlip(this.mActiveDoc,slot);}\nShaderToy.prototype.SetShaderFromEditor=function(forceall\n){var anyErrors=false\n ;var num=this.mEffect.GetNumPasses()\n ;var recompileAll=false\n ;for(var i=0;i<num;i++){if(this.mEffect.GetPassType(i)==\"common\"&&(gShaderToymPass[i].mDirty||forceall)){recompileAll=true;break;}}\n ;for(var j=0;j<4;j++\n ){for(var i=0;i<num;i++\n  ){if(j==0&&this.mEffect.GetPassType(i)!=\"common\")continue\n   ;if(j==1&&this.mEffect.GetPassType(i)!=\"buffer\")continue\n   ;if(j==2&&this.mEffect.GetPassType(i)!=\"image\")continue\n   ;if(j==3&&this.mEffect.GetPassType(i)!=\"sound\")continue\n   ;if(recompileAll||gShaderToymPass[i].mDirty||forceall){this.mEffect.NewShader(gShaderToymPass[i].mDocs.getValue(),i);}}}//needed for webvr?\n ;if(!anyErrors){this.mForceFrame=true;}}\n\n\n//guiID:\n//0:null 1:texture 2:cubemap 3:video 4:music 5:mic 6:keyb 7:webcam 8:musicstream 9:buffer\n\n\nShaderToy.prototype.ChangePass=function(id\n){gShaderToy.mActiveDoc=id\n ;gShaderToy.mEffect.UpdateInputs(id,true)\n ;var num=gShaderToy.mEffect.GetNumPasses()\n ;for(var i=0;i<num;i++//highlight the tab\n ){var eleLab=gei(\"tab\"+i);if(i==id)eleLab.classList.add(\"selected\")\n  ;else eleLab.classList.remove(\"selected\");}\n ;var passType=gShaderToy.mEffect.GetPassType(id)\n ;var ele=gei(\"textures\")\n ;ele.style.visibility=(passType===\"common\")?\"hidden\":\"visible\";}\n\nShaderToy.prototype.KillPass=function(id\n){this.mNeedsSave=true\n ;this.mEffect.DestroyPass(id)\n ;gShaderToymPass.splice(id,1)\n ;this.BuildTabs()\n ;var activePass=this.mActiveDoc\n ;if(activePass >=id){activePass--;if(activePass<0)activePass=0;}\n ;this.ChangePass(activePass)\n ;this.SetShaderFromEditor(true);}\n\nShaderToy.prototype.AddPass=function(passType,passName,outputID\n){var res=this.mEffect.AddPass(passType,passName)\n ;var id=res.mId\n ;this.mEffect.SetOutputsByBufferID(id,0,outputID)\n ;gShaderToymPass[id]=\n {mFailed:false //there was codemirror shit in this\n ,mError:null\n ,mDirty:false\n ,mCharCount:0\n ,mCharCountDirty:false}\n ;//alert(\"AddPass res.mId:\"+res.mId)//tells me that sound has res.mId==6\n ;this.BuildTabs()\n ;this.ChangePass(id)\n ;this.mNeedsSave=true;}\n\nShaderToy.prototype.AddTab=function(passType,passName,id\n){var me=this\n ;var eleTab=document.createElement(\"div\")\n ;eleTab.mNum=id\n ;eleTab.onclick=function(ev){me.ChangePass(this.mNum);}\n ;eleTab.id=\"tab\"+id\n ;eleTab.className=\"tab\"\n ;if(gShaderToymPass[id].mError!=null){eleTab.classList.add(\"errorYes\")\n ;}else{eleTab.classList.remove(\"errorYes\");}\n ;var eleImg=document.createElement(\"button\")\n ;eleImg.className=\"tabImage\"\n ;eleTab.appendChild(eleImg)\n ;var eleLab=document.createElement(\"label\")\n ;eleLab.textContent=passName\n ;eleTab.appendChild(eleLab)\n   //close tab button, i dont like that functionality!\n //;if(passType!=\"image\"&&passType!=\"common\"\n //){eleImg=document.createElement(\"button\")\n // ;eleImg.className=\"tabClose\"\n // ;eleImg.mNum=id\n // ;eleImg.onclick=function(ev){me.KillPass(this.mNum);}\n // ;eleTab.appendChild(eleImg);}\n  \n ;this.mPassParent.appendChild(eleTab);}\n\n\nShaderToy.prototype.BuildTabs=function(\n){gShaderToy.mPassParent.innerHTML=''\n ;var num=this.mEffect.GetNumPasses()\n ;gShaderToy.mTab2Pass=[]\n ;var n=0\n ;for(var i=0;i<num;i++\n ){var passType=gShaderToy.mEffect.GetPassType(i)\n  ;if(passType!==\"image\")continue\n  ;gShaderToy.AddTab(\"image\",\"Image\",0)\n  ;gShaderToy.mTab2Pass[n++]=0;}\n ;for(var i=0;i<num;i++\n ){var passType=gShaderToy.mEffect.GetPassType(i)\n  ;if(passType !==\"common\")continue\n  ;gShaderToy.AddTab(\"common\",\"Common\",1)\n  ;gShaderToy.mTab2Pass[n++]=i;}\n ;for(var i=0;i<num;i++\n ){var passType=gShaderToy.mEffect.GetPassType(i)\n  ;if(passType!==\"sound\")continue\n  ;gShaderToy.AddTab(\"sound\",\"Sound\",2)\n  ;gShaderToy.mTab2Pass[n++]=i;}\n ;for(var i=0;i<num;i++\n ){var passType=gShaderToy.mEffect.GetPassType(i)\n  ;if(passType!==\"buffer\")continue\n  ;var passName=gShaderToy.mEffect.GetPassName(i)//passname will also be the button label\n  ;gShaderToy.AddTab(\"buffer\",passName,i)\n  ;gShaderToy.mTab2Pass[n++]=i;}\n ;}\n\n\nvar gShaderToy=null;\nvar gCode=null;\nvar gIsLiked=0;\nvar gRes=null;\n\nfunction minify(str\n){return str;}\n\nEffectPass.prototype.SetOutputs=function(slot,id){this.mOutputs[slot]=id;}\nEffectPass.prototype.SetOutputsByBufferID=function(slot,id ){this.mOutputs[slot]=bufferID_to_assetID(id );}\n\n\nfunction watchResize(\n){var srdiv=gei(\"demogl\")\n ;if(srdiv\n ){var xres=srdiv.offsetWidth\n  ;var yres=srdiv.offsetHeight\n  ;gShaderToy.resize(xres,yres);}}\n\nfunction changeEditorFont(){var ele=gei(\"uiFontSelector\");gShaderToy.setFontSize(ele.selectedIndex,true);}\n\n//effect.js is a bridge between shadertoy frontend UI and piLibs,js as opengl container\nEffect.prototype.AddP=function(passType,passName//this funcion is designed to always add the dound tab AT LAST LAB\n){\n ;var id=this.GetNumPasses()\n ;this.mPasses[id]=new EffectPass(this.mR,this.mIs20,this.mShaderTextureLOD\n                                  ,this.mTextureCallbackFun,this.mTextureCallbackObj,this.mForcePaused\n                                  ,this.mGainNode,this.mProgramDownscale,id)\n ;this.mPasses[id].Create(\"sound\",\"Sound\",this.mAudioContext)\n ;var res=this.NewShader(get('s'),id)\n ;return{mId:id,mShader:get('s'),mError:res};}\n\nEffect.prototype.SetOutputsByID =function(passid,slot,id ){this.mPasses[passid].SetOutputsByBufferID(slot,id);}\n\nfunction soundCodeToggle(){\n ;var soundExists=-1;\n ;var num=gShaderToy.mEffect.GetNumPasses()\n ;for(var i=0;i<num;i++ ){if(gShaderToy.mEffect.GetPassType(i)==\"sound\"){soundExists=i;break;}}\n ;if(soundExists>-1)gShaderToy.KillPass(i)\n ;else if(gShaderToy.mEffect.GetNumOfType(\"sound\")<1)gShaderToy.AddPass(\"sound\",\"Sound\",null);}\n\nvar gShaderToymPass=[]\n\nfunction watchInit(\n){set(\"myVer\",cVer)\n ;document.addEventListener(\"keydown\",function(e\n ){if(e.keyCode==8//intercept BACKSPACE\n  ){var ele=piGetSourceElement(e)\n   ;if(ele.nodeName===\"BODY\"){e.preventDefault();return;}\n   ;if(ele.id===\"demogl\"\n   ){var me=gShaderToy\n    ;me.mEffect.SetKeyDown(me.mActiveDoc,e.keyCode)\n    ;if(me.mIsPaused)me.mForceFrame=true\n  ;}}else if(e.keyCode==83&&(navigator.platform.match(\"Mac\")?e.metaKey:e.ctrlKey)){e.preventDefault()//intercept CTRL+S (save the web page to disk)\n  ;//intercept browsers default behaviour for CTRL+F (search)\n  ;}else if(e.keyCode==70&&(navigator.platform.match(\"Mac\")?e.metaKey:e.ctrlKey)){e.preventDefault();}},false)\n\n ;//cancel/intercept browsers default behaviour for ALT+LEFT (prev URL)\n ;if(!navigator.platform.match(\"Mac\"))document.addEventListener(\"keydown\",function(e){if(e.keyCode==37&&e.altKey){e.preventDefault();}},false)\n ;gShaderToy=new ShaderToy()\n ;if(!gShaderToy.mCreated)return\n //in 2019-02 i had some mild sucess in reverse engineerign this json, but it still fails to auto-add sound, and without that it sucks a lot\n \n ;var kk={\"flags\":{\"mefvr\"         :\"true\"\n\t\t    \t        ,\"mefcam\"     :\"true\"\n\t\t    \t        ,\"mefSoundi\" :\"true\"\n\t\t    \t        ,\"mefSoundo\":\"true\"\n\t\t    \t        ,\"mFlagKeyboard\"   :\"true\"}//initially all flags were set to false. i do not trust this in terms of making debugging easy.\n\t\t    \t\t,\"renderpass\":[\t\t  \n\t\t    \t\t\n\t\t    \t\t //image tab mist be first in this list; we have 2 examples; one without buffers, and one that sets ichan0 as a pointer to the putput of BufA\n\t\t    \t\t //{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":37      }],\"type\":\"image\" ,\"code\":get('i')}\n\t\t    \t\t //above is bufferless, below sets ichan0=bufA\n\t\t    \t\t  {\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":37      }],\"type\":\"image\" ,\"code\":get('i')}\n\t\t    \t\t  //this segment fails\n\t\t    \t\t //,{\"inputs\":[{\"channel\":0,\"type\":\"buffer\",\"id\":\"bufAid\",\"filepath\":\"/media/previz/buffer00.png\"\n           //              ,\"sampler\":[{\"filter\":\"linear\",\"wrap\":\"clamp\",\"vflip\":true}] \n\t\t    \t\t//              }]\n\t\t    \t//\t ,\"outputs\":[{\"channel\":0,\"id\":37}],\"type\":\"image\",\"code\":get('i')}\n\t\t    \t//\t\n\t\t    \t\t//commontab is simple, must be after image tab in this list. the code of the commontab just gets added on top, just below the fragment shader header (with its input globals)\n\t\t    \t  ,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"none\"  }],\"type\":\"common\",\"code\":get('o')}\n\t\t    \t ,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"bufAid\"}],\"type\":\"buffer\",\"code\":get('a')}          //BufA without doublebuffer\n           //  ,{\"inputs\":[{\"channel\":0,\"type\":\"buffer\",\"id\":\"bufAid\",\"filepath\":\"/buffer00.png\"  //BufA ichan0=BufA (backbuffer)\n          //               ,\"sampler\":[{\"filter\":\"linear\",\"wrap\":\"clamp\",\"vflip\":true}]  }]                   //BufA ichan0=BufA (backbuffer)  \n          //   ,\"outputs\":[{\"channel\":0,\"id\":\"bufAid\"}]                                                        //BufA ichan0=BufA (backbuffer)  \n          //   ,\"type\":\"buffer\",\"code\":get('a')}                                                               //BufA ichan0=BufA (backbuffer)  \n\t\t    \t //above lines tresult in a mess that barely works, but it works\n\t\t    \t ,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"bufBid\"}],\"type\":\"buffer\",\"code\":get('b')}            //BufA without doublebuffer\t    \t \n\t\t    \t ,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"bufCid\"}],\"type\":\"buffer\",\"code\":get('c')}\n\t\t    \t ,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"bufDid\"}],\"type\":\"buffer\",\"code\":get('d')}\n\t    \t\t //,{\"inputs\":[],\"outputs\":[{\"channel\":0,\"id\":\"none\"  }],\"type\":\"sound\" ,\"code\":get('s') }//fails\n              ]}\n \n\n //;gShaderToy.resetTime()\n //;gShaderToy.pauseTime();\n ;gShaderToy.pauseTime();\n \n\n ;for(var i=0;i<6;i++)gShaderToymPass[i]={}\n \n ;gShaderToy.SetErrorsGlobal(gShaderToy.mEffect.newPass(kk).mFailed,true)\n ;gShaderToy.resetTime()\n ;gShaderToy.mInfo=kk.info\n ;gShaderToy.pauseTime();  \n ;gShaderToy.startRendering()\n \n   //;ShaderToy.prototype.ChangePass(5)\n   //;alert(\"activePass:   \"+ShaderToy.mActiveDoc)\n //gShaderToy.SetTexture() must be after gShaderToy.startRendering()\n //this automatically assigns buffers ti [activePass], which is now =[image]\n //edits an ichan slot of an activeTexture\n //the fiirst ActiveTexture is the \"image\" texture, below lines assign ichan[0,1,2,3] of [image] to [buff[A,B,C,D]id]\n //first parameter is the slot of the activeTexture\n ;gShaderToy.SetTexture(0,{mType:'buffer',mID:'bufAid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan0 of Image refers BufA\n ;gShaderToy.SetTexture(1,{mType:'buffer',mID:'bufBid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan1 of Image refers BufB\n ;gShaderToy.SetTexture(2,{mType:'buffer',mID:'bufCid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan2 of Image refers BufC\n ;gShaderToy.SetTexture(3,{mType:'buffer',mID:'bufDid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})////ichan3 refers BufD\n //;gShaderToy.SetTexture(3,{mType:'keyboard',mID:'4dXGRr',mSrc:null\n //,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers KeyIn\n\n ;gShaderToy.mActiveDoc=2 //is bufA\n ;gShaderToy.SetTexture(0,{mType:'buffer',mID:'bufDid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan0 refers Buf-1\n ;gShaderToy.SetTexture(1,{mType:'buffer',mID:'bufAid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan1 refers to self\n ;gShaderToy.SetTexture(2,{mType:'buffer',mID:'bufBid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan2 refers Buf+1\n //;gShaderToy.SetTexture(3,{mType:'buffer',mID:'bufCid'\n //,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers Buf+2\n ;gShaderToy.SetTexture(3,{mType:'keyboard',mID:'4dXGRr',mSrc:null\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers KeyIn\n \n ;gShaderToy.mActiveDoc=3 //is bufB\n ;gShaderToy.SetTexture(0,{mType:'buffer',mID:'bufAid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan0 refers Buf-1\n ;gShaderToy.SetTexture(1,{mType:'buffer',mID:'bufBid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan1 refers to self\n ;gShaderToy.SetTexture(2,{mType:'buffer',mID:'bufCid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan2 refers Buf+1\n //;gShaderToy.SetTexture(3,{mType:'buffer',mID:'bufDid'\n //,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers Buf+2\n ;gShaderToy.SetTexture(3,{mType:'keyboard',mID:'4dXGRr',mSrc:null\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers KeyIn\n \n ;gShaderToy.mActiveDoc=4 //is bufC\n ;gShaderToy.SetTexture(0,{mType:'buffer',mID:'bufBid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan0 refers Buf-1\n ;gShaderToy.SetTexture(1,{mType:'buffer',mID:'bufCid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan1 refers to self\n ;gShaderToy.SetTexture(2,{mType:'buffer',mID:'bufDid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan2 refers Buf+1\n //;gShaderToy.SetTexture(3,{mType:'buffer',mID:'bufAid'\n //,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers Buf+2\n  ;gShaderToy.SetTexture(3,{mType:'keyboard',mID:'4dXGRr',mSrc:null\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers KeyIn\n \n ;gShaderToy.mActiveDoc=5 //is bufD\n ;gShaderToy.SetTexture(0,{mType:'buffer',mID:'bufCid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan0 refers Buf-1\n ;gShaderToy.SetTexture(1,{mType:'buffer',mID:'bufDid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan1 refers to self\n ;gShaderToy.SetTexture(2,{mType:'buffer',mID:'bufAid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan2 refers Buf+1\n ;gShaderToy.SetTexture(3,{mType:'buffer',mID:'bufBid'\n ,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers Buf+2\n //;gShaderToy.SetTexture(3,{mType:'keyboard',mID:'4dXGRr',mSrc:null\n //,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})//ichan3 refers KeyIn\n ;gShaderToy.mActiveDoc=1\n //;ShaderToy.prototype.ChangePass()\n //;gShaderToy.soundCodeToggle()\n //;sPo(0) //makes a popin, maybe useful to debug anything\n //;sPo(1)//makes a popin,but its immobile\n ;if(gShaderToy.mEffect.GetNumOfType(\"sound\")<1)gShaderToy.AddPass(\"sound\",\"Sound\",null) //YAY uncommenting this plays audio instantly!\n //but then i lack the editor, so thats just more bullshit codependence\n //so i made a soundCodeToggle() function for a button, meh this is still not great!\n //but alas the dumb selector is obsoleted!\n //;ShaderToy.prototype.ChangePass(\"bufAid\")//works but has confusing side effects\n //;gShaderToy.resetTime()\n\n ;gShaderToy.pauseTime();\n //;if(gRes.mFailed)gShaderToy.pauseTime();\n ;}\n \n\n \n\nfunction cmpPageNavigation(eleParent,numResultsPerPage\n){var mResultsPerPage=numResultsPerPage\n ;var mTotalPages=0\n ;var mCurrentPage=0\n ;var mTotalResults=0\n ;var mFuncChangePage=null\n ;var mEleParent=eleParent\n ;var me={}\n ;me.SetOnClick=function(func){mFuncChangePage=func;}\n ;me.RefreshUI=function(\n ){}\n ;me.SetNumResults=function(numResults,numResultsPerPage\n ){mResultsPerPage=numResultsPerPage\n  ;TotalResults=numResults\n  ;mTotalPages=(((numResults+mResultsPerPage-1)|0)/mResultsPerPage)|0\n  ;mCurrentPage=0;}\n ;return me;}\n\n\nvar gThemeName=\"classic\";\nvar gFontSize=\"0\";\nfunction doSaveShader(){}\nvar gUserName='ollj';\nvar gShaderID=\"Md3yRB\";\n\nfunction cmpAssetBrowser(assetType,clickedCallback\n){var mJson=null\n ;var mNumAssetsInPage=0\n ;var mMaxAssetsPerPage=9\n ;var mNumAssets=0\n ;var mAssetType=assetType\n ;var mNavigator=new cmpPageNavigation(gei(assetType+\"Nav\"),mMaxAssetsPerPage)\n ;var mClickedCallback=clickedCallback\n ;var mLoaded=false\n ;var me={}\n ;me.Load=function(\n ){if(mLoaded)return\n  ;var req=new XMLHttpRequest()\n  ;req.onload=function(\n  ){mLoaded=true\n   ;mJson=req.response\n   ;if(mJson==null)return\n   ;mNumAssets=mJson.filepath.length\n   ;if(mNumAssets==0)return\n   ;mNavigator.SetNumResults(mNumAssets,mMaxAssetsPerPage)\n   ;mNavigator.RefreshUI()\n   ;mNavigator.SetOnClick(function(pageID){me.RefreshUI(pageID);})\n   ;me.RefreshUI(0);}\n  ;req.open(\"POST\",\"/shadertoy\",true)\n  ;req.responseType=\"json\"\n  ;req.setRequestHeader('Content-Type','application/x-www-form-urlencoded')\n  ;req.send(\"mga=1&type=\"+mAssetType);}//this whole bracked just defines a hson httpRequest.\n ;me.RefreshUI=function(pageid\n ){let firstAsset=pageid*mMaxAssetsPerPage\n  ;let numAssets=mMaxAssetsPerPage\n  ;if(firstAsset+numAssets>mNumAssets)numAssets=mNumAssets-firstAsset\n  ;for(let i=0;i<mMaxAssetsPerPage;i++\n  ){let eleAse=gei(mAssetType+\"Asset\"+i)\n   ;let eleImg=gei(mAssetType+\"AssetThumnail\"+i)\n   ;let eleNam=gei(mAssetType+\"AssetName\"+i)\n   ;let eleUse=gei(mAssetType+\"UserName\"+i)\n   ;let eleInf=gei(mAssetType+\"Info\"+i)\n   ;if(i<numAssets \n   ){let id=firstAsset+i\n    ;eleAse.style.display=\"block\"\n    ;eleImg.onclick=function(\n    ){mClickedCallback({mType:mAssetType\n     ,mID:mJson.id[id]\n     ,mSrc:mJson.filepath[id]\n     ,mSampler:mJson.sampler[id]\n     ,mPreviewSrc:mJson.previewFilepath[id]});}\n    ;eleImg.src=mJson.previewFilepath[id]\n    ;eleNam.textContent=mJson.name[id]\n    ;eleUse.innerHTML=\"<a class='user' href='/user/\"+htmlEntities(mJson.owner[id])+\"'>\"+htmlEntities(mJson.owner[id])+\"</a>\"\n    ;if(mAssetType===\"texture\"\n    ){eleInf.textContent=mJson.custom1[id]+\" x \"+mJson.custom2[id]+\"\\r\\n\"+mJson.custom3[id]+\" channels,uint8\"\n    ;}else if(mAssetType===\"volume\"\n    ){eleInf.textContent=mJson.custom1[id]+\" x \"+mJson.custom2[id]+\" x \"+mJson.custom3[id]+\"\\r\\n\" +mJson.custom4[id]+\" channels,uint8\"\n    ;}else if(mAssetType===\"cubemap\"\n    ){eleInf.textContent=mJson.custom1[id]+\" x \"+mJson.custom2[id]+\"\\r\\n\"+mJson.custom3[id]+\" channels,uint8\"\n    ;}else if(mAssetType===\"video\"\n    ){eleInf.textContent=mJson.custom1[id]+\" x \"+mJson.custom2[id]+\",\"+mJson.custom5[id]\n    +\" fps\\r\\n\"+mJson.custom3[id]+\" channels,uint8\\r\\n\"+mJson.custom6[id]+\" seconds\"\n    ;}else if(mAssetType===\"music\"){eleInf.textContent=mJson.custom3[id]+\" hz\\r\\n\"+mJson.custom1[id]\n    +\" channels,sint16\\r\\n\"+mJson.custom4[id]+\" seconds\"\n   ;}}else{eleAse.style.display=\"none\";}}};return me;}\n\nvar gDialog=null;\n//TO-DO:put all of the things below as members of gDialog\nvar gCurrentEditingSlot=null;//first parameter to setTexture(\nvar gBrowserTextures=null;\nvar gBrowserVideos=null;\nvar gBrowserCubemaps=null;\nvar gBrowserVolumes=null;\nvar gBrowserMusics=null;\n\nfunction overlay(slot,passType\n){gCurrentEditingSlot=slot\n ;{if(slot!=null\n ){var isSoundPassType=(passType===\"sound\")\n  ;var eleTabMusic=gei(\"liMusic\")\n  ;var eleTabVideos=gei(\"liVideos\")\n  ;var eleDialogTitle=gei(\"pickTextureDialogTitle\")\n  ;eleDialogTitle.textContent=\"set iChannel\"+slot+\" input\";}}\n ;if(gDialog==null\n ){gDialog={}\n  ;var clickedCallback=function(opts){gDialog.CloseSoundCloud();gShaderToy.SetTexture(gCurrentEditingSlot,opts);}\n  ;gBrowserTextures=new cmpAssetBrowser(\"texture\",clickedCallback)\n  ;gBrowserCubemaps=new cmpAssetBrowser(\"cubemap\",clickedCallback)\n  ;gBrowserVolumes=new cmpAssetBrowser(\"volume\",clickedCallback)\n  ;gBrowserVideos =new cmpAssetBrowser(\"video\",clickedCallback)\n  ;gBrowserMusics =new cmpAssetBrowser(\"music\",clickedCallback)\n  ;gDialog.mEle=gei(\"pickTexture_image\")\n  ;gDialog.mIsMoving=false\n  ;gDialog.mStartPosX=0\n  ;gDialog.mStartPosY=0\n  ;gDialog.mHeader=gei(\"pickTextureHeader\")\n  ;gDialog.mHeader.onmousedown=function(ev\n  ){gDialog.mIsMoving=true;gDialog.mStartPosX=ev.screenX-gDialog.mEle.offsetLeft;gDialog.mStartPosY=ev.screenY-gDialog.mEle.offsetTop;}\n   ;gDialog.mHeader.onmouseup=function(ev){gDialog.mIsMoving=false;}\n   ;gDialog.mVisible=false\n   ;if(passType==\"image\"||passType==\"buffer\"\n   ){//soundclouds URL click\n    ;var handlePress=function(str\n    ){var url=str.trim()\n     ;if(SC!=null\n     ){SC.resolve(url).then(function(song\n      ){if(song.streamable==true\n       ){gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'musicstream'\n              ,mID:\"new\"\n             ,mSrc:url\n ,mSampler:{filter:'linear'\n             ,wrap:'clamp'\n            ,vflip:'true'\n             ,srgb:'false'\n         ,internal:'byte'}})\n       ;}else{alert('Shadertoy:Soundcloud-This track cannot be streamed')\n      ;}}).catch(function(error){alert('Shadertoy:Soundcloud-'+error.message);});}\n //gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'musicstream',mID:-1,mSrc:url,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}});\n };gDialog.mSoundCloudsURL=gei(\"mySoundCloudURL\")\n  ;gDialog.mSoundCloudsURLBox=gei(\"mySoundCloudURLBox\")\n  ;var eleB=gei(\"mySoundCloudButton\")\n  ;//gDialog.mSoundCloudsURL.onchange=handlePress()\n  ;gDialog.mSoundCloudsURL.onkeypress=function(e\n  ){if(!e)e=window.event\n   ;var keyCode=e.keyCode||e.which\n   ;if(keyCode==13)handlePress(this.value)\n   ;return;}\n  ;gDialog.mSoundCloudsURL.onclick=function(){this.select();}\n  ;eleB.onclick=function(\n  ){gDialog.mSoundCloudsURLBox.classList.toggle(\"classSBV\")\n   ;gDialog.mSoundCloudsURL.focus()\n   ;gDialog.mSoundCloudsURL.select();}\n  ;gDialog.CloseSoundCloud=function(\n  ){gDialog.mSoundCloudsURLBox.classList.remove(\"classSBV\")\n   ;//gDialog.mSoundCloudsURL.value=''\n   ;}}else{}}\n ;document.onmousemove=function(ev\n ){if(gDialog!=null&&gDialog.mIsMoving\n  ){gDialog.mEle.style.left=(ev.screenX-gDialog.mStartPosX)+\"px\"\n   ;gDialog.mEle.style.top=(ev.screenY-gDialog.mStartPosY)+\"px\";}}\n ;if(gDialog.mVisible){gDialog.mVisible=false;gDialog.mEle.style.opacity=\"0.0\";gDialog.mEle.style.visibility=\"hidden\"\n ;}else               {gDialog.mVisible=true;gDialog.mEle.style.opacity=\"1.0\";gDialog.mEle.style.visibility=\"visible\";}\n ;if(slot!=null&&passType!=\"sound\"\n ){var texture=gShaderToy.GetTexture(slot)\n  ;if(texture!=null&&texture.mType==\"musicstream\")gDialog.mSoundCloudsURL.value=texture.mSrc\n  ;else          gDialog.mSoundCloudsURL.value=\"\";}}\n\n\n\nfunction openTab(evt,cityName //opens texture selector sub-taps\n//relies on gBrowserTextures.Load(), which is a function thats strange to me\n//it seems to be rtelated to buildInputsUI(overlay(cmpAssetBrowser()))\n//but the core of setting textures is in: EffectPass.prototype.NewTexture=function(wa,slot,url,buffers,keyboard){...\n){var i,tabcontent,tablinks\n ;tabcontent=document.getElementsByClassName(\"tabcontent\")\n ;for(i=0;i<tabcontent.length;i++){tabcontent[i].style.display=\"none\";}\n ;tablinks=document.getElementsByClassName(\"tablinks\")\n ;for(i=0;i<tablinks.length;i++){tablinks[i].className=tablinks[i].className.replace(\" active\",\"\");}\n ;gei(cityName).style.display=\"block\"\n ;evt.currentTarget.className+=\" active\"\n ;if(cityName==\"divTextures\"){gBrowserTextures.Load();}\n ;if(cityName==\"divCubemaps\"){gBrowserCubemaps.Load();}\n ;if(cityName==\"divVolumes\"){gBrowserVolumes.Load();}\n ;if(cityName==\"divVideos\"){gBrowserVideos.Load();}\n ;if(cityName==\"divMusic\"){gBrowserMusics.Load();}}\n\n//shadertoy fails in having 2 popins movagle at once.\n//it was like that from the start.\n//the help/ichanBinderMewnu was never supposed to be open at the same time as any other popin.\n//i managed to array one popin, but thats pretty useless, thonly [0] is movable, i am not sure why.\n\nvar Pop=[];\nfunction sPo(i\n){if(Pop[i]==null\n ){Pop[i]={}\n  ;var s=\"Po\"+i\n  ;Pop[i].mEle=gei(\"Po\"+i)\n  ;Pop[i].mHeader=gei(\"Ph\"+i)\n  ;Pop[i].mIsMoving=false\n  ;Pop[i].mStartPosX=0\n  ;Pop[i].mStartPosY=0\n  ;Pop[i].mHeader.onmousedown=function(e\n  ){Pop[i].mIsMoving=true;Pop[i].mStartPosX=e.screenX-Pop[i].mEle.offsetLeft;Pop[i].mStartPosY=e.screenY-Pop[i].mEle.offsetTop;}\n   ;Pop[i].mHeader.onmouseup=function(ev){Pop[i].mIsMoving=false;}\n   ;Pop[i].mVisible=false;}\n ;document.onmousemove=function(ev\n ){if(Pop[i]!=null&&Pop[i].mIsMoving\n  ){Pop[i].mEle.style.left=(ev.screenX-Pop[i].mStartPosX)+\"px\"\n   ;Pop[i].mEle.style.top=(ev.screenY-Pop[i].mStartPosY)+\"px\";}}\n ;if(Pop[i].mVisible){Pop[i].mVisible=false;Pop[i].mEle.style.opacity=\"0.0\";Pop[i].mEle.style.visibility=\"hidden\"\n ;}else              {Pop[i].mVisible=true ;Pop[i].mEle.style.opacity=\"1.0\";Pop[i].mEle.style.visibility=\"visible\";}}\n\n\n</script>\n\n<table bgcolor=#99F width=\"100%\"><tr><td>\n\n  <table bgcolor=#FF0 width=\"100%\"><tr>\n  <td><span id=\"myZoom\">z</span><span id=\"myRario\">a</span>\n  </tr><tr><td> \n  <span id=\"myResX\">x</span><span id=\"myResY\">y</span>\n  </tr></table>\n  \n <td>\n \n  <table bgcolor=#F0F width=\"100%\"><tr>\n  <td><input id=\"myZoom\" min=\"0\" max=\"90000\" onchange=\"setZoom(this.value/90000.0)\" \n  oninput=\"setZoom(this.value/90000.0)\" value=\"0\" type=\"range\"></input></tr><tr><td> \n  <button id=\"myFullScreen\" >fullscreen</button><span id=\"myVer\">hjghkj</span>\n  </tr></table>\n  \n <td> \n\n  <table bgcolor=#0FF width=\"100%\"><tr>\n  <td><input id=\"myRatio\" min=\"0\" max=\"90000\" onchange=\"setRatio(this.value/90000.0)\" \n  oninput=\"setRatio(this.value/90000.0)\" value=\"0\" type=\"range\"></input></tr><tr><td> \n  <button id=\"myRecord\">record</button><span id=\"myVerC\">\n  </tr></table>\n\n <td>\n \n  <table bgcolor=#FFF width=\"100%\"><td>\n  <input id=\"myVolS\" min=\"0\" max=\"90000\" onchange=\"setVol(this.value/90000.0)\" \n  oninput=\"setVol(this.value/90000.0)\" value=\"20000\" type=\"range\"></input>\n  <tr><td>   \n  <span><button id=\"myVolume\">0</button>\n  <span id=\"myVol\">100%</span></span></tr></table>\n   \n <td>\n\n  <table bgcolor=#FF0 width=\"100%\"><tr>\n  <td><input id=\"myTimeNow\" min=\"0\" max=\"90000\" onchange=\"setTime(this.value/90000.0)\" \n  oninput=\"setTime(this.value/90000.0)\" value=\"0\" type=\"range\"></input></tr><tr><td> \n  <button id=\"myResetButton\"><=</button><button id=\"myPauseButton\">p</button>\n  <span id=\"myTime\">0.00/</span><span id=\"myTimE\">0.00</span>\n  <span id=\"myFramerate\">0.5 fps</span>\n  </tr></table>\n<td></tr></table>\n\n</head><body onload=\"watchInit();\" onresize=\"watchResize()\">\n\n<div  id=\"Po0\" class=\"dialog\" style=\"left:30%;top:30%\">\n <div id=\"Ph0\" class=\"dialogHeader\"><button onclick\n      =\"sPo(0)\">close</button></div><div class=\"dialogContent\"></div></div>\n<div  id=\"Po1\" class=\"dialog\" style=\"left:30%;top:30%\">\n <div id=\"Ph1\" class=\"dialogHeader\"><button onclick\n      =\"sPo(1)\">close</button> </div><div class=\"dialogContent\"></div></div>\n\n<table style=\"width:100%\"><tbody><tr><td>\n <table><tbody><tr><td>\n  </tr> <tr>\n   <div id=\"passManager\"></div>\n  </tr><tr>\n   <button  onclick=\"sPo(0)\">shade</div><!--todo, put code text that is descriptive in these tabs; into, convention, help-->\n  </tr><tr>\n   <button id=\"myVR\">vr</button>   \n  </tr><tr>\n   <button onclick=\"soundCodeToggle()\">soundCodeToggle</button>\n  <div id=\"player\"><canvas id=\"demogl\" class=\"playerCanvas\" tabindex=\"0\"></canvas></div>\n </tr></td></tbody></table>\n\n\n<div>\n <table><tbody><td><tr>\n  </tr></td><td style=\"height 50%\"><tr>\n\n  <div id=\"textures\" style=\"visibility:hidden;\">\n\n                                       <div id=\"texture0\" \n         class=\"inputSelector\"><canvas id=\"myUnitCanvas0\" class=\"inputSelectorCanvas\" \n    width=\"110\" height=\"62\"></canvas><div id=\"mySampler0\" class=\"inputSampler\">\n<br>Filter<select class=\"inputForm\" id=\"mySamplerFilter0\" title=\"Pixel filtering mode\" \n                 onchange=\"gShaderToy.SetSamplerFilter(0,this.value);\"><option value=\"nearest\" selected=\"selected\">nearest</option><option value=\"linear\">linear</option><option value=\"mipmap\">mipmap</option></select><br>Wrap\n            <select class=\"inputForm\" id=\"mySamplerWrap0\" style=\"width:80px;\" title=\"Pixel filtering mode\" \n                   onchange=\"gShaderToy.SetSamplerWrap(0,this.value);\"><option value=\"clamp\" selected=\"selected\">clamp</option><option value=\"repeat\">repeat</option></select>\n                       <br><div id=\"mySamplerVFlipLabel0\"\n                 ><label>VFlip<input id=\"mySamplerVFlip0\" value=\"No\" \n                  onchange='gShaderToy.SetSamplerVFlip(0,(this.checked)?\"true\":\"false\");' type=\"checkbox\"></label></div></div>\n                         <div id=\"inputSelectorControls0\"\n      class=\"inputSelectorControls\"><div id=\"myUnitText0\" \n                     class=\"inputSelectorText\">iChannel0\n</div><img title=\"rewind\"            id=\"myRewindButton0\" class=\"uiButton\">\n      <img title=\"mute\"                id=\"myMuteButton0\" class=\"uiButton\">\n      <img title=\"sampler options\" id=\"mySamplingButton0\" class=\"uiButton\"></div></div>\n\n                                       <div id=\"texture1\" \n         class=\"inputSelector\"><canvas id=\"myUnitCanvas1\" class=\"inputSelectorCanvas\" \n    width=\"110\" height=\"62\"></canvas><div id=\"mySampler1\" class=\"inputSampler\">\n<br>Filter<select class=\"inputForm\" id=\"mySamplerFilter1\" title=\"Pixel filtering mode\" \n                 onchange=\"gShaderToy.SetSamplerFilter(1,this.value);\"><option value=\"nearest\" selected=\"selected\">nearest</option><option value=\"linear\">linear</option><option value=\"mipmap\">mipmap</option></select><br>Wrap\n            <select class=\"inputForm\" id=\"mySamplerWrap1\" style=\"width:80px;\" title=\"Pixel filtering mode\" \n                   onchange=\"gShaderToy.SetSamplerWrap(1,this.value);\"><option value=\"clamp\" selected=\"selected\">clamp</option><option value=\"repeat\">repeat</option></select>\n                       <br><div id=\"mySamplerVFlipLabel1\"\n                 ><label>VFlip<input id=\"mySamplerVFlip1\" value=\"No\" \n                  onchange='gShaderToy.SetSamplerVFlip(1,(this.checked)?\"true\":\"false\");' type=\"checkbox\"></label></div></div>\n                         <div id=\"inputSelectorControls1\"\n      class=\"inputSelectorControls\"><div id=\"myUnitText1\"\n                     class=\"inputSelectorText\">iChannel1\n</div><img title=\"pause/resume\"       id=\"myPauseButton1\" class=\"uiButton\">\n      <img title=\"rewind\"            id=\"myRewindButton1\" class=\"uiButton\">\n      <img title=\"mute\"                id=\"myMuteButton1\" class=\"uiButton\">\n      <img title=\"sampler options\" id=\"mySamplingButton1\" class=\"uiButton\"></div></div>\n  \n                                       <div id=\"texture2\" \n         class=\"inputSelector\"><canvas id=\"myUnitCanvas2\" class=\"inputSelectorCanvas\" \n    width=\"110\" height=\"62\"></canvas><div id=\"mySampler2\" class=\"inputSampler\">\n<br>Filter<select class=\"inputForm\" id=\"mySamplerFilter2\" title=\"Pixel filtering mode\" \n                 onchange=\"gShaderToy.SetSamplerFilter(2,this.value);\"><option value=\"nearest\" selected=\"selected\">nearest</option><option value=\"linear\">linear</option><option value=\"mipmap\">mipmap</option></select><br>Wrap\n            <select class=\"inputForm\" id=\"mySamplerWrap2\" style=\"width:80px;\" title=\"Pixel filtering mode\" \n                   onchange=\"gShaderToy.SetSamplerWrap(2,this.value);\"><option value=\"clamp\" selected=\"selected\">clamp</option><option value=\"repeat\">repeat</option></select>\n                       <br><div id=\"mySamplerVFlipLabel2\"\n                 ><label>VFlip<input id=\"mySamplerVFlip2\" value=\"No\" \n                  onchange='gShaderToy.SetSamplerVFlip(2,(this.checked)?\"true\":\"false\");' type=\"checkbox\"></label></div></div>\n                         <div id=\"inputSelectorControls2\"\n      class=\"inputSelectorControls\"><div id=\"myUnitText2\"\n                     class=\"inputSelectorText\">iChannel2\n</div><img title=\"pause/resume\"       id=\"myPauseButton2\" class=\"uiButton\">\n      <img title=\"rewind\"            id=\"myRewindButton2\" class=\"uiButton\">\n      <img title=\"mute\"                id=\"myMuteButton2\" class=\"uiButton\">\n      <img title=\"sampler options\" id=\"mySamplingButton2\" class=\"uiButton\"></div></div>\n      \n                                       <div id=\"texture3\" \n         class=\"inputSelector\"><canvas id=\"myUnitCanvas3\" class=\"inputSelectorCanvas\" \n    width=\"110\" height=\"62\"></canvas><div id=\"mySampler3\" class=\"inputSampler\">\n<br>Filter<select class=\"inputForm\" id=\"mySamplerFilter3\" title=\"Pixel filtering mode\" \n                 onchange=\"gShaderToy.SetSamplerFilter(3,this.value);\"><option value=\"nearest\" selected=\"selected\">nearest</option><option value=\"linear\">linear</option><option value=\"mipmap\">mipmap</option></select><br>Wrap\n            <select class=\"inputForm\" id=\"mySamplerWrap3\" style=\"width:80px;\" title=\"Pixel filtering mode\" \n                   onchange=\"gShaderToy.SetSamplerWrap(3,this.value);\"><option value=\"clamp\" selected=\"selected\">clamp</option><option value=\"repeat\">repeat</option></select>\n                       <br><div id=\"mySamplerVFlipLabel3\"\n                 ><label>VFlip<input id=\"mySamplerVFlip3\" value=\"No\" \n                  onchange='gShaderToy.SetSamplerVFlip(3,(this.checked)?\"true\":\"false\");' type=\"checkbox\"></label></div></div>\n                         <div id=\"inputSelectorControls3\"\n      class=\"inputSelectorControls\"><div id=\"myUnitText3\"\n                     class=\"inputSelectorText\">iChannel3\n</div><img title=\"pause/resume\"       id=\"myPauseButton3\" class=\"uiButton\">\n      <img title=\"rewind\"            id=\"myRewindButton3\" class=\"uiButton\">\n      <img title=\"mute\"                id=\"myMuteButton3\" class=\"uiButton\">\n      <img title=\"sampler options\" id=\"mySamplingButton3\" class=\"uiButton\"></div></div>\n      \n\n   </div>\n  </tr></td></tbody></table>\n  </div>\n </div>\n <div id=\"editor\"></div>\n</tr></td></tbody></table>\n \n\n<div id=\"pickTexture_image\" class=\"dialog\" style=\"left:30%;top:20%\">\n <div id=\"pickTextureHeader\" style=\"background-color:#f72\">\n  <table><tbody><tr><td>\n\n   </td></tr><tr><td>\n   <button onclick='overlay(null,\"image\")'>close</button>\n    <button class=\"tablinks active\" onclick=\"openTab(event,'divMisc')\">Misc</button>\n    <button class=\"tablinks\" onclick=\"openTab(event,'divTextures')\">Texture</button>\n    <button class=\"tablinks\" onclick=\"openTab(event,'divCubemaps')\">Cubemap</button>\n    <button class=\"tablinks\" onclick=\"openTab(event,'divVolumes')\">Volume</button>\n    <button class=\"tablinks\" onclick=\"openTab(event,'divVideos')\">Video</button>\n    <button class=\"tablinks\" onclick=\"openTab(event,'divMusic')\">Music</button>\n       </td><td>\n     <div id=\"pickTextureDialogTitle\"></div>\n     \n   </td></tr></tbody></table>\n  </div><div>\n    <div class=\"tabcontent\" id=\"divMisc\" style=\"display:block;\">\n   <table><tbody><tr><td>\n   \n    <div class=\"divAsset\"><table><tbody><tr><td>\n     <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:null,mID:-1,mSrc:null})\">\n    </td><td class=\"inputInfoColumn\">\n     <span class=\"spanName\">No Input</span>\n    </td></tr></tbody></table></div>\n    \n    </td><td><div class=\"divAsset\">\n    \n   <table><tbody><tr><td>\n    <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'keyboard',mID:'4dXGRr',mSrc:null,mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n     </td><td class=\"inputInfoColumn\">\n      <span class=\"spanName\">Keyboard</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n      <span class=\"spanDescription\">256 x 3<br>1 ch,int8</span></td></tr></tbody></table></div>\n    </td><td>\n     <div class=\"divAsset\">\n     <table><tbody><tr><td>\n      <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'webcam',mID:'4sf3zn',mSrc:'/media/a/32405eb234ec607dc883db7f5f354822fd453a79aca95107c01cfb140b4c9a2a.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n      </td><td class=\"inputInfoColumn\"><span class=\"spanName\">Webcam</span><br>by \n      <span class=\"spanUser\">shadertoy</span><br><br>\n      <span class=\"spanDescription\">1280 x 720<br>4 ch,int8,sRGB</span></td></tr></tbody></table>\n     </div>\n     \n    </td></tr><tr><td>\n    \n     <div class=\"divAsset\"><table><tbody><tr><td>\n      <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'mic',mID:'XdXGRr',mSrc:'/media/a/b0654e03c81a0764366c8370c57d2b7ef88f79c8fd7c15c5389bbbba750c94c5.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n      </td><td class=\"inputInfoColumn\">\n      <span class=\"spanName\">Microphone</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n      <span class=\"spanDescription\">512 x 2<br>1 ch,int8</span></td></tr></tbody></table>\n     \n    </div></td><td>\n    \n    <div class=\"divAsset\"><table><tbody><tr><td>\n    <img id=\"mySoundCloudButton\" class=\"inputThumbnail\" src=\"Wythoff%20explorer-Dateien/soundcloud.png\">\n    </td><td class=\"inputInfoColumn\">\n    <div style=\"position:absolute\">\n    <span class=\"spanName\">Soundcloud</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n    <span class=\"spanDescription\">512 x 2<br>1 ch,int8</span>\n    <div id=\"mySoundCloudURLBox\" class=\"mySoundCloudURLBox\"> Pick Soundcloud track:<br><br>\n    <input id=\"mySoundCloudURL\" class=\"mySoundCloudURL\" required=\"\" name=\"name2\" maxlength=\"255\" placeholder=\"Track URL\" type=\"text\">\n    </div>\n  </div>\n  \n  </td></tr></tbody></table>\n  </div></td><td><div class=\"divAsset\">\n   <table><tbody><tr><td style=\"vertical-align:top\">\n    <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'buffer',mID:'bufAid',mSrc:'/buffer00.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n    </td><td class=\"inputInfoColumn\">\n     <span class=\"spanName\">Buffer A</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n     <span class=\"spanDescription\">Viewport Resolution<br>4 ch,Float32,linear</span>\n    </td></tr></tbody></table></div>\n   </td></tr><tr><td>\n   <div class=\"divAsset\"><table><tbody><tr><td style=\"vertical-align:top\">\n   <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'buffer',mID:'bufBid',mSrc:'/buffer01.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n   </td><td class=\"inputInfoColumn\"><span class=\"spanName\">Buffer B</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n   <span class=\"spanDescription\">Viewport Resolution<br>4 ch,Float32,linear</span>\n   </td></tr></tbody></table></div>\n   </td><td>              \n   <div class=\"divAsset\"><table>\n    <tbody><tr><td style=\"vertical-align:top\">\n     <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'buffer',mID:'bufCid',mSrc:'/buffer02.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n     </td><td class=\"inputInfoColumn\">\n     <span class=\"spanName\">Buffer C</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n     <span class=\"spanDescription\">Viewport Resolution<br>4 ch,Float32,linear</span>\n     </td></tr></tbody></table></div>\n    </td><td>\n    <div class=\"divAsset\"><table><tbody>\n    <tr><td style=\"vertical-align:top\">\n    <img class=\"inputThumbnail\" onclick=\"gShaderToy.SetTexture(gCurrentEditingSlot,{mType:'buffer',mID:'bufDid',mSrc:'/buffer03.png',mSampler:{filter:'linear',wrap:'clamp',vflip:'true',srgb:'false',internal:'byte'}})\">\n    </td><td class=\"inputInfoColumn\">\n    <span class=\"spanName\">Buffer D</span><br>by <span class=\"spanUser\">shadertoy</span><br><br>\n    <span class=\"spanDescription\">Viewport Resolution<br>4 ch,Float32,linear</span>\n    </td></tr></tbody></table></div>\n     </td></tr></tbody></table>\n    </div>\n    <div class=\"tabcontent\" id=\"divTextures\"><table><tbody>\n  <tr><td><div class=\"divAsset\"\n         id=\"textureAsset0\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail0\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName0\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName0\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo0\"><br></span></td></tr></tbody></table></div>\n     </td><td><div class=\"divAsset\"\n         id=\"textureAsset1\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail1\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName1\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName1\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo1\"><br></span></td></tr></tbody></table></div>\n     </td><td><div class=\"divAsset\"\n         id=\"textureAsset2\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail2\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName2\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName2\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo2\"><br></span></td></tr></tbody></table></div>\n    </td></tr><tr><td><div class=\"divAsset\"\n         id=\"textureAsset3\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail3\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName3\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName3\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo3\"><br></span></td></tr></tbody></table></div>\n     </td><td><div class=\"divAsset\"\n         id=\"textureAsset4\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail4\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName4\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName4\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo4\"><br></span></td></tr></tbody></table></div>\n     </td><td>\n                           <div class=\"divAsset\"\n         id=\"textureAsset5\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail5\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName5\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName5\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo5\"><br></span></td></tr></tbody></table></div>\n     </td></tr><tr><td>\n                           <div class=\"divAsset\"\n         id=\"textureAsset6\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail6\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName6\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName6\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo6\"><br></span></td></tr></tbody></table></div>\n     </td><td>\n                           <div class=\"divAsset\"\n         id=\"textureAsset7\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail7\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName7\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName7\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo7\"><br></span></td></tr></tbody></table></div>\n     </td><td>\n                           <div class=\"divAsset\"\n         id=\"textureAsset8\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"textureAssetThumnail8\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"textureAssetName8\"></span><br>by<span class=\"spanUser\"\n      id=\"textureUserName8\"></span> <br><br><span class=\"spanDescription\"\n          id=\"textureInfo8\"><br></span></td></tr></tbody></table></div>\n      \n   </td></tr></tbody></table><br><br><div id=\"textureNav\" class=\"navigation\"></div></div>\n    \n    <div class=\"tabcontent\" id=\"divVideos\">\n     \n     <table><tbody><tr><td><div class=\"divAsset\" \n          id=\"videoAsset0\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n  id=\"videoAssetThumnail0\"></td><td class=\"inputInfoColumn\"> <span class=\"spanName\"\n      id=\"videoAssetName0\"></span><br>by  <span class=\"spanUser\" \n       id=\"videoUserName0\"></span><br><br><span class=\"spanDescription\" \n           id=\"videoInfo0\"><br></span></td></tr></tbody></table></div>\n     </td><td>           \n                          <div class=\"divAsset\"\n         id=\"videoAsset1\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail1\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName1\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName1\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo1\"><br></span></td></tr></tbody></table></div>\n     </td><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset2\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail2\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName2\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName2\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo2\"><br></span></td></tr></tbody></table></div>\n      </td></tr><tr><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset3\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail3\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName3\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName3\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo3\"><br></span></td></tr></tbody></table></div>\n      </td><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset4\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"videoAssetThumnail4\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName4\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName4\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo4\"><br></span></td></tr></tbody></table></div>\n      </td><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset5\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail5\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName5\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName5\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo5\"><br></span></td></tr></tbody></table></div>\n       </td></tr><tr><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset6\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail6\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName6\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName6\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo6\"><br></span></td></tr></tbody></table></div>\n       </td><td>\n                          <div class=\"divAsset\"\n         id=\"videoAsset7\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail7\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName7\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName7\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo7\"><br></span></td></tr></tbody></table></div>\n        </td><td>\n                         <div class=\"divAsset\"\n         id=\"videoAsset8\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"videoAssetThumnail8\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"videoAssetName8\"></span><br>by <span class=\"spanUser\"\n      id=\"videoUserName8\"></span><br><br><span class=\"spanDescription\"\n          id=\"videoInfo8\"><br></span></td></tr></tbody></table></div>\n         </td></tr>\n\n     </tbody></table><br><br><div id=\"videoNav\" class=\"navigation\"></div></div>\n  \n    <div class=\"tabcontent\" id=\"divCubemaps\">\n     <table><tbody><tr><td><div class=\"divAsset\" \n         id=\"cubemapAsset0\"><table><tbody><tr><td><img class=\"inputThumbnail\" \n id=\"cubemapAssetThumnail0\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName0\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName0\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo0\"><br></span></td></tr></tbody></table></div>\n      </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset1\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail1\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName1\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName1\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo1\"><br></span></td></tr></tbody></table></div>\n       </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset2\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail2\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName2\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName2\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo2\"><br></span></td></tr></tbody></table></div>\n       </td></tr><tr><td><div class=\"divAsset\"\n         id=\"cubemapAsset3\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail3\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName3\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName3\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo3\"><br></span></td></tr></tbody></table></div>\n       </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset4\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail4\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName4\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName4\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo4\"><br></span></td></tr></tbody></table></div>\n       </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset5\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail5\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName5\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName5\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo5\"><br></span></td></tr></tbody></table></div>\n       </td></tr><tr><td><div class=\"divAsset\"\n         id=\"cubemapAsset6\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail6\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName6\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName6\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo6\"><br></span></td></tr></tbody></table></div>\n       </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset7\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail7\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName7\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName7\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo7\"><br></span></td></tr></tbody></table></div>\n       </td><td><div class=\"divAsset\"\n         id=\"cubemapAsset8\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"cubemapAssetThumnail8\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"cubemapAssetName8\"></span><br>by <span class=\"spanUser\"\n      id=\"cubemapUserName8\"></span><br><br><span class=\"spanDescription\"\n          id=\"cubemapInfo8\"><br></span></td></tr></tbody></table></div>\n        </td></tr>\n\n </tbody></table><br><br><div id=\"cubemapNav\" class=\"navigation\"></div></div>\n       \n <div class=\"tabcontent\" id=\"divVolumes\">\n \n <table><tbody>\n <tr><td><div class=\"divAsset\"    \n         id=\"volumeAsset0\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail0\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName0\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName0\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo0\"><br></span></td></tr></tbody></table></div>\n </td><td><div class=\"divAsset\"\n         id=\"volumeAsset1\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail1\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName1\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName1\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo1\"><br></span></td></tr></tbody></table></div>\n </td><td><div class=\"divAsset\"\n         id=\"volumeAsset2\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail2\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName2\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName2\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo2\"><br></span></td></tr></tbody></table></div>\n </td></tr><tr><td><div class=\"divAsset\"\n         id=\"volumeAsset3\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail3\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName3\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName3\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo3\"><br></span></td></tr></tbody></table></div>\n </td><td><div class=\"divAsset\"\n         id=\"volumeAsset4\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail4\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName4\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName4\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo4\"><br></span></td></tr></tbody></table></div>\n </td><td><div class=\"divAsset\"\n         id=\"volumeAsset5\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail5\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName5\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName5\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo5\"><br></span></td></tr></tbody></table></div>\n </td></tr><tr><td><div class=\"divAsset\"\n         id=\"volumeAsset6\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail6\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName6\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName6\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo6\"><br></span></td></tr></tbody></table></div></td><td>\n                           <div class=\"divAsset\"\n         id=\"volumeAsset7\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail7\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName7\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName7\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo7\"><br></span></td></tr></tbody></table></div></td><td>\n                           <div class=\"divAsset\"\n         id=\"volumeAsset8\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"volumeAssetThumnail8\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"volumeAssetName8\"></span><br>by <span class=\"spanUser\"\n      id=\"volumeUserName8\"></span><br><br><span class=\"spanDescription\"\n          id=\"volumeInfo8\"><br></span></td></tr></tbody></table></div>\n      </td></tr>\n     </tbody></table><br><br><div id=\"volumeNav\" class=\"navigation\"></div></div>\n      \n    <div class=\"tabcontent\" id=\"divMusic\"><table><tbody><tr><td>\n    \n <div class=\"divAsset\" \n         id=\"musicAsset0\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail0\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName0\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName0\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo0\"><br></span></td></tr></tbody></table></div></td><td>\n <div class=\"divAsset\" \n         id=\"musicAsset1\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail1\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName1\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName1\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo1\"><br></span></td></tr></tbody></table></div></td><td>\n <div class=\"divAsset\"   \n         id=\"musicAsset2\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail2\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName2\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName2\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo2\"><br></span></td></tr></tbody></table></div></td></tr><tr><td>\n <div class=\"divAsset\" \n         id=\"musicAsset3\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail3\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName3\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName3\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo3\"><br></span></td></tr></tbody></table></div></td><td>\n    <div class=\"divAsset\" \n         id=\"musicAsset4\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail4\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName4\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName4\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo4\"><br></span></td></tr></tbody></table></div></td><td>\n <div class=\"divAsset\"\n         id=\"musicAsset5\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail5\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName5\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName5\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo5\"><br></span></td></tr></tbody></table></div></td></tr><tr><td>\n <div class=\"divAsset\"\n         id=\"musicAsset6\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n  d=\"musicAssetThumnail6\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName6\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName6\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo6\"><br></span></td></tr></tbody></table></div></td><td>  \n <div class=\"divAsset\"\n         id=\"musicAsset7\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail7\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName7\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName7\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo7\"><br></span></td></tr></tbody></table></div></td><td>   \n <div class=\"divAsset\"\n         id=\"musicAsset8\"><table><tbody><tr><td><img class=\"inputThumbnail\"\n id=\"musicAssetThumnail8\"></td><td class=\"inputInfoColumn\"><span class=\"spanName\"\n     id=\"musicAssetName8\"></span><br>by <span class=\"spanUser\"\n      id=\"musicUserName8\"></span><br><br><span class=\"spanDescription\"\n          id=\"musicInfo8\"><br></span></td></tr></tbody></table></div></td></tr></tbody></table><br><br>\n   <div id=\"musicNav\" class=\"navigation\"></div></div>\n  </div>\n </div>\n</div>\n</body></html>\n\n\n\n\n//remove this line from the html documentm and the very first line of it /**/",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            }
        ],
        "ver": "0.1"
    }
}