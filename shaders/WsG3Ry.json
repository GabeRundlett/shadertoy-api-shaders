{
    "Shader": {
        "info": {
            "date": "1570421433",
            "description": "Now I am craving some corn",
            "flags": 0,
            "hasliked": 0,
            "id": "WsG3Ry",
            "likes": 14,
            "name": "Shadertober 06b - Husky",
            "published": 3,
            "tags": [
                "corn",
                "inktober",
                "shadertober",
                "husky",
                "backwardscaptain",
                "cineshader"
            ],
            "usePreview": 0,
            "username": "BackwardsCap",
            "viewed": 27164
        },
        "renderpass": [
            {
                "code": "#define MAX_DIST 50.0\n#define PI 3.1415927\n\n//as always, thanks to IQ for sharing this knowledge :)\n\nvec2 rotate(vec2 a, float d){\n    float s  = sin(d);\n    float c = cos(d);\n    \n    return vec2(\n        a.x*c-a.y*s,\n        a.x*s+a.y*c);\n}\n\n\nfloat box(vec3 p, vec3 b)\n{\n    vec3 d = abs(p)-b;\n    return length(max(d,0.0));\n}\n\nfloat husk(vec3 bp, vec3 p)\n{\n    \n    return box(bp-vec3(0.,-2.,-4),vec3(10,3.+cos(p.x+p.z+p.y)/4.+bp.x/2.,.1));\n}\n\n\nvec2 map(vec3 p)\n{\n    p.x-=.5;\n    vec3 bp = p+vec3(-4.,0.,0);\n    \n    bp.yz=rotate(bp.yz,PI*iTime/2.);\n    \n    bp.x+=((bp.y*bp.y)+(bp.z*bp.z))/8.;\n    float b = box(bp,vec3(.1,2,2));\n    \n    bp.yz=rotate(bp.yz,PI/4.);\n    \n    b = min(b,box(bp,vec3(.1,2,2)));\n    \n    \n    float stem = box(bp+vec3(.5,0,0),vec3(1.,.5,.5));\n    \n    vec2 st = vec2(atan(p.z,p.y), length(p));\n    \n    float x = clamp(.5+(p.x+4.5)/10.,0.0,1.0);\n    float c=length(p/vec3(2.5-p.x/10.,1.,1.))-2.+(smoothstep(1.,-1.,abs(cos(iTime*10.+p.x*10.+.6)))/10.*x)+\n        (smoothstep(1.,-1.,abs(cos(st.x*10.)))/10.)*x;\n    \n    float r=min(c,b);\n    r=min(r,stem);\n    \n    float m=0.0;\n\n    if(r==c)m=1.;\n    else if(r==b||r==stem)m=2.;\n    \n    \n    return vec2(r,m);\n}\n\nvec3 normal(vec3 p)\n{\n    vec2 e = vec2(0.0001,0.);\n    return normalize(vec3(\n        map(p+e.xyy).x-map(p-e.xyy).x,\n        map(p+e.yxy).x-map(p-e.yxy).x,\n        map(p+e.yyx).x-map(p-e.yyx).x\n    ));\n    \n}\n\nvec2 ray(vec3 ro, vec3 rd)\n{\n    float t =0.0;\n    float m = 0.0;\n    \n    for(int i=0;i<128;i++)\n    {\n        \n        vec3 p=ro+rd*t;\n        vec2 h=map(p);\n        m=h.y;\n        if(h.x<0.00001)break;\n        t+=h.x;\n        if(t>MAX_DIST)break;\n    }\n    \n    if(t>MAX_DIST)t=-1.;\n    \n    return vec2(t,m);\n}\n \nvec3 color(vec3 p, vec3 n, vec2 t)\n{\n    vec3 c = vec3(0.);\n    vec3 mate = vec3(1.32,1,0);\n    if(t.y>1.5)\n    {\n        mate=vec3(0.,.125,0.);\n    }\n    vec3 sun=normalize(vec3(0.2,0.5,-0.5));\n    float dif=clamp(dot(n,sun),0.0,1.0);\n    float sha = step(ray(p+n*.001,sun).x,0.0);\n    float sky = clamp(0.5+0.5*dot(n,vec3(0,1,0)),0.,1.);\n    float bou = clamp(0.5+0.5*dot(n,vec3(0,1,0)),0.,1.);\n    \n    c=mate*vec3(0.5,0.6,0.5)*dif*sha;\n    c+=mate*vec3(0.2,0.3,.8)*sky;\n    c+=mate*vec3(0.2,0.1,0.1)*bou;\n    \n    return c;\n}\n\nvec3 render(vec3 ro, vec3 rd)\n{    \n    vec2 st = vec2(atan(rd.y,rd.x), length(ro));\n        \n\tvec3 c = vec3(0.,.1,0.)*(.5+smoothstep(-0.,1.,cos(st.x*40.+iTime*3.)));\n    \n    vec2 t = ray(ro,rd);\n\n    if(t.x>0.)\n    {\n        vec3 p = ro+rd*t.x;\n        vec3 n=normal(p);\n        \n        c=color(p,n,t);\n        \n    }\n   \tc=pow(c,vec3(0.454545));\n    \n    return c;\n}\n    \n\nvoid mainImage( out vec4 c, in vec2 f )\n{\n    vec2 uv = (2.*f-iResolution.xy)/iResolution.y;\n\n    float d = 10.;\n    vec3 ro = vec3(sin(PI)*d,0,cos(PI)*d);\n    vec3 ta = vec3(0.,0,0.);\n    vec3 camF =\tnormalize(ta-ro);\n    vec3 camU = normalize(cross(camF,vec3(0,1,0)));\n    vec3 camR = normalize(cross(camU,camF));\n    \n    vec3 rd = normalize(uv.x*camU+uv.y*camR+2.*camF);\n    \n    c.rgb=render(ro,rd);\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}