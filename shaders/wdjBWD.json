{
    "Shader": {
        "info": {
            "date": "1590169338",
            "description": "Worley noise",
            "flags": 0,
            "hasliked": 0,
            "id": "wdjBWD",
            "likes": 1,
            "name": "WorleyNoise2D",
            "published": 3,
            "tags": [
                "noise"
            ],
            "usePreview": 0,
            "username": "im_sky",
            "viewed": 324
        },
        "renderpass": [
            {
                "code": "#define PI 3.14159265359\n\n#define Interpolation 1\n#define CosineCurve 0\n#define PerlinSmoothCurve 1\n\nvec2 dirs[8] = vec2[]\n(\n    vec2(1, 0),                                                                                                                                                                                                                                       \n    vec2(0, 1),                                                                                                                                                                                                                                       \n    vec2(1, 0),                                                                                                                                                                                                                                      \n    vec2(0, 1),                                                                                                                                                                                                                                      \n    vec2(0.70711, 0.70711),                                                                                                                                                                                                                           \n    vec2(0.70711, 0.70711),                                                                                                                                                                                                                          \n    vec2(0.70711, 0.70711),                                                                                                                                                                                                                         \n    vec2(0.70711, 0.70711)\n);\n\nconst int tableSize = 512;\nconst int permutationMask = 512/2 - 1;\nconst int permutationTable[512] = int[]\n(                                                                                                                                                                                                                                          \n    180, 3, 121, 17, 22, 7, 69, 202, 72, 172,                                                                                                                                                                                                         \n    56, 94, 92, 254, 122, 139, 118, 127, 76, 2,                                                                                                                                                                                                       \n    46, 74, 169, 147, 228, 196, 47, 110, 138, 217,                                                                                                                                                                                                    \n    155, 39, 91, 61, 45, 238, 242, 229, 251, 207,                                                                                                                                                                                                     \n    192, 198, 175, 222, 176, 75, 234, 10, 25, 63,                                                                                                                                                                                                     \n    250, 135, 159, 183, 253, 96, 68, 153, 87, 50,                                                                                                                                                                                                     \n    226, 241, 114, 188, 13, 112, 21, 66, 249, 144,                                                                                                                                                                                                    \n    126, 1, 233, 124, 148, 43, 199, 156, 208, 223,                                                                                                                                                                                                    \n    164, 213, 18, 219, 59, 209, 108, 134, 27, 100,                                                                                                                                                                                                    \n    197, 90, 53, 140, 168, 29, 165, 19, 65, 161,                                                                                                                                                                                                      \n    141, 52, 195, 128, 151, 37, 117, 150, 36, 105,                                                                                                                                                                                                    \n    49, 6, 187, 116, 235, 216, 201, 119, 182, 204,                                                                                                                                                                                                    \n    221, 136, 0, 113, 24, 111, 158, 131, 212, 58,                                                                                                                                                                                                     \n    41, 85, 102, 166, 77, 157, 64, 103, 184, 83,                                                                                                                                                                                                      \n    237, 220, 23, 149, 84, 171, 99, 230, 152, 178,                                                                                                                                                                                                    \n    190, 215, 38, 34, 163, 93, 14, 244, 79, 31,                                                                                                                                                                                                       \n    9, 142, 240, 132, 145, 231, 95, 236, 8, 167,                                                                                                                                                                                                      \n    82, 80, 133, 137, 252, 211, 57, 248, 89, 20,                                                                                                                                                                                                      \n    30, 154, 32, 174, 205, 42, 98, 11, 15, 243,                                                                                                                                                                                                       \n    78, 203, 146, 185, 107, 51, 224, 54, 70, 106,                                                                                                                                                                                                     \n    194, 35, 177, 160, 255, 16, 104, 189, 12, 67,                                                                                                                                                                                                     \n    125, 33, 123, 55, 120, 186, 40, 143, 181, 239,                                                                                                                                                                                                    \n    193, 214, 115, 81, 4, 44, 200, 101, 206, 71,                                                                                                                                                                                                      \n    73, 28, 86, 130, 48, 225, 210, 227, 245, 109,                                                                                                                                                                                                     \n    232, 162, 129, 179, 218, 88, 247, 173, 191, 97,                                                                                                                                                                                                   \n    62, 60, 246, 5, 26, 170,\n    180, 3, 121, 17, 22, 7, 69, 202, 72, 172,                                                                                                                                                                                                         \n    56, 94, 92, 254, 122, 139, 118, 127, 76, 2,                                                                                                                                                                                                       \n    46, 74, 169, 147, 228, 196, 47, 110, 138, 217,                                                                                                                                                                                                    \n    155, 39, 91, 61, 45, 238, 242, 229, 251, 207,                                                                                                                                                                                                     \n    192, 198, 175, 222, 176, 75, 234, 10, 25, 63,                                                                                                                                                                                                     \n    250, 135, 159, 183, 253, 96, 68, 153, 87, 50,                                                                                                                                                                                                     \n    226, 241, 114, 188, 13, 112, 21, 66, 249, 144,                                                                                                                                                                                                    \n    126, 1, 233, 124, 148, 43, 199, 156, 208, 223,                                                                                                                                                                                                    \n    164, 213, 18, 219, 59, 209, 108, 134, 27, 100,                                                                                                                                                                                                    \n    197, 90, 53, 140, 168, 29, 165, 19, 65, 161,                                                                                                                                                                                                      \n    141, 52, 195, 128, 151, 37, 117, 150, 36, 105,                                                                                                                                                                                                    \n    49, 6, 187, 116, 235, 216, 201, 119, 182, 204,                                                                                                                                                                                                    \n    221, 136, 0, 113, 24, 111, 158, 131, 212, 58,                                                                                                                                                                                                     \n    41, 85, 102, 166, 77, 157, 64, 103, 184, 83,                                                                                                                                                                                                      \n    237, 220, 23, 149, 84, 171, 99, 230, 152, 178,                                                                                                                                                                                                    \n    190, 215, 38, 34, 163, 93, 14, 244, 79, 31,                                                                                                                                                                                                       \n    9, 142, 240, 132, 145, 231, 95, 236, 8, 167,                                                                                                                                                                                                      \n    82, 80, 133, 137, 252, 211, 57, 248, 89, 20,                                                                                                                                                                                                      \n    30, 154, 32, 174, 205, 42, 98, 11, 15, 243,                                                                                                                                                                                                       \n    78, 203, 146, 185, 107, 51, 224, 54, 70, 106,                                                                                                                                                                                                     \n    194, 35, 177, 160, 255, 16, 104, 189, 12, 67,                                                                                                                                                                                                     \n    125, 33, 123, 55, 120, 186, 40, 143, 181, 239,                                                                                                                                                                                                    \n    193, 214, 115, 81, 4, 44, 200, 101, 206, 71,                                                                                                                                                                                                      \n    73, 28, 86, 130, 48, 225, 210, 227, 245, 109,                                                                                                                                                                                                     \n    232, 162, 129, 179, 218, 88, 247, 173, 191, 97,                                                                                                                                                                                                   \n    62, 60, 246, 5, 26, 170\n);\n\nint Hash(vec2 x)\n{\n    return permutationTable[permutationTable[int(x.x) & permutationMask] + int(x.y) & permutationMask];\n}\n\nfloat SmoothCurve(float t)\n{\n#if CosineCurve\n    return (1.0 - cos(t * PI)) * 0.5;\n#elif PerlinSmoothCurve\n    return t * t * (3.0 - 2.0 * t);\n#else\n    return t;\n#endif\n}\n\nfloat GetIntegerNoise(vec2 p)  // replace this by something better, p is essentially ivec2\n{\n    p  = 53.7 * fract( (p*0.3183099) + vec2(0.71,0.113));\n    return fract( p.x*p.y*(p.x+p.y) );\n}\n\nvec2 GetGradient(vec2 x)\n{\n    return dirs[Hash(x) & 7];\n}\n\n//https://thebookofshaders.com/12/\nvec2 Random2D( vec2 p ) {\n    return fract(sin(vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3))))*43758.5453);\n}\n\nvec2 Rotate2D(vec2 v, float theta)\n{\n    float c = cos(theta);\n    float s = sin(theta);\n    \n    mat2 rotMat = mat2(c,s,-s,c);\n    return rotMat * v;\n}\n\n\nfloat GetWorleyNoise(vec2 uv)\n{\n    float noise = 0.0;\n    \n    vec2 p = floor(uv);\n    vec2 f = fract(uv);\n    \n    float minDist = 99.0;\n    for(int x = -1; x <=1; ++x)\n    {\n        for(int y = -1; y <=1; ++y)\n        {\n            vec2 point = p + vec2(x, y);\n            \n            vec2 g;\n            vec2 v;\n\n            v = Random2D(point);\n            //v = (v + 1.0) * 0.5;\n            \n            //v = Rotate2D(v * 0.25, GetIntegerNoise(v) * iTime * 10.0 * PI);\n            //v = vec2(cos(v.x * iTime *PI), sin(v.x * iTime * PI)) * 0.25;\n\n\n            float d = distance(point + v, uv);\n            minDist = min(minDist, d);\n        }\n    }\n\n    return 1.0-minDist;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (2.0 * fragCoord - iResolution.xy) / iResolution.y;\n    uv *= 2.0;\n    //uv *= 0.5*(sin(iTime * 2.0) + 5.0) * 2.40;\n\n\tfloat noise = GetWorleyNoise(uv);\n    //noise *= GetWorleyNoise(uv * 9.0) * 1.2;\n\t//isolines\n    //noise = step(0.5, abs(sin(40.0 * noise)));\n\n\tnoise = pow(noise, 1.6);\n    vec3 color = noise * vec3(0.6, 0.15, 0.15);\n    \n    fragColor = vec4(color, 1.0);\n}\n\n",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}