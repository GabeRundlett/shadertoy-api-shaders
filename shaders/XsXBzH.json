{
    "Shader": {
        "info": {
            "date": "1494759485",
            "description": "playing with the concept of \"laplacian\" noise by nimitz [url]https://www.shadertoy.com/view/MtKSWW[/url] (indeed, div(normalize(grad(noise)) )\nusing analytical gradient noise of iq [url]https://www.shadertoy.com/view/XdXBRH[/url]\n+ flownoise\n",
            "flags": 0,
            "hasliked": 0,
            "id": "XsXBzH",
            "likes": 63,
            "name": "laplacian+flow noise",
            "published": 3,
            "tags": [
                "procedural",
                "noise",
                "fbm",
                "gradient",
                "analytic",
                "laplacian",
                "divergence"
            ],
            "usePreview": 0,
            "username": "FabriceNeyret2",
            "viewed": 2285
        },
        "renderpass": [
            {
                "code": "// --- div(normalize(grad(noise)) idea from nimitz https://www.shadertoy.com/view/MtKSWW\n// --- base gradient noise + derivative from iq https://www.shadertoy.com/view/XdXBRH\n// --- plus flownoise\n\nfloat T = 0.;\nvec2 hash( in vec2 x ) \n{\n    float t = T  * sign(mod(x.x+x.y,2.)-.5), // optional checker swirls\n          c = cos(t), s=sin(t);\n    const vec2 k = vec2( 0.3183099, 0.3678794 );\n    x = x*k + k.yx;\n    x =  -1. + 2.*fract( 16. * k*fract( x.x*x.y*(x.x+x.y)) );\n    return x * mat2(c,-s,s,c); // flownoise\n // return vec2(cos(t+3.1416*x.x), s = sin(t+3.1416*x.x)); // iq variant\n}\n\n\n// return gradient noise (in x) and its derivatives (in yz)\nvec3 noised( in vec2 p )\n{\n    vec2 i = floor( p ),\n         f = fract( p );\n\n#if 1 // quintic interpolation\n    vec2 u = f*f*f*(f*(f*6.-15.)+10.),\n        du = 30.*f*f*(f*(f-2.)+1.);\n#else // cubic interpolation\n    vec2 u = f*f*(3.-2.*f),\n        du = 6.*f*(1.-f);\n#endif    \n    \n    vec2 ga = hash( i + vec2(0,0) ),\n         gb = hash( i + vec2(1,0) ),\n         gc = hash( i + vec2(0,1) ),\n         gd = hash( i + vec2(1,1) );\n    \n    float va = dot( ga, f - vec2(0,0) ),\n          vb = dot( gb, f - vec2(1,0) ),\n          vc = dot( gc, f - vec2(0,1) ),\n          vd = dot( gd, f - vec2(1,1) );\n\n    return vec3( va + u.x*(vb-va) + u.y*(vc-va) + u.x*u.y*(va-vb-vc+vd),   // value\n                 ga + u.x*(gb-ga) + u.y*(gc-ga) + u.x*u.y*(ga-gb-gc+gd) +  // derivatives\n                 du * (u.yx*(va-vb-vc+vd) + vec2(vb,vc) - va));\n}\n\n// -----------------------------------------------\n\n// normalize(grad(noise)) . div of it is nimitz pseudoLaplace noise\n#define N(i,j)  normalize ( noised( s*(p+.5*vec2(i,j))/64. ).yz) // x:noise yz: gradient   \n \n/**/  // using finite differences\nvoid mainImage( out vec4 O,  vec2 p )\n{\n    O -= O; \n    float s = 1.; vec4 C = vec4(1.,.9,.8,0);\n    for (int i=0; i<4; i++) {\n        // vec2 n = N(0,0);\n        T = iTime; // * s;      // optional *s\n        float d = N(1,0).x - N(-1,0).x + N(0,1).y - N(0,-1).y; // div(N)\n \n        O +=  max(0., d ) *C / s;    // optional / s\n     // O +=  max(d*vec4(-1,0,1,0), 0. ) / s;\n     // O.b += .1*(.5-.5*noised( s*p/64. ).x )/ s; // blue glow around filaments\n     // O.b += .1*(.5+.5*noised( s*p/64. ).x )/ s; // blue glow between filaments\n     // O   += .4*noised( s*p/64. ).x/ s *vec4(-1,0,1,0); // blue/red glow mix\n     // O.b += .1*length( noised( s*p/64.).yz)/ s; // blue strips between filaments\n        s *= 2.; C *= C;\n    \n    }\n    O *= 4.;\n // O = vec4(v*4.);\n // O = v*4.* vec4(1,0,-1,0);\n}\n/**/\n\n\n\n\n/**  // using hardware derivatives\n\nvoid mainImage( out vec4 O,  vec2 p )\n{\n    vec3 n;\n    \n    float s = 1., v=0.;\n    for (int i=0; i<3; i++) {\n        n = noised( s*p/64. );                    // x:noise yz: gradient\n        n .yz = normalize(n.yz);\n        v +=  max(0., dFdx(n.y)+dFdy(n.z) ) / s;  //  dFdx(n.y)+dFdy(n.z) is div(n.yz)\n        s *= 2.;\n    \n    }\n   O = vec4(v*4.);\n //O = v*4.* vec4(1,0,-1,0);\n}\n/**/",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}