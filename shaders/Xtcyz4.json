{
    "Shader": {
        "info": {
            "date": "1531672478",
            "description": "Sunbeams in the forest",
            "flags": 0,
            "hasliked": 0,
            "id": "Xtcyz4",
            "likes": 14,
            "name": "Forest Clearing",
            "published": 3,
            "tags": [
                "volumetrics"
            ],
            "usePreview": 0,
            "username": "_polymath",
            "viewed": 981
        },
        "renderpass": [
            {
                "code": "#define FLOOR 0.4\n\nvec4 light(vec3 p) {\n    vec2 u = p.xz,\n        xy = u * 0.1 + p.y * 0.04;\n    \n    return \n        texture(iChannel1, xy * 1.1 + iTime * 0.017 + 0.7).r\n        * texture(iChannel1, xy * -1.0 + iTime * 0.037 + 0.4).r\n        * texture(iChannel1, xy * 0.62 + iTime * 0.027).r\n        * min(1.  / dot(u, u), 1.)*.4\n        * vec4(.6, .56, .5, .0) ;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalised UV, centred on 0,0\n    vec2 uv = (fragCoord - iResolution.xy * 0.5) / iResolution.y;\n    // Mouselook up/down\n    if (iMouse.z > 0.)\n        uv.y += 0.5 - iMouse.y / iResolution.y;\n    // Standard ray vector\n    vec3 ray = normalize(vec3(uv, 1.));\n\n    // Rotate ray by time or mouse x coord\n    if (iMouse.z > 0.) {\n    \tfloat xy = iMouse.x * 3. / iResolution.x,\n            s = sin(xy), c = cos(xy);\n    \tray.xz *= mat2(s, c, -c, s);\n    } else {\n    \tfloat t = iTime * .1, s = sin(t), c = cos(t);\n    \tray.xz *= mat2(s, c, -c, s);\n    }\n\n  \t// base layer: forest cubemap\n    fragColor = texture(iChannel0, ray) * 0.6;\n    \n    // floor shading\n    if (ray.y < 0.) {\n        vec3 p = ray / (ray.y / FLOOR);\n        fragColor += light(p) * 20.;\n    }\n    \n    // sunbeams\n    for (float d = 2.; d >= .8; d -= .01) {\n      \tvec3 p = ray * d;\n        if (p.y > -FLOOR)\n            fragColor += light(p) * .38;\n    }\n    \n    // good practice\n    fragColor.a = 1.;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "cubemap",
                        "id": 26,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/94284d43be78f00eb6b298e6d78656a1b34e2b91b34940d02f1ca8b22310e8a0.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "texture",
                        "id": 47,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/ad56fba948dfba9ae698198c109e71f118a54d209c0ea50d77ea546abad89c57.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}