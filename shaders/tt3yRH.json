{
    "Shader": {
        "info": {
            "date": "1608492850",
            "description": "A recreation of the first footprint on the Moon, made by Neil Armstrong in 1969.  Amazing to think it's still there.\n\nCode coming in at under 2.4Kb.",
            "flags": 64,
            "hasliked": 0,
            "id": "tt3yRH",
            "likes": 56,
            "name": "One small step (2.4Kb)",
            "published": 3,
            "tags": [
                "3d",
                "raymarching",
                "space",
                "moon",
                "apollo",
                "reproduction",
                "cineshader"
            ],
            "usePreview": 0,
            "username": "dean_the_coder",
            "viewed": 14608
        },
        "renderpass": [
            {
                "code": "// 'One small step' dean_the_coder (Twitter: @deanthecoder)\n// https://www.shadertoy.com/view/tt3yRH\n//\n// A recreation of the first footprint on the Moon, made by Neil Armstrong in 1969.\n// Amazing to think it's still there.\n//\n// Code coming in at under 2.4Kb.\n//\n// Thanks to Evvvvil, Flopine, Nusan, BigWings, Iq, Shane\n// and a bunch of others for sharing their knowledge!\n\n#define R\tiResolution\n#define N\tnormalize\n\nfloat n31(vec3 p) {\n\tvec3 s = vec3(7, 157, 113), ip = floor(p);\n\tp = fract(p);\n\tp = p * p * (3. - 2. * p);\n\tvec4 h = vec4(0, s.yz, 270) + dot(ip, s);\n\th = mix(fract(sin(h) * 43.5453), fract(sin(h + s.x) * 43.5453), p.x);\n\th.xy = mix(h.xz, h.yw, p.y);\n\treturn mix(h.x, h.y, p.z);\n}\n\nmat2 rot(float a) {\n\tfloat c = cos(a),\n\t      s = sin(a);\n\treturn mat2(c, s, -s, c);\n}\n\nfloat box(vec3 p, vec3 b) {\n\tvec3 q = abs(p) - b;\n\treturn length(max(q, 0.)) + min(max(q.x, max(q.y, q.z)), 0.);\n}\n\nfloat map(vec3 p) {\n\tfloat r, k, t, h,\n\t      bmp = (n31(p) + n31(p * 2.12) * .5 + n31(p * 4.42) * .25 + n31(p * 8.54) * .125 + n31(p * 16.32) * .062 + n31(p * 32.98) * .031 + n31(p * 63.52) * .0156) * .5 * (.5 + 2. * exp(-pow(length(p.xz - vec2(.5, 2.2)), 2.) * .26)),\n\t      a = p.y - .27 - bmp,\n\t      b = (bmp * bmp * .5 - .5) * .12;\n\tp.xy = -p.xy;\n\tp.x /= .95 - cos((p.z + 1.2 - sign(p.x)) * .8) * .1;\n\tvec3 tp = p;\n\ttp.z = mod(tp.z - .5, .4) - .2;\n\tt = max(box(tp, vec3(2, .16, .12 + tp.y * .25)), box(p - vec3(0, 0, 1.1), vec3(2, .16, 1.7)));\n\ttp = p;\n\ttp.x = abs(p.x) - 1.65;\n\ttp.z -= 1.1;\n\tt = min(t, box(tp, vec3(.53 - .12 * tp.z, .16, 1.6)));\n\tp.z /= cos(p.z * .1);\n\tvec2 q = p.xz;\n\tq.x = abs(q.x);\n\tk = q.x * .12 + q.y;\n\tif (k < 0.) r = length(q) - 1.2;\n\telse if (k > 2.48) r = length(q - vec2(0, 2.5)) - 1.5;\n\telse r = dot(q, vec2(.99, -.12)) - 1.2;\n\n\tb -= max(max(r, p.y), -t);\n\th = clamp(.5 + .5 * (b - a) / -.8, 0., 1.);\n\treturn mix(b, a, h) + .8 * h * (1. - h);\n}\n\nvec3 NM(vec3 p, float t) {\n\tvec3 n = vec3(0), e;\n\tfor (int i = min(iFrame, 0); i < 4; i++) {\n\t\te = .5773 * (2. * vec3(((i + 3) >> 1) & 1, (i >> 1) & 1, i & 1) - 1.);\n\t\tn += e * map(p + .005 * t * e);\n\t}\n\n\treturn N(n);\n}\n\nfloat ao(vec3 p, vec3 n, float h) { return map(p + h * n) / h; }\n\nvec3 lights(vec3 p, vec3 rd, float d) {\n\tvec3 ld = N(vec3(6, 3, -10) - p),\n\t     n = NM(p, d) + n31(p * 79.0625) * .25 - .25;\n\tfloat ao = .1 + .9 * dot(vec3(ao(p, n, .1), ao(p, n, .4), ao(p, n, 2.)), vec3(.2, .3, .5)),\n\t      l1 = max(0., .1 + .9 * dot(ld, n)),\n\t      l2 = max(0., .1 + .9 * dot(ld * vec3(-1, 0, -1), n)) * .2,\n\t      spe = max(0., dot(rd, reflect(ld, n))) * .1,\n\t      fre = smoothstep(.7, 1., 1. + dot(rd, n)),\n\t      s = 1.,\n\t      t = .1;\n\tfor (float i = 0.; i < 30.; i++) {\n\t\tfloat h = map(p + ld * t);\n\t\ts = min(s, 15. * h / t);\n\t\tt += h;\n\t\tif (s < .001) break;\n\t}\n\n\tl1 *= .1 + .9 * clamp(s, 0., 1.);\n\treturn mix(.3, .4, fre) * ((l1 + l2) * ao + spe) * vec3(2, 1.8, 1.7);\n}\n\nfloat d = 0.;\nvec3 march(vec3 ro, vec3 rd) {\n\tvec3 p;\n\td = .01;\n\tfor (float i = 0.; i < 96.; i++) {\n\t\tp = ro + rd * d;\n\t\tfloat h = map(p);\n\t\tif (abs(h) < .0015) break;\n\t\td += h;\n\t}\n\n\treturn lights(p, rd, d) * exp(-d * .14);\n}\n\nvoid mainImage(out vec4 fragColor, vec2 fc) {\n\tfloat t = mod(iTime * .2, 30.);\n\tvec2 q = fc / R.xy,\n\t     uv = (fc - .5 * R.xy) / R.y;\n\tvec3 c, f, r,\n\t     ro = vec3(0, .2, -4);\n\tro.yz *= rot(-sin(t * .3) * .1 - .6);\n\tro.xz *= rot(1.1 + cos(t) * .2);\n\tf = N(vec3(0, 0, .8) - ro);\n\tr = N(cross(vec3(0, 1, 0), f));\n\tc = pow(march(ro, N(f + r * uv.x + cross(f, r) * uv.y)), vec3(.45));\n\tc *= .5 + .5 * pow(16. * q.x * q.y * (1. - q.x) * (1. - q.y), .4);\n\tfragColor = vec4(c, mix(1.2, 0., (d + 1.) / 8.));\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 25028,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/nasa/apollo-11-thats-one-small-step-for-a-man"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}