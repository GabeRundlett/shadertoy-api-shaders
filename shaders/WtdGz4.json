{
    "Shader": {
        "info": {
            "date": "1575828919",
            "description": "I'm trying, but its hard/ Click to make vertices",
            "flags": 32,
            "hasliked": 0,
            "id": "WtdGz4",
            "likes": 6,
            "name": "Triangulation Attempt",
            "published": 3,
            "tags": [
                "delaunay"
            ],
            "usePreview": 0,
            "username": "wyatt",
            "viewed": 465
        },
        "renderpass": [
            {
                "code": "void mainImage( out vec4 Q, in vec2 U )\n{\n    vec4 a = A(U), c = C(U), b = B(U);\n    Q = vec4(0);\n    Q += 0.5+0.5*sin(.1*c);\n    Q *= 0.8+0.1*sin(.1*a.x+.1*a.y);\n    Q.x += exp(-.5*ln(U,d2(c.x),d2(c.y)).x);\n    Q.x += exp(-.5*ln(U,d2(c.y),d2(c.z)).x);\n    Q.x += exp(-.5*ln(U,d2(c.z),d2(c.x)).x);\n   // Q.yz += .01*exp(-.5*ln(U,d2(b.x),d2(b.y)).x);\n    \n    Q += exp(-.5*length(U-d2(a.x)));\n       Q *= 0.9+.1*sin(-.5*length(U-cc(d2(c.x),d2(c.y),d2(c.z))));\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    },
                    {
                        "channel": 2,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "void X (inout vec4 Q, vec2 U, vec2 r) {\n    vec4 n = A(U+r);\n    if (length(d2(n.x)-U)<length(d2(Q.x)-U)) Q.x = n.x;\n}\nvoid mainImage( out vec4 Q, in vec2 U )\n{\n    Q = A(U);\n    for (int i = 0; i <N*N; i++)\n        X(Q,U,vec2(i%N-N/2,i/N-N/2));\n    \n\tif (iMouse.z>0.) {\n        vec2 a = iMouse.xy;\n        if (length(U-a)<length(U-d2(Q.x))) Q.x = d1(a);\n\t}\n    if (iFrame < 1||length(Q.xy-Q.zw)<1e-4) {\n    \tQ = vec4(d1(0.5*R));\n    }\n    Q = floor(Q);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "#define R iResolution.xy\n//Texture lookups :\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n#define C(U) texture(iChannel2,(U)/R)\n\n#define N 4\n#define d1(v) ((v).x+(v).y*R.x)\n#define d2(i) vec2(mod(i,R.x),floor(i/R.x))\n// Distance to line\nvec2 ln (vec2 p, vec2 a, vec2 b) {\n    float i = clamp(dot(p-a,b-a)/dot(b-a,b-a),0.,1.);\n\treturn vec2(length(p-a-(b-a)*i),i);\n}\n// perpindicular bisector\nvec2 bs (vec2 p, vec2 a, vec2 b) {\n\tvec2 mp = 0.5*(a+b);\n    vec2 u = vec2(a-b).yx*vec2(-1,1);\n    float i = dot(p-mp,u)/dot(u,u);\n\treturn vec2(length(p-mp-u*i),i);\n}\n// delaunay triangulation\nvec2 T (vec2 u) {return vec2(-u.y,u.x);}\n\nvec2 cc (vec2 a, vec2 b, vec2 c) {\n    vec2 ab = 0.5*(a+b), ac = 0.5*(a+c);\n\tfloat m1 = (a.x-b.x)/(b.y-a.y), m2 = (a.x-c.x)/(c.y-a.y);\n    float b1 = ab.y-m1*ab.x, b2 = ac.y-m2*ac.x;\n    float x = (b1-b2)/(m2-m1);\n    return vec2(x,m1*x+b1);\n}\nfloat side (vec2 p, vec2 a, vec2 b) {\n\tvec2 mp = 0.5*(a+b);\n    vec2 u = vec2(a-b).yx*vec2(-1,1);\n    return dot(p-mp,u)/dot(u,u);\n}\nbool inside (vec2 p, vec2 a, vec2 b, vec2 c) {\n    float x = side(p,a,b), y = side(p,b,c), z = side(p,c,a);\n    return(sign(x)==sign(y)&&sign(y)==sign(z));\n}\nbool delaunay (vec2 a, vec2 b, vec2 c) {\n\treturn inside(cc(a,b,c),a,b,c);\n}\n           \n",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            },
            {
                "code": "void mainImage( out vec4 Q, in vec2 U )\n{\n    Q = A(U);\n    for (int i = 0; i <N*N; i++) {\n         vec4 n = A(U+vec2(i%N-N/2,i/N-N/2));\n    \tif (ln(U,d2(n.x),d2(n.y)).x<ln(U,d2(Q.x),d2(Q.y)).x) Q.xy = n.xy;\n\t\n    }\n    \n\tfloat l1 = length(d2(Q.x)-U),l2 = length(d2(Q.y)-U), l3 = length(d2(Q.z)-U);\n    if (l3<l2) Q.yz = Q.zy;\n    if (l2<l1) Q.xy = Q.yx;\n    if (iMouse.z>0.) {\n        vec2 a = iMouse.xy;\n        if (ln(U,d2(Q.x),a).x<ln(U,d2(Q.x),d2(Q.y)).x) Q.y = d1(a);\n\t}\n   \n    if (iFrame < 1||length(Q.xy-Q.zw)<1e-4) {\n    \tQ = 0.5*R.xyxy;\n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buffer B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "void Y (inout vec4 P, vec2 U, vec2 r) {\n     vec4 n = B(U+r);\n\t if (n.x!=P.x) {\n         if (n.x!=P.y&&P.x!=P.y)\n             P.z=n.x;\n         else P.y=n.x;\n     }\n}\nvoid mainImage( out vec4 Q, in vec2 U )\n{\n    \n    Q = A(U);\n    vec2 a = d2(Q.x), b = d2(Q.y), c = d2(Q.z), m = cc(a,b,c);\n    if (iFrame < 1) {Q = vec4(-1);return;}\n    for (int i = 0; i <N*N; i++) {\n        vec4 n = A(U+vec2(i%N-N/2,i/N-N/2));\n    \tvec2 na = d2(n.x), nb = d2(n.y), nc = d2(n.z), nm = cc(na,nb,nc);\n    \tif (inside(U,na,nb,nc)&&(Q.x<0.||length(na-nm)<length(a-m))) \n            Q = n;\n        \n        if (Q.x!=n.x&&Q.x!=n.y) {\n            nc = d2(Q.x);\n            nm = cc(na,nb,nc);\n            if ((inside(U,na,nb,nc)&&length(na-nm)<length(a-m)))\n                Q = vec4(n.xy,Q.x,1);\n    \t}\t\n        if (Q.y!=n.x&&Q.y!=n.y) {\n            nc = d2(Q.y);\n            nm = cc(na,nb,nc);\n            if ((inside(U,na,nb,nc)&&length(na-nm)<length(a-m)))\n                Q = vec4(n.xy,Q.y,1);\n    \t}\n    \tif (Q.z!=n.x&&Q.z!=n.y) {\n            nc = d2(Q.z);\n            nm = cc(na,nb,nc);\n            if (inside(U,na,nb,nc)&&length(na-nm)<length(a-m))\n                Q = vec4(n.xy,Q.z,1);\n\t\t}\n    }\n    vec4 n=B(U).xxxx;\n    for (int i = 0; i <N*N; i++)\n        Y(n,U,vec2(i%N-N/2,i/N-N/2));\n    vec2 na = d2(n.x), nb = d2(n.y), nc = d2(n.z), nm = cc(na,nb,nc);\n    if (n.x!=n.y&&n.y!=n.z&&n.z!=n.x){\n        if (Q.x<0.||(inside(U,na,nb,nc)&&length(na-nm)<length(a-m))) Q = n;\n    }else if (n.x!=n.y) {\n        /*if (Q.x!=n.x&&Q.x!=n.y) {\n            nc = d2(Q.x);\n            nm = cc(na,nb,nc);\n            if ((inside(U,na,nb,nc)&&length(na-nm)<length(a-m)))\n                Q = vec4(n.xy,Q.x,1);\n    \t}\t\n        if (Q.y!=n.x&&Q.y!=n.y) {\n            nc = d2(Q.y);\n            nm = cc(na,nb,nc);\n            if ((inside(U,na,nb,nc)&&length(na-nm)<length(a-m)))\n                Q = vec4(n.xy,Q.y,1);\n    \t}\n    \tif (Q.z!=n.x&&Q.z!=n.y) {\n            nc = d2(Q.z);\n            nm = cc(na,nb,nc);\n            if (inside(U,na,nb,nc)&&length(na-nm)<length(a-m))\n                Q = vec4(n.xy,Q.z,1);\n\t\t}*/\n    }\n    \n    if (Q.z<Q.y) Q.yz = Q.zy;\n    if (Q.y<Q.x) Q.xy = Q.yx;\n    if (Q.z<Q.y) Q.yz = Q.zy;\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buffer C",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 259
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}