{
    "Shader": {
        "info": {
            "date": "1614737597",
            "description": "following a tutorial https://youtu.be/hlM940IqpRU\n",
            "flags": 0,
            "hasliked": 0,
            "id": "WlGfz3",
            "likes": 3,
            "name": "Falling Leaves",
            "published": 3,
            "tags": [
                "smoothstep",
                "feather",
                "artofthecode"
            ],
            "usePreview": 0,
            "username": "YitingLiu",
            "viewed": 435
        },
        "renderpass": [
            {
                "code": "// create something other than feather \n\n#define S smoothstep \n#define T (iTime*.05)\n\n\nmat2 Rot(float a){\n    float c = cos(a), s = sin(a);\n    return mat2(c,s,-s,c);\n}\n\nfloat Leaf(vec2 p ){\n    float d = length(p-vec2(0,clamp(p.y,-.3,.3)));\n    float r = mix(.1,.01,S(-.3,.3,mix(-1.,1.,mix(p.x,p.y,atan(p.x,p.y)))));// feather shape \n      \n  \n    \n    float m = S(.01,.0,d);\n    float tiny = 20.;// 1-20. bigger number, tinnier \n    m=S(.01,.0,d*tiny*p.y);\n    m=S(.01,.0,-d*tiny*p.y);\n   // m=S(.01,.0,p.x*p.y*tiny);\n    float side = sign(p.y);\n   \n    float x = .9*abs(p.x)/r;// stretch out the corner \n    float id = floor(p.y+20.);\n    \n    \n    d = length(p-vec2(0,clamp(p.y,-.8,.8)));\n    p*=Rot(3.14/2.);\n    d += length(p-vec2(0,clamp(p.y,-.8,.8)));\n    p*=Rot(3.14/4.);\n    d += length(p-vec2(0,clamp(p.y,-.8,.8)));\n    p*=Rot(3.14*1.5);\n    d += length(p-vec2(0,clamp(p.y,-.8,.8)));\n    float stem = S(1.,.0,d);\n    \n    \n    float n=fract(sin(id*564.2)*5623.2);\n    float shade = mix(.5,1.,n);\n   \n    return m*stem ;//max(strand*m*shade,stem); \n\n\n}\n\nvec3 Transform(vec3 p, float angle){\n    p.xz*=Rot(angle);\n    p.xy*=Rot(angle*.5);// rotate along z axis as well \n    return p;\n\n}\n\nvec4 LeafBall(vec3 ro, vec3 rd, vec3 pos,float angle ){\n\n    vec4 col = vec4(0);\n    float t = dot(pos-ro,rd);\n    \n    vec3 p = ro+rd*t;\n    float y = length(pos-p);\n    \n    if(y<1.){\n        float x = sqrt(1.-y);\n        vec3 pF = ro+rd*(t-x)-pos;//front intersection \n        pF = Transform(pF,angle);\n        vec2 uvF = vec2(atan(pF.x,pF.z),pF.y);//y axis to be the up and down axis\n        uvF*=vec2(.3,.5);\n        \n        // alpha blending \n        \n        float f = Leaf(uvF);\n        vec4 front = vec4(vec3(f),S(.0,.1,f));\n\n        vec3 pB = ro+rd*(t+x)-pos;//back intersection \n        pB = Transform(pB,angle);\n\n        vec2 uvB = vec2(atan(pB.x,pB.z),pB.y);//y axis to be the up and down axis\n        uvB*=vec2(.3,.5);\n        \n        float b = Leaf(uvB);\n        vec4 back = vec4(vec3(b),S(.0,.1,b));\n        col=mix(back, front, front.a);// alpha blend - see both back and front \n\n   }\n   \n   return col;\n\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n\n\n    vec4 col = vec4(0);\n    \n    vec3 ro = vec3(0,0,0.+mix(-3.,-1.5,sin(T*10.)));\n    vec3 rd = normalize(vec3(uv,1));\n \n    // bg\n    vec3 bg = vec3(.2,.5,.9)*(uv.y+.5);\n    bg+=vec3(.8,.1,.1)*(-uv.y+.5);\n    col = vec4(bg,0);\n   //float a = 180.+T*10.;\n  // col=vec4(Leaf(uv));\n \n  \n   \n  \n    for (float i = 0.; i <=1.; i+=1./100.){\n         \n         float x =mix(-15.,15.,fract(sin(i*643.2)*8593.1));\n         float y =mix(6.,-6.,fract(i+T));\n         float z =mix(8.,0.,i);\n         float a = T+i*5643.1;\n         vec4 leaf = LeafBall(ro,rd,vec3(x,y,z),a);\n         leaf.b = fract(i+T)/bg.r;\n         leaf.r = fract(i+T)*fract(sin(i*643.2)*8593.1);\n         \n         leaf.rgb = mix(bg,leaf.rgb,mix(.8,1.,i));\n         leaf.rgb=sqrt(leaf.rgb);\n         col = mix(col, leaf,leaf.a);\n\n    \n    }\n\n     col = pow(col, vec4(.4545));//gamma correction\n   \n    \n    // Output to screen\n    fragColor =col;\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}