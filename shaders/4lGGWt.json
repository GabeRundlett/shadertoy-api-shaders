{
    "Shader": {
        "info": {
            "date": "1477326880",
            "description": "dithering src: https://www.shadertoy.com/view/MtjGRd\ntrack: https://soundcloud.com/stansmeets0/red-7-i-lost-my-shoes-on-acid",
            "flags": 64,
            "hasliked": 0,
            "id": "4lGGWt",
            "likes": 21,
            "name": "I Lost My Shoes On Acid",
            "published": 3,
            "tags": [
                "waves",
                "pixel",
                "dither",
                "lsd",
                "acid"
            ],
            "usePreview": 0,
            "username": "UNDERDOGKID91",
            "viewed": 1565
        },
        "renderpass": [
            {
                "code": "#define DITHER\n#define AUTO_MODE\n#define DOWN_SCALE 2.0\n\n#define PALETTE_SIZE 16\n#define SUB_PALETTE_SIZE 8\n\n#define RGB(r,g,b) (vec3(r,g,b) / 255.0);\n\nvec3 palette[PALETTE_SIZE];\nvec3 subPalette[SUB_PALETTE_SIZE];\n\n//Initalizes the color palette.\nvoid InitPalette()\n{\n    //16-Color C64 color palette.\n\tpalette[ 0] = RGB(  0,  0,  0);\n\tpalette[ 1] = RGB(255,255,255);\n\tpalette[ 2] = RGB(152, 75, 67);\n\tpalette[ 3] = RGB(121,193,200);\n\t\n\tpalette[ 4] = RGB(155, 81,165);\n\tpalette[ 5] = RGB(202,160,218);\n\tpalette[ 6] = RGB(202,160,218);\n\tpalette[ 7] = RGB(202,160,218);\n\t\n\tpalette[ 8] = RGB(202,160,218);\n\tpalette[ 9] = RGB(191,148,208);\n\tpalette[10] = RGB(179,119,201 );\n\tpalette[11] = RGB(167,106,198);\n\t\n\tpalette[12] = RGB(138,138,138);\n\tpalette[13] = RGB(163,229,153);\n\tpalette[14] = RGB(138,123,206);\n\tpalette[15] = RGB(173,173,173);\n    \n    //8-Color metalic-like sub palette.\n\tsubPalette[0] = palette[6];\n\tsubPalette[1] = palette[11];\n\tsubPalette[2] = palette[4];\n\tsubPalette[3] = palette[14];\t\n\tsubPalette[4] = palette[5];\n\tsubPalette[5] = palette[3];\n\tsubPalette[6] = palette[13];\n\tsubPalette[7] = palette[1];\n\t\n}\n//Blends the nearest two palette colors with dithering.\nvec3 GetDitheredPalette(float x,vec2 pixel)\n{\n\tfloat idx = clamp(x,0.0,1.0)*float(SUB_PALETTE_SIZE-1);\n\t\n\tvec3 c1 = vec3(0);\n\tvec3 c2 = vec3(0);\n\t\n    //Loop to workaround constant array indexes.\n\tfor(int i = 0;i < SUB_PALETTE_SIZE;i++)\n\t{\n\t\tif(float(i) == floor(idx))\n\t\t{\n\t\t\tc1 = subPalette[i];\n\t\t\tc2 = subPalette[i + 1];\n\t\t\tbreak;\n\t\t}\t\n\t}\n    \n    #ifdef DITHER\n    \tfloat dith = texture(iChannel0, pixel / iChannelResolution[0].xy).r;\n    \tfloat mixAmt = float(fract(idx) > dith);\n    #else\n    \tfloat mixAmt = fract(idx);\n    #endif\n    \n\treturn mix(c1,c2,mixAmt);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    InitPalette();\n\tvec2 p = -1.0 + 2.0 * fragCoord.xy / iResolution.xy;\n\tfloat t = iTime;\n    \n        \n\t// main code, *original shader by: 'Plasma' by Viktor Korsun (2011)\n\tfloat x = p.x;\n\tfloat y = p.y;\n    \n\tfloat mov0 = x+y+cos(sin(t)*2.0)*100.+sin(x/100.)*1000.;\n\tfloat mov1 = -y / 0.5 +  t;\n\tfloat mov2 = -x / 0.2;\n    \n    // wave\n    //uv.yx * vec2(1.,-1.) + vec2(0.,1.)\n    float fft = texture(iChannel1, vec2(.4,.45)).x;\n    \n    float c1 = abs(sin(mov1+t)+mov2/2.-mov1-mov2+t);\n    float c2 = abs(sin(c1+sin(mov0/500.+t)+sin(y+t)+sin((x+y)/100.)*5.));\n\tfloat c3 = abs(sin(c2+cos(mov1+mov2+c2)+cos(mov2)+sin(x/1000.)));\n    c3 *= fft * 2.;\n        \n    vec3 outColor = GetDitheredPalette(c3, fragCoord / DOWN_SCALE);\n\n    //Palette preview\n    if(x < -0.95 || x > 0.95 || y < -0.9 || y > 0.9) \n    {\n        outColor = GetDitheredPalette(-y / 2. + 0.5, fragCoord / DOWN_SCALE);\n    }\n    \n\tfragColor = vec4(outColor, 1.);\n\t\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 28,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "musicstream",
                        "id": 5154,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/stansmeets0/red-7-i-lost-my-shoes-on-acid"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}