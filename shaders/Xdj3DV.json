{
    "Shader": {
        "info": {
            "date": "1393708676",
            "description": "I love sphere. :-)",
            "flags": 0,
            "hasliked": 0,
            "id": "Xdj3DV",
            "likes": 16,
            "name": "Quad Sphere",
            "published": 3,
            "tags": [
                "raymarching",
                "cineshader"
            ],
            "usePreview": 0,
            "username": "gyabo",
            "viewed": 43741
        },
        "renderpass": [
            {
                "code": "#define ITEMAX 75\n\nfloat QuadSphere(vec3 p, vec3 pos, vec3 size, float radius) {\n\treturn length(max(abs(p - pos), 0.0) - size) - radius;\n}\n\nvec2 rot(vec2 p, float r) {\n\tfloat c = cos(r), s = sin(r);\n\treturn vec2(p.x * c - p.y * s, p.x * s + p.y * c);\n}\n\nfloat map(vec3 p) {\n\tfloat t = 1000.;\n\tvec3 pos   = vec3(0.0, 0.0, 0.0);\n\tfloat gt = iTime;\n\tvec3 scale = vec3(0.2 + sin(gt) * 0.1, 0.1, 0.1);\n\tfor(int i = 0 ; i < 3; i++) {\n\t\tvec3 r = mod(p, 1.0) - 0.5;\n\t\tr.xy = rot(r.xy, gt * 0.7);\n\t\tr.yz = rot(r.yz, gt);\n\t\tt = min(t, QuadSphere(r, pos, scale, 0.05));\n\t\tpos   = pos.yzx;\n\t\tscale = scale.yzx;\n\t}\n\treturn t;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord ) {\n\tfloat gt = iTime;\n\tfloat d  = 0.0, dt = 0.0, ite = 0.0;\n\tvec2 uv  = -1.0 + 2.0 * ( fragCoord.xy / iResolution.xy );\n\tvec3 dir = normalize(vec3(uv * vec2(iResolution.x/iResolution.y, 1.0), 1.0));\n\tvec3 pos = vec3(0,gt,gt).zxy * 0.2;\n\tdir.xy   = rot(dir.xy, gt * 0.1);\n\tdir.yz   = rot(dir.yz, gt * 0.1);\n\n\tfor(int i = 0 ; i < ITEMAX; i++) {\n\t\tdt = map(pos + dir * d);\n\t\tif(dt < .001) break;\n\t\td += dt;\n\t\tite++;\n\t}\n\n\tvec3 col = vec3(d * 0.05);\n\tif(dt < 0.001) {\n\t\tfloat  www = pow(1.0 - (ite / float(ITEMAX)), 10.0);\n\t\tcol += www * (vec3(0,1,3).xyz * 0.5);\n\t}\n\tfragColor = vec4(sqrt(col) + dir * 0.03, 1.0 / (d * d) /* 1.0 / ite */);\n}\n",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}