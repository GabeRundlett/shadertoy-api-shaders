{
    "Shader": {
        "info": {
            "date": "1611635026",
            "description": "Using De Moivre's formula to calculate the three cube roots of a complex number. Drag with mouse to change z.",
            "flags": 0,
            "hasliked": 0,
            "id": "WtGcWy",
            "likes": 5,
            "name": "Cube Roots of a Complex Number",
            "published": 3,
            "tags": [
                "complex",
                "polar",
                "formula",
                "demoivre",
                "cuberoot"
            ],
            "usePreview": 0,
            "username": "oneshade",
            "viewed": 191
        },
        "renderpass": [
            {
                "code": "#define HALF_PI 1.57079632679\n#define COS_120 -0.5\n#define SIN_120 0.86602540378\n\n// Container for 3 complex numbers\nstruct Complex3 {\n    vec2 a;\n    vec2 b;\n    vec2 c;\n};\n\nComplex3 complexCuberoot(in vec2 z) {\n    // De Moivre's formula\n    vec2 r = sin(atan(z.y, z.x) / 3.0 + vec2(HALF_PI, 0.0)) * pow(length(z), 1.0 / 3.0);\n    return Complex3(r,\n                    r * mat2(COS_120,  SIN_120, -SIN_120, COS_120),  // Rotate +120 degrees\n                    r * mat2(COS_120, -SIN_120,  SIN_120, COS_120)); // Rotate -120 degrees\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n    vec2 screenCenter = 0.5 * iResolution.xy;\n\n    vec2 uv = (fragCoord - screenCenter) / iResolution.y * 4.0;\n    float unit = 8.0 / iResolution.y;\n    vec3 color = vec3(0.0);\n\n    // Draw grid\n    color = mix(color, vec3(0.0, 0.0, 1.0), smoothstep(unit, 0.0, abs(mod(uv.y + 0.125, 0.25) - 0.125)));\n    color = mix(color, vec3(0.0, 0.0, 1.0), smoothstep(unit, 0.0, abs(mod(uv.x + 0.125, 0.25) - 0.125)));\n\n    // Draw axes\n    color = mix(color, vec3(1.0, 0.0, 0.0), smoothstep(unit, 0.0, abs(uv.y)));\n    color = mix(color, vec3(1.0, 0.0, 0.0), smoothstep(unit, 0.0, abs(uv.x)));\n\n    // Complex number (demo if no mouse)\n    vec2 z = vec2(sin(iTime * 1.25) * 2.0, cos(iTime * 0.5));\n    if (iMouse.z > 0.0) {\n        z = (iMouse.xy - screenCenter) / iResolution.y * 4.0;\n    }\n\n    // Find cube roots of z and plot\n    Complex3 cbrt = complexCuberoot(z);\n\n    color = mix(color, vec3(1.0), smoothstep(unit, 0.0, length(uv - z) - 0.05));\n\n    color = mix(color, vec3(1.0, 0.0, 1.0), smoothstep(unit, 0.0, length(uv - cbrt.a) - 0.05));\n    color = mix(color, vec3(0.0, 1.0, 0.0), smoothstep(unit, 0.0, length(uv - cbrt.b) - 0.05));\n    color = mix(color, vec3(1.0, 1.0, 0.0), smoothstep(unit, 0.0, length(uv - cbrt.c) - 0.05));\n\n    // Draw \"z\" character\n    vec4 zTexBbox = vec4(0.625, 0.5, 0.6875, 0.5625);\n    vec4 zScrBbox = vec4(-0.15, 0.1, 0.15, 0.4);\n\n    zScrBbox.xy += z;\n    zScrBbox.zw += z;\n\n    if (all(lessThan(uv, zScrBbox.zw)) && all(greaterThan(uv, zScrBbox.xy))) {\n        vec2 mappedUv = (uv - zScrBbox.xy) / (zScrBbox.zw - zScrBbox.xy) * (zTexBbox.zw - zTexBbox.xy) + zTexBbox.xy;\n        color = mix(color, vec3(1.0), smoothstep(unit, 0.0, texture(iChannel0, mappedUv).w - 0.5));\n    }\n\n    fragColor = vec4(color, 1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 49,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}