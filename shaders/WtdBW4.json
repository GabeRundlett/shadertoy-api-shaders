{
    "Shader": {
        "info": {
            "date": "1612747229",
            "description": "Hiragana font with morphing of characters\ndid this some time ago, messy coding, will have to come back to clean it up a bit, or there might be faster algorithms out there ?",
            "flags": 0,
            "hasliked": 0,
            "id": "WtdBW4",
            "likes": 14,
            "name": "Hiragana Font",
            "published": 3,
            "tags": [
                "bezier",
                "font",
                "morph",
                "hiragana"
            ],
            "usePreview": 0,
            "username": "xavierseb",
            "viewed": 396
        },
        "renderpass": [
            {
                "code": "// hiragana glyphs , Xavierseb 2019  \n#define V0 vec4(0)\n#define Gen(u,v) mat4( V0,V0,   u,v, 1.,0., 0.,1., 0.,0.)\n#define Gen1(u,v,w,x) mat4( V0,V0,   u,v, w,x, 0.,1., 0.,0.)\n\n#define Wa Glyph( mat4( -.47,.14,-2.67,-.16,-.87,4.44,-1.09,.5, -.92,1.05,1.25,.38,-.52,.87,.39,-.76), Gen(.17,.87) )\n#define Ra Glyph( mat4( -.6,-.26,-.48,0.,-.46,1.76,1.07,.69, -.57,.75,1.15,-.05,-.5,.29,-.66,-1.),Gen( .17,.76) )\n#define Ya Glyph( mat4( 0.,-1.78,.88,.14,-.81,2.37,.83,1.,  -.96,1.39,1.2,.534,-.05,1.2,-.08,-.05),Gen( .28,.65) )\n#define Ma Glyph( mat4( .67,-1.8,-1.415,.545, .487,.415,-.5,.1, .1,.56,-1.55,.53,.68,-2.23,.47,-.78 ),Gen( .23,.82) )\n#define Ha Glyph( mat4( -.65,-.83,-.68,-.5,.78,-1.72,-.5,-.41,  .78,-1.65,.96,.48,.5,-.52,3.,-.53),mat4( .48,-.1,-.83,.86,-.53,-1.25,.16,-.7,  1.,0., .15,.8, V0) )\n#define Na Glyph( mat4( .1,-2.74,.96,-.63,.62,-.2,2.86,-.15, .63,1.38,.21,.2,.49,-.42,1.08,-.39),mat4( .2,.29,-1.42,.62,-.39,-1.66,.19,-.83, .2,0.7,.5,0.79, V0) )\n#define Ta Glyph( mat4( -.89,1.7,-3.4,.43,-.82,4.,-.69,.53, 0.2,4.05,.47,.17,-.12,.39,-1.32,-.58),Gen1( .23,0.8,.05,0.8) )\n#define Sa Glyph( mat4( .55,-2.,-1.93,.59,.6,-.86,4.14,-.17, .4,.23,-.54,-.41,-.84,-.81,-.75,-.42),Gen( .15,.9) )\n#define Ka Glyph( mat4( -.8,-.03,-.31,.93,-.75,1.37,1.43,-.25, -.9,1.,-.41,-.35,.1,1.,-1.17,-.73),Gen(.5,0.85) )\n#define Aa Glyph( mat4( -.675,2.8,-.806,-.15, .43,.55,3.64,-.844, .24,-.87,-2.08,1.61,.19,-2.29,.654,0.),mat4( -.625,.97,1.,.19,-.204,.63,-.72,-.86, .12,.8,.85,1., 0.,.2, 0.,0.) )\t\n\n#define Ri Glyph( mat4( -.32,.59,1.3,.23,.01,2.,-.13,-.96, -.32,-.32,-.48,-.32, 1.,.33,.59,.01),Gen(.05,.35) )\n#define Mi Glyph( mat4( -.38,1.18,.76,.07,.68,1.44,-.35,-.78, .15,-1.11,-1.8,.78,.84,-2.23,.78,-.52),Gen( .13,.65) )\n#define Hi Glyph( mat4( -.77,2.,-.6,.84,.54,1.78,1.71,-.11, -.28,-1.69,.62,.37,.73,-1.29,-1.41,.7),Gen( .06,.83) )\n#define Ni Glyph( mat4( .24,2.45,-1.05,.75,.53,1.05,-.88,-.54,  -.63,-.82,-.7,-.62,.66,-.13,-1.24,-.58),Gen(.06,.73) )\n#define Chi Glyph( mat4( .25,-3.9,1.23,-.47,.53,-.48,4.,-.48,  0.,1.3,.68,-.47,-1.,-.72,.5,-.48),Gen( .1,.83) )\n#define Shi Glyph( mat4( .59,-.43,-.48,-.38,-.74,-1.1,-.87,.83, V0,V0),Gen1(1.,0., 0.,1.) )\n#define Ki Glyph( mat4( -.26,1.48,2.46,-.56,-.02,.27,1.31,.33, .45,.06,-1.52,.3,-.42,.04,-.95,-.91),mat4( -.32,-.17,.04,.47,.92,1.05,.29,-.36, .2,0.85, 1.,0., V0) )\n#define Ii Glyph( mat4( -.37,-.13,.63,.83,-.66,.11,1.25,-.33,  -.88,-.87,-.68,-.37,.42,.16,-.48,-.66),Gen( .1,.69) )\n\n#define Ooo Glyph( mat4( -.63,3.72,-2.66,.4,.52,1.11,-.87,-.87,  0.,-1.32,.08,0.,.92,-1.27,1.08,-.53),Gen(.11,.44) )\n#define Ru Glyph( mat4( -.43,.47,.69,-.59,.65,.75,1.15,-.39,  -.63,1.14,.78,.23,-.48,.55,-.83,-.82),mat4( .2,-.71,.06,.23,-.84,-.93,-.34,-.82,  1.,0.,  1.,0.,  V0) )\n#define Yu Glyph( mat4( -.21,.98,-.79,-.79,-.94,.49,3.,-.45,  -.17,1.4,.84,-.79,-.114,-1.33,2.26,-.45),Gen(.41,.869) )\n#define Mu Glyph( mat4( -.44,-.55,-1.22,-.44,-.6,-1.6,-.45,-.6,  -.44,1.749,-.32,.84,-.6,-2.32,2.,.45),mat4( .04,-2.1,.17,-.44,.56,-.46,3.,-.64, 1.,0.,  .5,.85, .2,.7,0.,0.) )\n#define Fu Glyph( mat4( -.95,-.39,-1.5,.86,-.37,-2.13,2.48,-.5,  -.4,.01,.32,-.21,-.61,-1.03,-.39,.07),mat4( -.87,-.34,.34,-.03,1.75,.91,.5,.55, .3,.97,  1.,0., .0,.5,0.,0.) )\n#define Nu Glyph( mat4( -.74,1.18,-1.74,-.27,-.7,1.1,3.,-.61,-.74,-1.66,1.73,.61,-.7,.24,1.08,-.42),mat4( .61,-.05,-.17,.88,-.42,-1.04,.44,-.74, .38,.81, 1.,0., V0) )\n#define Tsu Glyph( mat4( -.9,.85,1.56,.145,.014,1.015,-.28,-.71, V0,V0),Gen1(1.,0., 0.,1.) )\n#define Su Glyph( mat4( .72,-5.1,1.1,.02,.57,-.66,4.5,-.39,  .015,-1.41,.9,-.5,-.39,.2,.61,-1.03),Gen(.1,.85) )\n#define Ku Glyph( mat4( .13,-.5,-.69,.14,.86,-.54,.69,-.9, V0,V0),Gen1( 1.,0., 0.,1.) )\n#define Uu Glyph( mat4(  -.12,.53,1.02,.16,1.04,.4,1.35,-.65,  -.54,-.59,1.02,-.04,.2,-.11,1.35,-1.),Gen( .15,1.) )\n\n#define Re Glyph( mat4( -.89,.67,.35,.37,-.66,.79,.9,-.57,  -.93,1.48,-.45,.92,.165,1.59,-1.54,-.42),mat4( -.49,-.29,-.64,-.45,.94,1.04,-1.49,-.67, 1.,0., .12,.6,  V0) )\n#define Me Glyph( mat4( -.23,-1.73,1.6,-.72,-.57,2.78,.78,-.62,  .35,2.14,-1.16,-.71,-.8,.47,.71,-.62),Gen( .16,.63) )\n#define He Glyph( mat4( -.95,-.01,-.93,.9,.02,.38,.69,-.42,  V0,V0),Gen1( 1.,0., 0.,1.) )\n#define Ne Glyph( mat4( -.87,.87,-.65,-.59,.24,.8,4.,-.89,  -.93,.5,.78,.59,-.63,1.1,.38,-.54), mat4( .59,-.05,-.23,.87,-.54,-1.17,.24,-.8, .11,.8,  1.,0.,  V0) )\n#define Te Glyph( mat4( -.78,2.32,-1.39,.45,.32,1.48,.14,-.84, V0,V0),Gen1( 1.,0., 0.,1.) )\n#define Se Glyph( mat4( -.44,-.14,-.95,.53,.57,-.1,-.97,-.8,  -.96,-.96,.11,.87,-.11,-.33,.23,.19),mat4( .29,.39,.26,.11,.78,.7,-.72,-.39,   1.,0., 1.,0., V0) )\n#define Ke Glyph( mat4( -.6,-1.3,1.02,.36,.8,-1.9,-1.8,1.,  -.63,-.51,-.58,.83,-.71,.26,.2,.41),Gen1(.27,.69, .1,.7) )\n#define Ee Glyph( mat4( -.66,.06,-.42,.62,-.72,-.16,-.87,-.81,  -.69,.2,.93,-.24,-.67,.55,.39,.91),mat4( -.64,-.63,.46,.26,.17,-.06,.54,.32, 1.,0.,  .4,.9, V0) )\n\n#define Nn Glyph( mat4( .03,.32,-1.8,-.27,.9,.86,-2.2,-.1, -.27,0.,-.11,.87,-.1,.03,-1.9,-.1),Gen( 1.,0.) )\n#define Ro Glyph( mat4( -.47,.79,.33,-.66,.72,.88,1.13,-.33,  -.66,.96,1.18,-.05,-.33,.63,-.69,-.8),Gen(1.,0.) )\n#define Yo Glyph( mat4( 0.,.31,-2.12,.5,.38,-2.3,.66,-.84,  0.,.12,-.3,.47,.89,.23,.29,.47),Gen(1.,0.) )\n#define Mo Glyph( mat4( -.6,-.46,3.1,-.55,0.,-.69,1.17,.42,  -.21,-.55,.88,.47,-.17,-1.3,-1.15,-.23),mat4( -.18,0.,-.17,-.21,1.,1.08,.3,-.17, .3,.93,  1.,0.,  V0) )\n#define Ho Glyph( mat4( .4,1.04,-1.35,.91,.62,-2.3,.47,-.8,  0.,2.88,.23,-.1,.71,1.45,-.21,.17),mat4( -.7,-.84,-.74,-.63,.77,-.21,-1.24,-.58, 1.,0.,  .1,.6,  V0) )\n#define No Glyph( mat4( -.6,-1.8,2.6,.21,-.6,1.35,.83,-.69,  -.6,-.35,.06,.11,-.6,-.35,.28,.7),Gen(1.,0.) )\n#define To Glyph( mat4( .43,1.12,-2.2,.62,.63,.74,-1.,-.69, -.54,-.37,-.32,-.13,.88,.95,.4,.1),Gen(1.,0.) )\n#define So Glyph( mat4( -.67,2.1,-1.1,.44,.05,1.,.1,-.71, -.5,.7,.3,-.67,1.,1.3,1.3,.05),Gen(1.,0.) )\n#define Ko Glyph( mat4( -.51,3.62,0.,-.65,.72,.728,-1.56,-.1,  V0,V0),Gen1(0.07,0.74,0.,1.) )\n#define Oo Glyph( mat4( -.83,-.73,.64,.81,.32,0.,1.17,.4,  -.45,-.3,-.34,-.78,.87,.08,-1.4,-.68),mat4( -.78,-.24,1.68,.26,-.68,.43,-.25,-.88, .5,.79,  1.,0.,  V0) )\n\n#define LV Glyph( mat4( 0.,-.45,-2.,0., .58,1.4,1.,-1., 0.,2.,.45,0., -1.,1.,1.4,.58), Gen(1.,0.) )\n#define _1 Glyph( mat4( vec4(-1.4,-1.4,1.4,1.4), vec4(-1.), V0, vec4(-1.)), Gen(1.,0.) )\n#define _2 Glyph( mat4( vec4(-1.), vec4(-1.4,-1.4,1.4,1.4),  vec4(1.),vec4(-1.4,-1.4,1.4,1.4) ), Gen(1.,0.) )\n#define UP Glyph( mat4( V0, vec4(10), V0, vec4(10)), mat4(V0,vec4(10), 0.,1.,0.,1.,0.,1., 0.,0.) )\n#define TEDDX Glyph( mat4( -.96,.68,-.95,.86, 0.,.15,.3,.55,  1.,.9,.6,.38, -.95,1.7,1.2,.34), mat4( -.96,-.6,.03,.05, 0.,-1.18,.26,-1., .88,1.,1.,0.,V0) )\n#define TEDDY Glyph( mat4( 0.,-1.4,-1.4,.32,-1.,-.78,2.4,.22, 0.,1.4,1.4,-.32,-1.,-.78,2.4,.22), mat4( -.234,1.,-1.,.234, -.346,.21,.21,-.346, .932,.99,.932,.99,V0) )\n#define TEDDZ Glyph( TEDDY.a, TEDDY.b+mat4( V0, vec4(0.,-.11,-.11,0.), V0,V0 ) )\n\n#define BOUNDINGBOX_W .1\n#define BOUNDINGBOX_H .14\n#define CHAR_W .07\n#define CHAR_H .07\n#define TEST(X0,X1,X2,X3) t<X0||t>X1?distance(getPos(nn,X2*CHAR_W,X3*CHAR_H),pos):1.\n#define TEST1(X0,X1,X2,X3) 1.-t<X0||1.-t>X1?distance(getPos(nn.wzyx,X2*CHAR_W,X3*CHAR_H),pos):1.\n#define IS_INSIDE pos.x<BOUNDINGBOX_W && pos.x>-BOUNDINGBOX_W && pos.y<BOUNDINGBOX_H && pos.y>-BOUNDINGBOX_H\n#define a2z(u0,u1,u2,u3,v0,v1,v2,v3)  if(IS_INSIDE) for(float t=0.0;t<.5;t+=.005) { vec4 nn=getN(t); c = min(c,min(min(min(TEST(v2.x,v2.y,u0,u1),TEST(v2.z,v2.w,u2,u3)),TEST(v3.x,v3.y,v0,v1)),min(min(TEST1(v2.x,v2.y,u0,u1),TEST1(v2.z,v2.w,u2,u3)),TEST1(v3.x,v3.y,v0,v1)))); if(c<.002) break; }\n\n#define  gmx( u, v, t)  gmix(u,v,clamp(t1-t,0.,1.))\n#define  qmx( u, v, t)  mix(u,v,clamp(t1-t,0.,1.))\n#define  mx2( u, v, t)  mmix(u,v,clamp(t,0.,1.))\n#define  A2Z(X) pos+=pstep; a2z(X.a[0], gl.a[1], gl.a[2], gl.a[3], gl.b[0], gl.b[1], gl.b[2], gl.b[3]) \n#define  _LV(X) if(X.a[0]==LV.a[0]) gl.a*=heartbeat;  A2Z(gl)  \n#define S(v) smoothstep(0., 2.5/ iResolution.y, v)\n\t\nstruct Glyph { mat4 a, b; };\n\nmat4 mmix(mat4 u,mat4 v, float t) { return v*t+u*(1.-t); }    \n\nGlyph gmix(in Glyph u,in Glyph v, float t) { return Glyph( mx2(u.a,v.a,t), mx2(u.b,v.b,t) ); }\n\t\nvec4 getN(in float t) {\tfloat t1=1.-t; return vec4(t1*t1*t1, 3.*t1*t1*t, 3.*t1*t*t, t*t*t); }\n\nvec2 getPos(in vec4 n, in vec4 x, in vec4 y) { return vec2(dot(x,n), dot(y,n)); }\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\tvec2 pos = fragCoord.xy/iResolution.y;\t\n\tvec2 pstep=vec2(.4,0.); pos += -vec2(1.3,.85);\n\tfloat c=1., t1=mod(iTime*2.,7.), heartbeat=2.-max(1.2,.5+sin(t1*4.)); \n\tconst Glyph g0=Sa, g5=Ko,  \n                g1=Yo, g6=Nn,\n                g2=Uu, g7=Ni,\n                g3=Na, g8=Chi,\n                g4=Ra, g9=Ha;\n\tGlyph gl;\t\n\tpos += pstep;//A2Z((gl=gmx(TEDDZ,gmx(TEDDX,gmx(TEDDZ,TEDDY,13.+sin(7.*t1)),8.),2.)))\n\tA2Z((gl= gmx(g0,gmx(g5,g0,3.0),.0) ))\tpstep=vec2(0.,.17);\n\tA2Z((gl= gmx(g1,gmx(g6,g1,3.4),.0) ))\n\tA2Z((gl= gmx(g2,gmx(g7,g2,3.8),.0) ))\n\tA2Z((gl= gmx(g3,gmx(g8,g3,4.2),.0) ))\n\t_LV((gl= gmx(g4,gmx(g9,g4,4.6),.0) ))\n\n\t//fragColor = c>.015? vec4(1):vec4( 1.-sin(sin(c*800.))  );\n    fragColor = vec4(( S(c) * S( abs(c-.01)*1.5 ) ) );     // FabriceNeyret2 method, thanks !\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}