{
    "Shader": {
        "info": {
            "date": "1694616767",
            "description": "Fun N-body simulation. (Interactive)",
            "flags": 32,
            "hasliked": 0,
            "id": "dtSBDd",
            "likes": 44,
            "name": "Get The Ball!",
            "published": 3,
            "tags": [
                "nbody"
            ],
            "usePreview": 0,
            "username": "wyatt",
            "viewed": 464
        },
        "renderpass": [
            {
                "code": "Main {\n    if ((int(U.x+U.y)+I)%2==0) {\n    \n        Q = vec4(0);\n        float d = 1e9;\n        float w = 0.;\n        for (float i = 0.; i < N; i++) {\n            vec4 a = A(vec2(i,0));\n            a.xy = a.xy*R.y+vec2(.5*R.x-.5*R.y,0);\n            vec4 _ = init(i,float(I)/60.);\n            float _d = length(U-a.xy)-_.z*R.y;\n            if (_d < d) d = _d, w = i;\n        }\n        \n        Q = 1.-smoothstep(2.,0.,d)*(.5+.5*sin(1.5+floor(w/T)+w/T+vec4(1,2,3,4)));\n        Q *= smoothstep(0.,2.,abs(d)-1.);\n    } else discard;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "#define T 350.\n#define N (T*2. + 1.)\n\n#define R iResolution.xy\n#define I iFrame\n#define A(U) texelFetch(iChannel0,ivec2(U),0)\n\n#define Main void mainImage(out vec4 Q, in vec2 U) \n#define pi 3.14159265359\n\nvec4 init (float i, float t) {\n    vec4 o = vec4(0);\n    if (i < T) {\n        float s = i/T;\n        o.z = .002+.02*(1.-i/T);\n        o.xy = vec2(.25+.1*(1.-s)*sin(4.*6.2*s*s-.4*t)+o.z*cos(pi*i),.9*s);\n        o.w = 1.;\n    } else if (i < 2.*T) {\n        i -= T;\n        float s = i/T;\n        o.z = .002+.02*(1.-i/T);\n        o.xy = vec2(.75+.1*(1.-s)*cos(4.*6.2*s*s+.4*t)+o.z*cos(pi*i),.9*s);\n        o.w = 2.;\n    } else {\n        o.xy = vec2(.5,.8);\n        o.z = .04;\n        o.w = 3.;\n    }\n    return o;\n}",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            },
            {
                "code": "Main {\n    U = floor(U);\n    if (U.y>1.||U.x>=N) discard;\n    Q = A(U);\n    vec4 Q0 = Q;\n    vec4 O = init(U.x,float(I)/60.);\n    \n    vec2 f = vec2(0,-3e-4*O.z);\n    for (float i = 0.; i < N; i++) {\n        vec4 q = A(vec2(i,0));\n        vec4 o = init(i,float(I)/60.);\n        vec2 r = q.xy-Q.xy;\n        float l = length(r);\n        float L = length(o.xy-O.xy);\n        \n        if (l > 0. && O.w == o.w) {\n        \n                f -= r/l*(L-l)/T*o.z*exp(-50.*L)*500.;\n        \n        }\n        if (L > 1.7*(o.z+O.z) || o.w != O.w) {\n            \n                \n                f += .1*r/l*clamp(l-1.1*(o.z+O.z+.005),-1.,0.);\n            \n        }\n        \n    }\n    \n    if (U.x < 2.*T) {\n        vec4 q = A(vec2(2.*T,0));\n        vec2 r = Q.xy - q.xy;\n        float l = length(r);\n        if (l>0.)\n        f -= .0001*r/l*exp(-2.*l);\n    }\n     \n     if (iMouse.z>0.) {\n        vec2 r = Q.xy - (iMouse.xy/R.y-vec2(.5*R.x-.5*R.y,0)/R.y);\n        float l = length(r);\n        if (l > 0.) \n        f += .001*r/l*exp(-2.*l);\n    }\n    {\n        float m = (.01+O.z*O.z);\n        if (O.w == 3.) m = .1;\n        f = f/m;\n        f = .03*f*inversesqrt(1.+dot(f,f));\n        Q.zw += f;\n        Q.xy += f + .03*Q.zw*inversesqrt(1.+dot(Q.zw,Q.zw));\n        \n        \n        if (Q.y - O.z< 0.) Q.y = O.z, Q.w = abs(Q.w);\n        if (Q.x - O.z< .5-.5*R.x/R.y) \n            Q.x = .5-.5*R.x/R.y + O.z, Q.z = abs(Q.z);\n        if (Q.x + O.z> .5+.5*R.x/R.y) \n            Q.x = .5+.5*R.x/R.y- O.z, Q.z = -abs(Q.z);\n        if (Q.y + O.z> 1.) Q.y = 1.-O.z, Q.w = -abs(Q.w);\n        \n    }\n    if (U.x < 2.*T)\n    Q = mix(Q0,Q,clamp(mod(U.x,T)-10.,0.,1.));\n    \n    if (I < 1) {\n    \n        Q = vec4(init (U.x,0.).xy, 0,0);\n        \n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 260,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer03.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "Main {\n    U = floor(U);\n    if (U.y>1.||U.x>=N) discard;\n    Q = A(U);\n    vec4 Q0 = Q;\n    vec4 O = init(U.x,float(I)/60.);\n    \n    vec2 f = vec2(0,-3e-4*O.z);\n    for (float i = 0.; i < N; i++) {\n        vec4 q = A(vec2(i,0));\n        vec4 o = init(i,float(I)/60.);\n        vec2 r = q.xy-Q.xy;\n        float l = length(r);\n        float L = length(o.xy-O.xy);\n        \n        if (l > 0. && O.w == o.w) {\n        \n                f -= r/l*(L-l)/T*o.z*exp(-50.*L)*500.;\n        \n        }\n        if (L > 1.7*(o.z+O.z) || o.w != O.w) {\n            \n                \n                f += .1*r/l*clamp(l-1.1*(o.z+O.z+.005),-1.,0.);\n            \n        }\n        \n    }\n    \n    if (U.x < 2.*T) {\n        vec4 q = A(vec2(2.*T,0));\n        vec2 r = Q.xy - q.xy;\n        float l = length(r);\n        if (l>0.)\n        f -= .0001*r/l*exp(-2.*l);\n    }\n     \n     if (iMouse.z>0.) {\n        vec2 r = Q.xy - (iMouse.xy/R.y-vec2(.5*R.x-.5*R.y,0)/R.y);\n        float l = length(r);\n        if (l > 0.) \n        f += .001*r/l*exp(-2.*l);\n    }\n    {\n        float m = (.01+O.z*O.z);\n        if (O.w == 3.) m = .1;\n        f = f/m;\n        f = .03*f*inversesqrt(1.+dot(f,f));\n        Q.zw += f;\n        Q.xy += f + .03*Q.zw*inversesqrt(1.+dot(Q.zw,Q.zw));\n        \n        \n        if (Q.y - O.z< 0.) Q.y = O.z, Q.w = abs(Q.w);\n        if (Q.x - O.z< .5-.5*R.x/R.y) \n            Q.x = .5-.5*R.x/R.y + O.z, Q.z = abs(Q.z);\n        if (Q.x + O.z> .5+.5*R.x/R.y) \n            Q.x = .5+.5*R.x/R.y- O.z, Q.z = -abs(Q.z);\n        if (Q.y + O.z> 1.) Q.y = 1.-O.z, Q.w = -abs(Q.w);\n        \n    }\n    if (U.x < 2.*T)\n    Q = mix(Q0,Q,clamp(mod(U.x,T)-10.,0.,1.));\n    \n    if (I < 1) {\n    \n        Q = vec4(init (U.x,0.).xy, 0,0);\n        \n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buffer B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "Main {\n    U = floor(U);\n    if (U.y>1.||U.x>=N) discard;\n    Q = A(U);\n    vec4 Q0 = Q;\n    vec4 O = init(U.x,float(I)/60.);\n    \n    vec2 f = vec2(0,-3e-4*O.z);\n    for (float i = 0.; i < N; i++) {\n        vec4 q = A(vec2(i,0));\n        vec4 o = init(i,float(I)/60.);\n        vec2 r = q.xy-Q.xy;\n        float l = length(r);\n        float L = length(o.xy-O.xy);\n        \n        if (l > 0. && O.w == o.w) {\n        \n                f -= r/l*(L-l)/T*o.z*exp(-50.*L)*500.;\n        \n        }\n        if (L > 1.7*(o.z+O.z) || o.w != O.w) {\n            \n                \n                f += .1*r/l*clamp(l-1.1*(o.z+O.z+.005),-1.,0.);\n            \n        }\n        \n    }\n    \n    if (U.x < 2.*T) {\n        vec4 q = A(vec2(2.*T,0));\n        vec2 r = Q.xy - q.xy;\n        float l = length(r);\n        if (l>0.)\n        f -= .0001*r/l*exp(-2.*l);\n    }\n     \n     if (iMouse.z>0.) {\n        vec2 r = Q.xy - (iMouse.xy/R.y-vec2(.5*R.x-.5*R.y,0)/R.y);\n        float l = length(r);\n        if (l > 0.) \n        f += .001*r/l*exp(-2.*l);\n    }\n    {\n        float m = (.01+O.z*O.z);\n        if (O.w == 3.) m = .1;\n        f = f/m;\n        f = .03*f*inversesqrt(1.+dot(f,f));\n        Q.zw += f;\n        Q.xy += f + .03*Q.zw*inversesqrt(1.+dot(Q.zw,Q.zw));\n        \n        \n        if (Q.y - O.z< 0.) Q.y = O.z, Q.w = abs(Q.w);\n        if (Q.x - O.z< .5-.5*R.x/R.y) \n            Q.x = .5-.5*R.x/R.y + O.z, Q.z = abs(Q.z);\n        if (Q.x + O.z> .5+.5*R.x/R.y) \n            Q.x = .5+.5*R.x/R.y- O.z, Q.z = -abs(Q.z);\n        if (Q.y + O.z> 1.) Q.y = 1.-O.z, Q.w = -abs(Q.w);\n        \n    }\n    if (U.x < 2.*T)\n    Q = mix(Q0,Q,clamp(mod(U.x,T)-10.,0.,1.));\n    \n    if (I < 1) {\n    \n        Q = vec4(init (U.x,0.).xy, 0,0);\n        \n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buffer C",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 259
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "Main {\n    U = floor(U);\n    if (U.y>1.||U.x>=N) discard;\n    Q = A(U);\n    vec4 Q0 = Q;\n    vec4 O = init(U.x,float(I)/60.);\n    \n    vec2 f = vec2(0,-3e-4*O.z);\n    for (float i = 0.; i < N; i++) {\n        vec4 q = A(vec2(i,0));\n        vec4 o = init(i,float(I)/60.);\n        vec2 r = q.xy-Q.xy;\n        float l = length(r);\n        float L = length(o.xy-O.xy);\n        \n        if (l > 0. && O.w == o.w) {\n        \n                f -= r/l*(L-l)/T*o.z*exp(-50.*L)*500.;\n        \n        }\n        if (L > 1.7*(o.z+O.z) || o.w != O.w) {\n            \n                \n                f += .1*r/l*clamp(l-1.1*(o.z+O.z+.005),-1.,0.);\n            \n        }\n        \n    }\n    \n    if (U.x < 2.*T) {\n        vec4 q = A(vec2(2.*T,0));\n        vec2 r = Q.xy - q.xy;\n        float l = length(r);\n        if (l>0.)\n        f -= .0001*r/l*exp(-2.*l);\n    }\n     \n     if (iMouse.z>0.) {\n        vec2 r = Q.xy - (iMouse.xy/R.y-vec2(.5*R.x-.5*R.y,0)/R.y);\n        float l = length(r);\n        if (l > 0.) \n        f += .001*r/l*exp(-2.*l);\n    }\n    {\n        float m = (.01+O.z*O.z);\n        if (O.w == 3.) m = .1;\n        f = f/m;\n        f = .03*f*inversesqrt(1.+dot(f,f));\n        Q.zw += f;\n        Q.xy += f + .03*Q.zw*inversesqrt(1.+dot(Q.zw,Q.zw));\n        \n        \n        if (Q.y - O.z< 0.) Q.y = O.z, Q.w = abs(Q.w);\n        if (Q.x - O.z< .5-.5*R.x/R.y) \n            Q.x = .5-.5*R.x/R.y + O.z, Q.z = abs(Q.z);\n        if (Q.x + O.z> .5+.5*R.x/R.y) \n            Q.x = .5+.5*R.x/R.y- O.z, Q.z = -abs(Q.z);\n        if (Q.y + O.z> 1.) Q.y = 1.-O.z, Q.w = -abs(Q.w);\n        \n    }\n    if (U.x < 2.*T)\n    Q = mix(Q0,Q,clamp(mod(U.x,T)-10.,0.,1.));\n    \n    if (I < 1) {\n    \n        Q = vec4(init (U.x,0.).xy, 0,0);\n        \n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buffer D",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 260
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}