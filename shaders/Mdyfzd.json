{
    "Shader": {
        "info": {
            "date": "1529992106",
            "description": "Made use of evan wallace's wonderful tool - http://evanw.github.io/glslx/\nI bet this can be made <2000 chars. But can it be done in <1500?\n(update) 1936 chars, thanks to DJDoomz",
            "flags": 32,
            "hasliked": 0,
            "id": "Mdyfzd",
            "likes": 17,
            "name": "Pathtracer Golf",
            "published": 3,
            "tags": [
                "fast",
                "pathtracing",
                "montecarlo",
                "scatter",
                "golf"
            ],
            "usePreview": 0,
            "username": "tehsauce",
            "viewed": 1548
        },
        "renderpass": [
            {
                "code": "void mainImage( out vec4 g, in vec2 c )\n{\n\tg = texture( K, c/m.xy);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "#define h iTime\n#define m iResolution\n#define q iFrame\n#define K iChannel0\n#define Z float\n#define V vec3\n#define R return",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            },
            {
                "code": "V n=V(2.7,1,3),L=V(1,.4,.6),A=V(.1031,.11369,.13787);\nvec4 o=vec4(0,-.64,1.8,.43);\nZ p(uint a){a=(a<<13U)^a,a=a*(a*a*15731U+789221U)+1376312589U;\nR Z(a&uvec3(0x7fffffffU))/Z(0x7fffffff);}\nZ g(V a){a=fract(a*A),a+=dot(a,a.yzx+19.19);\nR -1.+2.*fract((a.x+a.y)*a.z);}\nZ s(V d,V e,int f){Z b=p(uint(f)),a=g(d+.34),c=g(e);\nR g(V(b*a+c,a+b,c*a));}\nV B(V i,V j,int k){Z b=p(uint(k)),c=g(i),d=g(j);\nZ e=6.28318*g(V(b,c,d)),a=2.*g(V(d+1.,2.*b+3.5,c*1.56+9.))-1.;\nZ f=sqrt(1.-a*a);R V(f*sin(e),f*cos(e),a);}\nZ C(V b,V c){V a=abs(b)-c;\nR min(max(a.x,max(a.y,a.z)),0.)+length(max(a,0.));}\nZ t(V a,Z c,Z d){a.x*=.24,a.y*=3.,a.z*=2.;Z b=40.*a.x;\nR length(a+V(0.,.45*sin(b),.45*cos(b)))-c;}\nZ l(V b,Z c){Z a=1e+6;\na=min(a,t(b-o.xyz,o.w,c)),a=min(a,-C(b,n));R a;}\nV D(in V b,Z c){vec2 a=vec2(1.,-1.)*.5773*5e-4;\nR normalize(a.xyy*l(b+a.xyy,c)+a.yyx*l(b+a.yyx,c)+\n                 a.yxy*l(b+a.yxy,c)+a.xxx*l(b+a.xxx,c));}\nV E(V b){V a=V(.9);\nif(b.x>n.x-1e-3)a.rb=vec2(0.);if(b.x<-n.x+1e-3)a.rg=vec2(0.);R a;}\nvoid F(inout V b,V d){Z a;\nfor(int c=0;c<284;c++){a=l(b,h);if(a<1e-4)break;b+=d*a*.25;}}\nvoid mainImage(out vec4 G,in vec2 H){vec2 u=H.xy/m.xy,d=u-.5;d.x*=m.x/m.y;\nV v=V(0);for(int f=0;f<2;f++){int i=q*2+f;\nvec2 w=1./m.xy;d.x+=w.x*p(uint(1e+4*h)),d.y+=w.y*p(uint(2e+4*h+3535.));\nV b=normalize(V(d,1.)),a=V(0.,0.,-1.),c=V(1),e=V(0);\nfor(int x=0;x<7;x++){F(a,b);V j=D(a,h);\nif(t(a-o.xyz,o.w,h)<.05){V y=V(sin(4.*a.x)+1.,.2,.5);\nc*=y,e+=.03*y;}else if(a.y>.99&&abs(a.x)<n.x*.94&&all(lessThan(\nmod(abs(.01*s(a,b,i)+a.xz+vec2(4.4,-.1)),1.5),vec2(1.3)))){e+=V(5);break;}\nelse c*=E(a),e+=V(.01);Z k=length(cross(j,b)),I=s(a,b,i);\nif(I>.9-.7*k*k*k)b=reflect(b,j);else{V J=B(a,b,i+10);\nb=normalize(8.*(J+j));}a+=.01*b;}c=e*c,c=pow(c,V(.44)),v+=c;}\nZ r=1.-1./Z(q);r=q<1?0.:r;V K=texture(K,u).rgb;\nG=vec4(mix(1./Z(2)*v,K,r),1.);}\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}