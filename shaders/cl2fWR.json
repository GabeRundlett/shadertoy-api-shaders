{
    "Shader": {
        "info": {
            "date": "1693933428",
            "description": "Integral over a square source of uniform current (left)\nIntegral over a square source of uniform magnetic moment (right)",
            "flags": 0,
            "hasliked": 0,
            "id": "cl2fWR",
            "likes": 22,
            "name": "Finite Source",
            "published": 3,
            "tags": [
                "field",
                "magnetic",
                "em"
            ],
            "usePreview": 0,
            "username": "wyatt",
            "viewed": 439
        },
        "renderpass": [
            {
                "code": "vec2 point_source (vec2 u, vec2 m) {\n    return 4.*normalize(u)*dot(m,normalize(u))/dot(u,u)-2.*m/dot(u,u);\n}\nMain {\n\n        vec2 H = \n            integral(U.x-.3*R.x,U.y-.5*R.y,.05*R.x)/300. + \n            integral(U.x-.7*R.x,U.y-.5*R.y,0.,-1.,.05*R.x)/10.;\n        \n        H.xy += 100.*point_source(U-.5*R,vec2(0.,-1.));\n        Q = clamp(.7+vec4(H.x,H.x+H.y,H.y,0),0.,1.)*(.7-\n                .25*smoothstep(120.*fwidth(H.x),0.,abs(sin(H.x*100.)))-\n                .25*smoothstep(120.*fwidth(H.y),0.,abs(sin(H.y*100.)))+\n                .5*smoothstep(80.*fwidth(length(H.xy)),0.,abs(sin(length(H.xy)*60.))));\n    \n    \n        //Q = vec4(0);\n        //Q.xy = .001*charge(U.x-.5*R.x,U.y-.5*R.y,100.,100.);\n    //Q.xy = H;\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "#define R iResolution.xy\n#define Main void mainImage(out vec4 Q, in vec2 U)\n\n\n\nvec2 integral (float X, float Y, float d) {\n    \n    return vec2(\n    \n        ( -.5*(d+X)*log((+d-Y)*(+d-Y)+(d+X)*(d+X))\n          -.5*(d-X)*log((+d-Y)*(+d-Y)+(d-X)*(d-X))\n          -(+d-Y)*(atan((d+X)/(+d-Y))+atan((d-X)/(+d-Y)))\n        )\n           \n          -\n          \n        ( -.5*(d+X)*log((-d-Y)*(-d-Y)+(d+X)*(d+X))\n          -.5*(d-X)*log((-d-Y)*(-d-Y)+(d-X)*(d-X))\n          -(-d-Y)*(atan((d+X)/(-d-Y))+atan((d-X)/(-d-Y)))\n        )\n        \n          ,\n          \n          \n        ( -.5*(+d-Y)*log((+d-Y)*(+d-Y)+(d+X)*(d+X))\n          +.5*(+d-Y)*log((+d-Y)*(+d-Y)+(d-X)*(d-X))\n          -(d+X)*atan((+d-Y)/(d+X))+(d-X)*atan((+d-Y)/(d-X))\n        )\n           \n          -\n          \n        ( -.5*(-d-Y)*log((-d-Y)*(-d-Y)+(d+X)*(d+X))\n          +.5*(-d-Y)*log((-d-Y)*(-d-Y)+(d-X)*(d-X))\n          -(d+X)*atan((-d-Y)/(d+X))+(d-X)*atan((-d-Y)/(d-X))\n        )\n    \n    );\n\n}\n\n\n\n\n\nvec2 integral (float X, float Y, float A, float B, float d) {\n    \n    return vec2 (\n        (\n            (B*log((-d-Y)*(-d-Y)+(+d-X)*(+d-X))+2.*A*atan((+d-X)/(-d-Y))) - \n            (B*log((-d-Y)*(-d-Y)+(-d-X)*(-d-X))+2.*A*atan((-d-X)/(-d-Y)))\n        ) - (\n            (B*log((+d-Y)*(+d-Y)+(+d-X)*(+d-X))+2.*A*atan((+d-X)/(+d-Y))) - \n            (B*log((+d-Y)*(+d-Y)+(-d-X)*(-d-X))+2.*A*atan((-d-X)/(+d-Y)))\n        )  , \n         (\n            (A*log((+d-Y)*(+d-Y)+(-d-X)*(-d-X))+2.*B*atan((+d-Y)/(-d-X))) - \n            (A*log((-d-Y)*(-d-Y)+(-d-X)*(-d-X))+2.*B*atan((-d-Y)/(-d-X)))\n        ) - (\n            (A*log((+d-Y)*(+d-Y)+(+d-X)*(+d-X))+2.*B*atan((+d-Y)/(+d-X))) - \n            (A*log((-d-Y)*(-d-Y)+(+d-X)*(+d-X))+2.*B*atan((-d-Y)/(+d-X)))\n        )\n    );\n\n}\n\nvec2 integral (vec2 r, vec2 _00, vec2 _01, vec2 _10, vec2 _11, float A, float B) {\n    \n    return vec2 (\n        (\n            (B*log((_11.y-r.y)*(_11.y-r.y)+(_11.x-r.x)*(_11.x-r.x))+2.*A*atan((_11.x-r.x)/(_11.y-r.y))) - \n            (B*log((_01.y-r.y)*(_01.y-r.y)+(_01.x-r.x)*(_01.x-r.x))+2.*A*atan((_01.x-r.x)/(_01.y-r.y)))\n        ) - (\n            (B*log((_10.y-r.y)*(_10.y-r.y)+(_10.x-r.x)*(_10.x-r.x))+2.*A*atan((_10.x-r.x)/(_10.y-r.y))) - \n            (B*log((_00.y-r.y)*(_00.y-r.y)+(_00.x-r.x)*(_00.x-r.x))+2.*A*atan((_00.x-r.x)/(_00.y-r.y)))\n        ) , \n         (\n            (A*log((_11.y-r.y)*(_11.y-r.y)+(_11.x-r.x)*(_11.x-r.x))+2.*B*atan((_11.y-r.y)/(_11.x-r.x))) - \n            (A*log((_01.y-r.y)*(_01.y-r.y)+(_01.x-r.x)*(_01.x-r.x))+2.*B*atan((_01.y-r.y)/(_01.x-r.x)))\n        ) - (\n            (A*log((_10.y-r.y)*(_10.y-r.y)+(_10.x-r.x)*(_10.x-r.x))+2.*B*atan((_10.y-r.y)/(_10.x-r.x))) - \n            (A*log((_00.y-r.y)*(_00.y-r.y)+(_00.x-r.x)*(_00.x-r.x))+2.*B*atan((_00.y-r.y)/(_00.x-r.x)))\n        ) \n    );\n\n}\n\n\n\nvec2 charge (float X, float Y, float x, float y) {\n\n    return vec2 (\n        \n        (\n           (+y+(X- +x)*atan((Y- +y)/(X- +x)) + .5*(Y- +y)*log((X- +x)*(X- +x)+(Y- +y)*(Y- +y))) - \n           (-y+(X- +x)*atan((Y- -y)/(X- +x)) + .5*(Y- -y)*log((X- +x)*(X- +x)+(Y- -y)*(Y- -y))) \n        ) - (\n           (+y+(X- -x)*atan((Y- +y)/(X- -x)) + .5*(Y- +y)*log((X- -x)*(X- -x)+(Y- +y)*(Y- +y))) - \n           (-y+(X- -x)*atan((Y- -y)/(X- -x)) + .5*(Y- -y)*log((X- -x)*(X- -x)+(Y- -y)*(Y- -y))) \n        ) ,\n        (\n           (+x+(Y- +y)*atan((X- +x)/(Y- +y)) + .5*(X- +x)*log((X- +x)*(X- +x)+(Y- +y)*(Y- +y))) - \n           (-x+(Y- +y)*atan((X- -x)/(Y- +y)) + .5*(X- -x)*log((X- -x)*(X- -x)+(Y- +y)*(Y- +y))) \n        ) - (\n           (+x+(Y- -y)*atan((X- +x)/(Y- -y)) + .5*(X- +x)*log((X- +x)*(X- +x)+(Y- -y)*(Y- -y))) - \n           (-x+(Y- -y)*atan((X- -x)/(Y- -y)) + .5*(X- -x)*log((X- -x)*(X- -x)+(Y- -y)*(Y- -y))) \n        )\n    \n    \n    );\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            }
        ],
        "ver": "0.1"
    }
}