{
    "Shader": {
        "info": {
            "date": "1642902787",
            "description": "Rough implementation of something like ISPH/IISPH on left; vanilla SPH on right. Better volume preservation, but can cause some odd artefacts (probably my fault, not a faithful impl)",
            "flags": 32,
            "hasliked": 0,
            "id": "sdfyDs",
            "likes": 13,
            "name": "Incompressible SPH",
            "published": 3,
            "tags": [
                "fluid",
                "particles",
                "poisson",
                "ca",
                "sph",
                "divergence"
            ],
            "usePreview": 1,
            "username": "davidar",
            "viewed": 437
        },
        "renderpass": [
            {
                "code": "// ISPH: https://doi.org/10.1016/j.cpc.2018.01.005\n// IISPH: https://interactivecomputergraphics.github.io/SPH-Tutorial/slides/02_incompressibility.pdf\n\n//#define DEBUG\n\nvoid mainImage( out vec4 col, in vec2 pos )\n{\n\tR = iResolution.xy; time = iTime;\n    ivec2 p = ivec2(pos);\n    \n    vec4 data = texel(ch0, pos);\n    particle P = getParticle(data, pos);\n    \n    col = vec4(P.M.x);\n    \n#ifdef DEBUG\n    if(pos.x < .25*R.x) {\n        float divV = P.divV;\n        float d = 100. * divV;\n        if (divV == 0. && P.M.x > 0.) col.b = 1.;\n        if (d > 0.) col.g += abs(d);\n        if (d < 0.) col.r += abs(d);\n    } else if(pos.x < .5*R.x) {\n        float p = -3. * texel(ch1, pos).x;\n        if (p > 0.) col.g += abs(p);\n        if (p < 0.) col.r += abs(p);\n        if (P.divV == 0. && P.M.x > 0.) col.b = 1.;\n    }\n#endif\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    },
                    {
                        "channel": 2,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "#define Bf(p) p\n#define Bi(p) ivec2(p)\n#define texel(a, p) texelFetch(a, Bi(p), 0)\n#define pixel(a, p) texture(a, (p)/R)\n#define ch0 iChannel0\n#define ch1 iChannel1\n#define ch2 iChannel2\n#define ch3 iChannel3\n\n#define PI 3.14159265\n\n#define loop(i,x) for(int i = 0; i < x; i++)\n#define range(i,a,b) for(int i = a; i <= b; i++)\n\n#define dt 1.\n\n#define border_h 5.\nvec2 R;\nvec4 Mouse;\nfloat time;\n\n#define mass 1.\n\n#define fluid_rho 0.5\n\nfloat Pf(vec2 rho)\n{\n    return 0.05*rho.x*(pow(rho.x/fluid_rho, 2.) - 1.); //water pressure\n}\n\nmat2 Rot(float ang)\n{\n    return mat2(cos(ang), -sin(ang), sin(ang), cos(ang)); \n}\n\nvec2 Dir(float ang)\n{\n    return vec2(cos(ang), sin(ang));\n}\n\n\nfloat sdBox( in vec2 p, in vec2 b )\n{\n    vec2 d = abs(p)-b;\n    return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nfloat border(vec2 p)\n{\n    vec2 r = R * vec2(.5,1);\n    p = mod(p,r);\n    float bound = -sdBox(p - r*0.5, r*vec2(0.49, 0.49));\n    //return min(bound, .4*R.y);\n    float box = sdBox(Rot(0.*time)*(p - r*vec2(0.5, 0.6)) , r*vec2(0.05, 0.01));\n    float drain = -sdBox(p - r*vec2(0.5, 0.7), r*vec2(1.5, 0.5));\n    return max(drain,min(bound, box));\n}\n\n#define h 1.\nvec3 bN(vec2 p)\n{\n    vec3 dx = vec3(-h,0,h);\n    vec4 idx = vec4(-1./h, 0., 1./h, 0.25);\n    //p = fract(2.*p);\n    vec3 r = idx.zyw*border(p + dx.zy)\n           + idx.xyw*border(p + dx.xy)\n           + idx.yzw*border(p + dx.yz)\n           + idx.yxw*border(p + dx.yx);\n    return vec3(normalize(r.xy), r.z + 1e-4);\n}\n\nuint pack(vec2 x)\n{\n    x = 65534.0*clamp(0.5*x+0.5, 0., 1.);\n    return uint(round(x.x)) + 65535u*uint(round(x.y));\n}\n\nvec2 unpack(uint a)\n{\n    vec2 x = vec2(a%65535u, a/65535u);\n    return clamp(x/65534.0, 0.,1.)*2.0 - 1.0;\n}\n\nvec2 decode(float x)\n{\n    uint X = floatBitsToUint(x);\n    return unpack(X); \n}\n\nfloat encode(vec2 x)\n{\n    uint X = pack(x);\n    return uintBitsToFloat(X); \n}\n\nstruct particle\n{\n    vec2 X;\n    vec2 V;\n    vec2 M;\n    float divV; // not a property of the particle, but the centre of the cell the particle is in\n};\n    \nparticle getParticle(vec4 data, vec2 pos)\n{\n    particle P; \n    P.X = decode(data.x) + pos;\n    P.V = decode(data.y);\n    P.M.x = data.z;\n    P.M.y = 1.;\n    P.divV = data.w;\n    return P;\n}\n\nvec4 saveParticle(particle P, vec2 pos)\n{\n    P.X = clamp(P.X - pos, vec2(-0.5), vec2(0.5));\n    P.V = clamp(P.V, vec2(-0.5), vec2(0.5));\n    //if(P.M.x == 0.) P.V = vec2(0);\n    return vec4(encode(P.X), encode(P.V), P.M.x, P.divV);\n}\n\nvec3 hash32(vec2 p)\n{\n\tvec3 p3 = fract(vec3(p.xyx) * vec3(.1031, .1030, .0973));\n    p3 += dot(p3, p3.yxz+33.33);\n    return fract((p3.xxy+p3.yzz)*p3.zyx);\n}\n\nfloat G(vec2 x)\n{\n    return exp(-dot(x,x));\n}\n\nfloat G0(vec2 x)\n{\n    return exp(-length(x));\n}\n",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            },
            {
                "code": "//diffusion amount\n#define dif 1.12\n/*\nvec3 distribution(vec2 x, vec2 p, float K)\n{\n    vec2 omin = clamp(x - K*0.5, p - 0.5, p + 0.5);\n    vec2 omax = clamp(x + K*0.5, p - 0.5, p + 0.5); \n    return vec3(0.5*(omin + omax), (omax.x - omin.x)*(omax.y - omin.y)/(K*K));\n}\n*/\n\nvec3 distribution(vec2 x, vec2 p, float K)\n{\n    vec4 aabb0 = vec4(p - 0.5, p + 0.5);\n    vec4 aabb1 = vec4(x - K*0.5, x + K*0.5);\n    vec4 aabbX = vec4(max(aabb0.xy, aabb1.xy), min(aabb0.zw, aabb1.zw));\n    vec2 center = 0.5*(aabbX.xy + aabbX.zw); //center of mass\n    vec2 size = max(aabbX.zw - aabbX.xy, 0.); //only positive\n    float m = size.x*size.y/(K*K); //relative amount\n    //if any of the dimensions are 0 then the mass is 0\n    return vec3(center, m);\n}\n\n//diffusion and advection basically\nvoid Reintegration(sampler2D ch, inout particle P, vec2 pos)\n{\n    float divV = 0., divX = 0.;\n    //basically integral over all updated neighbor distributions\n    //that fall inside of this pixel\n    //this makes the tracking conservative\n    range(i, -6, 6) range(j, -6, 6)\n    {\n        vec2 tpos = pos + vec2(i,j);\n        vec4 data = texel(ch, tpos);\n       \n        particle P0 = getParticle(data, tpos);\n       \n        P0.X += P0.V*dt; //integrate position\n\n        float difR = 0.9 + 0.21*smoothstep(fluid_rho*0., fluid_rho*0.333, P0.M.x);\n        vec3 D = distribution(P0.X, pos, difR);\n        //the deposited mass into this cell\n        float m = P0.M.x*D.z;\n        \n        //add weighted by mass\n        P.X += D.xy*m;\n        P.V += P0.V*m;\n        P.M.y += P0.M.y*m;\n        \n        //add mass\n        P.M.x += m;\n        \n        // compute divergence\n        vec2 dx = P0.X - pos;\n        vec2 gradG = G(dx) * dx;\n        divV += P0.M.x * dot(P0.V, gradG); // velocity divergence\n        divX += P0.M.x * dot(dx, gradG); // position divergence\n    }\n    \n    if(bN(pos).z < border_h) divX = 10.; // solid boundary\n    if(divX < 1.7) divV = 0.; // free surface\n    P.divV = divV;\n    \n    //normalization\n    if(P.M.x != 0.)\n    {\n        P.X /= P.M.x;\n        P.V /= P.M.x;\n        P.M.y /= P.M.x;\n    }\n}\n\nvoid mainImage( out vec4 U, in vec2 pos )\n{\n    R = iResolution.xy; time = iTime; Mouse = iMouse;\n    ivec2 p = ivec2(pos);\n\n    vec4 data = texel(ch0, pos); \n    \n    particle P;// = getParticle(data, pos);\n       \n    Reintegration(ch0, P, pos);\n   \n    //initial condition\n    if(iFrame < 1)\n    {\n        P.X = pos;\n        P.V = vec2(0);\n        P.M = vec2(0);\n        if(pos.y < .2*R.y) P.M = vec2(fluid_rho, 1);\n    }\n    \n    U = saveParticle(P, pos);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 260,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer03.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "// Created by Robert Schuetze - trirop/2017\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n// https://www.shadertoy.com/view/MdSczK\n\n// Pressure solver (density invariance)\n\nfloat rhs(int x,int y){\n    vec2 p = gl_FragCoord.xy+vec2(x,y);\n\tvec4 data = texture(iChannel2,p/iResolution.xy);\n    particle P = getParticle(data, gl_FragCoord.xy);\n    return fluid_rho - P.M.x;\n}\n\n// 1/|x| - like distribution (RHS = right hand side = div(v))\nfloat TwentyStepRHS( void ){\n    float p = 0.;\n    p+=1.*rhs(-19,0);\n    p+=19.*rhs(-18,-1);\n    p+=4.*rhs(-18,0);\n    p+=19.*rhs(-18,1);\n    p+=171.*rhs(-17,-2);\n    p+=72.*rhs(-17,-1);\n    p+=377.*rhs(-17,0);\n    p+=72.*rhs(-17,1);\n    p+=171.*rhs(-17,2);\n    p+=969.*rhs(-16,-3);\n    p+=612.*rhs(-16,-2);\n    p+=3521.*rhs(-16,-1);\n    p+=1360.*rhs(-16,0);\n    p+=3521.*rhs(-16,1);\n    p+=612.*rhs(-16,2);\n    p+=969.*rhs(-16,3);\n    p+=3876.*rhs(-15,-4);\n    p+=3264.*rhs(-15,-3);\n    p+=20587.*rhs(-15,-2);\n    p+=12040.*rhs(-15,-1);\n    p+=34121.*rhs(-15,0);\n    p+=12040.*rhs(-15,1);\n    p+=20587.*rhs(-15,2);\n    p+=3264.*rhs(-15,3);\n    p+=3876.*rhs(-15,4);\n    p+=11628.*rhs(-14,-5);\n    p+=12240.*rhs(-14,-4);\n    p+=84524.*rhs(-14,-3);\n    p+=66432.*rhs(-14,-2);\n    p+=206531.*rhs(-14,-1);\n    p+=111044.*rhs(-14,0);\n    p+=206531.*rhs(-14,1);\n    p+=66432.*rhs(-14,2);\n    p+=84524.*rhs(-14,3);\n    p+=12240.*rhs(-14,4);\n    p+=11628.*rhs(-14,5);\n    p+=27132.*rhs(-13,-6);\n    p+=34272.*rhs(-13,-5);\n    p+=259012.*rhs(-13,-4);\n    p+=256160.*rhs(-13,-3);\n    p+=874636.*rhs(-13,-2);\n    p+=636608.*rhs(-13,-1);\n    p+=1296593.*rhs(-13,0);\n    p+=636608.*rhs(-13,1);\n    p+=874636.*rhs(-13,2);\n    p+=256160.*rhs(-13,3);\n    p+=259012.*rhs(-13,4);\n    p+=34272.*rhs(-13,5);\n    p+=27132.*rhs(-13,6);\n    p+=50388.*rhs(-12,-7);\n    p+=74256.*rhs(-12,-6);\n    p+=614516.*rhs(-12,-5);\n    p+=733376.*rhs(-12,-4);\n    p+=2752228.*rhs(-12,-3);\n    p+=2539344.*rhs(-12,-2);\n    p+=5691972.*rhs(-12,-1);\n    p+=3802112.*rhs(-12,0);\n    p+=5691972.*rhs(-12,1);\n    p+=2539344.*rhs(-12,2);\n    p+=2752228.*rhs(-12,3);\n    p+=733376.*rhs(-12,4);\n    p+=614516.*rhs(-12,5);\n    p+=74256.*rhs(-12,6);\n    p+=50388.*rhs(-12,7);\n    p+=75582.*rhs(-11,-8);\n    p+=127296.*rhs(-11,-7);\n    p+=1155388.*rhs(-11,-6);\n    p+=1616160.*rhs(-11,-5);\n    p+=6672148.*rhs(-11,-4);\n    p+=7480032.*rhs(-11,-3);\n    p+=18513100.*rhs(-11,-2);\n    p+=15789824.*rhs(-11,-1);\n    p+=26001936.*rhs(-11,0);\n    p+=15789824.*rhs(-11,1);\n    p+=18513100.*rhs(-11,2);\n    p+=7480032.*rhs(-11,3);\n    p+=6672148.*rhs(-11,4);\n    p+=1616160.*rhs(-11,5);\n    p+=1155388.*rhs(-11,6);\n    p+=127296.*rhs(-11,7);\n    p+=75582.*rhs(-11,8);\n    p+=92378.*rhs(-10,-9);\n    p+=175032.*rhs(-10,-8);\n    p+=1747226.*rhs(-10,-7);\n    p+=2803840.*rhs(-10,-6);\n    p+=12751388.*rhs(-10,-5);\n    p+=16859024.*rhs(-10,-4);\n    p+=46169052.*rhs(-10,-3);\n    p+=48243200.*rhs(-10,-2);\n    p+=88069168.*rhs(-10,-1);\n    p+=68625984.*rhs(-10,0);\n    p+=88069168.*rhs(-10,1);\n    p+=48243200.*rhs(-10,2);\n    p+=46169052.*rhs(-10,3);\n    p+=16859024.*rhs(-10,4);\n    p+=12751388.*rhs(-10,5);\n    p+=2803840.*rhs(-10,6);\n    p+=1747226.*rhs(-10,7);\n    p+=175032.*rhs(-10,8);\n    p+=92378.*rhs(-10,9);\n    p+=92378.*rhs(-9,-10);\n    p+=194480.*rhs(-9,-9);\n    p+=2144142.*rhs(-9,-8);\n    p+=3882736.*rhs(-9,-7);\n    p+=19495658.*rhs(-9,-6);\n    p+=29726528.*rhs(-9,-5);\n    p+=90216308.*rhs(-9,-4);\n    p+=112093952.*rhs(-9,-3);\n    p+=228013680.*rhs(-9,-2);\n    p+=219617664.*rhs(-9,-1);\n    p+=312737680.*rhs(-9,0);\n    p+=219617664.*rhs(-9,1);\n    p+=228013680.*rhs(-9,2);\n    p+=112093952.*rhs(-9,3);\n    p+=90216308.*rhs(-9,4);\n    p+=29726528.*rhs(-9,5);\n    p+=19495658.*rhs(-9,6);\n    p+=3882736.*rhs(-9,7);\n    p+=2144142.*rhs(-9,8);\n    p+=194480.*rhs(-9,9);\n    p+=92378.*rhs(-9,10);\n    p+=75582.*rhs(-8,-11);\n    p+=175032.*rhs(-8,-10);\n    p+=2144142.*rhs(-8,-9);\n    p+=4324320.*rhs(-8,-8);\n    p+=24056318.*rhs(-8,-7);\n    p+=41569528.*rhs(-8,-6);\n    p+=140048558.*rhs(-8,-5);\n    p+=202185728.*rhs(-8,-4);\n    p+=459561168.*rhs(-8,-3);\n    p+=532099904.*rhs(-8,-2);\n    p+=850585168.*rhs(-8,-1);\n    p+=743089408.*rhs(-8,0);\n    p+=850585168.*rhs(-8,1);\n    p+=532099904.*rhs(-8,2);\n    p+=459561168.*rhs(-8,3);\n    p+=202185728.*rhs(-8,4);\n    p+=140048558.*rhs(-8,5);\n    p+=41569528.*rhs(-8,6);\n    p+=24056318.*rhs(-8,7);\n    p+=4324320.*rhs(-8,8);\n    p+=2144142.*rhs(-8,9);\n    p+=175032.*rhs(-8,10);\n    p+=75582.*rhs(-8,11);\n    p+=50388.*rhs(-7,-12);\n    p+=127296.*rhs(-7,-11);\n    p+=1747226.*rhs(-7,-10);\n    p+=3882736.*rhs(-7,-9);\n    p+=24056318.*rhs(-7,-8);\n    p+=46448688.*rhs(-7,-7);\n    p+=174151978.*rhs(-7,-6);\n    p+=286712448.*rhs(-7,-5);\n    p+=729241528.*rhs(-7,-4);\n    p+=991865088.*rhs(-7,-3);\n    p+=1792109680.*rhs(-7,-2);\n    p+=1907533696.*rhs(-7,-1);\n    p+=2460787216.*rhs(-7,0);\n    p+=1907533696.*rhs(-7,1);\n    p+=1792109680.*rhs(-7,2);\n    p+=991865088.*rhs(-7,3);\n    p+=729241528.*rhs(-7,4);\n    p+=286712448.*rhs(-7,5);\n    p+=174151978.*rhs(-7,6);\n    p+=46448688.*rhs(-7,7);\n    p+=24056318.*rhs(-7,8);\n    p+=3882736.*rhs(-7,9);\n    p+=1747226.*rhs(-7,10);\n    p+=127296.*rhs(-7,11);\n    p+=50388.*rhs(-7,12);\n    p+=27132.*rhs(-6,-13);\n    p+=74256.*rhs(-6,-12);\n    p+=1155388.*rhs(-6,-11);\n    p+=2803840.*rhs(-6,-10);\n    p+=19495658.*rhs(-6,-9);\n    p+=41569528.*rhs(-6,-8);\n    p+=174151978.*rhs(-6,-7);\n    p+=321877248.*rhs(-6,-6);\n    p+=917173928.*rhs(-6,-5);\n    p+=1436202848.*rhs(-6,-4);\n    p+=2939586856.*rhs(-6,-3);\n    p+=3736940032.*rhs(-6,-2);\n    p+=5531327920.*rhs(-6,-1);\n    p+=5284992064.*rhs(-6,0);\n    p+=5531327920.*rhs(-6,1);\n    p+=3736940032.*rhs(-6,2);\n    p+=2939586856.*rhs(-6,3);\n    p+=1436202848.*rhs(-6,4);\n    p+=917173928.*rhs(-6,5);\n    p+=321877248.*rhs(-6,6);\n    p+=174151978.*rhs(-6,7);\n    p+=41569528.*rhs(-6,8);\n    p+=19495658.*rhs(-6,9);\n    p+=2803840.*rhs(-6,10);\n    p+=1155388.*rhs(-6,11);\n    p+=74256.*rhs(-6,12);\n    p+=27132.*rhs(-6,13);\n    p+=11628.*rhs(-5,-14);\n    p+=34272.*rhs(-5,-13);\n    p+=614516.*rhs(-5,-12);\n    p+=1616160.*rhs(-5,-11);\n    p+=12751388.*rhs(-5,-10);\n    p+=29726528.*rhs(-5,-9);\n    p+=140048558.*rhs(-5,-8);\n    p+=286712448.*rhs(-5,-7);\n    p+=917173928.*rhs(-5,-6);\n    p+=1623903168.*rhs(-5,-5);\n    p+=3762860920.*rhs(-5,-4);\n    p+=5593339456.*rhs(-5,-3);\n    p+=9567332872.*rhs(-5,-2);\n    p+=11195845888.*rhs(-5,-1);\n    p+=13625875600.*rhs(-5,0);\n    p+=11195845888.*rhs(-5,1);\n    p+=9567332872.*rhs(-5,2);\n    p+=5593339456.*rhs(-5,3);\n    p+=3762860920.*rhs(-5,4);\n    p+=1623903168.*rhs(-5,5);\n    p+=917173928.*rhs(-5,6);\n    p+=286712448.*rhs(-5,7);\n    p+=140048558.*rhs(-5,8);\n    p+=29726528.*rhs(-5,9);\n    p+=12751388.*rhs(-5,10);\n    p+=1616160.*rhs(-5,11);\n    p+=614516.*rhs(-5,12);\n    p+=34272.*rhs(-5,13);\n    p+=11628.*rhs(-5,14);\n    p+=3876.*rhs(-4,-15);\n    p+=12240.*rhs(-4,-14);\n    p+=259012.*rhs(-4,-13);\n    p+=733376.*rhs(-4,-12);\n    p+=6672148.*rhs(-4,-11);\n    p+=16859024.*rhs(-4,-10);\n    p+=90216308.*rhs(-4,-9);\n    p+=202185728.*rhs(-4,-8);\n    p+=729241528.*rhs(-4,-7);\n    p+=1436202848.*rhs(-4,-6);\n    p+=3762860920.*rhs(-4,-5);\n    p+=6397998208.*rhs(-4,-4);\n    p+=12613706776.*rhs(-4,-3);\n    p+=17743206112.*rhs(-4,-2);\n    p+=25824041560.*rhs(-4,-1);\n    p+=26826818560.*rhs(-4,0);\n    p+=25824041560.*rhs(-4,1);\n    p+=17743206112.*rhs(-4,2);\n    p+=12613706776.*rhs(-4,3);\n    p+=6397998208.*rhs(-4,4);\n    p+=3762860920.*rhs(-4,5);\n    p+=1436202848.*rhs(-4,6);\n    p+=729241528.*rhs(-4,7);\n    p+=202185728.*rhs(-4,8);\n    p+=90216308.*rhs(-4,9);\n    p+=16859024.*rhs(-4,10);\n    p+=6672148.*rhs(-4,11);\n    p+=733376.*rhs(-4,12);\n    p+=259012.*rhs(-4,13);\n    p+=12240.*rhs(-4,14);\n    p+=3876.*rhs(-4,15);\n    p+=969.*rhs(-3,-16);\n    p+=3264.*rhs(-3,-15);\n    p+=84524.*rhs(-3,-14);\n    p+=256160.*rhs(-3,-13);\n    p+=2752228.*rhs(-3,-12);\n    p+=7480032.*rhs(-3,-11);\n    p+=46169052.*rhs(-3,-10);\n    p+=112093952.*rhs(-3,-9);\n    p+=459561168.*rhs(-3,-8);\n    p+=991865088.*rhs(-3,-7);\n    p+=2939586856.*rhs(-3,-6);\n    p+=5593339456.*rhs(-3,-5);\n    p+=12613706776.*rhs(-3,-4);\n    p+=20720283328.*rhs(-3,-3);\n    p+=35988002440.*rhs(-3,-2);\n    p+=47530295680.*rhs(-3,-1);\n    p+=57901756420.*rhs(-3,0);\n    p+=47530295680.*rhs(-3,1);\n    p+=35988002440.*rhs(-3,2);\n    p+=20720283328.*rhs(-3,3);\n    p+=12613706776.*rhs(-3,4);\n    p+=5593339456.*rhs(-3,5);\n    p+=2939586856.*rhs(-3,6);\n    p+=991865088.*rhs(-3,7);\n    p+=459561168.*rhs(-3,8);\n    p+=112093952.*rhs(-3,9);\n    p+=46169052.*rhs(-3,10);\n    p+=7480032.*rhs(-3,11);\n    p+=2752228.*rhs(-3,12);\n    p+=256160.*rhs(-3,13);\n    p+=84524.*rhs(-3,14);\n    p+=3264.*rhs(-3,15);\n    p+=969.*rhs(-3,16);\n    p+=171.*rhs(-2,-17);\n    p+=612.*rhs(-2,-16);\n    p+=20587.*rhs(-2,-15);\n    p+=66432.*rhs(-2,-14);\n    p+=874636.*rhs(-2,-13);\n    p+=2539344.*rhs(-2,-12);\n    p+=18513100.*rhs(-2,-11);\n    p+=48243200.*rhs(-2,-10);\n    p+=228013680.*rhs(-2,-9);\n    p+=532099904.*rhs(-2,-8);\n    p+=1792109680.*rhs(-2,-7);\n    p+=3736940032.*rhs(-2,-6);\n    p+=9567332872.*rhs(-2,-5);\n    p+=17743206112.*rhs(-2,-4);\n    p+=35988002440.*rhs(-2,-3);\n    p+=57958224640.*rhs(-2,-2);\n    p+=91565303500.*rhs(-2,-1);\n    p+=109719615760.*rhs(-2,0);\n    p+=91565303500.*rhs(-2,1);\n    p+=57958224640.*rhs(-2,2);\n    p+=35988002440.*rhs(-2,3);\n    p+=17743206112.*rhs(-2,4);\n    p+=9567332872.*rhs(-2,5);\n    p+=3736940032.*rhs(-2,6);\n    p+=1792109680.*rhs(-2,7);\n    p+=532099904.*rhs(-2,8);\n    p+=228013680.*rhs(-2,9);\n    p+=48243200.*rhs(-2,10);\n    p+=18513100.*rhs(-2,11);\n    p+=2539344.*rhs(-2,12);\n    p+=874636.*rhs(-2,13);\n    p+=66432.*rhs(-2,14);\n    p+=20587.*rhs(-2,15);\n    p+=612.*rhs(-2,16);\n    p+=171.*rhs(-2,17);\n    p+=19.*rhs(-1,-18);\n    p+=72.*rhs(-1,-17);\n    p+=3521.*rhs(-1,-16);\n    p+=12040.*rhs(-1,-15);\n    p+=206531.*rhs(-1,-14);\n    p+=636608.*rhs(-1,-13);\n    p+=5691972.*rhs(-1,-12);\n    p+=15789824.*rhs(-1,-11);\n    p+=88069168.*rhs(-1,-10);\n    p+=219617664.*rhs(-1,-9);\n    p+=850585168.*rhs(-1,-8);\n    p+=1907533696.*rhs(-1,-7);\n    p+=5531327920.*rhs(-1,-6);\n    p+=11195845888.*rhs(-1,-5);\n    p+=25824041560.*rhs(-1,-4);\n    p+=47530295680.*rhs(-1,-3);\n    p+=91565303500.*rhs(-1,-2);\n    p+=151053077920.*rhs(-1,-1);\n    p+=226056661220.*rhs(-1,0);\n    p+=151053077920.*rhs(-1,1);\n    p+=91565303500.*rhs(-1,2);\n    p+=47530295680.*rhs(-1,3);\n    p+=25824041560.*rhs(-1,4);\n    p+=11195845888.*rhs(-1,5);\n    p+=5531327920.*rhs(-1,6);\n    p+=1907533696.*rhs(-1,7);\n    p+=850585168.*rhs(-1,8);\n    p+=219617664.*rhs(-1,9);\n    p+=88069168.*rhs(-1,10);\n    p+=15789824.*rhs(-1,11);\n    p+=5691972.*rhs(-1,12);\n    p+=636608.*rhs(-1,13);\n    p+=206531.*rhs(-1,14);\n    p+=12040.*rhs(-1,15);\n    p+=3521.*rhs(-1,16);\n    p+=72.*rhs(-1,17);\n    p+=19.*rhs(-1,18);\n    p+=1.*rhs(0,-19);\n    p+=4.*rhs(0,-18);\n    p+=377.*rhs(0,-17);\n    p+=1360.*rhs(0,-16);\n    p+=34121.*rhs(0,-15);\n    p+=111044.*rhs(0,-14);\n    p+=1296593.*rhs(0,-13);\n    p+=3802112.*rhs(0,-12);\n    p+=26001936.*rhs(0,-11);\n    p+=68625984.*rhs(0,-10);\n    p+=312737680.*rhs(0,-9);\n    p+=743089408.*rhs(0,-8);\n    p+=2460787216.*rhs(0,-7);\n    p+=5284992064.*rhs(0,-6);\n    p+=13625875600.*rhs(0,-5);\n    p+=26826818560.*rhs(0,-4);\n    p+=57901756420.*rhs(0,-3);\n    p+=109719615760.*rhs(0,-2);\n    p+=226056661220.*rhs(0,-1);\n    p+=492400873280.*rhs(0,0);\n    p+=226056661220.*rhs(0,1);\n    p+=109719615760.*rhs(0,2);\n    p+=57901756420.*rhs(0,3);\n    p+=26826818560.*rhs(0,4);\n    p+=13625875600.*rhs(0,5);\n    p+=5284992064.*rhs(0,6);\n    p+=2460787216.*rhs(0,7);\n    p+=743089408.*rhs(0,8);\n    p+=312737680.*rhs(0,9);\n    p+=68625984.*rhs(0,10);\n    p+=26001936.*rhs(0,11);\n    p+=3802112.*rhs(0,12);\n    p+=1296593.*rhs(0,13);\n    p+=111044.*rhs(0,14);\n    p+=34121.*rhs(0,15);\n    p+=1360.*rhs(0,16);\n    p+=377.*rhs(0,17);\n    p+=4.*rhs(0,18);\n    p+=1.*rhs(0,19);\n    p+=19.*rhs(1,-18);\n    p+=72.*rhs(1,-17);\n    p+=3521.*rhs(1,-16);\n    p+=12040.*rhs(1,-15);\n    p+=206531.*rhs(1,-14);\n    p+=636608.*rhs(1,-13);\n    p+=5691972.*rhs(1,-12);\n    p+=15789824.*rhs(1,-11);\n    p+=88069168.*rhs(1,-10);\n    p+=219617664.*rhs(1,-9);\n    p+=850585168.*rhs(1,-8);\n    p+=1907533696.*rhs(1,-7);\n    p+=5531327920.*rhs(1,-6);\n    p+=11195845888.*rhs(1,-5);\n    p+=25824041560.*rhs(1,-4);\n    p+=47530295680.*rhs(1,-3);\n    p+=91565303500.*rhs(1,-2);\n    p+=151053077920.*rhs(1,-1);\n    p+=226056661220.*rhs(1,0);\n    p+=151053077920.*rhs(1,1);\n    p+=91565303500.*rhs(1,2);\n    p+=47530295680.*rhs(1,3);\n    p+=25824041560.*rhs(1,4);\n    p+=11195845888.*rhs(1,5);\n    p+=5531327920.*rhs(1,6);\n    p+=1907533696.*rhs(1,7);\n    p+=850585168.*rhs(1,8);\n    p+=219617664.*rhs(1,9);\n    p+=88069168.*rhs(1,10);\n    p+=15789824.*rhs(1,11);\n    p+=5691972.*rhs(1,12);\n    p+=636608.*rhs(1,13);\n    p+=206531.*rhs(1,14);\n    p+=12040.*rhs(1,15);\n    p+=3521.*rhs(1,16);\n    p+=72.*rhs(1,17);\n    p+=19.*rhs(1,18);\n    p+=171.*rhs(2,-17);\n    p+=612.*rhs(2,-16);\n    p+=20587.*rhs(2,-15);\n    p+=66432.*rhs(2,-14);\n    p+=874636.*rhs(2,-13);\n    p+=2539344.*rhs(2,-12);\n    p+=18513100.*rhs(2,-11);\n    p+=48243200.*rhs(2,-10);\n    p+=228013680.*rhs(2,-9);\n    p+=532099904.*rhs(2,-8);\n    p+=1792109680.*rhs(2,-7);\n    p+=3736940032.*rhs(2,-6);\n    p+=9567332872.*rhs(2,-5);\n    p+=17743206112.*rhs(2,-4);\n    p+=35988002440.*rhs(2,-3);\n    p+=57958224640.*rhs(2,-2);\n    p+=91565303500.*rhs(2,-1);\n    p+=109719615760.*rhs(2,0);\n    p+=91565303500.*rhs(2,1);\n    p+=57958224640.*rhs(2,2);\n    p+=35988002440.*rhs(2,3);\n    p+=17743206112.*rhs(2,4);\n    p+=9567332872.*rhs(2,5);\n    p+=3736940032.*rhs(2,6);\n    p+=1792109680.*rhs(2,7);\n    p+=532099904.*rhs(2,8);\n    p+=228013680.*rhs(2,9);\n    p+=48243200.*rhs(2,10);\n    p+=18513100.*rhs(2,11);\n    p+=2539344.*rhs(2,12);\n    p+=874636.*rhs(2,13);\n    p+=66432.*rhs(2,14);\n    p+=20587.*rhs(2,15);\n    p+=612.*rhs(2,16);\n    p+=171.*rhs(2,17);\n    p+=969.*rhs(3,-16);\n    p+=3264.*rhs(3,-15);\n    p+=84524.*rhs(3,-14);\n    p+=256160.*rhs(3,-13);\n    p+=2752228.*rhs(3,-12);\n    p+=7480032.*rhs(3,-11);\n    p+=46169052.*rhs(3,-10);\n    p+=112093952.*rhs(3,-9);\n    p+=459561168.*rhs(3,-8);\n    p+=991865088.*rhs(3,-7);\n    p+=2939586856.*rhs(3,-6);\n    p+=5593339456.*rhs(3,-5);\n    p+=12613706776.*rhs(3,-4);\n    p+=20720283328.*rhs(3,-3);\n    p+=35988002440.*rhs(3,-2);\n    p+=47530295680.*rhs(3,-1);\n    p+=57901756420.*rhs(3,0);\n    p+=47530295680.*rhs(3,1);\n    p+=35988002440.*rhs(3,2);\n    p+=20720283328.*rhs(3,3);\n    p+=12613706776.*rhs(3,4);\n    p+=5593339456.*rhs(3,5);\n    p+=2939586856.*rhs(3,6);\n    p+=991865088.*rhs(3,7);\n    p+=459561168.*rhs(3,8);\n    p+=112093952.*rhs(3,9);\n    p+=46169052.*rhs(3,10);\n    p+=7480032.*rhs(3,11);\n    p+=2752228.*rhs(3,12);\n    p+=256160.*rhs(3,13);\n    p+=84524.*rhs(3,14);\n    p+=3264.*rhs(3,15);\n    p+=969.*rhs(3,16);\n    p+=3876.*rhs(4,-15);\n    p+=12240.*rhs(4,-14);\n    p+=259012.*rhs(4,-13);\n    p+=733376.*rhs(4,-12);\n    p+=6672148.*rhs(4,-11);\n    p+=16859024.*rhs(4,-10);\n    p+=90216308.*rhs(4,-9);\n    p+=202185728.*rhs(4,-8);\n    p+=729241528.*rhs(4,-7);\n    p+=1436202848.*rhs(4,-6);\n    p+=3762860920.*rhs(4,-5);\n    p+=6397998208.*rhs(4,-4);\n    p+=12613706776.*rhs(4,-3);\n    p+=17743206112.*rhs(4,-2);\n    p+=25824041560.*rhs(4,-1);\n    p+=26826818560.*rhs(4,0);\n    p+=25824041560.*rhs(4,1);\n    p+=17743206112.*rhs(4,2);\n    p+=12613706776.*rhs(4,3);\n    p+=6397998208.*rhs(4,4);\n    p+=3762860920.*rhs(4,5);\n    p+=1436202848.*rhs(4,6);\n    p+=729241528.*rhs(4,7);\n    p+=202185728.*rhs(4,8);\n    p+=90216308.*rhs(4,9);\n    p+=16859024.*rhs(4,10);\n    p+=6672148.*rhs(4,11);\n    p+=733376.*rhs(4,12);\n    p+=259012.*rhs(4,13);\n    p+=12240.*rhs(4,14);\n    p+=3876.*rhs(4,15);\n    p+=11628.*rhs(5,-14);\n    p+=34272.*rhs(5,-13);\n    p+=614516.*rhs(5,-12);\n    p+=1616160.*rhs(5,-11);\n    p+=12751388.*rhs(5,-10);\n    p+=29726528.*rhs(5,-9);\n    p+=140048558.*rhs(5,-8);\n    p+=286712448.*rhs(5,-7);\n    p+=917173928.*rhs(5,-6);\n    p+=1623903168.*rhs(5,-5);\n    p+=3762860920.*rhs(5,-4);\n    p+=5593339456.*rhs(5,-3);\n    p+=9567332872.*rhs(5,-2);\n    p+=11195845888.*rhs(5,-1);\n    p+=13625875600.*rhs(5,0);\n    p+=11195845888.*rhs(5,1);\n    p+=9567332872.*rhs(5,2);\n    p+=5593339456.*rhs(5,3);\n    p+=3762860920.*rhs(5,4);\n    p+=1623903168.*rhs(5,5);\n    p+=917173928.*rhs(5,6);\n    p+=286712448.*rhs(5,7);\n    p+=140048558.*rhs(5,8);\n    p+=29726528.*rhs(5,9);\n    p+=12751388.*rhs(5,10);\n    p+=1616160.*rhs(5,11);\n    p+=614516.*rhs(5,12);\n    p+=34272.*rhs(5,13);\n    p+=11628.*rhs(5,14);\n    p+=27132.*rhs(6,-13);\n    p+=74256.*rhs(6,-12);\n    p+=1155388.*rhs(6,-11);\n    p+=2803840.*rhs(6,-10);\n    p+=19495658.*rhs(6,-9);\n    p+=41569528.*rhs(6,-8);\n    p+=174151978.*rhs(6,-7);\n    p+=321877248.*rhs(6,-6);\n    p+=917173928.*rhs(6,-5);\n    p+=1436202848.*rhs(6,-4);\n    p+=2939586856.*rhs(6,-3);\n    p+=3736940032.*rhs(6,-2);\n    p+=5531327920.*rhs(6,-1);\n    p+=5284992064.*rhs(6,0);\n    p+=5531327920.*rhs(6,1);\n    p+=3736940032.*rhs(6,2);\n    p+=2939586856.*rhs(6,3);\n    p+=1436202848.*rhs(6,4);\n    p+=917173928.*rhs(6,5);\n    p+=321877248.*rhs(6,6);\n    p+=174151978.*rhs(6,7);\n    p+=41569528.*rhs(6,8);\n    p+=19495658.*rhs(6,9);\n    p+=2803840.*rhs(6,10);\n    p+=1155388.*rhs(6,11);\n    p+=74256.*rhs(6,12);\n    p+=27132.*rhs(6,13);\n    p+=50388.*rhs(7,-12);\n    p+=127296.*rhs(7,-11);\n    p+=1747226.*rhs(7,-10);\n    p+=3882736.*rhs(7,-9);\n    p+=24056318.*rhs(7,-8);\n    p+=46448688.*rhs(7,-7);\n    p+=174151978.*rhs(7,-6);\n    p+=286712448.*rhs(7,-5);\n    p+=729241528.*rhs(7,-4);\n    p+=991865088.*rhs(7,-3);\n    p+=1792109680.*rhs(7,-2);\n    p+=1907533696.*rhs(7,-1);\n    p+=2460787216.*rhs(7,0);\n    p+=1907533696.*rhs(7,1);\n    p+=1792109680.*rhs(7,2);\n    p+=991865088.*rhs(7,3);\n    p+=729241528.*rhs(7,4);\n    p+=286712448.*rhs(7,5);\n    p+=174151978.*rhs(7,6);\n    p+=46448688.*rhs(7,7);\n    p+=24056318.*rhs(7,8);\n    p+=3882736.*rhs(7,9);\n    p+=1747226.*rhs(7,10);\n    p+=127296.*rhs(7,11);\n    p+=50388.*rhs(7,12);\n    p+=75582.*rhs(8,-11);\n    p+=175032.*rhs(8,-10);\n    p+=2144142.*rhs(8,-9);\n    p+=4324320.*rhs(8,-8);\n    p+=24056318.*rhs(8,-7);\n    p+=41569528.*rhs(8,-6);\n    p+=140048558.*rhs(8,-5);\n    p+=202185728.*rhs(8,-4);\n    p+=459561168.*rhs(8,-3);\n    p+=532099904.*rhs(8,-2);\n    p+=850585168.*rhs(8,-1);\n    p+=743089408.*rhs(8,0);\n    p+=850585168.*rhs(8,1);\n    p+=532099904.*rhs(8,2);\n    p+=459561168.*rhs(8,3);\n    p+=202185728.*rhs(8,4);\n    p+=140048558.*rhs(8,5);\n    p+=41569528.*rhs(8,6);\n    p+=24056318.*rhs(8,7);\n    p+=4324320.*rhs(8,8);\n    p+=2144142.*rhs(8,9);\n    p+=175032.*rhs(8,10);\n    p+=75582.*rhs(8,11);\n    p+=92378.*rhs(9,-10);\n    p+=194480.*rhs(9,-9);\n    p+=2144142.*rhs(9,-8);\n    p+=3882736.*rhs(9,-7);\n    p+=19495658.*rhs(9,-6);\n    p+=29726528.*rhs(9,-5);\n    p+=90216308.*rhs(9,-4);\n    p+=112093952.*rhs(9,-3);\n    p+=228013680.*rhs(9,-2);\n    p+=219617664.*rhs(9,-1);\n    p+=312737680.*rhs(9,0);\n    p+=219617664.*rhs(9,1);\n    p+=228013680.*rhs(9,2);\n    p+=112093952.*rhs(9,3);\n    p+=90216308.*rhs(9,4);\n    p+=29726528.*rhs(9,5);\n    p+=19495658.*rhs(9,6);\n    p+=3882736.*rhs(9,7);\n    p+=2144142.*rhs(9,8);\n    p+=194480.*rhs(9,9);\n    p+=92378.*rhs(9,10);\n    p+=92378.*rhs(10,-9);\n    p+=175032.*rhs(10,-8);\n    p+=1747226.*rhs(10,-7);\n    p+=2803840.*rhs(10,-6);\n    p+=12751388.*rhs(10,-5);\n    p+=16859024.*rhs(10,-4);\n    p+=46169052.*rhs(10,-3);\n    p+=48243200.*rhs(10,-2);\n    p+=88069168.*rhs(10,-1);\n    p+=68625984.*rhs(10,0);\n    p+=88069168.*rhs(10,1);\n    p+=48243200.*rhs(10,2);\n    p+=46169052.*rhs(10,3);\n    p+=16859024.*rhs(10,4);\n    p+=12751388.*rhs(10,5);\n    p+=2803840.*rhs(10,6);\n    p+=1747226.*rhs(10,7);\n    p+=175032.*rhs(10,8);\n    p+=92378.*rhs(10,9);\n    p+=75582.*rhs(11,-8);\n    p+=127296.*rhs(11,-7);\n    p+=1155388.*rhs(11,-6);\n    p+=1616160.*rhs(11,-5);\n    p+=6672148.*rhs(11,-4);\n    p+=7480032.*rhs(11,-3);\n    p+=18513100.*rhs(11,-2);\n    p+=15789824.*rhs(11,-1);\n    p+=26001936.*rhs(11,0);\n    p+=15789824.*rhs(11,1);\n    p+=18513100.*rhs(11,2);\n    p+=7480032.*rhs(11,3);\n    p+=6672148.*rhs(11,4);\n    p+=1616160.*rhs(11,5);\n    p+=1155388.*rhs(11,6);\n    p+=127296.*rhs(11,7);\n    p+=75582.*rhs(11,8);\n    p+=50388.*rhs(12,-7);\n    p+=74256.*rhs(12,-6);\n    p+=614516.*rhs(12,-5);\n    p+=733376.*rhs(12,-4);\n    p+=2752228.*rhs(12,-3);\n    p+=2539344.*rhs(12,-2);\n    p+=5691972.*rhs(12,-1);\n    p+=3802112.*rhs(12,0);\n    p+=5691972.*rhs(12,1);\n    p+=2539344.*rhs(12,2);\n    p+=2752228.*rhs(12,3);\n    p+=733376.*rhs(12,4);\n    p+=614516.*rhs(12,5);\n    p+=74256.*rhs(12,6);\n    p+=50388.*rhs(12,7);\n    p+=27132.*rhs(13,-6);\n    p+=34272.*rhs(13,-5);\n    p+=259012.*rhs(13,-4);\n    p+=256160.*rhs(13,-3);\n    p+=874636.*rhs(13,-2);\n    p+=636608.*rhs(13,-1);\n    p+=1296593.*rhs(13,0);\n    p+=636608.*rhs(13,1);\n    p+=874636.*rhs(13,2);\n    p+=256160.*rhs(13,3);\n    p+=259012.*rhs(13,4);\n    p+=34272.*rhs(13,5);\n    p+=27132.*rhs(13,6);\n    p+=11628.*rhs(14,-5);\n    p+=12240.*rhs(14,-4);\n    p+=84524.*rhs(14,-3);\n    p+=66432.*rhs(14,-2);\n    p+=206531.*rhs(14,-1);\n    p+=111044.*rhs(14,0);\n    p+=206531.*rhs(14,1);\n    p+=66432.*rhs(14,2);\n    p+=84524.*rhs(14,3);\n    p+=12240.*rhs(14,4);\n    p+=11628.*rhs(14,5);\n    p+=3876.*rhs(15,-4);\n    p+=3264.*rhs(15,-3);\n    p+=20587.*rhs(15,-2);\n    p+=12040.*rhs(15,-1);\n    p+=34121.*rhs(15,0);\n    p+=12040.*rhs(15,1);\n    p+=20587.*rhs(15,2);\n    p+=3264.*rhs(15,3);\n    p+=3876.*rhs(15,4);\n    p+=969.*rhs(16,-3);\n    p+=612.*rhs(16,-2);\n    p+=3521.*rhs(16,-1);\n    p+=1360.*rhs(16,0);\n    p+=3521.*rhs(16,1);\n    p+=612.*rhs(16,2);\n    p+=969.*rhs(16,3);\n    p+=171.*rhs(17,-2);\n    p+=72.*rhs(17,-1);\n    p+=377.*rhs(17,0);\n    p+=72.*rhs(17,1);\n    p+=171.*rhs(17,2);\n    p+=19.*rhs(18,-1);\n    p+=4.*rhs(18,0);\n    p+=19.*rhs(18,1);\n    p+=1.*rhs(19,0);\n    return p/1099511627776.;\n}\n\nfloat p0c(int x,int y){\n    vec2 p = gl_FragCoord.xy+vec2(x,y);\n\treturn texture(iChannel1,p/iResolution.xy).x;\n}\n\n// Gaussian - like redistribution of the previously calculated pressure p0c\nfloat TwentyStepPressure( void ){\n    float p = 0.;\n    p+=1.*p0c(-20,0);\n    p+=20.*p0c(-19,-1);\n    p+=20.*p0c(-19,1);\n    p+=190.*p0c(-18,-2);\n    p+=400.*p0c(-18,0);\n    p+=190.*p0c(-18,2);\n    p+=1140.*p0c(-17,-3);\n    p+=3800.*p0c(-17,-1);\n    p+=3800.*p0c(-17,1);\n    p+=1140.*p0c(-17,3);\n    p+=4845.*p0c(-16,-4);\n    p+=22800.*p0c(-16,-2);\n    p+=36100.*p0c(-16,0);\n    p+=22800.*p0c(-16,2);\n    p+=4845.*p0c(-16,4);\n    p+=15504.*p0c(-15,-5);\n    p+=96900.*p0c(-15,-3);\n    p+=216600.*p0c(-15,-1);\n    p+=216600.*p0c(-15,1);\n    p+=96900.*p0c(-15,3);\n    p+=15504.*p0c(-15,5);\n    p+=38760.*p0c(-14,-6);\n    p+=310080.*p0c(-14,-4);\n    p+=920550.*p0c(-14,-2);\n    p+=1299600.*p0c(-14,0);\n    p+=920550.*p0c(-14,2);\n    p+=310080.*p0c(-14,4);\n    p+=38760.*p0c(-14,6);\n    p+=77520.*p0c(-13,-7);\n    p+=775200.*p0c(-13,-5);\n    p+=2945760.*p0c(-13,-3);\n    p+=5523300.*p0c(-13,-1);\n    p+=5523300.*p0c(-13,1);\n    p+=2945760.*p0c(-13,3);\n    p+=775200.*p0c(-13,5);\n    p+=77520.*p0c(-13,7);\n    p+=125970.*p0c(-12,-8);\n    p+=1550400.*p0c(-12,-6);\n    p+=7364400.*p0c(-12,-4);\n    p+=17674560.*p0c(-12,-2);\n    p+=23474025.*p0c(-12,0);\n    p+=17674560.*p0c(-12,2);\n    p+=7364400.*p0c(-12,4);\n    p+=1550400.*p0c(-12,6);\n    p+=125970.*p0c(-12,8);\n    p+=167960.*p0c(-11,-9);\n    p+=2519400.*p0c(-11,-7);\n    p+=14728800.*p0c(-11,-5);\n    p+=44186400.*p0c(-11,-3);\n    p+=75116880.*p0c(-11,-1);\n    p+=75116880.*p0c(-11,1);\n    p+=44186400.*p0c(-11,3);\n    p+=14728800.*p0c(-11,5);\n    p+=2519400.*p0c(-11,7);\n    p+=167960.*p0c(-11,9);\n    p+=184756.*p0c(-10,-10);\n    p+=3359200.*p0c(-10,-8);\n    p+=23934300.*p0c(-10,-6);\n    p+=88372800.*p0c(-10,-4);\n    p+=187792200.*p0c(-10,-2);\n    p+=240374016.*p0c(-10,0);\n    p+=187792200.*p0c(-10,2);\n    p+=88372800.*p0c(-10,4);\n    p+=23934300.*p0c(-10,6);\n    p+=3359200.*p0c(-10,8);\n    p+=184756.*p0c(-10,10);\n    p+=167960.*p0c(-9,-11);\n    p+=3695120.*p0c(-9,-9);\n    p+=31912400.*p0c(-9,-7);\n    p+=143605800.*p0c(-9,-5);\n    p+=375584400.*p0c(-9,-3);\n    p+=600935040.*p0c(-9,-1);\n    p+=600935040.*p0c(-9,1);\n    p+=375584400.*p0c(-9,3);\n    p+=143605800.*p0c(-9,5);\n    p+=31912400.*p0c(-9,7);\n    p+=3695120.*p0c(-9,9);\n    p+=167960.*p0c(-9,11);\n    p+=125970.*p0c(-8,-12);\n    p+=3359200.*p0c(-8,-10);\n    p+=35103640.*p0c(-8,-8);\n    p+=191474400.*p0c(-8,-6);\n    p+=610324650.*p0c(-8,-4);\n    p+=1201870080.*p0c(-8,-2);\n    p+=1502337600.*p0c(-8,0);\n    p+=1201870080.*p0c(-8,2);\n    p+=610324650.*p0c(-8,4);\n    p+=191474400.*p0c(-8,6);\n    p+=35103640.*p0c(-8,8);\n    p+=3359200.*p0c(-8,10);\n    p+=125970.*p0c(-8,12);\n    p+=77520.*p0c(-7,-13);\n    p+=2519400.*p0c(-7,-11);\n    p+=31912400.*p0c(-7,-9);\n    p+=210621840.*p0c(-7,-7);\n    p+=813766200.*p0c(-7,-5);\n    p+=1953038880.*p0c(-7,-3);\n    p+=3004675200.*p0c(-7,-1);\n    p+=3004675200.*p0c(-7,1);\n    p+=1953038880.*p0c(-7,3);\n    p+=813766200.*p0c(-7,5);\n    p+=210621840.*p0c(-7,7);\n    p+=31912400.*p0c(-7,9);\n    p+=2519400.*p0c(-7,11);\n    p+=77520.*p0c(-7,13);\n    p+=38760.*p0c(-6,-14);\n    p+=1550400.*p0c(-6,-12);\n    p+=23934300.*p0c(-6,-10);\n    p+=191474400.*p0c(-6,-8);\n    p+=895142820.*p0c(-6,-6);\n    p+=2604051840.*p0c(-6,-4);\n    p+=4882597200.*p0c(-6,-2);\n    p+=6009350400.*p0c(-6,0);\n    p+=4882597200.*p0c(-6,2);\n    p+=2604051840.*p0c(-6,4);\n    p+=895142820.*p0c(-6,6);\n    p+=191474400.*p0c(-6,8);\n    p+=23934300.*p0c(-6,10);\n    p+=1550400.*p0c(-6,12);\n    p+=38760.*p0c(-6,14);\n    p+=15504.*p0c(-5,-15);\n    p+=775200.*p0c(-5,-13);\n    p+=14728800.*p0c(-5,-11);\n    p+=143605800.*p0c(-5,-9);\n    p+=813766200.*p0c(-5,-7);\n    p+=2864457024.*p0c(-5,-5);\n    p+=6510129600.*p0c(-5,-3);\n    p+=9765194400.*p0c(-5,-1);\n    p+=9765194400.*p0c(-5,1);\n    p+=6510129600.*p0c(-5,3);\n    p+=2864457024.*p0c(-5,5);\n    p+=813766200.*p0c(-5,7);\n    p+=143605800.*p0c(-5,9);\n    p+=14728800.*p0c(-5,11);\n    p+=775200.*p0c(-5,13);\n    p+=15504.*p0c(-5,15);\n    p+=4845.*p0c(-4,-16);\n    p+=310080.*p0c(-4,-14);\n    p+=7364400.*p0c(-4,-12);\n    p+=88372800.*p0c(-4,-10);\n    p+=610324650.*p0c(-4,-8);\n    p+=2604051840.*p0c(-4,-6);\n    p+=7161142560.*p0c(-4,-4);\n    p+=13020259200.*p0c(-4,-2);\n    p+=15868440900.*p0c(-4,0);\n    p+=13020259200.*p0c(-4,2);\n    p+=7161142560.*p0c(-4,4);\n    p+=2604051840.*p0c(-4,6);\n    p+=610324650.*p0c(-4,8);\n    p+=88372800.*p0c(-4,10);\n    p+=7364400.*p0c(-4,12);\n    p+=310080.*p0c(-4,14);\n    p+=4845.*p0c(-4,16);\n    p+=1140.*p0c(-3,-17);\n    p+=96900.*p0c(-3,-15);\n    p+=2945760.*p0c(-3,-13);\n    p+=44186400.*p0c(-3,-11);\n    p+=375584400.*p0c(-3,-9);\n    p+=1953038880.*p0c(-3,-7);\n    p+=6510129600.*p0c(-3,-5);\n    p+=14322285120.*p0c(-3,-3);\n    p+=21157921200.*p0c(-3,-1);\n    p+=21157921200.*p0c(-3,1);\n    p+=14322285120.*p0c(-3,3);\n    p+=6510129600.*p0c(-3,5);\n    p+=1953038880.*p0c(-3,7);\n    p+=375584400.*p0c(-3,9);\n    p+=44186400.*p0c(-3,11);\n    p+=2945760.*p0c(-3,13);\n    p+=96900.*p0c(-3,15);\n    p+=1140.*p0c(-3,17);\n    p+=190.*p0c(-2,-18);\n    p+=22800.*p0c(-2,-16);\n    p+=920550.*p0c(-2,-14);\n    p+=17674560.*p0c(-2,-12);\n    p+=187792200.*p0c(-2,-10);\n    p+=1201870080.*p0c(-2,-8);\n    p+=4882597200.*p0c(-2,-6);\n    p+=13020259200.*p0c(-2,-4);\n    p+=23273713320.*p0c(-2,-2);\n    p+=28210561600.*p0c(-2,0);\n    p+=23273713320.*p0c(-2,2);\n    p+=13020259200.*p0c(-2,4);\n    p+=4882597200.*p0c(-2,6);\n    p+=1201870080.*p0c(-2,8);\n    p+=187792200.*p0c(-2,10);\n    p+=17674560.*p0c(-2,12);\n    p+=920550.*p0c(-2,14);\n    p+=22800.*p0c(-2,16);\n    p+=190.*p0c(-2,18);\n    p+=20.*p0c(-1,-19);\n    p+=3800.*p0c(-1,-17);\n    p+=216600.*p0c(-1,-15);\n    p+=5523300.*p0c(-1,-13);\n    p+=75116880.*p0c(-1,-11);\n    p+=600935040.*p0c(-1,-9);\n    p+=3004675200.*p0c(-1,-7);\n    p+=9765194400.*p0c(-1,-5);\n    p+=21157921200.*p0c(-1,-3);\n    p+=31031617760.*p0c(-1,-1);\n    p+=31031617760.*p0c(-1,1);\n    p+=21157921200.*p0c(-1,3);\n    p+=9765194400.*p0c(-1,5);\n    p+=3004675200.*p0c(-1,7);\n    p+=600935040.*p0c(-1,9);\n    p+=75116880.*p0c(-1,11);\n    p+=5523300.*p0c(-1,13);\n    p+=216600.*p0c(-1,15);\n    p+=3800.*p0c(-1,17);\n    p+=20.*p0c(-1,19);\n    p+=1.*p0c(0,-20);\n    p+=400.*p0c(0,-18);\n    p+=36100.*p0c(0,-16);\n    p+=1299600.*p0c(0,-14);\n    p+=23474025.*p0c(0,-12);\n    p+=240374016.*p0c(0,-10);\n    p+=1502337600.*p0c(0,-8);\n    p+=6009350400.*p0c(0,-6);\n    p+=15868440900.*p0c(0,-4);\n    p+=28210561600.*p0c(0,-2);\n    p+=34134779536.*p0c(0,0);\n    p+=28210561600.*p0c(0,2);\n    p+=15868440900.*p0c(0,4);\n    p+=6009350400.*p0c(0,6);\n    p+=1502337600.*p0c(0,8);\n    p+=240374016.*p0c(0,10);\n    p+=23474025.*p0c(0,12);\n    p+=1299600.*p0c(0,14);\n    p+=36100.*p0c(0,16);\n    p+=400.*p0c(0,18);\n    p+=1.*p0c(0,20);\n    p+=20.*p0c(1,-19);\n    p+=3800.*p0c(1,-17);\n    p+=216600.*p0c(1,-15);\n    p+=5523300.*p0c(1,-13);\n    p+=75116880.*p0c(1,-11);\n    p+=600935040.*p0c(1,-9);\n    p+=3004675200.*p0c(1,-7);\n    p+=9765194400.*p0c(1,-5);\n    p+=21157921200.*p0c(1,-3);\n    p+=31031617760.*p0c(1,-1);\n    p+=31031617760.*p0c(1,1);\n    p+=21157921200.*p0c(1,3);\n    p+=9765194400.*p0c(1,5);\n    p+=3004675200.*p0c(1,7);\n    p+=600935040.*p0c(1,9);\n    p+=75116880.*p0c(1,11);\n    p+=5523300.*p0c(1,13);\n    p+=216600.*p0c(1,15);\n    p+=3800.*p0c(1,17);\n    p+=20.*p0c(1,19);\n    p+=190.*p0c(2,-18);\n    p+=22800.*p0c(2,-16);\n    p+=920550.*p0c(2,-14);\n    p+=17674560.*p0c(2,-12);\n    p+=187792200.*p0c(2,-10);\n    p+=1201870080.*p0c(2,-8);\n    p+=4882597200.*p0c(2,-6);\n    p+=13020259200.*p0c(2,-4);\n    p+=23273713320.*p0c(2,-2);\n    p+=28210561600.*p0c(2,0);\n    p+=23273713320.*p0c(2,2);\n    p+=13020259200.*p0c(2,4);\n    p+=4882597200.*p0c(2,6);\n    p+=1201870080.*p0c(2,8);\n    p+=187792200.*p0c(2,10);\n    p+=17674560.*p0c(2,12);\n    p+=920550.*p0c(2,14);\n    p+=22800.*p0c(2,16);\n    p+=190.*p0c(2,18);\n    p+=1140.*p0c(3,-17);\n    p+=96900.*p0c(3,-15);\n    p+=2945760.*p0c(3,-13);\n    p+=44186400.*p0c(3,-11);\n    p+=375584400.*p0c(3,-9);\n    p+=1953038880.*p0c(3,-7);\n    p+=6510129600.*p0c(3,-5);\n    p+=14322285120.*p0c(3,-3);\n    p+=21157921200.*p0c(3,-1);\n    p+=21157921200.*p0c(3,1);\n    p+=14322285120.*p0c(3,3);\n    p+=6510129600.*p0c(3,5);\n    p+=1953038880.*p0c(3,7);\n    p+=375584400.*p0c(3,9);\n    p+=44186400.*p0c(3,11);\n    p+=2945760.*p0c(3,13);\n    p+=96900.*p0c(3,15);\n    p+=1140.*p0c(3,17);\n    p+=4845.*p0c(4,-16);\n    p+=310080.*p0c(4,-14);\n    p+=7364400.*p0c(4,-12);\n    p+=88372800.*p0c(4,-10);\n    p+=610324650.*p0c(4,-8);\n    p+=2604051840.*p0c(4,-6);\n    p+=7161142560.*p0c(4,-4);\n    p+=13020259200.*p0c(4,-2);\n    p+=15868440900.*p0c(4,0);\n    p+=13020259200.*p0c(4,2);\n    p+=7161142560.*p0c(4,4);\n    p+=2604051840.*p0c(4,6);\n    p+=610324650.*p0c(4,8);\n    p+=88372800.*p0c(4,10);\n    p+=7364400.*p0c(4,12);\n    p+=310080.*p0c(4,14);\n    p+=4845.*p0c(4,16);\n    p+=15504.*p0c(5,-15);\n    p+=775200.*p0c(5,-13);\n    p+=14728800.*p0c(5,-11);\n    p+=143605800.*p0c(5,-9);\n    p+=813766200.*p0c(5,-7);\n    p+=2864457024.*p0c(5,-5);\n    p+=6510129600.*p0c(5,-3);\n    p+=9765194400.*p0c(5,-1);\n    p+=9765194400.*p0c(5,1);\n    p+=6510129600.*p0c(5,3);\n    p+=2864457024.*p0c(5,5);\n    p+=813766200.*p0c(5,7);\n    p+=143605800.*p0c(5,9);\n    p+=14728800.*p0c(5,11);\n    p+=775200.*p0c(5,13);\n    p+=15504.*p0c(5,15);\n    p+=38760.*p0c(6,-14);\n    p+=1550400.*p0c(6,-12);\n    p+=23934300.*p0c(6,-10);\n    p+=191474400.*p0c(6,-8);\n    p+=895142820.*p0c(6,-6);\n    p+=2604051840.*p0c(6,-4);\n    p+=4882597200.*p0c(6,-2);\n    p+=6009350400.*p0c(6,0);\n    p+=4882597200.*p0c(6,2);\n    p+=2604051840.*p0c(6,4);\n    p+=895142820.*p0c(6,6);\n    p+=191474400.*p0c(6,8);\n    p+=23934300.*p0c(6,10);\n    p+=1550400.*p0c(6,12);\n    p+=38760.*p0c(6,14);\n    p+=77520.*p0c(7,-13);\n    p+=2519400.*p0c(7,-11);\n    p+=31912400.*p0c(7,-9);\n    p+=210621840.*p0c(7,-7);\n    p+=813766200.*p0c(7,-5);\n    p+=1953038880.*p0c(7,-3);\n    p+=3004675200.*p0c(7,-1);\n    p+=3004675200.*p0c(7,1);\n    p+=1953038880.*p0c(7,3);\n    p+=813766200.*p0c(7,5);\n    p+=210621840.*p0c(7,7);\n    p+=31912400.*p0c(7,9);\n    p+=2519400.*p0c(7,11);\n    p+=77520.*p0c(7,13);\n    p+=125970.*p0c(8,-12);\n    p+=3359200.*p0c(8,-10);\n    p+=35103640.*p0c(8,-8);\n    p+=191474400.*p0c(8,-6);\n    p+=610324650.*p0c(8,-4);\n    p+=1201870080.*p0c(8,-2);\n    p+=1502337600.*p0c(8,0);\n    p+=1201870080.*p0c(8,2);\n    p+=610324650.*p0c(8,4);\n    p+=191474400.*p0c(8,6);\n    p+=35103640.*p0c(8,8);\n    p+=3359200.*p0c(8,10);\n    p+=125970.*p0c(8,12);\n    p+=167960.*p0c(9,-11);\n    p+=3695120.*p0c(9,-9);\n    p+=31912400.*p0c(9,-7);\n    p+=143605800.*p0c(9,-5);\n    p+=375584400.*p0c(9,-3);\n    p+=600935040.*p0c(9,-1);\n    p+=600935040.*p0c(9,1);\n    p+=375584400.*p0c(9,3);\n    p+=143605800.*p0c(9,5);\n    p+=31912400.*p0c(9,7);\n    p+=3695120.*p0c(9,9);\n    p+=167960.*p0c(9,11);\n    p+=184756.*p0c(10,-10);\n    p+=3359200.*p0c(10,-8);\n    p+=23934300.*p0c(10,-6);\n    p+=88372800.*p0c(10,-4);\n    p+=187792200.*p0c(10,-2);\n    p+=240374016.*p0c(10,0);\n    p+=187792200.*p0c(10,2);\n    p+=88372800.*p0c(10,4);\n    p+=23934300.*p0c(10,6);\n    p+=3359200.*p0c(10,8);\n    p+=184756.*p0c(10,10);\n    p+=167960.*p0c(11,-9);\n    p+=2519400.*p0c(11,-7);\n    p+=14728800.*p0c(11,-5);\n    p+=44186400.*p0c(11,-3);\n    p+=75116880.*p0c(11,-1);\n    p+=75116880.*p0c(11,1);\n    p+=44186400.*p0c(11,3);\n    p+=14728800.*p0c(11,5);\n    p+=2519400.*p0c(11,7);\n    p+=167960.*p0c(11,9);\n    p+=125970.*p0c(12,-8);\n    p+=1550400.*p0c(12,-6);\n    p+=7364400.*p0c(12,-4);\n    p+=17674560.*p0c(12,-2);\n    p+=23474025.*p0c(12,0);\n    p+=17674560.*p0c(12,2);\n    p+=7364400.*p0c(12,4);\n    p+=1550400.*p0c(12,6);\n    p+=125970.*p0c(12,8);\n    p+=77520.*p0c(13,-7);\n    p+=775200.*p0c(13,-5);\n    p+=2945760.*p0c(13,-3);\n    p+=5523300.*p0c(13,-1);\n    p+=5523300.*p0c(13,1);\n    p+=2945760.*p0c(13,3);\n    p+=775200.*p0c(13,5);\n    p+=77520.*p0c(13,7);\n    p+=38760.*p0c(14,-6);\n    p+=310080.*p0c(14,-4);\n    p+=920550.*p0c(14,-2);\n    p+=1299600.*p0c(14,0);\n    p+=920550.*p0c(14,2);\n    p+=310080.*p0c(14,4);\n    p+=38760.*p0c(14,6);\n    p+=15504.*p0c(15,-5);\n    p+=96900.*p0c(15,-3);\n    p+=216600.*p0c(15,-1);\n    p+=216600.*p0c(15,1);\n    p+=96900.*p0c(15,3);\n    p+=15504.*p0c(15,5);\n    p+=4845.*p0c(16,-4);\n    p+=22800.*p0c(16,-2);\n    p+=36100.*p0c(16,0);\n    p+=22800.*p0c(16,2);\n    p+=4845.*p0c(16,4);\n    p+=1140.*p0c(17,-3);\n    p+=3800.*p0c(17,-1);\n    p+=3800.*p0c(17,1);\n    p+=1140.*p0c(17,3);\n    p+=190.*p0c(18,-2);\n    p+=400.*p0c(18,0);\n    p+=190.*p0c(18,2);\n    p+=20.*p0c(19,-1);\n    p+=20.*p0c(19,1);\n    p+=1.*p0c(20,0);\n    return p/1099511627776.;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 C )\n{ \n    if(C.x > .5*iResolution.x) return;\n    vec4 data = texel(ch2, C);\n    particle P = getParticle(data, C);\n    fragColor = vec4(0);\n    \n    if(P.M.x == 0.) return;\n    \n    //float divV = rhs(0,0);\n    //float divX = texel(ch0, C).y;\n    if(P.divV == 0.) return; // free surface\n    \n    float p = TwentyStepRHS()+TwentyStepPressure();\n    //if(C.x < 1. || C.y < 1. || C.x > iResolution.x-1. || C.y > iResolution.y-1.) p = 0.;\n    fragColor = vec4(p,0,0,1);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buffer B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "// Created by Robert Schuetze - trirop/2017\n// License Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.\n// https://www.shadertoy.com/view/MdSczK\n\n// Pressure solver (velocity divergence)\n\nfloat rhs(int x,int y){\n    vec2 p = gl_FragCoord.xy+vec2(x,y);\n\tvec4 data = texture(iChannel2,p/iResolution.xy);\n    particle P = getParticle(data, gl_FragCoord.xy);\n    return P.divV;\n}\n\n// 1/|x| - like distribution (RHS = right hand side = div(v))\nfloat TwentyStepRHS( void ){\n    float p = 0.;\n    p+=1.*rhs(-19,0);\n    p+=19.*rhs(-18,-1);\n    p+=4.*rhs(-18,0);\n    p+=19.*rhs(-18,1);\n    p+=171.*rhs(-17,-2);\n    p+=72.*rhs(-17,-1);\n    p+=377.*rhs(-17,0);\n    p+=72.*rhs(-17,1);\n    p+=171.*rhs(-17,2);\n    p+=969.*rhs(-16,-3);\n    p+=612.*rhs(-16,-2);\n    p+=3521.*rhs(-16,-1);\n    p+=1360.*rhs(-16,0);\n    p+=3521.*rhs(-16,1);\n    p+=612.*rhs(-16,2);\n    p+=969.*rhs(-16,3);\n    p+=3876.*rhs(-15,-4);\n    p+=3264.*rhs(-15,-3);\n    p+=20587.*rhs(-15,-2);\n    p+=12040.*rhs(-15,-1);\n    p+=34121.*rhs(-15,0);\n    p+=12040.*rhs(-15,1);\n    p+=20587.*rhs(-15,2);\n    p+=3264.*rhs(-15,3);\n    p+=3876.*rhs(-15,4);\n    p+=11628.*rhs(-14,-5);\n    p+=12240.*rhs(-14,-4);\n    p+=84524.*rhs(-14,-3);\n    p+=66432.*rhs(-14,-2);\n    p+=206531.*rhs(-14,-1);\n    p+=111044.*rhs(-14,0);\n    p+=206531.*rhs(-14,1);\n    p+=66432.*rhs(-14,2);\n    p+=84524.*rhs(-14,3);\n    p+=12240.*rhs(-14,4);\n    p+=11628.*rhs(-14,5);\n    p+=27132.*rhs(-13,-6);\n    p+=34272.*rhs(-13,-5);\n    p+=259012.*rhs(-13,-4);\n    p+=256160.*rhs(-13,-3);\n    p+=874636.*rhs(-13,-2);\n    p+=636608.*rhs(-13,-1);\n    p+=1296593.*rhs(-13,0);\n    p+=636608.*rhs(-13,1);\n    p+=874636.*rhs(-13,2);\n    p+=256160.*rhs(-13,3);\n    p+=259012.*rhs(-13,4);\n    p+=34272.*rhs(-13,5);\n    p+=27132.*rhs(-13,6);\n    p+=50388.*rhs(-12,-7);\n    p+=74256.*rhs(-12,-6);\n    p+=614516.*rhs(-12,-5);\n    p+=733376.*rhs(-12,-4);\n    p+=2752228.*rhs(-12,-3);\n    p+=2539344.*rhs(-12,-2);\n    p+=5691972.*rhs(-12,-1);\n    p+=3802112.*rhs(-12,0);\n    p+=5691972.*rhs(-12,1);\n    p+=2539344.*rhs(-12,2);\n    p+=2752228.*rhs(-12,3);\n    p+=733376.*rhs(-12,4);\n    p+=614516.*rhs(-12,5);\n    p+=74256.*rhs(-12,6);\n    p+=50388.*rhs(-12,7);\n    p+=75582.*rhs(-11,-8);\n    p+=127296.*rhs(-11,-7);\n    p+=1155388.*rhs(-11,-6);\n    p+=1616160.*rhs(-11,-5);\n    p+=6672148.*rhs(-11,-4);\n    p+=7480032.*rhs(-11,-3);\n    p+=18513100.*rhs(-11,-2);\n    p+=15789824.*rhs(-11,-1);\n    p+=26001936.*rhs(-11,0);\n    p+=15789824.*rhs(-11,1);\n    p+=18513100.*rhs(-11,2);\n    p+=7480032.*rhs(-11,3);\n    p+=6672148.*rhs(-11,4);\n    p+=1616160.*rhs(-11,5);\n    p+=1155388.*rhs(-11,6);\n    p+=127296.*rhs(-11,7);\n    p+=75582.*rhs(-11,8);\n    p+=92378.*rhs(-10,-9);\n    p+=175032.*rhs(-10,-8);\n    p+=1747226.*rhs(-10,-7);\n    p+=2803840.*rhs(-10,-6);\n    p+=12751388.*rhs(-10,-5);\n    p+=16859024.*rhs(-10,-4);\n    p+=46169052.*rhs(-10,-3);\n    p+=48243200.*rhs(-10,-2);\n    p+=88069168.*rhs(-10,-1);\n    p+=68625984.*rhs(-10,0);\n    p+=88069168.*rhs(-10,1);\n    p+=48243200.*rhs(-10,2);\n    p+=46169052.*rhs(-10,3);\n    p+=16859024.*rhs(-10,4);\n    p+=12751388.*rhs(-10,5);\n    p+=2803840.*rhs(-10,6);\n    p+=1747226.*rhs(-10,7);\n    p+=175032.*rhs(-10,8);\n    p+=92378.*rhs(-10,9);\n    p+=92378.*rhs(-9,-10);\n    p+=194480.*rhs(-9,-9);\n    p+=2144142.*rhs(-9,-8);\n    p+=3882736.*rhs(-9,-7);\n    p+=19495658.*rhs(-9,-6);\n    p+=29726528.*rhs(-9,-5);\n    p+=90216308.*rhs(-9,-4);\n    p+=112093952.*rhs(-9,-3);\n    p+=228013680.*rhs(-9,-2);\n    p+=219617664.*rhs(-9,-1);\n    p+=312737680.*rhs(-9,0);\n    p+=219617664.*rhs(-9,1);\n    p+=228013680.*rhs(-9,2);\n    p+=112093952.*rhs(-9,3);\n    p+=90216308.*rhs(-9,4);\n    p+=29726528.*rhs(-9,5);\n    p+=19495658.*rhs(-9,6);\n    p+=3882736.*rhs(-9,7);\n    p+=2144142.*rhs(-9,8);\n    p+=194480.*rhs(-9,9);\n    p+=92378.*rhs(-9,10);\n    p+=75582.*rhs(-8,-11);\n    p+=175032.*rhs(-8,-10);\n    p+=2144142.*rhs(-8,-9);\n    p+=4324320.*rhs(-8,-8);\n    p+=24056318.*rhs(-8,-7);\n    p+=41569528.*rhs(-8,-6);\n    p+=140048558.*rhs(-8,-5);\n    p+=202185728.*rhs(-8,-4);\n    p+=459561168.*rhs(-8,-3);\n    p+=532099904.*rhs(-8,-2);\n    p+=850585168.*rhs(-8,-1);\n    p+=743089408.*rhs(-8,0);\n    p+=850585168.*rhs(-8,1);\n    p+=532099904.*rhs(-8,2);\n    p+=459561168.*rhs(-8,3);\n    p+=202185728.*rhs(-8,4);\n    p+=140048558.*rhs(-8,5);\n    p+=41569528.*rhs(-8,6);\n    p+=24056318.*rhs(-8,7);\n    p+=4324320.*rhs(-8,8);\n    p+=2144142.*rhs(-8,9);\n    p+=175032.*rhs(-8,10);\n    p+=75582.*rhs(-8,11);\n    p+=50388.*rhs(-7,-12);\n    p+=127296.*rhs(-7,-11);\n    p+=1747226.*rhs(-7,-10);\n    p+=3882736.*rhs(-7,-9);\n    p+=24056318.*rhs(-7,-8);\n    p+=46448688.*rhs(-7,-7);\n    p+=174151978.*rhs(-7,-6);\n    p+=286712448.*rhs(-7,-5);\n    p+=729241528.*rhs(-7,-4);\n    p+=991865088.*rhs(-7,-3);\n    p+=1792109680.*rhs(-7,-2);\n    p+=1907533696.*rhs(-7,-1);\n    p+=2460787216.*rhs(-7,0);\n    p+=1907533696.*rhs(-7,1);\n    p+=1792109680.*rhs(-7,2);\n    p+=991865088.*rhs(-7,3);\n    p+=729241528.*rhs(-7,4);\n    p+=286712448.*rhs(-7,5);\n    p+=174151978.*rhs(-7,6);\n    p+=46448688.*rhs(-7,7);\n    p+=24056318.*rhs(-7,8);\n    p+=3882736.*rhs(-7,9);\n    p+=1747226.*rhs(-7,10);\n    p+=127296.*rhs(-7,11);\n    p+=50388.*rhs(-7,12);\n    p+=27132.*rhs(-6,-13);\n    p+=74256.*rhs(-6,-12);\n    p+=1155388.*rhs(-6,-11);\n    p+=2803840.*rhs(-6,-10);\n    p+=19495658.*rhs(-6,-9);\n    p+=41569528.*rhs(-6,-8);\n    p+=174151978.*rhs(-6,-7);\n    p+=321877248.*rhs(-6,-6);\n    p+=917173928.*rhs(-6,-5);\n    p+=1436202848.*rhs(-6,-4);\n    p+=2939586856.*rhs(-6,-3);\n    p+=3736940032.*rhs(-6,-2);\n    p+=5531327920.*rhs(-6,-1);\n    p+=5284992064.*rhs(-6,0);\n    p+=5531327920.*rhs(-6,1);\n    p+=3736940032.*rhs(-6,2);\n    p+=2939586856.*rhs(-6,3);\n    p+=1436202848.*rhs(-6,4);\n    p+=917173928.*rhs(-6,5);\n    p+=321877248.*rhs(-6,6);\n    p+=174151978.*rhs(-6,7);\n    p+=41569528.*rhs(-6,8);\n    p+=19495658.*rhs(-6,9);\n    p+=2803840.*rhs(-6,10);\n    p+=1155388.*rhs(-6,11);\n    p+=74256.*rhs(-6,12);\n    p+=27132.*rhs(-6,13);\n    p+=11628.*rhs(-5,-14);\n    p+=34272.*rhs(-5,-13);\n    p+=614516.*rhs(-5,-12);\n    p+=1616160.*rhs(-5,-11);\n    p+=12751388.*rhs(-5,-10);\n    p+=29726528.*rhs(-5,-9);\n    p+=140048558.*rhs(-5,-8);\n    p+=286712448.*rhs(-5,-7);\n    p+=917173928.*rhs(-5,-6);\n    p+=1623903168.*rhs(-5,-5);\n    p+=3762860920.*rhs(-5,-4);\n    p+=5593339456.*rhs(-5,-3);\n    p+=9567332872.*rhs(-5,-2);\n    p+=11195845888.*rhs(-5,-1);\n    p+=13625875600.*rhs(-5,0);\n    p+=11195845888.*rhs(-5,1);\n    p+=9567332872.*rhs(-5,2);\n    p+=5593339456.*rhs(-5,3);\n    p+=3762860920.*rhs(-5,4);\n    p+=1623903168.*rhs(-5,5);\n    p+=917173928.*rhs(-5,6);\n    p+=286712448.*rhs(-5,7);\n    p+=140048558.*rhs(-5,8);\n    p+=29726528.*rhs(-5,9);\n    p+=12751388.*rhs(-5,10);\n    p+=1616160.*rhs(-5,11);\n    p+=614516.*rhs(-5,12);\n    p+=34272.*rhs(-5,13);\n    p+=11628.*rhs(-5,14);\n    p+=3876.*rhs(-4,-15);\n    p+=12240.*rhs(-4,-14);\n    p+=259012.*rhs(-4,-13);\n    p+=733376.*rhs(-4,-12);\n    p+=6672148.*rhs(-4,-11);\n    p+=16859024.*rhs(-4,-10);\n    p+=90216308.*rhs(-4,-9);\n    p+=202185728.*rhs(-4,-8);\n    p+=729241528.*rhs(-4,-7);\n    p+=1436202848.*rhs(-4,-6);\n    p+=3762860920.*rhs(-4,-5);\n    p+=6397998208.*rhs(-4,-4);\n    p+=12613706776.*rhs(-4,-3);\n    p+=17743206112.*rhs(-4,-2);\n    p+=25824041560.*rhs(-4,-1);\n    p+=26826818560.*rhs(-4,0);\n    p+=25824041560.*rhs(-4,1);\n    p+=17743206112.*rhs(-4,2);\n    p+=12613706776.*rhs(-4,3);\n    p+=6397998208.*rhs(-4,4);\n    p+=3762860920.*rhs(-4,5);\n    p+=1436202848.*rhs(-4,6);\n    p+=729241528.*rhs(-4,7);\n    p+=202185728.*rhs(-4,8);\n    p+=90216308.*rhs(-4,9);\n    p+=16859024.*rhs(-4,10);\n    p+=6672148.*rhs(-4,11);\n    p+=733376.*rhs(-4,12);\n    p+=259012.*rhs(-4,13);\n    p+=12240.*rhs(-4,14);\n    p+=3876.*rhs(-4,15);\n    p+=969.*rhs(-3,-16);\n    p+=3264.*rhs(-3,-15);\n    p+=84524.*rhs(-3,-14);\n    p+=256160.*rhs(-3,-13);\n    p+=2752228.*rhs(-3,-12);\n    p+=7480032.*rhs(-3,-11);\n    p+=46169052.*rhs(-3,-10);\n    p+=112093952.*rhs(-3,-9);\n    p+=459561168.*rhs(-3,-8);\n    p+=991865088.*rhs(-3,-7);\n    p+=2939586856.*rhs(-3,-6);\n    p+=5593339456.*rhs(-3,-5);\n    p+=12613706776.*rhs(-3,-4);\n    p+=20720283328.*rhs(-3,-3);\n    p+=35988002440.*rhs(-3,-2);\n    p+=47530295680.*rhs(-3,-1);\n    p+=57901756420.*rhs(-3,0);\n    p+=47530295680.*rhs(-3,1);\n    p+=35988002440.*rhs(-3,2);\n    p+=20720283328.*rhs(-3,3);\n    p+=12613706776.*rhs(-3,4);\n    p+=5593339456.*rhs(-3,5);\n    p+=2939586856.*rhs(-3,6);\n    p+=991865088.*rhs(-3,7);\n    p+=459561168.*rhs(-3,8);\n    p+=112093952.*rhs(-3,9);\n    p+=46169052.*rhs(-3,10);\n    p+=7480032.*rhs(-3,11);\n    p+=2752228.*rhs(-3,12);\n    p+=256160.*rhs(-3,13);\n    p+=84524.*rhs(-3,14);\n    p+=3264.*rhs(-3,15);\n    p+=969.*rhs(-3,16);\n    p+=171.*rhs(-2,-17);\n    p+=612.*rhs(-2,-16);\n    p+=20587.*rhs(-2,-15);\n    p+=66432.*rhs(-2,-14);\n    p+=874636.*rhs(-2,-13);\n    p+=2539344.*rhs(-2,-12);\n    p+=18513100.*rhs(-2,-11);\n    p+=48243200.*rhs(-2,-10);\n    p+=228013680.*rhs(-2,-9);\n    p+=532099904.*rhs(-2,-8);\n    p+=1792109680.*rhs(-2,-7);\n    p+=3736940032.*rhs(-2,-6);\n    p+=9567332872.*rhs(-2,-5);\n    p+=17743206112.*rhs(-2,-4);\n    p+=35988002440.*rhs(-2,-3);\n    p+=57958224640.*rhs(-2,-2);\n    p+=91565303500.*rhs(-2,-1);\n    p+=109719615760.*rhs(-2,0);\n    p+=91565303500.*rhs(-2,1);\n    p+=57958224640.*rhs(-2,2);\n    p+=35988002440.*rhs(-2,3);\n    p+=17743206112.*rhs(-2,4);\n    p+=9567332872.*rhs(-2,5);\n    p+=3736940032.*rhs(-2,6);\n    p+=1792109680.*rhs(-2,7);\n    p+=532099904.*rhs(-2,8);\n    p+=228013680.*rhs(-2,9);\n    p+=48243200.*rhs(-2,10);\n    p+=18513100.*rhs(-2,11);\n    p+=2539344.*rhs(-2,12);\n    p+=874636.*rhs(-2,13);\n    p+=66432.*rhs(-2,14);\n    p+=20587.*rhs(-2,15);\n    p+=612.*rhs(-2,16);\n    p+=171.*rhs(-2,17);\n    p+=19.*rhs(-1,-18);\n    p+=72.*rhs(-1,-17);\n    p+=3521.*rhs(-1,-16);\n    p+=12040.*rhs(-1,-15);\n    p+=206531.*rhs(-1,-14);\n    p+=636608.*rhs(-1,-13);\n    p+=5691972.*rhs(-1,-12);\n    p+=15789824.*rhs(-1,-11);\n    p+=88069168.*rhs(-1,-10);\n    p+=219617664.*rhs(-1,-9);\n    p+=850585168.*rhs(-1,-8);\n    p+=1907533696.*rhs(-1,-7);\n    p+=5531327920.*rhs(-1,-6);\n    p+=11195845888.*rhs(-1,-5);\n    p+=25824041560.*rhs(-1,-4);\n    p+=47530295680.*rhs(-1,-3);\n    p+=91565303500.*rhs(-1,-2);\n    p+=151053077920.*rhs(-1,-1);\n    p+=226056661220.*rhs(-1,0);\n    p+=151053077920.*rhs(-1,1);\n    p+=91565303500.*rhs(-1,2);\n    p+=47530295680.*rhs(-1,3);\n    p+=25824041560.*rhs(-1,4);\n    p+=11195845888.*rhs(-1,5);\n    p+=5531327920.*rhs(-1,6);\n    p+=1907533696.*rhs(-1,7);\n    p+=850585168.*rhs(-1,8);\n    p+=219617664.*rhs(-1,9);\n    p+=88069168.*rhs(-1,10);\n    p+=15789824.*rhs(-1,11);\n    p+=5691972.*rhs(-1,12);\n    p+=636608.*rhs(-1,13);\n    p+=206531.*rhs(-1,14);\n    p+=12040.*rhs(-1,15);\n    p+=3521.*rhs(-1,16);\n    p+=72.*rhs(-1,17);\n    p+=19.*rhs(-1,18);\n    p+=1.*rhs(0,-19);\n    p+=4.*rhs(0,-18);\n    p+=377.*rhs(0,-17);\n    p+=1360.*rhs(0,-16);\n    p+=34121.*rhs(0,-15);\n    p+=111044.*rhs(0,-14);\n    p+=1296593.*rhs(0,-13);\n    p+=3802112.*rhs(0,-12);\n    p+=26001936.*rhs(0,-11);\n    p+=68625984.*rhs(0,-10);\n    p+=312737680.*rhs(0,-9);\n    p+=743089408.*rhs(0,-8);\n    p+=2460787216.*rhs(0,-7);\n    p+=5284992064.*rhs(0,-6);\n    p+=13625875600.*rhs(0,-5);\n    p+=26826818560.*rhs(0,-4);\n    p+=57901756420.*rhs(0,-3);\n    p+=109719615760.*rhs(0,-2);\n    p+=226056661220.*rhs(0,-1);\n    p+=492400873280.*rhs(0,0);\n    p+=226056661220.*rhs(0,1);\n    p+=109719615760.*rhs(0,2);\n    p+=57901756420.*rhs(0,3);\n    p+=26826818560.*rhs(0,4);\n    p+=13625875600.*rhs(0,5);\n    p+=5284992064.*rhs(0,6);\n    p+=2460787216.*rhs(0,7);\n    p+=743089408.*rhs(0,8);\n    p+=312737680.*rhs(0,9);\n    p+=68625984.*rhs(0,10);\n    p+=26001936.*rhs(0,11);\n    p+=3802112.*rhs(0,12);\n    p+=1296593.*rhs(0,13);\n    p+=111044.*rhs(0,14);\n    p+=34121.*rhs(0,15);\n    p+=1360.*rhs(0,16);\n    p+=377.*rhs(0,17);\n    p+=4.*rhs(0,18);\n    p+=1.*rhs(0,19);\n    p+=19.*rhs(1,-18);\n    p+=72.*rhs(1,-17);\n    p+=3521.*rhs(1,-16);\n    p+=12040.*rhs(1,-15);\n    p+=206531.*rhs(1,-14);\n    p+=636608.*rhs(1,-13);\n    p+=5691972.*rhs(1,-12);\n    p+=15789824.*rhs(1,-11);\n    p+=88069168.*rhs(1,-10);\n    p+=219617664.*rhs(1,-9);\n    p+=850585168.*rhs(1,-8);\n    p+=1907533696.*rhs(1,-7);\n    p+=5531327920.*rhs(1,-6);\n    p+=11195845888.*rhs(1,-5);\n    p+=25824041560.*rhs(1,-4);\n    p+=47530295680.*rhs(1,-3);\n    p+=91565303500.*rhs(1,-2);\n    p+=151053077920.*rhs(1,-1);\n    p+=226056661220.*rhs(1,0);\n    p+=151053077920.*rhs(1,1);\n    p+=91565303500.*rhs(1,2);\n    p+=47530295680.*rhs(1,3);\n    p+=25824041560.*rhs(1,4);\n    p+=11195845888.*rhs(1,5);\n    p+=5531327920.*rhs(1,6);\n    p+=1907533696.*rhs(1,7);\n    p+=850585168.*rhs(1,8);\n    p+=219617664.*rhs(1,9);\n    p+=88069168.*rhs(1,10);\n    p+=15789824.*rhs(1,11);\n    p+=5691972.*rhs(1,12);\n    p+=636608.*rhs(1,13);\n    p+=206531.*rhs(1,14);\n    p+=12040.*rhs(1,15);\n    p+=3521.*rhs(1,16);\n    p+=72.*rhs(1,17);\n    p+=19.*rhs(1,18);\n    p+=171.*rhs(2,-17);\n    p+=612.*rhs(2,-16);\n    p+=20587.*rhs(2,-15);\n    p+=66432.*rhs(2,-14);\n    p+=874636.*rhs(2,-13);\n    p+=2539344.*rhs(2,-12);\n    p+=18513100.*rhs(2,-11);\n    p+=48243200.*rhs(2,-10);\n    p+=228013680.*rhs(2,-9);\n    p+=532099904.*rhs(2,-8);\n    p+=1792109680.*rhs(2,-7);\n    p+=3736940032.*rhs(2,-6);\n    p+=9567332872.*rhs(2,-5);\n    p+=17743206112.*rhs(2,-4);\n    p+=35988002440.*rhs(2,-3);\n    p+=57958224640.*rhs(2,-2);\n    p+=91565303500.*rhs(2,-1);\n    p+=109719615760.*rhs(2,0);\n    p+=91565303500.*rhs(2,1);\n    p+=57958224640.*rhs(2,2);\n    p+=35988002440.*rhs(2,3);\n    p+=17743206112.*rhs(2,4);\n    p+=9567332872.*rhs(2,5);\n    p+=3736940032.*rhs(2,6);\n    p+=1792109680.*rhs(2,7);\n    p+=532099904.*rhs(2,8);\n    p+=228013680.*rhs(2,9);\n    p+=48243200.*rhs(2,10);\n    p+=18513100.*rhs(2,11);\n    p+=2539344.*rhs(2,12);\n    p+=874636.*rhs(2,13);\n    p+=66432.*rhs(2,14);\n    p+=20587.*rhs(2,15);\n    p+=612.*rhs(2,16);\n    p+=171.*rhs(2,17);\n    p+=969.*rhs(3,-16);\n    p+=3264.*rhs(3,-15);\n    p+=84524.*rhs(3,-14);\n    p+=256160.*rhs(3,-13);\n    p+=2752228.*rhs(3,-12);\n    p+=7480032.*rhs(3,-11);\n    p+=46169052.*rhs(3,-10);\n    p+=112093952.*rhs(3,-9);\n    p+=459561168.*rhs(3,-8);\n    p+=991865088.*rhs(3,-7);\n    p+=2939586856.*rhs(3,-6);\n    p+=5593339456.*rhs(3,-5);\n    p+=12613706776.*rhs(3,-4);\n    p+=20720283328.*rhs(3,-3);\n    p+=35988002440.*rhs(3,-2);\n    p+=47530295680.*rhs(3,-1);\n    p+=57901756420.*rhs(3,0);\n    p+=47530295680.*rhs(3,1);\n    p+=35988002440.*rhs(3,2);\n    p+=20720283328.*rhs(3,3);\n    p+=12613706776.*rhs(3,4);\n    p+=5593339456.*rhs(3,5);\n    p+=2939586856.*rhs(3,6);\n    p+=991865088.*rhs(3,7);\n    p+=459561168.*rhs(3,8);\n    p+=112093952.*rhs(3,9);\n    p+=46169052.*rhs(3,10);\n    p+=7480032.*rhs(3,11);\n    p+=2752228.*rhs(3,12);\n    p+=256160.*rhs(3,13);\n    p+=84524.*rhs(3,14);\n    p+=3264.*rhs(3,15);\n    p+=969.*rhs(3,16);\n    p+=3876.*rhs(4,-15);\n    p+=12240.*rhs(4,-14);\n    p+=259012.*rhs(4,-13);\n    p+=733376.*rhs(4,-12);\n    p+=6672148.*rhs(4,-11);\n    p+=16859024.*rhs(4,-10);\n    p+=90216308.*rhs(4,-9);\n    p+=202185728.*rhs(4,-8);\n    p+=729241528.*rhs(4,-7);\n    p+=1436202848.*rhs(4,-6);\n    p+=3762860920.*rhs(4,-5);\n    p+=6397998208.*rhs(4,-4);\n    p+=12613706776.*rhs(4,-3);\n    p+=17743206112.*rhs(4,-2);\n    p+=25824041560.*rhs(4,-1);\n    p+=26826818560.*rhs(4,0);\n    p+=25824041560.*rhs(4,1);\n    p+=17743206112.*rhs(4,2);\n    p+=12613706776.*rhs(4,3);\n    p+=6397998208.*rhs(4,4);\n    p+=3762860920.*rhs(4,5);\n    p+=1436202848.*rhs(4,6);\n    p+=729241528.*rhs(4,7);\n    p+=202185728.*rhs(4,8);\n    p+=90216308.*rhs(4,9);\n    p+=16859024.*rhs(4,10);\n    p+=6672148.*rhs(4,11);\n    p+=733376.*rhs(4,12);\n    p+=259012.*rhs(4,13);\n    p+=12240.*rhs(4,14);\n    p+=3876.*rhs(4,15);\n    p+=11628.*rhs(5,-14);\n    p+=34272.*rhs(5,-13);\n    p+=614516.*rhs(5,-12);\n    p+=1616160.*rhs(5,-11);\n    p+=12751388.*rhs(5,-10);\n    p+=29726528.*rhs(5,-9);\n    p+=140048558.*rhs(5,-8);\n    p+=286712448.*rhs(5,-7);\n    p+=917173928.*rhs(5,-6);\n    p+=1623903168.*rhs(5,-5);\n    p+=3762860920.*rhs(5,-4);\n    p+=5593339456.*rhs(5,-3);\n    p+=9567332872.*rhs(5,-2);\n    p+=11195845888.*rhs(5,-1);\n    p+=13625875600.*rhs(5,0);\n    p+=11195845888.*rhs(5,1);\n    p+=9567332872.*rhs(5,2);\n    p+=5593339456.*rhs(5,3);\n    p+=3762860920.*rhs(5,4);\n    p+=1623903168.*rhs(5,5);\n    p+=917173928.*rhs(5,6);\n    p+=286712448.*rhs(5,7);\n    p+=140048558.*rhs(5,8);\n    p+=29726528.*rhs(5,9);\n    p+=12751388.*rhs(5,10);\n    p+=1616160.*rhs(5,11);\n    p+=614516.*rhs(5,12);\n    p+=34272.*rhs(5,13);\n    p+=11628.*rhs(5,14);\n    p+=27132.*rhs(6,-13);\n    p+=74256.*rhs(6,-12);\n    p+=1155388.*rhs(6,-11);\n    p+=2803840.*rhs(6,-10);\n    p+=19495658.*rhs(6,-9);\n    p+=41569528.*rhs(6,-8);\n    p+=174151978.*rhs(6,-7);\n    p+=321877248.*rhs(6,-6);\n    p+=917173928.*rhs(6,-5);\n    p+=1436202848.*rhs(6,-4);\n    p+=2939586856.*rhs(6,-3);\n    p+=3736940032.*rhs(6,-2);\n    p+=5531327920.*rhs(6,-1);\n    p+=5284992064.*rhs(6,0);\n    p+=5531327920.*rhs(6,1);\n    p+=3736940032.*rhs(6,2);\n    p+=2939586856.*rhs(6,3);\n    p+=1436202848.*rhs(6,4);\n    p+=917173928.*rhs(6,5);\n    p+=321877248.*rhs(6,6);\n    p+=174151978.*rhs(6,7);\n    p+=41569528.*rhs(6,8);\n    p+=19495658.*rhs(6,9);\n    p+=2803840.*rhs(6,10);\n    p+=1155388.*rhs(6,11);\n    p+=74256.*rhs(6,12);\n    p+=27132.*rhs(6,13);\n    p+=50388.*rhs(7,-12);\n    p+=127296.*rhs(7,-11);\n    p+=1747226.*rhs(7,-10);\n    p+=3882736.*rhs(7,-9);\n    p+=24056318.*rhs(7,-8);\n    p+=46448688.*rhs(7,-7);\n    p+=174151978.*rhs(7,-6);\n    p+=286712448.*rhs(7,-5);\n    p+=729241528.*rhs(7,-4);\n    p+=991865088.*rhs(7,-3);\n    p+=1792109680.*rhs(7,-2);\n    p+=1907533696.*rhs(7,-1);\n    p+=2460787216.*rhs(7,0);\n    p+=1907533696.*rhs(7,1);\n    p+=1792109680.*rhs(7,2);\n    p+=991865088.*rhs(7,3);\n    p+=729241528.*rhs(7,4);\n    p+=286712448.*rhs(7,5);\n    p+=174151978.*rhs(7,6);\n    p+=46448688.*rhs(7,7);\n    p+=24056318.*rhs(7,8);\n    p+=3882736.*rhs(7,9);\n    p+=1747226.*rhs(7,10);\n    p+=127296.*rhs(7,11);\n    p+=50388.*rhs(7,12);\n    p+=75582.*rhs(8,-11);\n    p+=175032.*rhs(8,-10);\n    p+=2144142.*rhs(8,-9);\n    p+=4324320.*rhs(8,-8);\n    p+=24056318.*rhs(8,-7);\n    p+=41569528.*rhs(8,-6);\n    p+=140048558.*rhs(8,-5);\n    p+=202185728.*rhs(8,-4);\n    p+=459561168.*rhs(8,-3);\n    p+=532099904.*rhs(8,-2);\n    p+=850585168.*rhs(8,-1);\n    p+=743089408.*rhs(8,0);\n    p+=850585168.*rhs(8,1);\n    p+=532099904.*rhs(8,2);\n    p+=459561168.*rhs(8,3);\n    p+=202185728.*rhs(8,4);\n    p+=140048558.*rhs(8,5);\n    p+=41569528.*rhs(8,6);\n    p+=24056318.*rhs(8,7);\n    p+=4324320.*rhs(8,8);\n    p+=2144142.*rhs(8,9);\n    p+=175032.*rhs(8,10);\n    p+=75582.*rhs(8,11);\n    p+=92378.*rhs(9,-10);\n    p+=194480.*rhs(9,-9);\n    p+=2144142.*rhs(9,-8);\n    p+=3882736.*rhs(9,-7);\n    p+=19495658.*rhs(9,-6);\n    p+=29726528.*rhs(9,-5);\n    p+=90216308.*rhs(9,-4);\n    p+=112093952.*rhs(9,-3);\n    p+=228013680.*rhs(9,-2);\n    p+=219617664.*rhs(9,-1);\n    p+=312737680.*rhs(9,0);\n    p+=219617664.*rhs(9,1);\n    p+=228013680.*rhs(9,2);\n    p+=112093952.*rhs(9,3);\n    p+=90216308.*rhs(9,4);\n    p+=29726528.*rhs(9,5);\n    p+=19495658.*rhs(9,6);\n    p+=3882736.*rhs(9,7);\n    p+=2144142.*rhs(9,8);\n    p+=194480.*rhs(9,9);\n    p+=92378.*rhs(9,10);\n    p+=92378.*rhs(10,-9);\n    p+=175032.*rhs(10,-8);\n    p+=1747226.*rhs(10,-7);\n    p+=2803840.*rhs(10,-6);\n    p+=12751388.*rhs(10,-5);\n    p+=16859024.*rhs(10,-4);\n    p+=46169052.*rhs(10,-3);\n    p+=48243200.*rhs(10,-2);\n    p+=88069168.*rhs(10,-1);\n    p+=68625984.*rhs(10,0);\n    p+=88069168.*rhs(10,1);\n    p+=48243200.*rhs(10,2);\n    p+=46169052.*rhs(10,3);\n    p+=16859024.*rhs(10,4);\n    p+=12751388.*rhs(10,5);\n    p+=2803840.*rhs(10,6);\n    p+=1747226.*rhs(10,7);\n    p+=175032.*rhs(10,8);\n    p+=92378.*rhs(10,9);\n    p+=75582.*rhs(11,-8);\n    p+=127296.*rhs(11,-7);\n    p+=1155388.*rhs(11,-6);\n    p+=1616160.*rhs(11,-5);\n    p+=6672148.*rhs(11,-4);\n    p+=7480032.*rhs(11,-3);\n    p+=18513100.*rhs(11,-2);\n    p+=15789824.*rhs(11,-1);\n    p+=26001936.*rhs(11,0);\n    p+=15789824.*rhs(11,1);\n    p+=18513100.*rhs(11,2);\n    p+=7480032.*rhs(11,3);\n    p+=6672148.*rhs(11,4);\n    p+=1616160.*rhs(11,5);\n    p+=1155388.*rhs(11,6);\n    p+=127296.*rhs(11,7);\n    p+=75582.*rhs(11,8);\n    p+=50388.*rhs(12,-7);\n    p+=74256.*rhs(12,-6);\n    p+=614516.*rhs(12,-5);\n    p+=733376.*rhs(12,-4);\n    p+=2752228.*rhs(12,-3);\n    p+=2539344.*rhs(12,-2);\n    p+=5691972.*rhs(12,-1);\n    p+=3802112.*rhs(12,0);\n    p+=5691972.*rhs(12,1);\n    p+=2539344.*rhs(12,2);\n    p+=2752228.*rhs(12,3);\n    p+=733376.*rhs(12,4);\n    p+=614516.*rhs(12,5);\n    p+=74256.*rhs(12,6);\n    p+=50388.*rhs(12,7);\n    p+=27132.*rhs(13,-6);\n    p+=34272.*rhs(13,-5);\n    p+=259012.*rhs(13,-4);\n    p+=256160.*rhs(13,-3);\n    p+=874636.*rhs(13,-2);\n    p+=636608.*rhs(13,-1);\n    p+=1296593.*rhs(13,0);\n    p+=636608.*rhs(13,1);\n    p+=874636.*rhs(13,2);\n    p+=256160.*rhs(13,3);\n    p+=259012.*rhs(13,4);\n    p+=34272.*rhs(13,5);\n    p+=27132.*rhs(13,6);\n    p+=11628.*rhs(14,-5);\n    p+=12240.*rhs(14,-4);\n    p+=84524.*rhs(14,-3);\n    p+=66432.*rhs(14,-2);\n    p+=206531.*rhs(14,-1);\n    p+=111044.*rhs(14,0);\n    p+=206531.*rhs(14,1);\n    p+=66432.*rhs(14,2);\n    p+=84524.*rhs(14,3);\n    p+=12240.*rhs(14,4);\n    p+=11628.*rhs(14,5);\n    p+=3876.*rhs(15,-4);\n    p+=3264.*rhs(15,-3);\n    p+=20587.*rhs(15,-2);\n    p+=12040.*rhs(15,-1);\n    p+=34121.*rhs(15,0);\n    p+=12040.*rhs(15,1);\n    p+=20587.*rhs(15,2);\n    p+=3264.*rhs(15,3);\n    p+=3876.*rhs(15,4);\n    p+=969.*rhs(16,-3);\n    p+=612.*rhs(16,-2);\n    p+=3521.*rhs(16,-1);\n    p+=1360.*rhs(16,0);\n    p+=3521.*rhs(16,1);\n    p+=612.*rhs(16,2);\n    p+=969.*rhs(16,3);\n    p+=171.*rhs(17,-2);\n    p+=72.*rhs(17,-1);\n    p+=377.*rhs(17,0);\n    p+=72.*rhs(17,1);\n    p+=171.*rhs(17,2);\n    p+=19.*rhs(18,-1);\n    p+=4.*rhs(18,0);\n    p+=19.*rhs(18,1);\n    p+=1.*rhs(19,0);\n    return p/1099511627776.;\n}\n\nfloat p0c(int x,int y){\n    vec2 p = gl_FragCoord.xy+vec2(x,y);\n\treturn texture(iChannel1,p/iResolution.xy).x;\n}\n\n// Gaussian - like redistribution of the previously calculated pressure p0c\nfloat TwentyStepPressure( void ){\n    float p = 0.;\n    p+=1.*p0c(-20,0);\n    p+=20.*p0c(-19,-1);\n    p+=20.*p0c(-19,1);\n    p+=190.*p0c(-18,-2);\n    p+=400.*p0c(-18,0);\n    p+=190.*p0c(-18,2);\n    p+=1140.*p0c(-17,-3);\n    p+=3800.*p0c(-17,-1);\n    p+=3800.*p0c(-17,1);\n    p+=1140.*p0c(-17,3);\n    p+=4845.*p0c(-16,-4);\n    p+=22800.*p0c(-16,-2);\n    p+=36100.*p0c(-16,0);\n    p+=22800.*p0c(-16,2);\n    p+=4845.*p0c(-16,4);\n    p+=15504.*p0c(-15,-5);\n    p+=96900.*p0c(-15,-3);\n    p+=216600.*p0c(-15,-1);\n    p+=216600.*p0c(-15,1);\n    p+=96900.*p0c(-15,3);\n    p+=15504.*p0c(-15,5);\n    p+=38760.*p0c(-14,-6);\n    p+=310080.*p0c(-14,-4);\n    p+=920550.*p0c(-14,-2);\n    p+=1299600.*p0c(-14,0);\n    p+=920550.*p0c(-14,2);\n    p+=310080.*p0c(-14,4);\n    p+=38760.*p0c(-14,6);\n    p+=77520.*p0c(-13,-7);\n    p+=775200.*p0c(-13,-5);\n    p+=2945760.*p0c(-13,-3);\n    p+=5523300.*p0c(-13,-1);\n    p+=5523300.*p0c(-13,1);\n    p+=2945760.*p0c(-13,3);\n    p+=775200.*p0c(-13,5);\n    p+=77520.*p0c(-13,7);\n    p+=125970.*p0c(-12,-8);\n    p+=1550400.*p0c(-12,-6);\n    p+=7364400.*p0c(-12,-4);\n    p+=17674560.*p0c(-12,-2);\n    p+=23474025.*p0c(-12,0);\n    p+=17674560.*p0c(-12,2);\n    p+=7364400.*p0c(-12,4);\n    p+=1550400.*p0c(-12,6);\n    p+=125970.*p0c(-12,8);\n    p+=167960.*p0c(-11,-9);\n    p+=2519400.*p0c(-11,-7);\n    p+=14728800.*p0c(-11,-5);\n    p+=44186400.*p0c(-11,-3);\n    p+=75116880.*p0c(-11,-1);\n    p+=75116880.*p0c(-11,1);\n    p+=44186400.*p0c(-11,3);\n    p+=14728800.*p0c(-11,5);\n    p+=2519400.*p0c(-11,7);\n    p+=167960.*p0c(-11,9);\n    p+=184756.*p0c(-10,-10);\n    p+=3359200.*p0c(-10,-8);\n    p+=23934300.*p0c(-10,-6);\n    p+=88372800.*p0c(-10,-4);\n    p+=187792200.*p0c(-10,-2);\n    p+=240374016.*p0c(-10,0);\n    p+=187792200.*p0c(-10,2);\n    p+=88372800.*p0c(-10,4);\n    p+=23934300.*p0c(-10,6);\n    p+=3359200.*p0c(-10,8);\n    p+=184756.*p0c(-10,10);\n    p+=167960.*p0c(-9,-11);\n    p+=3695120.*p0c(-9,-9);\n    p+=31912400.*p0c(-9,-7);\n    p+=143605800.*p0c(-9,-5);\n    p+=375584400.*p0c(-9,-3);\n    p+=600935040.*p0c(-9,-1);\n    p+=600935040.*p0c(-9,1);\n    p+=375584400.*p0c(-9,3);\n    p+=143605800.*p0c(-9,5);\n    p+=31912400.*p0c(-9,7);\n    p+=3695120.*p0c(-9,9);\n    p+=167960.*p0c(-9,11);\n    p+=125970.*p0c(-8,-12);\n    p+=3359200.*p0c(-8,-10);\n    p+=35103640.*p0c(-8,-8);\n    p+=191474400.*p0c(-8,-6);\n    p+=610324650.*p0c(-8,-4);\n    p+=1201870080.*p0c(-8,-2);\n    p+=1502337600.*p0c(-8,0);\n    p+=1201870080.*p0c(-8,2);\n    p+=610324650.*p0c(-8,4);\n    p+=191474400.*p0c(-8,6);\n    p+=35103640.*p0c(-8,8);\n    p+=3359200.*p0c(-8,10);\n    p+=125970.*p0c(-8,12);\n    p+=77520.*p0c(-7,-13);\n    p+=2519400.*p0c(-7,-11);\n    p+=31912400.*p0c(-7,-9);\n    p+=210621840.*p0c(-7,-7);\n    p+=813766200.*p0c(-7,-5);\n    p+=1953038880.*p0c(-7,-3);\n    p+=3004675200.*p0c(-7,-1);\n    p+=3004675200.*p0c(-7,1);\n    p+=1953038880.*p0c(-7,3);\n    p+=813766200.*p0c(-7,5);\n    p+=210621840.*p0c(-7,7);\n    p+=31912400.*p0c(-7,9);\n    p+=2519400.*p0c(-7,11);\n    p+=77520.*p0c(-7,13);\n    p+=38760.*p0c(-6,-14);\n    p+=1550400.*p0c(-6,-12);\n    p+=23934300.*p0c(-6,-10);\n    p+=191474400.*p0c(-6,-8);\n    p+=895142820.*p0c(-6,-6);\n    p+=2604051840.*p0c(-6,-4);\n    p+=4882597200.*p0c(-6,-2);\n    p+=6009350400.*p0c(-6,0);\n    p+=4882597200.*p0c(-6,2);\n    p+=2604051840.*p0c(-6,4);\n    p+=895142820.*p0c(-6,6);\n    p+=191474400.*p0c(-6,8);\n    p+=23934300.*p0c(-6,10);\n    p+=1550400.*p0c(-6,12);\n    p+=38760.*p0c(-6,14);\n    p+=15504.*p0c(-5,-15);\n    p+=775200.*p0c(-5,-13);\n    p+=14728800.*p0c(-5,-11);\n    p+=143605800.*p0c(-5,-9);\n    p+=813766200.*p0c(-5,-7);\n    p+=2864457024.*p0c(-5,-5);\n    p+=6510129600.*p0c(-5,-3);\n    p+=9765194400.*p0c(-5,-1);\n    p+=9765194400.*p0c(-5,1);\n    p+=6510129600.*p0c(-5,3);\n    p+=2864457024.*p0c(-5,5);\n    p+=813766200.*p0c(-5,7);\n    p+=143605800.*p0c(-5,9);\n    p+=14728800.*p0c(-5,11);\n    p+=775200.*p0c(-5,13);\n    p+=15504.*p0c(-5,15);\n    p+=4845.*p0c(-4,-16);\n    p+=310080.*p0c(-4,-14);\n    p+=7364400.*p0c(-4,-12);\n    p+=88372800.*p0c(-4,-10);\n    p+=610324650.*p0c(-4,-8);\n    p+=2604051840.*p0c(-4,-6);\n    p+=7161142560.*p0c(-4,-4);\n    p+=13020259200.*p0c(-4,-2);\n    p+=15868440900.*p0c(-4,0);\n    p+=13020259200.*p0c(-4,2);\n    p+=7161142560.*p0c(-4,4);\n    p+=2604051840.*p0c(-4,6);\n    p+=610324650.*p0c(-4,8);\n    p+=88372800.*p0c(-4,10);\n    p+=7364400.*p0c(-4,12);\n    p+=310080.*p0c(-4,14);\n    p+=4845.*p0c(-4,16);\n    p+=1140.*p0c(-3,-17);\n    p+=96900.*p0c(-3,-15);\n    p+=2945760.*p0c(-3,-13);\n    p+=44186400.*p0c(-3,-11);\n    p+=375584400.*p0c(-3,-9);\n    p+=1953038880.*p0c(-3,-7);\n    p+=6510129600.*p0c(-3,-5);\n    p+=14322285120.*p0c(-3,-3);\n    p+=21157921200.*p0c(-3,-1);\n    p+=21157921200.*p0c(-3,1);\n    p+=14322285120.*p0c(-3,3);\n    p+=6510129600.*p0c(-3,5);\n    p+=1953038880.*p0c(-3,7);\n    p+=375584400.*p0c(-3,9);\n    p+=44186400.*p0c(-3,11);\n    p+=2945760.*p0c(-3,13);\n    p+=96900.*p0c(-3,15);\n    p+=1140.*p0c(-3,17);\n    p+=190.*p0c(-2,-18);\n    p+=22800.*p0c(-2,-16);\n    p+=920550.*p0c(-2,-14);\n    p+=17674560.*p0c(-2,-12);\n    p+=187792200.*p0c(-2,-10);\n    p+=1201870080.*p0c(-2,-8);\n    p+=4882597200.*p0c(-2,-6);\n    p+=13020259200.*p0c(-2,-4);\n    p+=23273713320.*p0c(-2,-2);\n    p+=28210561600.*p0c(-2,0);\n    p+=23273713320.*p0c(-2,2);\n    p+=13020259200.*p0c(-2,4);\n    p+=4882597200.*p0c(-2,6);\n    p+=1201870080.*p0c(-2,8);\n    p+=187792200.*p0c(-2,10);\n    p+=17674560.*p0c(-2,12);\n    p+=920550.*p0c(-2,14);\n    p+=22800.*p0c(-2,16);\n    p+=190.*p0c(-2,18);\n    p+=20.*p0c(-1,-19);\n    p+=3800.*p0c(-1,-17);\n    p+=216600.*p0c(-1,-15);\n    p+=5523300.*p0c(-1,-13);\n    p+=75116880.*p0c(-1,-11);\n    p+=600935040.*p0c(-1,-9);\n    p+=3004675200.*p0c(-1,-7);\n    p+=9765194400.*p0c(-1,-5);\n    p+=21157921200.*p0c(-1,-3);\n    p+=31031617760.*p0c(-1,-1);\n    p+=31031617760.*p0c(-1,1);\n    p+=21157921200.*p0c(-1,3);\n    p+=9765194400.*p0c(-1,5);\n    p+=3004675200.*p0c(-1,7);\n    p+=600935040.*p0c(-1,9);\n    p+=75116880.*p0c(-1,11);\n    p+=5523300.*p0c(-1,13);\n    p+=216600.*p0c(-1,15);\n    p+=3800.*p0c(-1,17);\n    p+=20.*p0c(-1,19);\n    p+=1.*p0c(0,-20);\n    p+=400.*p0c(0,-18);\n    p+=36100.*p0c(0,-16);\n    p+=1299600.*p0c(0,-14);\n    p+=23474025.*p0c(0,-12);\n    p+=240374016.*p0c(0,-10);\n    p+=1502337600.*p0c(0,-8);\n    p+=6009350400.*p0c(0,-6);\n    p+=15868440900.*p0c(0,-4);\n    p+=28210561600.*p0c(0,-2);\n    p+=34134779536.*p0c(0,0);\n    p+=28210561600.*p0c(0,2);\n    p+=15868440900.*p0c(0,4);\n    p+=6009350400.*p0c(0,6);\n    p+=1502337600.*p0c(0,8);\n    p+=240374016.*p0c(0,10);\n    p+=23474025.*p0c(0,12);\n    p+=1299600.*p0c(0,14);\n    p+=36100.*p0c(0,16);\n    p+=400.*p0c(0,18);\n    p+=1.*p0c(0,20);\n    p+=20.*p0c(1,-19);\n    p+=3800.*p0c(1,-17);\n    p+=216600.*p0c(1,-15);\n    p+=5523300.*p0c(1,-13);\n    p+=75116880.*p0c(1,-11);\n    p+=600935040.*p0c(1,-9);\n    p+=3004675200.*p0c(1,-7);\n    p+=9765194400.*p0c(1,-5);\n    p+=21157921200.*p0c(1,-3);\n    p+=31031617760.*p0c(1,-1);\n    p+=31031617760.*p0c(1,1);\n    p+=21157921200.*p0c(1,3);\n    p+=9765194400.*p0c(1,5);\n    p+=3004675200.*p0c(1,7);\n    p+=600935040.*p0c(1,9);\n    p+=75116880.*p0c(1,11);\n    p+=5523300.*p0c(1,13);\n    p+=216600.*p0c(1,15);\n    p+=3800.*p0c(1,17);\n    p+=20.*p0c(1,19);\n    p+=190.*p0c(2,-18);\n    p+=22800.*p0c(2,-16);\n    p+=920550.*p0c(2,-14);\n    p+=17674560.*p0c(2,-12);\n    p+=187792200.*p0c(2,-10);\n    p+=1201870080.*p0c(2,-8);\n    p+=4882597200.*p0c(2,-6);\n    p+=13020259200.*p0c(2,-4);\n    p+=23273713320.*p0c(2,-2);\n    p+=28210561600.*p0c(2,0);\n    p+=23273713320.*p0c(2,2);\n    p+=13020259200.*p0c(2,4);\n    p+=4882597200.*p0c(2,6);\n    p+=1201870080.*p0c(2,8);\n    p+=187792200.*p0c(2,10);\n    p+=17674560.*p0c(2,12);\n    p+=920550.*p0c(2,14);\n    p+=22800.*p0c(2,16);\n    p+=190.*p0c(2,18);\n    p+=1140.*p0c(3,-17);\n    p+=96900.*p0c(3,-15);\n    p+=2945760.*p0c(3,-13);\n    p+=44186400.*p0c(3,-11);\n    p+=375584400.*p0c(3,-9);\n    p+=1953038880.*p0c(3,-7);\n    p+=6510129600.*p0c(3,-5);\n    p+=14322285120.*p0c(3,-3);\n    p+=21157921200.*p0c(3,-1);\n    p+=21157921200.*p0c(3,1);\n    p+=14322285120.*p0c(3,3);\n    p+=6510129600.*p0c(3,5);\n    p+=1953038880.*p0c(3,7);\n    p+=375584400.*p0c(3,9);\n    p+=44186400.*p0c(3,11);\n    p+=2945760.*p0c(3,13);\n    p+=96900.*p0c(3,15);\n    p+=1140.*p0c(3,17);\n    p+=4845.*p0c(4,-16);\n    p+=310080.*p0c(4,-14);\n    p+=7364400.*p0c(4,-12);\n    p+=88372800.*p0c(4,-10);\n    p+=610324650.*p0c(4,-8);\n    p+=2604051840.*p0c(4,-6);\n    p+=7161142560.*p0c(4,-4);\n    p+=13020259200.*p0c(4,-2);\n    p+=15868440900.*p0c(4,0);\n    p+=13020259200.*p0c(4,2);\n    p+=7161142560.*p0c(4,4);\n    p+=2604051840.*p0c(4,6);\n    p+=610324650.*p0c(4,8);\n    p+=88372800.*p0c(4,10);\n    p+=7364400.*p0c(4,12);\n    p+=310080.*p0c(4,14);\n    p+=4845.*p0c(4,16);\n    p+=15504.*p0c(5,-15);\n    p+=775200.*p0c(5,-13);\n    p+=14728800.*p0c(5,-11);\n    p+=143605800.*p0c(5,-9);\n    p+=813766200.*p0c(5,-7);\n    p+=2864457024.*p0c(5,-5);\n    p+=6510129600.*p0c(5,-3);\n    p+=9765194400.*p0c(5,-1);\n    p+=9765194400.*p0c(5,1);\n    p+=6510129600.*p0c(5,3);\n    p+=2864457024.*p0c(5,5);\n    p+=813766200.*p0c(5,7);\n    p+=143605800.*p0c(5,9);\n    p+=14728800.*p0c(5,11);\n    p+=775200.*p0c(5,13);\n    p+=15504.*p0c(5,15);\n    p+=38760.*p0c(6,-14);\n    p+=1550400.*p0c(6,-12);\n    p+=23934300.*p0c(6,-10);\n    p+=191474400.*p0c(6,-8);\n    p+=895142820.*p0c(6,-6);\n    p+=2604051840.*p0c(6,-4);\n    p+=4882597200.*p0c(6,-2);\n    p+=6009350400.*p0c(6,0);\n    p+=4882597200.*p0c(6,2);\n    p+=2604051840.*p0c(6,4);\n    p+=895142820.*p0c(6,6);\n    p+=191474400.*p0c(6,8);\n    p+=23934300.*p0c(6,10);\n    p+=1550400.*p0c(6,12);\n    p+=38760.*p0c(6,14);\n    p+=77520.*p0c(7,-13);\n    p+=2519400.*p0c(7,-11);\n    p+=31912400.*p0c(7,-9);\n    p+=210621840.*p0c(7,-7);\n    p+=813766200.*p0c(7,-5);\n    p+=1953038880.*p0c(7,-3);\n    p+=3004675200.*p0c(7,-1);\n    p+=3004675200.*p0c(7,1);\n    p+=1953038880.*p0c(7,3);\n    p+=813766200.*p0c(7,5);\n    p+=210621840.*p0c(7,7);\n    p+=31912400.*p0c(7,9);\n    p+=2519400.*p0c(7,11);\n    p+=77520.*p0c(7,13);\n    p+=125970.*p0c(8,-12);\n    p+=3359200.*p0c(8,-10);\n    p+=35103640.*p0c(8,-8);\n    p+=191474400.*p0c(8,-6);\n    p+=610324650.*p0c(8,-4);\n    p+=1201870080.*p0c(8,-2);\n    p+=1502337600.*p0c(8,0);\n    p+=1201870080.*p0c(8,2);\n    p+=610324650.*p0c(8,4);\n    p+=191474400.*p0c(8,6);\n    p+=35103640.*p0c(8,8);\n    p+=3359200.*p0c(8,10);\n    p+=125970.*p0c(8,12);\n    p+=167960.*p0c(9,-11);\n    p+=3695120.*p0c(9,-9);\n    p+=31912400.*p0c(9,-7);\n    p+=143605800.*p0c(9,-5);\n    p+=375584400.*p0c(9,-3);\n    p+=600935040.*p0c(9,-1);\n    p+=600935040.*p0c(9,1);\n    p+=375584400.*p0c(9,3);\n    p+=143605800.*p0c(9,5);\n    p+=31912400.*p0c(9,7);\n    p+=3695120.*p0c(9,9);\n    p+=167960.*p0c(9,11);\n    p+=184756.*p0c(10,-10);\n    p+=3359200.*p0c(10,-8);\n    p+=23934300.*p0c(10,-6);\n    p+=88372800.*p0c(10,-4);\n    p+=187792200.*p0c(10,-2);\n    p+=240374016.*p0c(10,0);\n    p+=187792200.*p0c(10,2);\n    p+=88372800.*p0c(10,4);\n    p+=23934300.*p0c(10,6);\n    p+=3359200.*p0c(10,8);\n    p+=184756.*p0c(10,10);\n    p+=167960.*p0c(11,-9);\n    p+=2519400.*p0c(11,-7);\n    p+=14728800.*p0c(11,-5);\n    p+=44186400.*p0c(11,-3);\n    p+=75116880.*p0c(11,-1);\n    p+=75116880.*p0c(11,1);\n    p+=44186400.*p0c(11,3);\n    p+=14728800.*p0c(11,5);\n    p+=2519400.*p0c(11,7);\n    p+=167960.*p0c(11,9);\n    p+=125970.*p0c(12,-8);\n    p+=1550400.*p0c(12,-6);\n    p+=7364400.*p0c(12,-4);\n    p+=17674560.*p0c(12,-2);\n    p+=23474025.*p0c(12,0);\n    p+=17674560.*p0c(12,2);\n    p+=7364400.*p0c(12,4);\n    p+=1550400.*p0c(12,6);\n    p+=125970.*p0c(12,8);\n    p+=77520.*p0c(13,-7);\n    p+=775200.*p0c(13,-5);\n    p+=2945760.*p0c(13,-3);\n    p+=5523300.*p0c(13,-1);\n    p+=5523300.*p0c(13,1);\n    p+=2945760.*p0c(13,3);\n    p+=775200.*p0c(13,5);\n    p+=77520.*p0c(13,7);\n    p+=38760.*p0c(14,-6);\n    p+=310080.*p0c(14,-4);\n    p+=920550.*p0c(14,-2);\n    p+=1299600.*p0c(14,0);\n    p+=920550.*p0c(14,2);\n    p+=310080.*p0c(14,4);\n    p+=38760.*p0c(14,6);\n    p+=15504.*p0c(15,-5);\n    p+=96900.*p0c(15,-3);\n    p+=216600.*p0c(15,-1);\n    p+=216600.*p0c(15,1);\n    p+=96900.*p0c(15,3);\n    p+=15504.*p0c(15,5);\n    p+=4845.*p0c(16,-4);\n    p+=22800.*p0c(16,-2);\n    p+=36100.*p0c(16,0);\n    p+=22800.*p0c(16,2);\n    p+=4845.*p0c(16,4);\n    p+=1140.*p0c(17,-3);\n    p+=3800.*p0c(17,-1);\n    p+=3800.*p0c(17,1);\n    p+=1140.*p0c(17,3);\n    p+=190.*p0c(18,-2);\n    p+=400.*p0c(18,0);\n    p+=190.*p0c(18,2);\n    p+=20.*p0c(19,-1);\n    p+=20.*p0c(19,1);\n    p+=1.*p0c(20,0);\n    return p/1099511627776.;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 C )\n{ \n    if(C.x > .5*iResolution.x) return;\n    vec4 data = texel(ch2, C);\n    particle P = getParticle(data, C);\n    fragColor = vec4(0);\n    \n    if(P.M.x == 0.) return;\n    \n    float divV = rhs(0,0);\n    //float divX = texel(ch0, C).y;\n    if(divV == 0.) return; // free surface\n    \n    float p = TwentyStepRHS()+TwentyStepPressure();\n    //if(C.x < 1. || C.y < 1. || C.x > iResolution.x-1. || C.y > iResolution.y-1.) p = 0.;\n    fragColor = vec4(p,0,0,1);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buffer C",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 259
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "#define COMPRESSIBLE (pos.x > .5*R.x)\n#define IISPH 0.1\n\n//force calculation and integration\nvoid Simulation(sampler2D ch, inout particle P, vec2 pos)\n{\n    float pressure = -texture(iChannel2, P.X/R).x;\n    float dpressure = -texture(iChannel1, P.X/R).x;\n    //if(P.M.x > 1.) pressure += P.M.x - 1.;\n    \n    //Compute the SPH force\n    vec2 F = vec2(0.);\n    //vec3 avgV = vec3(0.);\n    range(i, -6, 6) range(j, -6, 6)\n    {\n        vec2 tpos = pos + vec2(i,j);\n        vec4 data = texel(ch, tpos);\n        particle P0 = getParticle(data, tpos);\n        vec2 dx = P0.X - P.X;\n        dx /= 2.;\n        //float avgP = 0.5*P0.M.x*(Pf(P.M) + Pf(P0.M)); \n        //F -= 0.5*G(1.*dx)*avgP*dx;\n        //avgV += P0.M.x*G(1.*dx)*vec3(P0.V,1.);\n        \n        float pressure0 = -texture(iChannel2, P0.X/R).x;\n        float dpressure0 = -texture(iChannel1, P0.X/R).x;\n        //if(P0.M.x > 1.) pressure0 += P0.M.x - 1.;\n        vec2 gradG = G(dx) * dx / 4.;\n        F -= mix(Pf(P.M) + Pf(P0.M), mix(pressure0 - pressure, dpressure0 - dpressure, .1), COMPRESSIBLE ? 0. : .5) * gradG;\n    }\n    //avgV.xy /= avgV.z;\n\n    //viscosity\n    //F += 0.*P.M.x*(avgV.xy - P.V);\n    \n    //gravity\n    F.y -= .0015 * P.M.x;\n\n    if(Mouse.z > 0.)\n    {\n        vec2 dm =(Mouse.xy - Mouse.zw)/10.; \n        float d = distance(Mouse.xy, P.X)/20.;\n        F += 0.001*dm*exp(-d*d);\n       // P.M.y += 0.1*exp(-40.*d*d);\n    }\n    \n    //integrate\n    P.V += F*dt/P.M.x;\n\n    //border \n    vec3 N = bN(P.X);\n    float vdotN = step(N.z, border_h)*dot(-N.xy, P.V);\n    if(vdotN > 0.) P.V += N.xy * abs(vdotN);\n    //P.V += 0.*P.M.x*N.xy*step(abs(N.z), border_h)*exp(-N.z);\n    \n    if(N.z < 0.) P.M = P.V = vec2(0.);\n    \n    if(pos.x < 10. || pos.x > R.x-10. || abs(pos.x - .5*R.x) < 10.) P.M = P.V = vec2(0.);\n    \n    //velocity limit\n    float v = length(P.V);\n    P.V /= (v > 1.)?v:1.;\n}\n\nvoid mainImage( out vec4 U, in vec2 pos )\n{\n    R = iResolution.xy; time = iTime; Mouse = iMouse;\n    ivec2 p = ivec2(pos);\n        \n    vec4 data = texel(ch0, pos); \n    \n    particle P = getParticle(data, pos);\n    \n    \n    if(P.M.x != 0.) //not vacuum\n    {\n        Simulation(ch0, P, pos);\n    }\n    \n    if(length(pos - R*vec2(.1 + .3*hash32(vec2(iFrame)).z, 0.9)) < 50e-3*R.y && iFrame%500 < 1) \n    {\n        P.X = pos;\n        P.V = vec2(0, -1);\n        P.M = vec2(fluid_rho, 0.);\n    }\n    \n    if(length(pos - R*vec2(.6 + .3*hash32(vec2(iFrame)).z, 0.9)) < 50e-3*R.y && iFrame%500 < 1) \n    {\n        P.X = pos;\n        P.V = vec2(0, -1);\n        P.M = vec2(fluid_rho, 0.);\n    }\n\n    U = saveParticle(P, pos);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    },
                    {
                        "channel": 2,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buffer D",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 260
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}