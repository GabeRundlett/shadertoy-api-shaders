{
    "Shader": {
        "info": {
            "date": "1574274441",
            "description": "A shader created live on-stream (Episode 73) at https://twitch.tv/codebasealpha. The texture that is flying upward is not the correct image, but I cannot upload the right one!",
            "flags": 0,
            "hasliked": 0,
            "id": "tdGXRy",
            "likes": 3,
            "name": "CodebaseAlpha7",
            "published": 3,
            "tags": [
                "fire",
                "smoke",
                "rocketplume"
            ],
            "usePreview": 0,
            "username": "codebasealpha",
            "viewed": 468
        },
        "renderpass": [
            {
                "code": "float noiseFunction(vec2 pos)\n{\n    return texture(iChannel0, pos - 0.5).x * 2.0 - 1.0;\n}\n\nfloat fbm(vec2 pos)\n{\n    pos *= 0.02;\n    pos.y += iTime * -0.05;\n    float sum = 0.0;\n    float freq = 1.0;\n    float amp = 1.0;\n    \n    for (int i = 0; i < 4; i++)\n    {\n        sum += amp * noiseFunction(pos * freq);\n        amp *= 0.5;\n        freq *= 3.0;\n    }\n    \n    return sum;\n}\n\nvec2 toPolarCoords(vec2 pos)\n{\n    float radius = length(pos);\n    float angle = atan(pos.y, pos.x);\n    return vec2(radius, angle);\n}\n\nvec2 toRectCoords(vec2 polar)\n{\n    float x = polar.x * cos(polar.y);\n    float y = polar.x * sin(polar.y);\n    \n    return vec2(x,y);\n}\n\nvec3 fire(vec2 pos)\n{\n    pos.y += 0.75;\n    pos *= 5.0;\n    \n    float n = tanh(exp(fbm(pos) - pos.y));\n    vec3 col = mix(vec3(pow(n, 0.4)), vec3(1.5 * n, 1.5 * pow(n,3.0), pow(n, 6.0)), n);\n    \n    return col;\n}\n\nvec4 rocketPlume(vec2 pos)\n{\n    pos.y *= -0.75;\n\n    vec2 p = toPolarCoords(pos);\n    p.x -= 1.2;\n    \n    pos = toRectCoords(p);\n    vec3 col = fire(pos);\n    float alpha = smoothstep(0.1, -0.2, p.x) * (smoothstep(2.5, 2.0, p.y) * smoothstep(0.5, 1.5, p.y));\n    \n    return vec4(col, alpha);\n}\n\nvec4 alf(vec2 pos)\n{\n    pos.y -= 0.06;\n    pos.y *= -1.0;\n    pos *= 4.0;\n    pos += 0.5;\n    float a = pos.x >= 0.0 && pos.x <= 1.0 ? 1.0 : 0.0;\n    float b = pos.y >= 0.0 && pos.y <= 1.0 ? 1.0 : 0.0;\n    vec4 col = texture(iChannel1, pos) * a * b;\n    return col;\n}\n\nvec3 rocketAlf(vec2 pos)\n{\n    vec3 col = vec3(0.0);\n    vec4 rocketc = rocketPlume(pos);\n    col = mix(col, rocketc.xyz, rocketc.w);\n    vec4 alfc = alf(pos);    \n    col = mix(col, alfc.xyz, alfc.w);\n    return col;\n}\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = (fragCoord/iResolution.xy) * 2.0 - 1.0;\n    uv.x *= iResolution.x / iResolution.y;\n    \n    float offset = mix(1.0, -2.1, smoothstep(0.0, 10.0, mod(iTime, 10.0)));\n    uv.y += offset;\n\n    vec3 col = rocketAlf(uv);    \n        \n    fragColor = vec4(\n        col,\n        1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 1,
                        "ctype": "texture",
                        "id": 1,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/10eb4fe0ac8a7dc348a2cc282ca5df1759ab8bf680117e4047728100969e7b43.jpg"
                    },
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 17,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/0c7bf5fe9462d5bffbd11126e82908e39be3ce56220d900f633d58fb432e56f5.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}