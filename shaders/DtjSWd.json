{
    "Shader": {
        "info": {
            "date": "1676806086",
            "description": "CC0: Impulse 2023!\nSilliness on sunday morning. \nMusic by Lotek Style, hope he doesn't mind I put his music to this silliness\n",
            "flags": 64,
            "hasliked": 0,
            "id": "DtjSWd",
            "likes": 16,
            "name": "Impulse 2023!",
            "published": 3,
            "tags": [
                "atari"
            ],
            "usePreview": 1,
            "username": "mrange",
            "viewed": 391
        },
        "renderpass": [
            {
                "code": "// CC0: Impulse 2023!\n// Silliness on sunday morning. \n// Music by Lotek Style, hope he doesn't mind I put his music to this silliness\n\n// If you struggle getting the music to play the reason is often that the browser \n// refuse to play unless you interacted with the controls. \n// So usually pausing and rewinding tend to unlock the music.\n\n#define THAT_CRT_FEELING\n\n#define PI  3.141592654\n#define TAU (2.0*PI)\n\n// Font rendering macros (ASCII codes)\n#define _SPACE 32\n#define _EXCLAMATION 33\n#define _COMMA 44\n#define _DASH 45\n#define _PERIOD 46\n#define _SLASH 47\n#define _COLON 58\n#define _AT 64\n#define _A 65\n#define _B 66\n#define _C 67\n#define _D 68\n#define _E 69\n#define _F 70\n#define _G 71\n#define _H 72\n#define _I 73\n#define _J 74\n#define _K 75\n#define _L 76\n#define _M 77\n#define _N 78\n#define _O 79\n#define _P 80\n#define _Q 81\n#define _R 82\n#define _S 83\n#define _T 84\n#define _U 85\n#define _V 86\n#define _W 87\n#define _X 88\n#define _Y 89\n#define _Z 90\n\n#define _a 97\n#define _b 98\n#define _c 99\n#define _d 100\n#define _e 101\n#define _f 102\n#define _g 103\n#define _h 104\n#define _i 105\n#define _j 106\n#define _k 107\n#define _l 108\n#define _m 109\n#define _n 110\n#define _o 111\n#define _p 112\n#define _q 113\n#define _r 114\n#define _s 115\n#define _t 116\n#define _u 117\n#define _v 118\n#define _w 119\n#define _x 120\n#define _y 121\n#define _z 122\n\n#define _0 48\n#define _1 49\n#define _2 50\n#define _3 51\n#define _4 52\n#define _5 53\n#define _6 54\n#define _7 55\n#define _8 56\n#define _9 57\n\nconst int numLetters = 13;\nconst int letterArray[numLetters] = int[](\n  _I,_M,_P,_U,_L,_S,_E,_EXCLAMATION,_SPACE,_2,_0,_2,_3\n);\n\n\n#define TIME        iTime\n#define RESOLUTION  iResolution\n\n// License: MIT OR CC-BY-NC-4.0, author: mercury, found: https://mercury.sexy/hg_sdf/\nvec2 mod2(inout vec2 p, vec2 size) {\n  vec2 c = floor((p + size*0.5)/size);\n  p = mod(p + size*0.5,size) - size*0.5;\n  return c;\n}\n\n// License: MIT, author: Inigo Quilez, found: https://iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\nfloat box(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,0.0)) + min(max(d.x,d.y),0.0);\n}\n\nvec4 atariBee(vec2 p, float aa, float csz, vec3 bgCol, vec3 fgCol) {\n  const int[] rows = int[16](\n    0x00007c3e\n  , 0x282c7f7f\n  , 0x6a52ffff\n  , 0x1b22ffff\n  , 0x7b02ffff\n  , 0x0686ffff\n  , 0x3fcc7fff\n  , 0x1ab87ffe\n  , 0x07603ffc\n  , 0x2ad87ffc\n  , 0x5198ffff\n  , 0x2163ffff\n  , 0x4360fff7\n  , 0x4600fff8\n  , 0x3c10ff38\n  , 0x00107e38\n  );\n\n  vec2 cp = p;\n  float r  = 0.125*csz; \n  vec2 cn = mod2(cp, vec2(csz));\n  cn += 7.0;\n  \n  \n  if (cn.x < 0.0 || cn.x > 15.0) {\n    return vec4(0.0);\n  }\n  \n  if (cn.y < 0.0 || cn.y > 15.0) {\n    return vec4(0.0);\n  }\n\n  float d = box(cp, vec2(0.5*csz-r))-r;\n  // Praying bit tests aren't _too_ bad performance wise.\n  int row = rows[int(cn.y)];\n  bool bg = (row & (1 << int(cn.x))) != 0;\n  if (!bg) {\n    return vec4(0.0);\n  }\n  vec3 col = bgCol;\n  bool fg = (row & (1 << (int(cn.x)+16))) != 0;\n  if (fg) {\n    col = fgCol;\n  }\n  float t = smoothstep(aa, -aa, d);\n  return vec4(col, t);\n}\n\nvec4 atariBomb(vec2 p, float aa, float csz, vec3 bgCol, vec3 fgCol) {\n  const int[] rows = int[16](\n    0x03800380\n  , 0x0fe00fe0\n  , 0x1df01ff0\n  , 0x3bf83ff8\n  , 0x3bf83ff8\n  , 0x7ffc7ffc\n  , 0x7ffc7ffc\n  , 0x3fb83ff8\n  , 0x3ff83ff8\n  , 0x1ff01ff0\n  , 0x07c007c0\n  , 0x07c407c4\n  , 0x01090109\n  , 0x00800080\n  , 0x004a004a\n  , 0x00300030\n  );\n\n  vec2 cp = p;\n  float r  = 0.125*csz; \n  vec2 cn = mod2(cp, vec2(csz));\n  cn += 7.0;\n  \n  \n  if (cn.x < 0.0 || cn.x > 15.0) {\n    return vec4(0.0);\n  }\n  \n  if (cn.y < 0.0 || cn.y > 15.0) {\n    return vec4(0.0);\n  }\n\n  float d = box(cp, vec2(0.5*csz-r))-r;\n  // Praying bit tests aren't _too_ bad performance wise.\n  int row = rows[int(cn.y)];\n  bool bg = (row & (1 << int(cn.x))) != 0;\n  if (!bg) {\n    return vec4(0.0);\n  }\n  vec3 col = bgCol;\n  bool fg = (row & (1 << (int(cn.x)+16))) != 0;\n  if (fg) {\n    col = fgCol;\n  }\n\n  float t = smoothstep(aa, -aa, d);\n  return vec4(col, t);\n}\n\nvec4 text(in vec2 uv, int start, int count, bool repeat) {\n  float fl = floor(uv + 0.5).x;\n  float cursorPos = fl;\n  int arrayPos = int(cursorPos);\n  if (arrayPos < 0)\n  {\n    return vec4(0.0, 0.0, 0.0, 1.0);\n  }\n  if (!repeat && arrayPos >= count)\n  {\n    return vec4(0.0, 0.0, 0.0, 1.0);\n  }\n\n  arrayPos %= count;\n  arrayPos += start;\n\n  int letter = letterArray[arrayPos];\n  vec2 lp = vec2(letter % 16, 15 - letter/16);\n  vec2 uvl = lp + fract(uv+0.5)-0.5;\n\n  // Sample the font texture. Make sure to not use mipmaps.\n  // Add a small amount to the distance field to prevent a strange bug on some gpus. Slightly mysterious. :(\n  vec2 tp = (uvl+0.5)*(1.0/16.0);\n  return texture(iChannel1, tp, -100.0) + vec4(0.0, 0.0, 0.0, 0.000000001);\n}\n\nvec3 competitionWinnerEffect(vec3 col, vec2 p, float tm) {\n  vec2 tp = p;\n  tp.x += sin(p.y+tm);\n  tp.y += sin(tm)*sin(p.x+sqrt(0.5)*tm);\n  tp *= 3.0;\n  tp.x -= -float(numLetters)*0.5;\n  tp.y += 0.4*tm;\n  if (tp.y < 0.5+18.0) {\n    return col;\n  }\n  vec4 tcol = text(tp, 0, numLetters, false);\n  \n  vec3 ecol = vec3(0.0);\n  vec3 fcol = vec3(1.0);\n\n  float ry = p.y-tm;\n  fcol = (1.0+cos(2.0*vec3(0.0, 1.0, 2.0)+ry));\n  fcol = floor(fcol*16.0)/16.0;\n  fcol = step(tcol.w, 0.5)*fcol;\n  float t = step(tcol.w, 0.55);\n  \n  return mix(col, fcol, t);;\n}\n\nvec3 background(vec2 p, vec2 q, float sz) {\n  const vec3 atariBg = vec3(148.0, 236.0, 70.0)/255.0;\n  vec3 col = atariBg;\n  if (1.0-q.y < sz*8.0 ) {\n    col = vec3(0.0);\n  }\n  if (1.0-q.y < sz*7.0 ) {\n    vec2 tp =p;\n    tp *= 8.0;\n    tp.x += float(numLetters)*0.5;\n    tp.y += 0.5;\n    vec4 tcol = text(tp, 0, numLetters, false);\n    col = step(0.52,tcol.w)*vec3(1.0);\n  }\n  return col;\n}\n\nvec3 bombsAway(vec3 col, vec2 p, float sz, float r, float aa) {\n  vec2 bp = p;\n  bp.x -= -1.0*r+8.0*sz;\n  bp.y += -1.0+8.0*sz;\n  vec2 bn = mod2(bp, vec2(16.0*sz));\n\n  float bombs = texture(iChannel0, vec2(clamp((0.0125*(1.0-bn.y)), 0.0, 1.0), 0.25)).x;\n  bombs -= 0.2;\n  bombs = max(bombs, 0.0);\n  bombs *= bombs;\n  bombs *= 20.0;\n\n  if (bn.x > bombs || bn.y > -1.0) {\n    return col;\n  }\n\n  col = vec3(1.0);\n  vec4 bcol = atariBomb(bp, aa, sz, vec3(1.0), vec3(0.0));\n  return mix(col, bcol.xyz, bcol.w);\n}\n\nvec3 busyBee(vec3 col, vec2 p, vec2 m, float aa, float sz) {\n  vec2 ap = p;\n  if (iMouse.z != 0.0) {\n    ap -= m;\n  }\n\n  vec4 acol = atariBee(ap, aa, sz, vec3(1.0), vec3(0.0));\n  return mix(col, acol.xyz, acol.w);\n}\n\nvec3 beatingNik(vec3 col, vec2 p, float aa, float sz, float tm) {\n  sz *= 4.0;\n\n  float ry = 1.0*p.y+tm;\n  vec3 fcol = (1.0+cos(1.6*vec3(0.0, 1.0, 2.0).yzx+ry));\n  fcol = floor(fcol*16.0)/16.0;\n  fcol = mix(vec3(1.0), fcol, smoothstep(54.0, 56.0, tm));\n  p.y += 3.0*smoothstep(15.0, 9.0, tm);\n//  p *= 1.0-0.5*length(p-sin(1.133*TAU*vec2(1.0, sqrt(0.5))*(tm)));\n  for (float i = 0.0; i < 10.0; ++i) {\n    vec2 bp = p;\n    bp += sin(0.33*TAU*vec2(1.0, sqrt(0.5))*(tm+0.25*i));\n    vec4 bcol = atariBee(bp, aa, sz, fcol, vec3(0.0));\n    col = mix(col, bcol.xyz, bcol.w);\n  }\n  return col;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec2 q = fragCoord/RESOLUTION.xy;\n  vec2 p = -1. + 2. * q;\n  vec2 pp = p;\n  vec2 m = -1. + 2. * (iMouse.xy)/RESOLUTION.xy;\n  float r = RESOLUTION.x/RESOLUTION.y;\n  p.x *= r;\n  m.x *= r;\n  float tm = mod(TIME, 4.0*60.0+11.0);\n//  tm += 10.0;\n  float aa = 2.0/RESOLUTION.y;\n  const float dsz = 0.01;\n  float sz = aa*floor(dsz/aa);\n\n  vec3 col = background(p, q, sz);\n  col = bombsAway(col, p, sz, r, aa);\n  col = beatingNik(col, p, aa, sz, tm);\n  col = competitionWinnerEffect(col, p, tm);\n  col = busyBee(col, p, m, aa, sz);\n  col = clamp(col, 0.0, 1.0);\n#ifdef THAT_CRT_FEELING\n  col *= 1.1*smoothstep(2.1, 0.75, length(pp));\n  col *= mix(vec3(0.71), vec3(1.0),smoothstep(-0.9, 0.9, sin(TAU*p.y/sz+TAU*vec3(0.0, 1., 2.0)/3.0)));\n#endif\n\n  fragColor = vec4(col, 1.0);\n}\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 1,
                        "ctype": "texture",
                        "id": 49,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png"
                    },
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 32428,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/lotekstyle/lotek-style-artefakt"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}