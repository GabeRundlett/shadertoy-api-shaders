{
    "Shader": {
        "info": {
            "date": "1692846086",
            "description": "Music by Tony Leys https://soundcloud.com/tonileys",
            "flags": 64,
            "hasliked": 0,
            "id": "clffWH",
            "likes": 8,
            "name": "Fork Shimmy",
            "published": 3,
            "tags": [
                "raymarching",
                "audioreactive"
            ],
            "usePreview": 0,
            "username": "cbalestra",
            "viewed": 341
        },
        "renderpass": [
            {
                "code": "//#define iTime iChannelTime[0]\nfloat det=.005, maxdist=50., pi=3.1416, gl=0.;\nvec2 id;\n\n\nfloat hash12(vec2 p)\n{\n    p*=1000.;\n    vec3 p3  = fract(vec3(p.xyx) * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\n\nmat2 rot(float a)\n{\n    float s=sin(a), c=cos(a);\n    return mat2(c,s,-s,c);\n}\n\nfloat box(vec3 p, vec3 c)\n{\n    vec3 pc=abs(p)-c;\n    return length(max(vec3(0.),pc))-min(0.,max(pc.z,max(pc.x,pc.y)));\n}\n\nvec2 amod(vec2 p, float n, float off, out float i)\n{\n    float l=length(p)-off;\n    float at=atan(p.x,p.y)/pi*n*.5;\n    i=abs(floor(at));\n    float a=fract(at)-.5;\n    return vec2(a,l);\n}\n\nfloat ring(vec3 p,inout vec2 id)\n{\n    p.xy=amod(p.xy*rot(iTime*0.), 20., 2., id.x);\n    float h=max(0.,texture(iChannel0,vec2(.15+fract(id.x*.2+id.y*.1),0.)*.5).r*3.-.5);\n    h+=sin(iTime*10.+id.x)*.2;\n    float d=box(p+vec3(0.,-h*1.5,0.),vec3(.1,h,.1));\n    return d*.5;\n}\n\nfloat de(vec3 p)\n{\n    float d=100.,ii=0.;\n    p.xz*=rot(iTime);\n    p.yz*=rot(sin(iTime));\n    float r=4.;\n    vec2 ids;\n    for (float i=0.; i<r; i++)\n    {\n        p.xz*=rot(pi/r);\n        ids.y=i;\n        float r=ring(p,ids);\n        if (r<d)\n        {\n            d=r;\n            id=ids;\n        }\n    }\n    d=min(d,length(p)-1.5);\n    return d*.7;\n}\n\nvec3 normal(vec3 p)\n{\n    vec2 e=vec2(0.,det);\n    return normalize(vec3(de(p+e.yxx),de(p+e.xyx),de(p+e.xxy))-de(p));\n}\n\n\nvec3 march(vec3 from, vec3 dir)\n{\n    float d, td=0.;\n    vec3 p, col=vec3(0.);\n    for (int i=0; i<100; i++)\n    {\n        p=from+td*dir;\n        d=de(p);\n        if (d<det || td>maxdist) break;\n        td+=d;\n        gl+=.1/(10.+d*d*10.)*step(.7,hash12(id+floor(iTime*5.)));\n    }\n    if (d<det)\n    {\n        //id+=floor(iTime*5.);\n        vec3 colid=vec3(hash12(id),hash12(id+123.123),1.);\n        p-=dir*det;\n        vec3 n=normal(p);\n        vec2 e=vec2(0.,.05);\n        col=.1+max(0.,dot(-dir,n))*colid;\n        col*=.5+step(.7,hash12(id+floor(iTime*5.)));\n    } \n    else\n    {\n        dir.xz*=rot(iTime*.5);\n        dir.yz*=rot(iTime*.25);\n        vec2 p2=abs(.5-fract(dir.yz));\n        float d2=100.,is=0.;\n        for(int i=0; i<10; i++)\n        {\n            p2=abs(p2*1.3)*rot(radians(45.))-.5;\n            float sh=length(max(vec2(0.),abs(p2)-.05));\n            if (sh<d2)\n            {\n                d2=sh;\n                is=float(i);\n            }\n        }\n        col+=smoothstep(.05,.0,d2)*fract(is*.1+iTime)*normalize(p+50.);\n    }\n    return col*mod(gl_FragCoord.y,4.)*.5+gl;\n}\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord-iResolution.xy*.5)/iResolution.y;\n    vec3 from = vec3(0.,0.,-8.);\n    vec3 dir = normalize(vec3(uv,.7));\n    vec3 col = march(from, dir);\n    fragColor = vec4(col,1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 26471,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/tonileys/through-a-cardboard-world"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}