{
    "Shader": {
        "info": {
            "date": "1500579327",
            "description": "A rude 2D dispersion light attempt. Hope doing it right eventually.",
            "flags": 96,
            "hasliked": 0,
            "id": "4sSfWm",
            "likes": 4,
            "name": "Hand-made 2D Dispersion Light",
            "published": 3,
            "tags": [
                "2d",
                "light",
                "prism",
                "dispersion",
                "pinkfloyd",
                "handmade",
                "diy"
            ],
            "usePreview": 0,
            "username": "josemorval",
            "viewed": 767
        },
        "renderpass": [
            {
                "code": "void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{      \n   \tfloat t = mod(iTime,10.);\n    fragColor = texture(iChannel0,fragCoord.xy/iResolution.xy)/t;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "musicstream",
                        "id": 11328,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/lysergic-dream/pink-floyd-money-dark-side-of"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "float hash1(float n){\n return fract(111117.*sin(3.*n));   \n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 p = fragCoord.xy / iResolution.xy, p0;\n    p-=.5;\n    p.x*=iResolution.x/iResolution.y;\n    p*=10.;\n    \n    float angle0 = 0.3;\n    \n    vec4 col = vec4(0.);\n    vec4 cols[3] = vec4[3](\n        vec4(1.,0.,0.,1.),\n        vec4(0.,1.,0.,1.),\n        vec4(0.,0.,1.,1.)\n    );\n    \n    for(int l=0;l<3;l++){\n        float angle = angle0+.05*float(l);\n        mat2 m = mat2(cos(angle),-sin(angle),sin(angle),cos(angle));\n        \n        p0 = p;\n        float h = 3.1415*2.*hash1(p.x*p.y+iTime);\n        vec2 d = vec2(cos(h),sin(h));\n        vec2 dl = vec2(1.,0.);\n        \n        float f = length(p0)-.8,s = 0.;\n        \n        if(f<.01){\n            col = vec4(0.,0.,0.,0.);\n            s=-5.;\n        }\n        \n        int i=0;\n        while(i++<4 && s>-4.){\n            \n            f=length(p0)-.8; \n            float f2 = length(p0-vec2(5.,0.))-.05;\n            if(f2<.1 && dot(d,dl)>0.99){\n                col+=cols[l];\n                s=-1.;\n                break;\n            }\n            \n            if(f<.01){\n                s = 1.;\n                break;\n            }\n            p0+=min(f,f2)*d;\n        }\n        \n        \n        if(s>0.){\n            d=m*d;\n            s=0.,i=0;\n            while(i++<4){\n\n                f=-length(p0)+.8;\n\n                if(f<.1){\n                    s = 1.;\n                    break;\n                }\n                p0+=f*d;\n            }   \n        }\n        \n        if(s>0.){\n            d=m*d;\n            s=0.,i=0;\n            while(i++<4){\n\n                f=length(p0-vec2(5.,0.))-.05;\n\n                if(f<.1 && dot(d,dl)>0.99){\n                    col+=cols[l];\n                    break;\n                }\n                p0+=f*d;\n            }   \n        }\n        \n        if(s<-4.){\n        \tcol = vec4(0.);   \n        }\n    }\n    \n    \n    if(mod(iTime,10.)<0.5){\n    \tfragColor = vec4(0.0);    \n    }else{\n    \tfragColor = texture(iChannel0,fragCoord.xy/iResolution.xy) + col;        \n    }\n    \n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buf A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}