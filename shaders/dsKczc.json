{
    "Shader": {
        "info": {
            "date": "1696425909",
            "description": "mandelbrot",
            "flags": 64,
            "hasliked": 0,
            "id": "dsKczc",
            "likes": 1,
            "name": "Mandelbrot-prim",
            "published": 3,
            "tags": [
                "mandelbrot"
            ],
            "usePreview": 0,
            "username": "f_x",
            "viewed": 155
        },
        "renderpass": [
            {
                "code": "\n\nvec2 init(vec2 fragCoord, vec2 res) {\n    float ratio = res.y/res.x;\n    vec2 mr = vec2(min(res.x, res.y));\n    vec2 uv = (fragCoord/mr) + vec2(-0.5/ratio, -0.5);\n    return uv;\n}\n\nvec2 sq(vec2 c) {\n    float re = c.x*c.x - c.y*c.y;\n    float im = 2.*c.x*c.y;\n    return vec2(re,im);\n}\n\nfloat amount(vec2 c) {\n    return sqrt(c.x*c.x + c.y*c.y);\n}\n\nint mandel(vec2 c0, vec2 c00, int maxIter) {\n    vec2 c = sq(c0);\n    \n    int iter;\n    for (iter=0;iter < maxIter && amount(c) < 4.; iter++) {\n        c = sq(c - c00);\n    }\n    \n    return iter;\n}\n\nfloat band(int hz) { \n    int ix = int(float(hz)/23.); \n    float fft  = texelFetch( iChannel0, ivec2(ix,0), 0 ).x; \n    return fft;\n}\n\n\nfloat sinp(float x) {\n    return (1. + sin(x)) / 2.;\n}\n\nfloat sinp(int n) {\n    return sinp(float(n));\n}\n\nfloat nn(int n) {\n    if (n < 8) return float(n);\n    return float(n) + band(180)*250.;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = init(fragCoord,iResolution.xy*.4) - vec2(1.3, 0.8);\n\n    int N = 10000;\n    \n    float ra = band(200)*.1;//sin(iTime * 1.012) * 0.02;\n    float rb = band(200)*(.35-band(4000))/.6;//sin(iTime * 1.037) * 0.08;\n    \n    \n    int n = mandel(uv.yx, vec2(.57+ra, .57+rb), N);\n    \n    \n    vec3 col = n == N ? vec3(0) : vec3(\n        sinp(nn(n) / 43.), sinp(nn(n) / 27.), sinp(nn(n) * .2)\n    );\n\n    fragColor = vec4(col,1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 34844,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/f_x/so-techno-halt"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}