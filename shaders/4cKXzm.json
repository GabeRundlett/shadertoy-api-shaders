{
    "Shader": {
        "info": {
            "date": "1715000494",
            "description": "robot",
            "flags": 32,
            "hasliked": 0,
            "id": "4cKXzm",
            "likes": 30,
            "name": " Quadruped",
            "published": 3,
            "tags": [
                "robot"
            ],
            "usePreview": 0,
            "username": "wyatt",
            "viewed": 281
        },
        "renderpass": [
            {
                "code": "float map (vec3 p) {\n    return abs(p.y+2.4)-.1;\n}\nMain {\n\n    float T = 6.*float(iFrame)/60.;\n    vec3 p = vec3(0,.5,-4);\n    \n    vec3 d = normalize(vec3(2.*(U-.5*R)/R.y,1));\n    \n    vec3 p0 = A(.5+vec2(0,0)).xyz;\n    vec3 v = A(.5+vec2(1,0)).xyz;\n    vec3 s = A(.5+vec2(2,0)).xyz;\n    mat3 o = mat3(\n        A(.5+vec2(3,0)).xyz,\n        A(.5+vec2(4,0)).xyz,\n        A(.5+vec2(5,0)).xyz\n    );\n    \n    vec4 x = tube(p,d,vec3(.0),vec3(sin(iTime),cos(iTime),0),.05);\n    Q = vec4(0);\n    float _x = 1e9;\n    for (int i = 0; i < 14; i++) {\n        vec3 s = spheres[i]*o;\n        {\n            vec4 x = sphere(p-s,d,.2);\n            if (x.x >0.&& x.x <_x) Q.xyz = .5+.5*x.yzw,_x = x.x;\n        }\n        if (i < 13){\n        \n        vec3 a = pegs_a[i]*o;\n        vec3 b = pegs_b[i]*o;\n            vec4 x = tube(p,d,a,b,.2);\n            if (x.x >0.&&x.x < _x) Q.xyz = .5+.5*x.yzw,_x = x.x;\n        }\n        \n    }\n    \n    p += p0;\n    float x_ = 0.;\n    for (float i = 0.; i < 30.; i++) {\n        x_ += map(p+d*x_);\n    }\n    vec3 u = p + d*x_;\n    if (x_ < _x && x_ < 100.) {Q = vec4(.6+.4*sign(sin(u.x)*sin(u.z)));\n    \n    \n    p = u-p0;\n    d = vec3(0,1,0);\n    _x = 1e9;\n    if (length(p)<4.)\n    for (int i = 0; i < 14; i++) {\n        vec3 s = spheres[i]*o;\n        vec3 a = pegs_a[i]*o;\n        vec3 b = pegs_b[i]*o;\n        {\n            vec4 x = sphere(p-s,d,.2);\n            if (x.x >0.&& x.x <_x) {Q.xyz *= .5;break;}\n           \n        }\n        {\n            vec4 x = tube(p,d,a,b,.2);\n            if (x.x >0.&&x.x < _x) {Q.xyz *= .5;break;}\n        }\n        \n    }\n    }\n    \n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "\n#define _0 vec3(0)\n#define a0 0.+.1*sin(2.*T)-.1\n#define _1 (_0 + 1.2*vec3(cos(a0),sin(a0),0))\n#define a1 pi -.1*sin(2.*T)+.1\n#define _2 (_0 + 1.2*vec3(cos(a1),sin(a1),0))\n#define a2 pi*3./4. + .1*sin(T)\n#define _3 (_2 + vec3(cos(a2),sin(a2),0))\n#define a3 pi*1./4. + .1*sin(T) + .2\n#define _4 (_1 + vec3(cos(a3),sin(a3),0))\n#define a4 3.*pi/2. - .4*sin(T) + .2\n#define _5 (_2 + vec3(cos(a4),sin(a4),.75))\n#define a5 3.*pi/2. + .4*sin(T) + .2\n#define _6 (_2 + vec3(cos(a5),sin(a5),-.75))\n#define a6 3.*pi/2. + .4*sin(T) + .3\n#define _7 (_1 + vec3(cos(a6),sin(a6),.75))\n#define a7 3.*pi/2. - .4*sin(T) + .3\n#define _8 (_1 + vec3(cos(a7),sin(a7),-.75))\n#define a8 0. - .1*sin(T)\n#define _9 (_4 + vec3(cos(a8),sin(a8),0))\n#define a9 3.*pi/2. - 1.*abs(sin(.5*T))+.2\n#define _10 (_5 + vec3(cos(a9),sin(a9),.2))\n#define a10 3.*pi/2. - 1.*abs(cos(.5*T))+.2\n#define _11 (_6 + vec3(cos(a10),sin(a10),-.2))\n#define a11 3.*pi/2. - 1.*abs(cos(.5*T))+.3\n#define _12 (_7 + vec3(cos(a11),sin(a11),.2))\n#define a12 3.*pi/2. - 1.*abs(sin(.5*T))+.3\n#define _13 (_8 + vec3(cos(a12),sin(a12),-.2))\n\n\n#define spheres vec3[14] (_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12,_13)\n#define pegs_a vec3[13] (_0,_0,_2,_1,_2,_2,_1,_1,_4,_5,_6,_7,_8)\n#define pegs_b vec3[13] (_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,_11,_12,_13)\n\n#define pi 3.14159265359\n\n#define R iResolution.xy\n#define A(U) texture(iChannel0,(U)/R)\n#define B(U) texture(iChannel1,(U)/R)\n#define C(U) texture(iChannel2,(U)/R)\n#define D(U) texture(iChannel3,(U)/R)\n\n#define Main void mainImage(out vec4 Q, in vec2 U) \n\nmat3 matrix (vec3 r) { \n   if (length(r)==0.) return mat3(1);\n   float a = length(r);\n   vec3 o = normalize(r);\n   float c = cos(a), t = 1.-c;\n   float s = sin(a);\n   return mat3(\n       t*o.x*o.x+c,t*o.x*o.y-o.z*s,t*o.x*o.z+o.y*s,\n       t*o.x*o.y+o.z*s,t*o.y*o.y+c,t*o.y*o.z-o.x*s,\n       t*o.x*o.z-o.y*s,t*o.y*o.z+o.x*s,t*o.z*o.z+c\n   \n   );\n\n}\n\nfloat quadratic (float a, float b, float c) {\n    float det = b*b-4.*a*c;\n    if (det <= 0.) return -1.;\n    return (-b-sqrt(det))/(2.*a);\n\n}\n\nvec4 sphere (vec3 p, vec3 d, float r) {\n    float a = 1., b = 2.*dot(p,d), c = dot(p,p)-r*r;\n    float x = quadratic (a,b,c);\n    return vec4(x,normalize(p+d*x));\n}\n\nvec4 tube (vec3 p, vec3 d, vec3 a, vec3 b, float r) {\n        p -= a;\n        b -= a;\n        a -= a;\n        vec3 ab = normalize(b-a);\n        float pp = dot(p,p);\n        float abab = dot(ab,ab);\n        float pab = dot(p,ab);\n        float aab = dot(a,ab);\n        float dab = dot(d,ab);\n        float pd = dot(p,d);\n        float _a = 1. - 2.*dab*dab + abab*dab*dab,\n            _b = 2.*pd - 4.*pab*dab + 2.*dab*aab + 2.*abab*pab*dab - 2.*abab*dab*aab,\n            _c = pp - 2.*pab*pab + 2.*pab*aab + abab*pab*pab - 2.*abab*pab*aab + abab*aab*aab - r*r;\n        float x = quadratic(_a,_b,_c);\n        \n        if (x < 0.) return vec4(-1.,0,0,0);\n        \n        float y = dot(p + d*x - a,ab);\n        \n        if (y < 0.||y>length(a-b)) return vec4(-1.,0,0,0);\n        \n        return vec4(x,(p + d*x - (a+ab*y))/r);\n        \n        \n}",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            },
            {
                "code": "void impulse(vec3 im, vec3 dv, vec3 p, inout vec3 f, inout vec3 t) {\n    if (length(p)>0.){\n    im += dv*min(length(im),.5);\n    f -= im*dot(im,normalize(p));\n    t -= .05*cross(normalize(p),im);\n    }\n}\nMain {\n    float T = 6.*float(iFrame)/60.;\n    if (U.y > 1. || U.x>6.) discard;\n    \n    vec3 p = A(.5+vec2(0,0)).xyz;\n    vec3 v = A(.5+vec2(1,0)).xyz;\n    vec3 s = A(.5+vec2(2,0)).xyz;\n    mat3 o = mat3(\n        A(.5+vec2(3,0)).xyz,\n        A(.5+vec2(4,0)).xyz,\n        A(.5+vec2(5,0)).xyz\n    );\n    float K = 1.;\n    //for (float k = 0.; k < K; k++) {\n        vec3 f = vec3(0,-.01,0);\n        vec3 t = vec3(0);\n        for (int i = 0; i < 14; i++) {\n            vec3 sph = spheres[i]*o;\n            T -= 6./60.;\n            vec3 dsph = spheres[i]*o;\n            T += 6./60.;\n            vec3 vel = 3.*(sph-dsph);\n            vel += v + cross(s,sph);\n            sph += p;\n            if (sph.y < -2.) impulse(vec3(0,(sph.y+2.),0),vel,sph-p,f,t);\n\n        }\n        v += f/K - .01*v/K;\n        s += t/K - .01*s/K;\n        p += f/K + v/K;\n        o *= matrix(s/K+t/K);\n        o[0] = normalize(o[0]);\n        o[1] = normalize(o[1]);\n        o[2] = normalize(o[2]);\n        o[2] = cross(o[0],o[1]);\n        o[1] = cross(o[2],o[0]);\n    //}\n\n    if (iFrame < 1) {\n    \n        p = vec3(0);\n        v = vec3(0);\n        s = vec3(0);\n        o = mat3(1);\n        \n        v = .1 * (vec3(sin(10. * iDate.w * vec3(4,5,6))) + vec3(0,1,0));\n        s = v.x * vec3(.05,1,0);\n        \n    }\n\n    if (U.x < 1.) Q.xyz = p;\n    else if (U.x < 2.) Q.xyz = v;\n    else if (U.x < 3.) Q.xyz = s;\n    else if (U.x < 4.) Q.xyz = o[0];\n    else if (U.x < 5.) Q.xyz = o[1];\n    else if (U.x < 6.) Q.xyz = o[2];\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}