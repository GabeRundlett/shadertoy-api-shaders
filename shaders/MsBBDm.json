{
    "Shader": {
        "info": {
            "date": "1500659326",
            "description": "started with https://iquilezles.org/articles/popcorns/popcorns.htm and went sideways...",
            "flags": 32,
            "hasliked": 0,
            "id": "MsBBDm",
            "likes": 11,
            "name": "color lights",
            "published": 3,
            "tags": [
                "music",
                "lights",
                "popcorn"
            ],
            "usePreview": 0,
            "username": "krwq",
            "viewed": 906
        },
        "renderpass": [
            {
                "code": "void mainImage(out vec4 f, in vec2 g) {\n    f = texelFetch(iChannel1, ivec2(g),0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "#define pi 3.14159265359\n\nvec2 v(vec2 p, vec4 t) {\n    return sin(vec2(\n        t.x + p.y + sin(t.z + pi * p.x),\n        t.y + p.x + sin(t.w + pi * p.y)\n    ));\n}\n\nfloat randt(float x) {\n    float a = 0.11;\n    float b = 0.31;\n    float d = b - a;\n    if (x > 0.) {\n        return a + x / d;\n    }\n    else {\n        return -a + x / d;;\n    }\n}\n\nvoid mainImage(out vec4 f, in vec2 g) {\n    if (iFrame == 0) {\n        f = vec4(0.3 * sin(2. * g.x + 5. * g.y), 0.3 * cos(11. * g.x + 13. *  g.y), 0., 0.);\n    }\n    else {\n\t    f = texelFetch(iChannel0, ivec2(g),0);\n        \n        vec4 t = vec4(randt(cos(0.1 + g.x * .57 + g.y * .11)),\n                      randt(sin(0.2 + g.x * .41 + g.y * .13)),\n                      randt(sin(0.3 + g.x * .5 + g.y * .07)),\n                      randt(cos(0.4 + g.x * .7 + g.y * .09))) * .2 * iTime;\n        vec2 vpop = v(f.xy, t);\n        vec2 vc = -0.1 * f.xy;\n        \n        vpop = mix(vpop, vc, smoothstep(0.6, 1., abs(length(f.xy))));\n        \n        f.zw = f.xy;\n        f.xy = f.xy + 1. * min(iTimeDelta, 0.1) * vpop;\n        //f.xy = min(vec2(1., 1.), max(vec2(-1., -1.), f.xy));\n    }\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buf A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "#define n 50\n\nvoid mainImage(out vec4 f, in vec2 g) {\n    vec3 prevResolution = texelFetch(iChannel1, ivec2(0., 0.), 0).xyz;\n    \n    if (g.x < 1. && g.y < 1.) {\n        vec2 d = iResolution.xy - prevResolution.xy;\n        f.z = dot(d, d);\n        f.xy = iResolution.xy;\n        f.w = 1.;\n        return;\n    }\n    \n    bool sizeChanged = prevResolution.z > 1.;\n    if (iFrame == 0 || sizeChanged) {\n        f = vec4(0., 0., 0., 0.);\n        return;\n    }\n\n\tf = texelFetch(iChannel1, ivec2(g),0);\n    f.xyz *= 0.98;\n    \n    vec2 p = 2. * (g - iResolution.xy / 2.) / iResolution.y;\n    vec3 black = vec3(0., 0., 0.);\n\n    for (int idx = 0; idx < n; idx += 1) {\n        vec4 circlePos = texelFetch(iChannel0, ivec2(idx % 10, idx / 10),0).xyzw;\n        float beat = texture(iChannel2, vec2(float(idx) / float(n) * 256., 1.)).x;\n        float r = 0.003 * (1. + .7 * beat);\n\n        vec3 color = black;\n        vec2 dir = normalize(circlePos.xy - circlePos.zw);\n        vec3 paint = vec3(0.5 + 0.5 * sin(iTime * 0.1 * (1. + mod(float(idx), 7.77))),\n                          0.5 + 0.5 * dir.y,\n                          0.5 + 0.5 * dir.x);\n        \n        color = mix(color, paint, smoothstep(0.1, 1.0, pow(r / (0.0001 + length(circlePos.xy - p)), .7 - 0.25 * beat)));\n        \n        //vec2 halfWay = 0.5 * (circlePos.zw + circlePos.xy);\n        //color = mix(color, paint, smoothstep(0.1, 1.0, pow(0.99 * r / length(halfWay - p), .7 - 0.25 * beat)));\n        \n        f = max(f, vec4(color, 0.));\n    }\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "music",
                        "id": 35,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/a/48e2d9ef22ca6673330b8c38a260c87694d2bbc94c19fec9dfa4a1222c364a99.mp3"
                    },
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buf B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}