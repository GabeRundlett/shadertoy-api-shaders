{
    "Shader": {
        "info": {
            "date": "1614439241",
            "description": "following the two tutorials to create the over the moon. \nhttps://youtu.be/LLZPnh_LK8c\nhttps://youtu.be/XaiYKkxvrFM",
            "flags": 64,
            "hasliked": 0,
            "id": "wlyBDw",
            "likes": 2,
            "name": "Over the Moon_",
            "published": 3,
            "tags": [
                "moon"
            ],
            "usePreview": 0,
            "username": "YitingLiu",
            "viewed": 309
        },
        "renderpass": [
            {
                "code": "#define S(a,b,t) smoothstep(a,b,t)\n\nfloat TaperBox(vec2 p, float wb, float wt, float yb, float yt, float blur){\n    float m = S(-blur,blur,p.y-yb);\n    m *= S(blur,-blur,p.y-yt);\n    p.x=abs(p.x);\n    \n    // taper 0 p.y = yb 1 p.y = wt\n    float w =mix(wb,wt,(p.y-yb)/(yt-yb));\n    m *= S(blur,-blur,p.x-w);\n\n    return m;\n\n}\n\n// conver the taperbox into sugar lollipop in the sugar land \nvec4 Tree(vec2 uv, vec3 col, float blur){\n\n    float m = TaperBox(uv, .03, .03, -.05, .25, blur);// trunk\n    m += TaperBox(uv, .2, .1, .25, .5, blur);// canopy1\n    m += TaperBox(uv, .15, .05, .5, .75, blur);// canopy2\n    m += TaperBox(uv, .1, .0, .75, 1., blur);// canopy3\n \n    //shadow - opposite of taperbox \n    //changing the light shadow angle based on time \n\n    float angle = sin(iTime);\n    float shadow = TaperBox(uv+vec2(0.25,0)*angle*-1., .1, .5, .15, .25, blur);// trunk\n    shadow += TaperBox(uv+vec2(0.3,.0)*angle, .1, .7, .4, .5, blur);// trunk\n    shadow += TaperBox(uv+vec2(0.3,.0)*angle*-1., .1, .5, .7, .75, blur);// trunk\n    \n    \n    col-=shadow*.8;\n    \n    \n    return vec4(col,m);\n    }\n\nfloat GetHeight(float x){\n    return sin(x*.432)+sin(x)*.3;\n}\n\nvec4 Layer(vec2 uv, float blur){\n vec4 col = vec4(0);\n    \n    float id = floor(uv.x);\n    float n = fract(sin(id*234.51)*251.2)*2.-1.;// -1. to 1. //random val\n    float x =n*.3;\n    float y =GetHeight(uv.x);\n\n    float ground = S(blur,-blur,uv.y+GetHeight(uv.x));// ground \n    col+=ground;\n    y = GetHeight(id+.5+x);\n\n    uv.x=fract(uv.x)-.5;\n\n    vec4 tree = Tree((uv-vec2(x,-y))*vec2(1,1.+n*.2), vec3(1), blur);\n    col = mix(col, tree, tree.a);\n    col.a=max(ground, tree.a);\n    return col; \n    }\n    \n    \nfloat Hash21(vec2 p){\n    p = fract(p*vec2(234.45,4532.24));\n    p+=dot(p,p+45632.23);\n    return fract(p.x*p.y);\n    \n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord-.5*iResolution.xy)/iResolution.y;\n    vec2 M = (iMouse.xy/iResolution.xy)*2.-1.;\n    float fft  = texelFetch( iChannel0, ivec2(0.5,0.2), 0 ).x; \n\n    float t = iTime*.2;\n    vec3 colVal =vec3(Hash21(uv)*(sin(t)*.5+.5),.9,cos(t)*.5+.8)*fft;\n\n\n    float blur = .005;\n    float twinkle = dot(length(sin(uv+t)),length(cos(uv*vec2(22,6.7)-t*5.)));\n    twinkle = sin(twinkle*20.)*.5+.5;\n\n    float stars = pow(Hash21(uv),8.)*twinkle/fft;\n    vec4 col = vec4(stars)*vec4(colVal,twinkle);\n    \n   float moon = S(.02*fft ,-.01,length(uv-vec2(.4,.2))-.15);\n   moon*=fft*2.;\n   col*=1.-moon+fft ;\n   \n   moon *= S(-.01,.2,length(uv-vec2(.5,.25))-.15);\n\n\n   col+=moon*vec4(colVal,1.);\n      float bg = 1.-moon-stars;\n\n   col+=bg*.5*vec4(fft-colVal,1.2);\n\n    \n    vec4 layer;\n    \n    for(float i =0.; i<1.; i +=1./10.){\n        float scale = mix(30., 1., i);\n        blur = mix(.05,.005,i);\n        layer = Layer(uv*scale+vec2(t+i*100.,i)-M,blur);\n       vec3 colVal =vec3(Hash21(uv*fft)*(sin(t)*.5+.5),.9*(1.-.5*i),cos(t)*.5+.5);\n       layer.rgb*=mix(i*colVal,(1.-i)*colVal,uv.x*(1.-fft));\n        col = 1.-.5*fft-mix(col, layer,layer.a);\n    \n    \n    }\n          layer = Layer(uv+vec2(t,1.2)-M,blur*2.);\n          \n          layer.rgb*=colVal*.1;\n          col = mix(col, layer,layer.a);\n    \n    col/=mix(0.75,1.,uv.x+fft);\n    \n    \n    /*\n    if(abs(uv.x)<thickness) col.g=1.;\n    if(abs(uv.y)<thickness) col.r=1.;\n    */\n\n    fragColor = col;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 25908,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/themarias/over-the-moon"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}