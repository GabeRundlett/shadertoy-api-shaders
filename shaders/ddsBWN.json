{
    "Shader": {
        "info": {
            "date": "1688760946",
            "description": "FULLSCREEN RECOMMENDED\n\nMouse x controls \"blurring\", mouse y controls regeneration frequency",
            "flags": 48,
            "hasliked": 0,
            "id": "ddsBWN",
            "likes": 13,
            "name": "Constant Collision",
            "published": 3,
            "tags": [
                "2d",
                "simulation",
                "explosion",
                "automata",
                "life",
                "conway",
                "gameoflife",
                "multipass"
            ],
            "usePreview": 0,
            "username": "misol101",
            "viewed": 291
        },
        "renderpass": [
            {
                "code": "void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 val = texelFetch( iChannel0, ivec2(fragCoord), 0 ).xxx;\n    //fragColor = vec4( val.x*0.95, val.x*0.95, val.x, 1.0 );\n\n    fragColor = vec4( (0.7-val)*1.5, 1.0 );\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "const int Key_SPACE = 32;\n\nbool ReadKey( int key )\n{\n\tbool toggle = false;\n\tfloat keyVal = texture( iChannel1, vec2( (float(key)+.5)/256.0, toggle?.75:.25 ) ).x;\n\treturn (keyVal>.5)?true:false;\n}\n\nconst int stayrules[9] = int[9](0,0,1,1,0,0,0,0,1);\nconst int bornrules[9] = int[9](0,0,1,0,0,0,1,1,0);\nconst float liveval = 0.01;\n\n\nint cell2( in ivec2 p )\n{\n    ivec2 r = ivec2(textureSize(iChannel0, 0));\n    p = (p+r) % r;\n    float val = texelFetch(iChannel0, p, 0 ).x;\n    return ( val == liveval) ? 1 : 0;\n}\n\nint cell( in ivec2 p )\n{\n    ivec2 r = ivec2(textureSize(iChannel0, 0));\n    p = (p+r) % r;\n    float val = texelFetch(iChannel0, p, 0 ).x;\n    return ( val > 0.) ? 1 : 0;\n}\nvec2 cellval( in ivec2 p )\n{\n    ivec2 r = ivec2(textureSize(iChannel0, 0));\n    p = (p+r) % r;\n    return texelFetch(iChannel0, p, 0 ).xw;\n}\n\n\nfloat hash1( float n )\n{\n    return fract(sin(n)*138.5453123);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    int v1 = 134, v2=98; float density=90.;\n    \n    ivec2 px = ivec2( fragCoord );\n    \n\tint k =   cell(px+ivec2(-1,-1)) + cell(px+ivec2(0,-1)) + cell(px+ivec2(1,-1))\n            + cell(px+ivec2(-1, 0))                        + cell(px+ivec2(1, 0))\n            + cell(px+ivec2(-1, 1)) + cell(px+ivec2(0, 1)) + cell(px+ivec2(1, 1));\n    int e = cell(px);\n    vec2 cvv=cellval(px);\n    int ev = int(cvv.x*10.+0.5);\n    int f = 0;\n    if (e==1) {\n        f = ev - 1;\n        if (stayrules[k]==1) f = k;\n    }\n    else {\n        f = bornrules[k]==1? k : 0;\n    }\n\n    float ff = float(f)/10.;\n\n    if( iFrame==0 || ReadKey(Key_SPACE) || iResolution.x != cvv.y) ff = 2.7;\n    \n    float maxregen = iResolution.x*iResolution.y/(1920.*1080.)*30.;  \n    for (float i=0.; i<maxregen - clamp((iMouse.y/iResolution.y), 0., 1.) * maxregen; i++) {\n        int sz = int(1. + hash1(iTime + i) * 1.5);\n        if (abs(int(hash1(iTime+i)*iResolution.x) - int(fragCoord.x)) < sz && abs(int(hash1(iTime + i + 0.287)*iResolution.y) - int(fragCoord.y)) < sz)\n            ff = -1.;\n    }\n\n\tfragColor = vec4( ff, 0.0, 0.0, iResolution.x);\n}\n\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 1,
                        "ctype": "keyboard",
                        "id": 33,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/presets/tex00.jpg"
                    },
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "nearest",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    }
                ],
                "name": "Buffer A",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 257
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 val = texelFetch( iChannel0, ivec2(fragCoord), 0 ).xxx;\n \n    vec2 screenCenter = 0.5 * iResolution.xy;\n    vec2 uv = (fragCoord - screenCenter) / iResolution.y;\n    vec3 val2 = texture(iChannel1, (fragCoord - screenCenter) * (1.-0.015*iMouse.x/iResolution.x) / iResolution.xy + 0.5).xxx;\n\n    fragColor = vec4( (val*0.5+val2*0.9)/1.4, 1.0 );\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 257,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer00.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buffer B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}