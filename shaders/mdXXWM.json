{
    "Shader": {
        "info": {
            "date": "1668994000",
            "description": "Something I had made sometime ago in MaterialMaker",
            "flags": 64,
            "hasliked": 0,
            "id": "mdXXWM",
            "likes": 36,
            "name": "Soft dip",
            "published": 3,
            "tags": [
                "materialmaker",
                "shadershrinker"
            ],
            "usePreview": 1,
            "username": "PauloFalcao",
            "viewed": 639
        },
        "renderpass": [
            {
                "code": "// Soft dip\n//\n// Generated in Material Maker by PauloFalcao\n//\n// The music is also done by me BTW :)\n//\n// You can now use #MaterialMaker on the browser!!!\n//\n// https://materialmaker.org/public/mm_web/\n//\n// Loading this example https://twitter.com/paulofalcao/status/1597367766507737090\n//\n// // You can find the original Material Maker file here\n// https://www.materialmaker.org/material?id=577\n//\n// A video playing with this on Material Maker\n// https://youtu.be/uBpX1CG28c4\n//\n// Processed by 'GLSL Shader Shrinker' (Shrunk by 18,337 characters)\n// (https://github.com/deanthecoder/GLSLShaderShrinker)\n\n#define v4\tvec4\n#define v3\tvec3\n#define v2\tvec2\n#define RET\treturn\n#define NM\tnormalize\n#define _c\tclamp\n#define _f\tfloat\n#define iT\tiTime\n#define iR\tiResolution\n\nvec3 x3(v3 c) {\n\t_f j = 4096. * sin(dot(c, v3(17, 59.4, 15)));\n\tv3 r;\n\tr.z = fract(512. * j);\n\tj *= .125;\n\tr.x = fract(512. * j);\n\tj *= .125;\n\tr.y = fract(512. * j);\n\tRET r - .5;\n}\n\nfloat Xd(v3 p) {\n\tv3 s = floor(p + dot(p, v3(.3333333))),\n\t   x = p - s + dot(s, v3(.1666667)),\n\t   e = step(v3(0), x - x.yzx),\n\t   H = e * (1. - e.zxy),\n\t   I = 1. - e.zxy * (1. - e),\n\t   X1 = x - H + .1666667,\n\t   X2 = x - I + .33333,\n\t   X3 = x - .5;\n\tv4 w, d;\n\tw.x = dot(x, x);\n\tw.y = dot(X1, X1);\n\tw.z = dot(X2, X2);\n\tw.w = dot(X3, X3);\n\tw = max(.6 - w, 0.);\n\td.x = dot(x3(s), x);\n\td.y = dot(x3(s + H), X1);\n\td.z = dot(x3(s + I), X2);\n\td.w = dot(x3(s + 1.), X3);\n\tw *= w;\n\tw *= w;\n\td *= w;\n\tRET dot(d, v4(52));\n}\n\nfloat g(v3 UV, v3 s) {\n\tv3 q = abs(UV) - s;\n\tRET length(max(q, 0.)) + min(max(q.x, max(q.y, q.z)), 0.);\n}\n\nvec3 rd(v3 p, v3 a) {\n\t_f c = cos(a.x),\n\t   s = sin(a.x);\n\tv3 RV;\n\tRV.x = p.x;\n\tRV.y = p.y * c + p.z * s;\n\tRV.z = -p.y * s + p.z * c;\n\tc = cos(a.y);\n\ts = sin(a.y);\n\tp.x = RV.x * c + RV.z * s;\n\tp.y = RV.y;\n\tp.z = -RV.x * s + RV.z * c;\n\tc = cos(a.z);\n\ts = sin(a.z);\n\tRV.x = p.x * c + p.y * s;\n\tRV.y = -p.x * s + p.y * c;\n\tRV.z = p.z;\n\tRET RV;\n}\n\nvec3 sY(v3 p) {\n\t_f d, x, C,\n\t   s = 6.;\n\ts *= .5;\n\td = length(p.xz);\n\tx = asin(sin(atan(p.x, p.z) * s) * .493) * d;\n\tC = d * s;\n\tRET v3(x / s, p.y, mix(C, 2. * C - sqrt(x * x + C * C), 1.) / s - 1.148);\n}\n\nvec3 P(v3 p, v3 a) {\n\t_f c = cos(a.x),\n\t   s = sin(a.x);\n\tv3 RV;\n\tRV.x = p.x;\n\tRV.y = p.y * c + p.z * s;\n\tRV.z = -p.y * s + p.z * c;\n\tc = cos(a.y);\n\ts = sin(a.y);\n\tp.x = RV.x * c + RV.z * s;\n\tp.y = RV.y;\n\tp.z = -RV.x * s + RV.z * c;\n\tc = cos(a.z);\n\ts = sin(a.z);\n\tRV.x = p.x * c + p.y * s;\n\tRV.y = -p.x * s + p.y * c;\n\tRV.z = p.z;\n\tRET RV;\n}\n\nfloat we(_f x) { RET .5 - .5 * cos(6.28319 * x); }\n\nfloat U(_f x, _f y, _f z) {\n\t_f XY = min(x + y, 2. - x - y);\n\tRET min(XY + z, 2. - XY - z);\n}\n\nfloat S(_f a, _f b, _f k) {\n\t_f h = max(k - abs(a - b), 0.) / k;\n\tRET min(a, b) - h * h * k * .25;\n}\n\nvec4 R(v4 a, v4 b) {\n\t_f h,\n\t   k = 1.;\n\tk = max(k, .001);\n\th = S(a.w, b.w, k);\n\tv2 n = NM(v2(S(a.w + .001, b.w, k) - S(a.w - .001, b.w, k), S(a.w, b.w + .001, k) - S(a.w, b.w - .001, k)));\n\tRET v4(mix(a.xyz, b.xyz, atan(abs(n.y), abs(n.x)) / 1.5708), h);\n}\n\nvec4 Q(v4 J) {\n\tconst v4 K = v4(0, 0, 0, 9999999),\n\t         L = v4(0, 0, 0, 9999999),\n\t         M = v4(0, 0, 0, 9999999);\n\tv4 t = (J.w < K.w) ? v4(J) : v4(K);\n\tt = (t.w < K.w) ? t : v4(K);\n\tt = (t.w < L.w) ? t : v4(L);\n\tRET (t.w < M.w) ? t : v4(M);\n}\n\nfloat t0(v3 v, _f _) {\n\t_f X = 0.,\n\t   ve = 0.,\n\t   se = 1.,\n\t   SE = 1.;\n\tfor (int i = 0; i < 6; i++) {\n\t\tve += Xd(v * SE) * se;\n\t\tX += se;\n\t\tSE *= 2.;\n\t\tse *= .5;\n\t}\n\n\tRET ve / X;\n}\n\nfloat s0(_f f, _f _) { RET f * 15.505 - 7.2525; }\n\nvec3 l0(v4 p, _f _) { RET _c(v3(s0(t0((p).xyz * 4.56 + v3(0), _) * .5 + .5, _)), v3(0), v3(1)); }\n\nfloat m0(v4 p, _f _) { RET 1.; }\n\nfloat q0(v4 p, _f _) { RET 1.; }\n\nfloat o0(v4 p, _f _) { RET 1.; }\n\nvec3 k0(v4 p, _f _) { RET v3(1); }\n\nvec3 n0(v4 p, _f _) { RET v3(0, 1, 0); }\n\nfloat i0(v4 p, _f _) { RET 1.; }\n\nfloat j0(v4 p, _f _) { RET 1.; }\n\nfloat p0(v3 p, _f _) { RET (v2(g(rd(sY(p), -v3(-32, -106, -129) * .01745329), v3(.22, 1.94, .25)) - .06, 0)).x; }\n\nvec4 P5(v4 UV, _f _) {\n\tUV.xyz = P(UV.xyz - v3(0, sin(iT * .5) + 1., 0), v3(iT * .041, iT * .05, iT * .043) * 6.2831853) / .815;\n\t_f sf = p0(UV.xyz, _) * .815;\n\tif (UV.w > 18.5) RET v4(0. * j0(v4(UV.xyz, 19), _), 0, 0, sf);\n\tif (UV.w > 14.5) RET v4(0. * i0(v4(UV.xyz, 15), _), 0, 0, sf);\n\tif (UV.w > 13.5) RET v4(0. * n0(v4(UV.xyz, 14), _), sf);\n\tif (UV.w > 12.5) RET v4(0. * k0(v4(UV.xyz, 13), _), sf);\n\tif (UV.w > 4.5) RET v4(0. * o0(v4(UV.xyz, 5), _), 0, 0, sf);\n\tif (UV.w > 3.5) RET v4(.306 * q0(v4(UV.xyz, 4), _), 0, 0, sf);\n\tif (UV.w > 1.5) RET v4(0. * m0(v4(UV.xyz, 2), _), 0, 0, sf);\n\tif (UV.w > .5) RET v4(v4(1, 0, 0, 1).rgb * l0(v4(UV.xyz, 1), _), sf);\n\tRET v4(v3(0), sf);\n}\n\nfloat om(v3 v, _f _) {\n\t_f X = 0.,\n\t   ve = 0.,\n\t   se = 1.,\n\t   SE = 1.;\n\tfor (int i = 0; i < 6; i++) {\n\t\tve += Xd(v * SE) * se;\n\t\tX += se;\n\t\tSE *= 2.;\n\t\tse *= .5049;\n\t}\n\n\tRET ve / X;\n}\n\nfloat oc(_f f, _f _) { RET f * 2.42737 - .71368; }\n\nfloat OM(v3 v, _f _) {\n\t_f X = 0.,\n\t   ve = 0.,\n\t   se = 1.,\n\t   SE = 1.;\n\tfor (int i = 0; i < 6; i++) {\n\t\tve += Xd(v * SE) * se;\n\t\tX += se;\n\t\tSE *= 2.;\n\t\tse *= 0.;\n\t}\n\n\tRET ve / X;\n}\n\nfloat OC(_f f, _f _) { RET f * 1.927 - .4635; }\n\nvec3 OD(v4 p, _f _) {\n\tv3 g0 = v3(oc(om((p).xyz * 1.36 + v3(0.), _) * .5 + .5, _)),\n\t   h0 = v3(OC(OM((v4((p).xyz + (g0 * .655 - .5), 0)).xyz * v3(.62504, 0, .56013), _) * .5 + .5, _));\n\tRET v3(U(we(.79 * (v4((v4((p).xyz + (g0 * .655 - .5), 0)).xyz + (h0 * .82 - .5), 0)).x), we(0. * (v4((v4((p).xyz + (g0 * .655 - .5), 0)).xyz + (h0 * .82 - .5), 0)).y), we(0. * (v4((v4((p).xyz + (g0 * .655 - .5), 0)).xyz + (h0 * .82 - .5), 0)).z)));\n}\n\nfloat b0(v4 p, _f _) { RET 1.; }\n\nfloat f0(v4 p, _f _) { RET 1.; }\n\nfloat d0(v4 p, _f _) { RET 1.; }\n\nvec3 a0(v4 p, _f _) { RET v3(1); }\n\nvec3 c0(v4 p, _f _) { RET v3(0, 1, 0); }\n\nfloat Z(v4 p, _f _) { RET 1.; }\n\nfloat od(v4 p, _f _) { RET 1.; }\n\nfloat of(v3 p, _f _) { RET g(p, v3(5, .07, 5)) - .08; }\n\nvec3 r0(v4 p, _f _) { RET v3(sin(length((p).xz) * 6.18 - mod(iT * 8., 6.283))); }\n\nfloat B(v3 UV, _f _) { RET of(UV - r0(v4(UV, 0), _) * v3(0, .062, 0), _); }\n\nfloat e0(v3 p, _f _) { RET B(p, _); }\n\nvec4 P9(v4 UV, _f _) {\n\tUV.xyz = P(UV.xyz - v3(0), v3(0));\n\t_f sf = e0(UV.xyz, _);\n\tif (UV.w > 18.5) RET v4(0. * od(v4(UV.xyz, 19), _), 0, 0, sf);\n\tif (UV.w > 14.5) RET v4(0. * Z(v4(UV.xyz, 15), _), 0, 0, sf);\n\tif (UV.w > 13.5) RET v4(0. * c0(v4(UV.xyz, 14), _), sf);\n\tif (UV.w > 12.5) RET v4(0. * a0(v4(UV.xyz, 13), _), sf);\n\tif (UV.w > 4.5) RET v4(0. * d0(v4(UV.xyz, 5), _), 0, 0, sf);\n\tif (UV.w > 3.5) RET v4(.5 * f0(v4(UV.xyz, 4), _), 0, 0, sf);\n\tif (UV.w > 1.5) RET v4(0. * b0(v4(UV.xyz, 2), _), 0, 0, sf);\n\tif (UV.w > .5) RET v4(v4(1).rgb * OD(v4(UV.xyz, 1), _), sf);\n\tRET v4(v3(0), sf);\n}\n\nvec4 Y(v4 p, _f _) { RET Q(R(P5(p, _), P9(p, _))); }\n\nvec3 E(v3 p, _f PO) {\n\tp = p.yzx;\n\tRET pow(texture(iChannel0, p).xyz, v3(2.2)) + pow(texture(iChannel0, p).xxx, v3(16)) * PO;\n}\n\nvec3 W(v3 p, _f _) {\n\tconst v3 e = v3(.001, -.001, 0);\n\t_f V1 = Y(v4(p + e.xyy, 0), _).w,\n\t   V2 = Y(v4(p + e.yyx, 0), _).w,\n\t   V3 = Y(v4(p + e.yxy, 0), _).w,\n\t   V4 = Y(v4(p + e.xxx, 0), _).w;\n\tRET NM(v3(V4 + V1 - V3 - V2, V3 + V4 - V1 - V2, V2 + V4 - V3 - V1));\n}\n\nvoid O(inout float d, inout vec3 p, _f D, v3 RO, v3 RD, _f _) {\n\tfor (int i = 0; i < 500; i++) {\n\t\tp = RO + RD * d;\n\t\tD = Y(v4(p, 0), _).w;\n\t\td += D;\n\t\tif (d > 50. || abs(D) < 1e-4) break;\n\t}\n}\n\nfloat i(v3 ps, v3 V, _f _) {\n\t_f u0 = 0.,\n\t   sa = 1.;\n\tfor (int i = 0; i < 5; i++) {\n\t\t_f h = .001 + .25 * _f(i) / 4.,\n\t\t   d = Y(v4(ps + h * V, 0), _).w;\n\t\tu0 += (h - d) * sa;\n\t\tsa *= .98;\n\t}\n\n\tRET _c(1. - 1.6 * u0, 0., 1.);\n}\n\nfloat m(v3 RO, v3 RD, _f _) {\n\t_f rs = 1.,\n\t   t = .05;\n\tfor (int i = 0; i < 32; i++) {\n\t\t_f h = Y(v4(RO + RD * t, 0), _).w;\n\t\trs = min(rs, 10. * h / t);\n\t\tt += h;\n\t\tif (rs < 1e-4 || t > 5.) break;\n\t}\n\n\tRET _c(rs, 0., 1.);\n}\n\nvec3 r1(v2 UV) {\n\t_f OR, os,\n\t   _ = 0.,\n\t   d = 0.,\n\t   D = 0.;\n\tUV -= .5;\n\tv3 or, N,\n\t   u = v3(0),\n\t   o = v3(sin(iT * .1) * 5., 4.077, cos(iT * .13) * 5.) * 1.153,\n\t   ry = NM(v3(0, .289, 0) - o),\n\t   A = NM(cross(v3(0, 1, 0), ry)),\n\t   RD = NM(ry * 1.5 + A * UV.x + NM(cross(A, ry)) * UV.y),\n\t   RO = o,\n\t   p = v3(0);\n\tO(d, p, D, RO, RD, _);\n\tor = Y(v4(p, 1), _).xyz;\n\tOR = Y(v4(p, 4), _).x * .2;\n\tos = Y(v4(p, 5), _).x;\n\tN = v3(22e-5, 1, 22e-5);\n\tif (d < 50.) {\n\t\tv3 rf, OF,\n\t\t   n = W(p, _);\n\t\t_f l = _c(dot(-N, -n), 0., 1.);\n\t\trf = NM(reflect(RD, -n));\n\t\tu = min(v3(max(mix(1., m(p, N, _), 1.), .07)), max(l, .07)) * max(mix(1., i(p, n, _), 1.), .07) * or + 4. * pow(_c(dot(rf, N), 0., 1.), pow(256., 1. - os)) * OR;\n\t\td = .01;\n\t\tO(d, p, D, p, rf, _);\n\t\tOF = v3(0);\n\t\tif (d < 50.) {\n\t\t\tOF = Y(v4(p, 1), _).xyz;\n\t\t\tn = W(p, _);\n\t\t\tl = _c(dot(-N, -n), 0., 1.);\n\t\t\tOF = max(l, .07) * OF;\n\t\t}\n\t\telse OF = E(rf.xzy, 6.);\n\n\t\tu = mix(u, OF, OR);\n\t}\n\telse u = E(RD.xzy, 0.);\n\n\tRET pow(u, v3(.50942));\n}\n\nvoid mainImage(out vec4 F, v2 G) {\n\t_f T = min(iR.x, iR.y);\n\tF = v4(r1(v2(0, 1) + v2(1, -1) * (G - .5 * (iR.xy - v2(T))) / T), 1);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "cubemap",
                        "id": 22,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "false",
                            "wrap": "clamp"
                        },
                        "src": "/media/a/585f9546c092f53ded45332b343144396c0b2d70d9965f585ebc172080d8aa58.jpg"
                    },
                    {
                        "channel": 1,
                        "ctype": "musicstream",
                        "id": 30555,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/paulofalcao/landscape"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}