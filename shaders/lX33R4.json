{
    "Shader": {
        "info": {
            "date": "1716147475",
            "description": "Does nothing but convert sRGB to Oklab and then back.\nImplementation of https://bottosson.github.io/posts/oklab/.\nsRGB to linear sRGB conversion from https://bottosson.github.io/posts/colorwrong/#what-can-we-do%3F.",
            "flags": 0,
            "hasliked": 0,
            "id": "lX33R4",
            "likes": 0,
            "name": "Oklab sandbox",
            "published": 3,
            "tags": [
                "colorspace",
                "oklab"
            ],
            "usePreview": 0,
            "username": "Kampfhund",
            "viewed": 113
        },
        "renderpass": [
            {
                "code": "float sRGB_channel_to_linear_sRGB(float color_channel)\n{\n    if(color_channel >= 0.04045)\n    {\n        return pow(((color_channel + 0.055) / (1.0 + 0.055)), 2.4);\n    }\n\n    return color_channel / 12.92;\n}\n\nvec4 sRGB_to_linear_sRGB(vec4 color)\n{\n   color.r = sRGB_channel_to_linear_sRGB(color.r);\n   color.g = sRGB_channel_to_linear_sRGB(color.g);\n   color.b = sRGB_channel_to_linear_sRGB(color.b);\n   \n   \n   return color;\n}\n\n\nfloat linear_sRGB_channel_to_sRGB(float color_channel)\n{\n    if(color_channel >= 0.0031308)\n    {\n        return 1.055 * pow(color_channel, 1.0/2.4) - 0.055;\n    }\n\n    return color_channel * 12.92;\n}\n\n\nvec4 linear_sRGB_to_sRGB(vec4 color)\n{\n   color.r = linear_sRGB_channel_to_sRGB(color.r);\n   color.g = linear_sRGB_channel_to_sRGB(color.g);\n   color.b = linear_sRGB_channel_to_sRGB(color.b);\n   \n   \n   return color;\n}\n\n\nvec4 srgb_to_oklab(vec4 color)\n{\n    color = sRGB_to_linear_sRGB(color);\n\n    float l = 0.4122214708 * color.r + 0.5363325363 * color.g + 0.0514459929 * color.b;\n    float m = 0.2119034982 * color.r + 0.6806995451 * color.g + 0.1073969566 * color.b;\n    float s = 0.0883024619 * color.r + 0.2817188376 * color.g + 0.6299787005 * color.b;\n    \n    l = sqrt(l);\n    m = sqrt(m);\n    s = sqrt(s);\n    \n    color.r = 0.2104542553f * l + 0.7936177850f * m - 0.0040720468f * s;\n    color.g = 1.9779984951f * l - 2.4285922050f * m + 0.4505937099f * s;\n    color.b = 0.0259040371f * l + 0.7827717662f * m - 0.8086757660f * s;\n\n\n    return color;\n}\n\n\nvec4 oklab_to_srgb(vec4 color)\n{\n    float l = color.r + 0.3963377774 * color.g + 0.2158037573 * color.b;\n    float m = color.r - 0.1055613458 * color.g - 0.0638541728 * color.b;\n    float s = color.r - 0.0894841775 * color.g - 1.2914855480 * color.b;\n    \n    l = l*l*l;\n    m = m*m*m;\n    s = s*s*s;\n    \n    color.r = 4.0767416621f * l - 3.3077115913f * m + 0.2309699292f * s;\n    color.g = -1.2684380046f * l + 2.6097574011f * m - 0.3413193965f * s;\n    color.b = -0.0041960863f * l - 0.7034186147f * m + 1.7076147010f * s;\n    \n    color = linear_sRGB_to_sRGB(color);\n    \n    return color;\n}\n\n\n\n\n\n\n\n\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n\n    vec4 color = texture(iChannel0, uv); \n\n    color = srgb_to_oklab(color);\n    \n    //Alter values of oklab below this point.\n    \n    \n    \n    \n \n    fragColor = oklab_to_srgb(color);\n}\n\n\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 8,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/52d2a8f514c4fd2d9866587f4d7b2a5bfa1a11a0e772077d7682deb8b3b517e5.jpg"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}