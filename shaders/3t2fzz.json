{
    "Shader": {
        "info": {
            "date": "1598228292",
            "description": "Allows single function definitions accepting vec2, vec3, vec4, (and float if needed).",
            "flags": 0,
            "hasliked": 0,
            "id": "3t2fzz",
            "likes": 8,
            "name": "float/vec2/vec3/vec4 generics",
            "published": 3,
            "tags": [
                "glsl",
                "macro",
                "generics"
            ],
            "usePreview": 0,
            "username": "ttg",
            "viewed": 1213
        },
        "renderpass": [
            {
                "code": "/*\n\nUser-defined GLSL generics\nCreated by Theron Tarigo, 2020\nhttps://www.shadertoy.com/view/3t2fzz\n\nAllows single function definitions accepting vec2, vec3, vec4, (and float if needed).\n\n\n*/\n                                                                                                                                                                                                                                                                #define XXX /*\n\n\n    SEE COMMON TAB\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n*/\n\n////// BEGIN text encoding https://www.shadertoy.com/view/Wd2SDt\nconst struct CCDS_T {\n  uint\n    skipstart, rewind, reverse, record, stop, play, pause, fastforward, skipend, note4, note8, noteb16, notebb16, _flat, natural, sharp,\n    leftarrow, uparrow, rightarrow, downarrow, leftright, updown, upleft, upright, downright, downleft, ccw, cw, star, smiley, mute, loud,\n    _,   em,  dq,  ha,  ds,  mo,  am,  sq,  lp,  rp,  as,  pl,  cm,  hm,  pe,  sl,\n    _0,  _1,  _2,  _3,  _4,  _5,  _6,  _7,  _8,  _9,  co,  sc,  lt,  eq,  gt,  qm,\n    at,   A,   B,   C,   D,   E,   F,   G,   H,   I,   J,   K,   L,   M,   N,   O,\n     P,   Q,   R,   S,   T,   U,   V,   W,   X,   Y,   Z,  lb,  bs,  rb,  up,  un,\n    bt,   a,   b,   c,   d,   e,   f,   g,   h,   i,   j,   k,   l,   m,   n,   o,\n     p,   q,   r,   s,   t,   u,   v,   w,   x,   y,   z,  lc,  ba,  rc,  ti, _U0,\n   alp, bet, gam, del, eps, the, lam,  mu,  xi,  pi, rho, sig, tau, phi, psi, ome,\n   Gam, Del, The, Lam,  Pi, Sig, Phi, Psi, Ome, inf,flor,ring,intg,pdrv, nab,sqrt,\n   _U1, iem, cen, pou, cur, yen, bba, sec, dia, cop, fem, lda, not, _U2, reg, mac,\n   deg, pms, su2, su3, acu, mic, pil, mid, ced, su1, mas, rda, v14, v12, v34, iqm,\n    AG,  AA,  AC,  AT,  AD,  AR,  AE,  CC,  EG,  EA,  EC,  ED,  IG,  IA,  IC,  ID,\n   Eth,  NT,  OG,  OA,  OC,  OT,  OD, mul,  OS,  UG,  UA,  UC,  UD,  YA, Tho, Sha,\n    aG,  aA,  aC,  aT,  aD,  aR,  ae,  cC,  eG,  eA,  eC,  eD,  iG,  iA,  iC,  iD,\n   eth,  nT,  oG,  oA,  oC,  oT,  oD, div,  oS,  uG,  uA,  uC,  uD,  yA, yho,  yD,  \n  _nul;\n} CCDS = CCDS_T(\n  0x00u,0x01u,0x02u,0x03u,0x04u,0x05u,0x06u,0x07u,0x08u,0x09u,0x0au,0x0bu,0x0cu,0x0du,0x0eu,0x0fu,\n  0x10u,0x11u,0x12u,0x13u,0x14u,0x15u,0x16u,0x17u,0x18u,0x19u,0x1au,0x1bu,0x1cu,0x1du,0x1eu,0x1fu,\n  0x20u,0x21u,0x22u,0x23u,0x24u,0x25u,0x26u,0x27u,0x28u,0x29u,0x2au,0x2bu,0x2cu,0x2du,0x2eu,0x2fu,\n  0x30u,0x31u,0x32u,0x33u,0x34u,0x35u,0x36u,0x37u,0x38u,0x39u,0x3au,0x3bu,0x3cu,0x3du,0x3eu,0x3fu,\n  0x40u,0x41u,0x42u,0x43u,0x44u,0x45u,0x46u,0x47u,0x48u,0x49u,0x4au,0x4bu,0x4cu,0x4du,0x4eu,0x4fu,\n  0x50u,0x51u,0x52u,0x53u,0x54u,0x55u,0x56u,0x57u,0x58u,0x59u,0x5au,0x5bu,0x5cu,0x5du,0x5eu,0x5fu,\n  0x60u,0x61u,0x62u,0x63u,0x64u,0x65u,0x66u,0x67u,0x68u,0x69u,0x6au,0x6bu,0x6cu,0x6du,0x6eu,0x6fu,\n  0x70u,0x71u,0x72u,0x73u,0x74u,0x75u,0x76u,0x77u,0x78u,0x79u,0x7au,0x7bu,0x7cu,0x7du,0x7eu,0x7fu,\n  0x80u,0x81u,0x82u,0x83u,0x84u,0x85u,0x86u,0x87u,0x88u,0x89u,0x8au,0x8bu,0x8cu,0x8du,0x8eu,0x8fu,\n  0x90u,0x91u,0x92u,0x93u,0x94u,0x95u,0x96u,0x97u,0x98u,0x99u,0x9au,0x9bu,0x9cu,0x9du,0x9eu,0x9fu,\n  0xa0u,0xa1u,0xa2u,0xa3u,0xa4u,0xa5u,0xa6u,0xa7u,0xa8u,0xa9u,0xaau,0xabu,0xacu,0xadu,0xaeu,0xafu,\n  0xb0u,0xb1u,0xb2u,0xb3u,0xb4u,0xb5u,0xb6u,0xb7u,0xb8u,0xb9u,0xbau,0xbbu,0xbcu,0xbdu,0xbeu,0xbfu,\n  0xc0u,0xc1u,0xc2u,0xc3u,0xc4u,0xc5u,0xc6u,0xc7u,0xc8u,0xc9u,0xcau,0xcbu,0xccu,0xcdu,0xceu,0xcfu,\n  0xd0u,0xd1u,0xd2u,0xd3u,0xd4u,0xd5u,0xd6u,0xd7u,0xd8u,0xd9u,0xdau,0xdbu,0xdcu,0xddu,0xdeu,0xdfu,\n  0xe0u,0xe1u,0xe2u,0xe3u,0xe4u,0xe5u,0xe6u,0xe7u,0xe8u,0xe9u,0xeau,0xebu,0xecu,0xedu,0xeeu,0xefu,\n  0xf0u,0xf1u,0xf2u,0xf3u,0xf4u,0xf5u,0xf6u,0xf7u,0xf8u,0xf9u,0xfau,0xfbu,0xfcu,0xfdu,0xfeu,0xffu,\n0x7fu);\n\n#define U4CHAR4(a,b,c,d) ((CCDS.a)+(CCDS.b<<8)+(CCDS.c<<16)+(CCDS.d<<24))\n\n#define STRING16(n,\\\n  a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af)\\\n    uint[](uint(n), \\\n      U4CHAR4(a0,a1,a2,a3),U4CHAR4(a4,a5,a6,a7),U4CHAR4(a8,a9,aa,ab),U4CHAR4(ac,ad,ae,af) )\n\n#define STRING32(n,\\\n  a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,\\\n  b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf)\\\n    uint[](uint(n), \\\n      U4CHAR4(a0,a1,a2,a3),U4CHAR4(a4,a5,a6,a7),U4CHAR4(a8,a9,aa,ab),U4CHAR4(ac,ad,ae,af),\\\n      U4CHAR4(b0,b1,b2,b3),U4CHAR4(b4,b5,b6,b7),U4CHAR4(b8,b9,ba,bb),U4CHAR4(bc,bd,be,bf) )\n\n#define STRING64(n,\\\n  a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,\\\n  b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,\\\n  c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,\\\n  d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df)\\\n    uint[](uint(n), \\\n      U4CHAR4(a0,a1,a2,a3),U4CHAR4(a4,a5,a6,a7),U4CHAR4(a8,a9,aa,ab),U4CHAR4(ac,ad,ae,af),\\\n      U4CHAR4(b0,b1,b2,b3),U4CHAR4(b4,b5,b6,b7),U4CHAR4(b8,b9,ba,bb),U4CHAR4(bc,bd,be,bf),\\\n      U4CHAR4(c0,c1,c2,c3),U4CHAR4(c4,c5,c6,c7),U4CHAR4(c8,c9,ca,cb),U4CHAR4(cc,cd,ce,cf),\\\n      U4CHAR4(d0,d1,d2,d3),U4CHAR4(d4,d5,d6,d7),U4CHAR4(d8,d9,da,db),U4CHAR4(dc,dd,de,df))\n\n#define STRING80(n,\\\n  a0,a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,\\\n  b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,ba,bb,bc,bd,be,bf,\\\n  c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,ca,cb,cc,cd,ce,cf,\\\n  d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,da,db,dc,dd,de,df,\\\n  e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,ea,eb,ec,ed,ee,ef)\\\n    uint[](uint(n), \\\n      U4CHAR4(a0,a1,a2,a3),U4CHAR4(a4,a5,a6,a7),U4CHAR4(a8,a9,aa,ab),U4CHAR4(ac,ad,ae,af),\\\n      U4CHAR4(b0,b1,b2,b3),U4CHAR4(b4,b5,b6,b7),U4CHAR4(b8,b9,ba,bb),U4CHAR4(bc,bd,be,bf),\\\n      U4CHAR4(c0,c1,c2,c3),U4CHAR4(c4,c5,c6,c7),U4CHAR4(c8,c9,ca,cb),U4CHAR4(cc,cd,ce,cf),\\\n      U4CHAR4(d0,d1,d2,d3),U4CHAR4(d4,d5,d6,d7),U4CHAR4(d8,d9,da,db),U4CHAR4(dc,dd,de,df),\\\n      U4CHAR4(e0,e1,e2,e3),U4CHAR4(e4,e5,e6,e7),U4CHAR4(e8,e9,ea,eb),U4CHAR4(ec,ed,ee,ef))\n\n#define DEF_DRAW_STRING(N) \\\nfloat draw_string (sampler2D sampler,                    \\\n                   in vec2 uv, const uint[1+N] string) { \\\n  int i = int(uv.x);                                     \\\n  int strlen = min(int(string[0]),N*4);                  \\\n  if (uv.x<0.||i>=strlen) return 0.;                     \\\n  int code = int( (string[i/4+1]>>((i%4)*8)) &0xFFu);    \\\n  if (uv.y<0.||uv.y>1.) return 0.;                       \\\n  uv.x=fract(uv.x)/2.+.25; uv.y=1.-uv.y;                 \\\n  uv+=vec2(code%16,15-code/16);                          \\\n  return texture(sampler, uv/16.).r;                   }\nDEF_DRAW_STRING(8)\nDEF_DRAW_STRING(16)\nDEF_DRAW_STRING(20)\n////// END text encoding\n\n/*\nDefine new generics, example:\n  T project(T a, T b) {     ...\n  float lensq(T x)          ...\nT  -> float, vec2,  vec3,  vec4\nTI ->  int, ivec2, ivec3, ivec4\nTU -> uint, uvec2, uvec3, uvec4\nTB -> bool, bvec2, bvec3, bvec4\n*/\n\nconst uint[] line1 = STRING32(32, D,e,f,i,n,e,_,n,e,w,_,g,e,n,e,r,i,c,s,cm,_,e,x,a,m,p,l,e,co,_,_,_);\nconst uint[] line2 = STRING32(32, _,_,T,_,p,r,o,j,e,c,t,lp,T,_,a,cm,_,T,_,b,rp,_,lc,_,_,_,_,_,pe,pe,pe,_);\nconst uint[] line3 = STRING32(32, _,_,f,l,o,a,t,_,l,e,n,s,q,lp,T,_,x,rp,_,lc,_,_,_,_,_,_,_,_,pe,pe,pe,_);\nconst uint[] line4 = STRING32(32, T,_,_,rightarrow,_,f,l,o,a,t,cm,_,v,e,c,_2,cm,_,_,v,e,c,_3,cm,_,_,v,e,c,_4,_,_);\nconst uint[] line5 = STRING32(32, T,I,_,rightarrow,_,_,i,n,t,cm,_,i,v,e,c,_2,cm,_,i,v,e,c,_3,cm,_,i,v,e,c,_4,_,_);\nconst uint[] line6 = STRING32(32, T,U,_,rightarrow,_,u,i,n,t,cm,_,u,v,e,c,_2,cm,_,u,v,e,c,_3,cm,_,u,v,e,c,_4,_,_);\nconst uint[] line7 = STRING32(32, T,B,_,rightarrow,_,b,o,o,l,cm,_,b,v,e,c,_2,cm,_,b,v,e,c,_3,cm,_,b,v,e,c,_4,_,_);\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    uv.y=1.-uv.y; // Left-handed coordinate system is most natural for Latin text layout\n    fragColor = vec4(vec3(0.),1.0);\n    vec2 grid = vec2(34,10);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,1.0), line1);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,2.5), line2);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,4.0), line3);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,5.5), line4);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,6.5), line5);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,7.5), line6);\n    fragColor+=draw_string(iChannel0,uv*grid-vec2(1,8.5), line7);\n\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "texture",
                        "id": 49,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "\n// Beginning of example usage of generics\n\n#define GENFUNS      \\\n                     \\\nfloat lensq(T x)   { \\\n  return dot(x,x);   \\\n}                    \\\n                     \\\nT square(T x) {      \\\n  return x*x;        \\\n}                    \\\n// end of GENFUNS\n\n#define GENVECFUNS            \\\n                              \\\nT project(T a, T b) {         \\\n  return dot(a,b)/dot(b,b)*b; \\\n}                             \\\n// end of GENVECFUNS\n\n// End of generics example usage\n    \n\n// User-defined GLSL generics example by ttg\n// https://www.shadertoy.com/view/3t2fzz\n#undef T\n#undef TI\n#undef TU\n#undef TB\n#define T float\n#define TI  int\n#define TU uint\n#define TB bool\nGENFUNS\n#undef T\n#undef TI\n#undef TU\n#undef TB\n#define T   vec2\n#define TI ivec2\n#define TU uvec2\n#define TB bvec2\nGENFUNS\nGENVECFUNS\n#undef T\n#undef TI\n#undef TU\n#undef TB\n#define T   vec3\n#define TI ivec3\n#define TU uvec3\n#define TB bvec3\nGENFUNS\nGENVECFUNS\n#undef T\n#undef TI\n#undef TU\n#undef TB\n#define T   vec4\n#define TI ivec4\n#define TU uvec4\n#define TB bvec4\nGENFUNS\nGENVECFUNS\n#undef T\n#undef TI\n#undef TU\n#undef TB\n",
                "description": "",
                "inputs": [],
                "name": "Common",
                "outputs": [],
                "type": "common"
            }
        ],
        "ver": "0.1"
    }
}