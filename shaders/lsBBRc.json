{
    "Shader": {
        "info": {
            "date": "1501429392",
            "description": "Screening whole population for health issue is not always a good idea:\nfalse positives are hugely more than true positives;\n treatment (surgery, invasive screenings) have some casualties... that can overcome the risk population.\n-> mouse  to play numbers",
            "flags": 0,
            "hasliked": 0,
            "id": "lsBBRc",
            "likes": 6,
            "name": "[SH17C] screening or not ?",
            "published": 3,
            "tags": [
                "stats",
                "health",
                "proba"
            ],
            "usePreview": 0,
            "username": "FabriceNeyret2",
            "viewed": 802
        },
        "renderpass": [
            {
                "code": "float p1 = .01, // percentage of population really having the risk\n      p2 = .05, // rate of false negatives ( risk erroneously not detected )\n      p3 = .05, // rate of false positives ( risk erroneously detected )\n      p4 = .05; // percentage of treatment(surgery, deep sceening...) causing casualties\n\n\n// --- lines #define S(v) smoothstep( 0., 1., v )\n\nfloat line( vec2 p, vec2 a, vec2 b, float r) { // draw line a-b width e\n    p -= a; b -= a;\n    float d = length( p - b * clamp(dot(p,b)/dot(b,b), 0., 1. ));\n    return   smoothstep( 1., 0., d/r );\n}\n\nbool inRec( vec2 p, vec2 a, vec2 b) {\n    p = abs( p - (a+b)/2. ) / ( (b-a)/2. );\n    return max(p.x,p.y) < 1.;\n}\n\n// --- fonts\nvec4 char(vec2 p, int c) {  // access to the image of ascii code c. https://www.shadertoy.com/view/llySRh\n    if (p.x<.0|| p.x>1. || p.y<0.|| p.y>1.) return vec4(0,0,0,1e5);\n\treturn textureGrad( iChannel2, p/16. + fract( vec2(c, 15-c/16) / 16. ), \n                        dFdx(p/16.),dFdy(p/16.) );\n}\n// --- display int with N digits\nvec4 pInt(vec2 p, float n, float N) {\n    vec4 v = vec4(0);\n    if (n < 0.) \n        v += char(p - vec2(-.5,0), 45 ),\n        n = -n;\n\n    for (float i = N-1.; i>=0.; i--) \n        n /=  9.999999, // 10., // for windows :-(\n        v += char(p - .5*vec2(i,0), 48+ int(fract(n)*10.) );\n    return v;\n}\n\n// --- chars\nint CAPS=0;\n#define low CAPS=32\n#define caps CAPS=0\n#define spc V.x -= .5\n#define C(c) spc; O-= char(V,64+CAPS+c).x\n#define N(c) spc; O-= char(V,48+c).x\n#define percent(v) spc; spc; O -= pInt(V, 100.*(v)+.5, 2.).x; spc; N(-11);\n#define tot(v)     spc; spc; O -= pInt(V, v+.5, 6.).x;\n#define EQ    spc; N(13);\n#define TIMES spc; N(-6);\n#define PLUS  spc; N(-5);\n#define MINUS spc; N(-3);\n#define LEFT  spc; N(-8);\n#define RIGHT spc; N(-7);\n\nvoid mainImage( out vec4 O, vec2 U )\n{\n    vec2 R = iResolution.xy, V, r = R/R.y, r2 = r/vec2(640./360.,1);\n\tU /= R;\n    O -= O;\n    \n    if (length(iMouse.xy)>0.) p1 = iMouse.x/R.x, p2 = p3 = iMouse.y/R.y;\n    \n    // --- color chart\n    O = U.x < p1 ? U.y < p2 ? vec4(.8,.8,1,1) : vec4(1,(1.-U.y)/(1.-p2) < p4 ? 0. :.6,1,1)\n                 : U.y < p3 ? vec4(1,(1.-U.x)/(1.-p1) < p4 ? 0. :.8,.8,1) : vec4(.8,1,.8,0);\n\n    // --- labels and numbers\n    \n    // total pop:\n    V = ( U - vec2(.3,.8) ) * 20.*r/r2; caps;C(20);low;C(15);C(20);C(1);C(12); spc; C(16);C(15);C(16); N(10);\n    spc*10.; N(1);N(0);N(0);N(-11); EQ; spc; N(1);spc*-1.;tot(1e6);\n    \n    // real risk:\n    O -= line(  U, vec2(.31,.72), vec2(.5*p1,.72), 2./R.y );\n    V = ( U - vec2(.3,.7) ) * 20.*r/r2; caps;C(18);low;C(5);C(1);C(12); spc; C(18);C(9);C(19);C(11); N(10);\n    spc*11.; percent(p1); spc; N(13); tot(1e6*p1);\n    \n    // \"screening:\"\n    V = ( U - vec2(.2,.6) ) * 16.*r/r2; caps;C(19);low;C(3);C(18);C(5);C(5);C(14);C(9);C(14);C(7);N(10);\n\n    // true positive:\n    O -= line(  U, vec2(.31,.57), vec2(.25,.57), 2./R.y );\n    O -= line(  U, vec2(.25,.57), vec2(.5*p1,.45), 2./R.y );\n    V = ( U - vec2(.3,.55)) * 20.*r/r2; caps;C(20);low;C(18);C(21);C(5); spc; C(16);C(15);C(19);C(9);C(20);C(9);C(22);C(5);N(10);\n    spc; percent(1.-p2); TIMES percent(p1); EQ tot(1e6*p1*(1.-p2));\n\n    // false positive:\n    O -=  line(  U, vec2(.28,.52), vec2(.28,.5*p2), 2./R.y )\n        + line(  U, vec2(.28,.52), vec2(.31,.52), 2./R.y );\n    V = ( U - vec2(.3,.5) ) * 20.*r/r2; caps;C(6);low;C(1);C(12);C(19);C(5); spc; C(16);C(15);C(19);C(9);C(20);C(9);C(22);C(5);N(10);\n    percent(p3); TIMES percent(1.-p1);  EQ tot(1e6*(1.-p1)*p3);\n    //spc*6.; EQ TIMES spc*2.; O-= pInt(V, (1.-p1)*p3 / ( p1*(1.-p2) ) +.5, 2.).x; \n    \n    // false negative:\n    O -= line(  U, vec2(.31,.47), vec2(.5*p1,.5*p2), 2./R.y );\n    V = ( U - vec2(.3,.45)) * 20.*r/r2; caps;C(6);low;C(1);C(12);C(19);C(5); spc; C(14);C(5);C(7);C(1);C(20);C(9);C(22);C(5);N(10);\n    percent(p2); TIMES percent(p1);  EQ tot(1e6*p1*p2);\n    \n    // Treatment casualties:\n    O -= line( U, vec2(.85,.3), vec2(1.-p4*.5,p3*.5), 2./R.y );\n    O -= line( U, vec2(.78,.35), vec2(.97,1.-p4*.5), 2./R.y );\n    O -= line( U, vec2(.97,1.-p4*.5), vec2(p1*.5,1.-p4*.5), 2./R.y );\n    V = ( U - vec2(.3,.3)) * 20.*r/r2; caps;C(20);low;C(18);C(5);C(1);C(20);C(13);C(5);C(14);C(20); spc; C(3);C(1);C(19);C(21);C(1);C(12);C(20);C(9);C(5);C(19); N(10);\n    percent(p4); TIMES LEFT percent(p1*(1.-p2)) PLUS percent((1.-p1)*p3) RIGHT\n    V = ( U - vec2(.64,.25)) * 20.*r/r2;\n    spc; EQ; tot(1e6*(p1*(1.-p2)+(1.-p1)*p3));\n    \n    if (inRec(U, vec2(.71,.49), vec2(.81,.61)))  O.r/=.8;\n    if (inRec(U, vec2(.71,.69), vec2(.81,.76)))  O.r/=.8, O.gb*=.8;\n    if (inRec(U, vec2(.71,.24), vec2(.81,.3)))   O.r/=.8, O.gb*=.8;\n}\n\t",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "texture",
                        "id": 49,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}