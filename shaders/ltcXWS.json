{
    "Shader": {
        "info": {
            "date": "1481377138",
            "description": "Based on [url]http://js1k.com/2013-spring/demo/1431[/url].",
            "flags": 32,
            "hasliked": 0,
            "id": "ltcXWS",
            "likes": 3,
            "name": "Rotating fractal motion blur",
            "published": 3,
            "tags": [
                "procedural",
                "2d",
                "fractal",
                "port",
                "feedback",
                "js1k"
            ],
            "usePreview": 0,
            "username": "piotrekli",
            "viewed": 753
        },
        "renderpass": [
            {
                "code": "vec4 sample_(vec2 fragCoord, sampler2D channel)\n{\n    return texture(channel, fragCoord/iResolution.xy);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec3 col = sample_(fragCoord, iChannel0).xyz;\n    vec3 edgeT = (col.xyz-sample_(fragCoord+vec2(0, 0), iChannel1).xyz);\n    edgeT = 1.0-(1.0-edgeT)*length(edgeT);\n    //col = 0.75-col;\n\tfragColor.xyz = col+edgeT*0.5*col;\n    fragColor.xyz = fragColor.xyz*fragColor.yzx-fragColor.zxy*0.1;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    },
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            },
            {
                "code": "const float change = 0.2;\n\nvec4 over(vec4 orig, vec4 overlay)\n{\n\tvec4 new = vec4(0.0);\n    new.w = mix(orig.w, 1.0, overlay.w);\n    if (new.w == 0.0) return vec4(0.0);\n    new.xyz = mix(orig.xyz*orig.w, overlay.xyz, overlay.w)/new.w;\n    return new;\n}\n\nmat2 rotation(float angle)\n{\n    float cosine = cos(angle);\n    float sine = sin(angle);\n    return mat2(cosine, -sine, sine, cosine);\n}\n\nfloat s(float angle)\n{\n    return sin(angle)*0.5+0.5;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    if (iFrame < 10)\n    {\n        fragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        return;\n    }\n    vec2 uv = fragCoord.xy / iResolution.xy;\n    vec2 rotCentre = vec2(0.5);\n    float t = 0.0008*float(iFrame);\n    uv -= rotCentre;\n    uv *= rotation(-7.0*(cos(t*0.99)));\n    uv += rotCentre;\n    vec4 col = vec4(0.0);\n    vec2 w = vec2(0.6)+0.22*vec2(cos(t*4.0), sin(t*2.5));\n    vec2 grid = mod(uv, w*2.0)/w;\n    bool tile = (grid.x > 1.0) != (grid.y > 1.0);\n    col = over(col, texture(iChannel0, fract(grid)));\n    vec4 fillStyle = tile ? vec4(s(t*3.0+grid.x), s(t*5.0+grid.y), s((t-grid.x*grid.y)*7.0), change) :\n    \t\t\t\t\t\tvec4(0.0, 0.0, 0.0, change);\n    col = over(col, fillStyle);\n    fragColor = over(texture(iChannel0, fragCoord/iResolution.xy), col).yzxw;\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    }
                ],
                "name": "Buf B",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 258
                    }
                ],
                "type": "buffer"
            },
            {
                "code": "void mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    fragColor = mix(texture(iChannel1, uv), texture(iChannel0, uv), 0.04);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "buffer",
                        "id": 258,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer01.png"
                    },
                    {
                        "channel": 1,
                        "ctype": "buffer",
                        "id": 259,
                        "published": 1,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "/media/previz/buffer02.png"
                    }
                ],
                "name": "Buf C",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 259
                    }
                ],
                "type": "buffer"
            }
        ],
        "ver": "0.1"
    }
}