{
    "Shader": {
        "info": {
            "date": "1622657102",
            "description": "potate",
            "flags": 0,
            "hasliked": 0,
            "id": "stsGRl",
            "likes": 17,
            "name": "Day 531",
            "published": 3,
            "tags": [
                "mdtmjvm"
            ],
            "usePreview": 0,
            "username": "jeyko",
            "viewed": 460
        },
        "renderpass": [
            {
                "code": "#define pmod(p,a) mod(p,a) - 0.5*a\n#define rot(a) mat2(cos(a),-sin(a),sin(a),cos(a))\n#define pi acos(-1.)\n#define iTime (iTime + 24.)\n// from inigo quilez\nvec3 triIntersect( in vec3 ro, in vec3 rd, in vec3 v0, in vec3 v1, in vec3 v2 )\n{\n    vec3 v1v0 = v1 - v0;\n    vec3 v2v0 = v2 - v0;\n    vec3 rov0 = ro - v0;\n    vec3  n = cross( v1v0, v2v0 );\n    vec3  q = cross( rov0, rd );\n    float d = 1.0/dot( rd, n );\n    float u = d*dot( -q, v2v0 );\n    float v = d*dot(  q, v1v0 );\n    float t = d*dot( -n, rov0 );\n    if( u<0.0 || u>1.0 || v<0.0 || (u+v)>1.0 ) t = -1.0;\n    return vec3( t, u, v );\n}\n\nvec4 n14(float f){ return texture(iChannel0,vec2(mod(floor(f),256.),floor(f/256.))/256.); }\n\n\nfloat eass(float p, float g) {\n    float s = p*0.45;\n    for(float i = 0.; i < g; i++){\n    \ts = smoothstep(0.,1.,s);\n    }\n    return s;\n}\n\nfloat text(vec2 p, float[8] chars, float spacing, float s, bool isAbs, float absWidth, float opacity, bool scrobble) {\n\tp *= s;  \n    \n    p.x *= 1. - spacing;\n    vec2 id = floor(p*8.*2.);\n    p = mod(p,1./16.);\n    p.x = p.x/(1. - spacing) + 1./16./8.;\n    float char = chars[int(id.x)];\n    //char += 112. ;\n    if(scrobble)\n        char += floor(15. * n14(id.x + (iTime + sin(id.x))*24.).y*pow(abs(sin(iTime + id.x*0.2)),14.) ) ;\n    \n    if(scrobble)\n        char += 0.*floor(15. * n14(id.x + (iTime + sin(id.x))*24.).y * (2. - 1.)* (1. - eass((iTime - + id.x*1./16. - 3.)*1.,3.)) ) ;\n    \n    float t;\n    if(abs(id.y) < 1. && id.x >= 0. && id.x < 8.  && char < 200.){\n        vec4 letter = texture(iChannel3,p + vec2(mod(char,16.),-floor(char/16.) )/16.);\n        t = letter.w - opacity;\n        if(abs(p.x-1./16./2.)>1./16./2.)\n            t = 10e4;\n    \n        t /= s*10.1;\n    } else {\n        t = 10e5;\n    \n\t }\n    if (isAbs)\n        t = abs(t) - absWidth;\n    return t;\n}\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = (fragCoord - 0.5*iResolution.xy)/iResolution.y;\n\n    vec3 col = vec3(1.);\n    col.x -= 0.1;\n    //col.xz -= sin(abs(dot(uv,uv))*1.)*0.1;\n    \n    float envb = sin(floor(iTime/2.));\n            \n    bool hit = false;\n    {\n        vec3 ro = vec3(0.4,0,-1.);\n        vec3 rd = normalize(vec3(uv + sin(envb*20.)*0.4,0.5));\n        vec3 rol = ro;\n        for(float i = 0.; i < 150.*(0.5 + 0.3*sin(envb*27.)); i++){\n            \n            float env = iTime + sin(iTime + i/40. + envb*20.);\n            \n            \n            \n            \n            vec3 rol = ro + vec3(sin(i*20.),cos(i),sin(i*20.))*0.2;\n            vec3 lrd = rd;\n            ro += 0.1*sin(i*0.4 + env);\n            lrd.yx *= rot(i*1.3 + env*0.1*sign(sin(envb*20.)));\n            lrd.xz *= rot(envb*.5);\n            vec3 a = vec3(0.,0.,-0.2);\n            vec3 b = vec3(0.2,-0.2,0);\n            vec3 c = vec3(0.1,0.2,0.);\n            //b *= 1. + sin(i);\n            //b *= 1. + sin(i);\n            a *= 1. + sin(i);\n            b *= 1. + sin(i + env*0.5);\n            b *= 1. + sin(i + env*0.3);\n            \n            vec3 tri = triIntersect( rol + vec3(0.+sin(i*20. + env)*0.1,0,0), lrd, a, b, c );\n        \n            if(tri.x >0.){\n                hit = true;\n                //col -= 0. + ;\n                col = mix(col,1.*pow(abs(envb),0.1)-col*0.5*sin(vec3(2,3.5,4) + i + tri.x*3. + env),1.);\n            }\n        }\n    }\n    \n    {\n        vec2 p = uv;\n        p = pmod(p,0.02);\n        float d = abs(p.x);\n        d = min(d,abs(p.y));\n        d -= 0.00;\n        \n        for(float j = 0.; j < 18.; j++){\n            vec2 luv = uv + vec2(sin(j*20.)*1.5,sin(j*20.)*1.5);\n            for(float i = 0.; i < 7. + sin(j)*9.; i++){\n                p = luv;\n                if(sin(i) < -0.9){\n                    p *= rot(0.5*pi);\n                }\n                p.x -= 0.4 + sin(i*11. + envb*120. )*0.1;\n                float ld = abs(p.x) - 0.005 + sin(i)*0.03;\n                float env = sin(i*1.1 + j*1.1 + envb);\n            \n                ld = max(ld,p.y + sin(i*20. + env));\n                //ld = abs(ld) - 0.001;\n                d = max(d,-ld + 0.1);\n\n            }\n        }\n        float od = d;\n        d = 10e5;\n        #define xor(a,b) min(max(a,-(b) + 0.5*sin(i)),max(b,-(a)))\n        \n        for(float j = 0.; j < 18.; j++){\n            vec2 luv = uv + vec2(sin(j*20.)*1.5,sin(j*20.)*1.5);\n            for(float i = 0.; i < 7. + sin(j)*9.; i++){\n                p = luv;\n                if(sin(i) < -0.9){\n                    p *= rot(0.5*pi);\n                }\n                p.x -= 0.4 + sin(i*11.+ envb*120. )*0.1;\n                \n                float s =  - 0.005 + sin(i)*0.2;\n                float ld = abs(p.x) + s;\n                float env = iTime + sin(iTime + i*0.1 + j*0.1);\n            \n                ld = max(ld,p.y + sin(i*20. + env*0.1 + envb*12.));\n                ld = max(abs(ld) - 0.001,-abs(p.x) - s);\n                d = xor(d,ld);\n\n            }\n        }\n            \n        d = min(d,od);\n        \n        \n        col = mix(col,vec3(1.,1. ,1.) - col*0.2 - 0.1,smoothstep(fwidth(uv.y),0.,d)*0.6);\n        \n        \n        \n    }\n    \n    {\n                float t = 10e5;\n            \n            for(float i = 0.; i < 14.; i++){\n                float m = sin(iTime*0.4 + sin(iTime)+i);\n                t = min(t,text(uv + vec2(0. + sin(envb + i),sin(i+ m)*0.1), float[8](135.,130.,121.,119.,120.,132.,117.,130.), 0.04 +m*0.5 , 0.5 , true, 0.004, 0.3 + 0.1*sin(iTime+i*0.4), false));\n                \n                \n            }\n            {\n                float m = sin(iTime*0.4 + sin(iTime));\n                vec2 p = uv + vec2(0.7,-0.2);\n                p *= rot(0.5*pi);\n                p.x += (iTime + sin(iTime))*0.3;\n                p.x = pmod(p.x,2.);\n                //t = min(t,text(p, float[8](128.,127.,132.,113.,132.,117.,1117.,1130.), 0.01 +m*0.4 , 0.4 , true, 0.0001, 0.4 + 0.*sin(iTime*0.3 + 0.4), true));\n            }   \n             \n            \n            col = mix(col,vec3(1.,1. ,1.) - col*0.2 - 0.1,smoothstep(fwidth(uv.y) + 0.04,0., t)*0.5);\n    }\n    \n    {\n        vec2 p = uv;\n        if( (abs(p.y) > 0.47 || abs(p.x) > 0.85)){\n            col = 1. - col*0.4;\n        }\n    \n    }\n    //col = vec3(1.,1.,1.) - col*vec3(1.,0.7,1.);\n    \n    //col = smoothstep(1.,0.,vec3(1,1.,1.)-col*vec3(1.,1.,1.));\n    if(sin(envb*12.) < 0.){\n        float m = sin(envb*6.7 + iTime*0.3 + sin(iTime) );\n        //m = max(abs(m),0.8)*sign(m);\n        //col = pow(smoothstep(0.6,1.2,col),vec3(1. + m*1.5 ,1.   ,.5 - m*1.4));\n        //col = pow(smoothstep(0.4,1.2,col),max(vec3(0.8 - m*4.,0.2   ,.5 + m*4.4),0.4));\n        if(sin(envb*250.) <0.){\n            col = 1. - col.xzy*vec3(0.1,0.5,0.5);\n            \n        } else {\n            col = 1. - col.xzy*vec3(0.1,0.5,0.5);\n            col = pow(col,vec3(2.,0.7,1.));\n            col = smoothstep(0.6,1.,col.x*vec3(1.,1.,1.4));\n        }\n    }\n    \n    //col = mix(col,1.-exp(-col*1.4),0.6);\n    \n    col = pow(col,vec3(0.4545));\n    fragColor = vec4(col,1.0);\n}",
                "description": "",
                "inputs": [
                    {
                        "channel": 2,
                        "ctype": "texture",
                        "id": 30,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/f735bee5b64ef98879dc618b016ecf7939a5756040c2cde21ccb15e69a6e1cfb.png"
                    },
                    {
                        "channel": 3,
                        "ctype": "texture",
                        "id": 49,
                        "published": 1,
                        "sampler": {
                            "filter": "mipmap",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "repeat"
                        },
                        "src": "/media/a/08b42b43ae9d3c0605da11d0eac86618ea888e62cdd9518ee8b9097488b31560.png"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}