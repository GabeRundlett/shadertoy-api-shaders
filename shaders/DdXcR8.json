{
    "Shader": {
        "info": {
            "date": "1686546393",
            "description": "Simple Music Visualizer",
            "flags": 64,
            "hasliked": 0,
            "id": "DdXcR8",
            "likes": 3,
            "name": "Fork Simple Mus notdaniel 389",
            "published": 3,
            "tags": [
                "music",
                "bars"
            ],
            "usePreview": 0,
            "username": "notdaniel",
            "viewed": 191
        },
        "renderpass": [
            {
                "code": "const vec3 COL_LOW = vec3(0.3,0.3,1.0);\nconst vec3 COL_MID = vec3(0.3,1.0,0.3);\nconst vec3 COL_HIGH = vec3(1.0,0.3,0.3);\nconst float NUM_BARS = 32.0;\n\nfloat discretize(float x, float nbars) {\n    return (floor(x * nbars) + 0.5)/nbars;\n}\n\nfloat get_sample_gain(float offset) {\n    return texture(iChannel0, vec2(offset, 0.75)).x;\n}\n\nfloat get_freq_gain(float freq) {\n    return texture(iChannel0, vec2(freq, 0.25)).x;\n}\n\nfloat get_overall_gain() {\n    float gain = 0.0;\n    for(float x = 0.0; x<1.0; x += 1.0/NUM_BARS)\n        gain += texture(iChannel0, vec2(discretize(x, NUM_BARS), 0.25)).x;\n    gain /= NUM_BARS;\n    return gain;\n}\n\nvec3 mix3(vec3 a, vec3 b, vec3 c, float x) {\n    return mix(b, c, (x-0.5)*2.0) * step(0.5, x) +\n           mix(a, b, x*2.0) * step(x, 0.5) ;\n}\n\nvec3 draw_background(vec2 uv) {\n    vec3 col = vec3(get_sample_gain(uv.x),\n                    get_freq_gain(uv.y),\n                    sin(iTime*30.0)*min(get_overall_gain()*2.0, 1.0));\n    return col * 0.2;\n}\n\nvec3 draw_bars(vec2 uv) {\n    uv.y *= 2.0;\n    float freq = discretize(uv.x, NUM_BARS);\n    float gain = get_freq_gain(freq);\n    vec3 col = mix3(COL_LOW, COL_MID, COL_HIGH, gain);\n    float cut = step(uv.y, max(gain, 0.01));\n    return col * cut;\n}\n\nvec3 draw_wave(vec2 uv) {\n    float gain = get_sample_gain(uv.x);\n    uv = (uv - 0.5)*4.0;\n    uv.y -= 1.0;\n    uv.y += gain - 0.5;\n\tfloat line_width = 2.0/iResolution.y;\n    float dist = length(uv.y) - line_width;\n    float cut = smoothstep(0.01, 0.0, dist);\n    vec3 col = mix3(COL_LOW, COL_MID, COL_HIGH, gain);\n    return col * cut;\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    vec2 uv = fragCoord/iResolution.xy;\n    vec3 col = draw_background(uv);\n    col += draw_bars(uv);\n    col += draw_wave(uv);\n    fragColor = vec4(col, 1.0);\n}\n",
                "description": "",
                "inputs": [
                    {
                        "channel": 0,
                        "ctype": "musicstream",
                        "id": 33589,
                        "published": 0,
                        "sampler": {
                            "filter": "linear",
                            "internal": "byte",
                            "srgb": "false",
                            "vflip": "true",
                            "wrap": "clamp"
                        },
                        "src": "https://soundcloud.com/bt/mercury-solace-helsloot-remix"
                    }
                ],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}