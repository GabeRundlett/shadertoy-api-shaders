{
    "Shader": {
        "info": {
            "date": "1712479026",
            "description": "CC0: Windows Terminal - Mandelmapping\n Shader prepared for Windows Terminal Shader Gallery\n https://github.com/mrange/windows-terminal-shader-gallery\n",
            "flags": 0,
            "hasliked": 0,
            "id": "4cKGRW",
            "likes": 4,
            "name": "Windows terminal Mandelmapping",
            "published": 3,
            "tags": [
                "2d"
            ],
            "usePreview": 0,
            "username": "mrange",
            "viewed": 196
        },
        "renderpass": [
            {
                "code": "// CC0: Windows Terminal - Mandelmapping\n//  Shader prepared for Windows Terminal Shader Gallery\n//  https://github.com/mrange/windows-terminal-shader-gallery\n\n#define TIME        iTime\n#define RESOLUTION  iResolution\n#define PI          3.141592654\n#define TAU         (2.0*PI)\n#define ROT(a)      mat2(cos(a), sin(a), -sin(a), cos(a))\n\n// License: Unknown, author: Martijn Steinrucken, found: https://www.youtube.com/watch?v=VmrIDyYiJBA\nvec2 hextile(inout vec2 p) {\n  // See Art of Code: Hexagonal Tiling Explained!\n  // https://www.youtube.com/watch?v=VmrIDyYiJBA\n  const vec2 sz       = vec2(1.0, sqrt(3.0));\n  const vec2 hsz      = 0.5*sz;\n\n  vec2 p1 = mod(p, sz)-hsz;\n  vec2 p2 = mod(p - hsz, sz)-hsz;\n  vec2 p3 = dot(p1, p1) < dot(p2, p2) ? p1 : p2;\n  vec2 n = ((p3 - p + hsz)/sz);\n  p = p3;\n\n  n -= vec2(0.5);\n  // Rounding to make hextile 0,0 well behaved\n  return round(n*2.0)*0.5;\n}\n\n// License: Unknown, author: Matt Taylor (https://github.com/64), found: https://64.github.io/tonemapping/\nvec3 aces_approx(vec3 v) {\n  v = max(v, 0.0);\n  v *= 0.6;\n  float a = 2.51;\n  float b = 0.03;\n  float c = 2.43;\n  float d = 0.59;\n  float e = 0.14;\n  return clamp((v*(a*v+b))/(v*(c*v+d)+e), 0.0, 1.0);\n}\n\n// License: MIT, author: Inigo Quilez, found: https://www.iquilezles.org/www/articles/smin/smin.htm\nfloat pmin(float a, float b, float k) {\n  float h = clamp(0.5+0.5*(b-a)/k, 0.0, 1.0);\n  return mix(b, a, h) - k*h*(1.0-h);\n}\n\nfloat pmax(float a, float b, float k) {\n  return -pmin(-a, -b, k);\n}\n\nfloat pabs(float a, float k) {\n  return -pmin(a, -a, k);\n}\n\nvec3 palette(float a){\n  return (1.+(sin(vec3(0., 1., 2.)+a)));\n}\n\nvec3 effect(vec2 p) {\n  float tm = -TIME*0.25;\n  const float MaxIter = 22.;\n  const float zz= 1.;\n  const float b = 0.1;\n\n  vec2 op = p;\n  p = p.yx;\n\n  vec2 center = vec2(-0.4, 0.);\n  vec2 c = center+p*0.5;\n  vec2 z = c;\n\n  vec2 z2;\n\n  float s = 1.;\n  float i = 0.;\n  for (; i < MaxIter; ++i) {\n    z2 = z*z;\n    float ss = sqrt(z2.x+z2.y);\n    if (ss > 2.) break;\n    s *= 2.;\n    s *= ss;\n    z = vec2(z2.x-z2.y, 2.*z.x*z.y)+c;\n  }\n\n  vec2 p2 = z/zz;\n  float a = 0.1*tm;\n  p2 *= ROT(a);\n  p2 += sin(vec2(1., sqrt(0.5))*a*b)/b;\n\n  const float gfo = 0.5;\n  float fo = (gfo*1E-3)+s*(gfo*3E-3);\n  vec2 c2 = p2;\n  hextile(c2);\n\n  float gd0 = length(c2)-0.25;\n  float gd1 = abs(c2.y);\n  const vec2 n2 = ROT(radians(60.))*vec2(0.,1.);\n  const vec2 n3 = ROT(radians(-60.))*vec2(0.,1.);\n  float gd2 = abs(dot(n2, c2));\n  float gd3 = abs(dot(n3, c2));\n  gd1 = min(gd1, gd2);\n  gd1 = min(gd1, gd3);\n  float gd = gd0;\n  gd = pmax(gd, -(gd1-0.025), 0.075);\n  gd = min(gd, gd1);\n  gd = pmin(gd, gd0+0.2, 0.025);\n  gd = abs(gd);\n  gd -= fo;\n\n  vec3 col = vec3(0.);\n\n  if (i < MaxIter) {\n  } else {\n    float gf = (gfo*1E-2)/max(gd, fo);\n//    gf *= sqrt(gf);\n    col += gf*palette(tm+(p2.x-p2.y)+op.x);\n  }\n\n  float div = 6.*max(round(RESOLUTION.y/1080.0), 1.);\n\n  col *= sqrt(0.5)*(0.5+0.5*sin(op.y*RESOLUTION.y*TAU/div));\n  col = aces_approx(col);\n  col = sqrt(col);\n  \n  return col;\n}\n\n\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec2 q = fragCoord/RESOLUTION.xy;\n  vec2 p = -1. + 2. * q;\n  p.x *= RESOLUTION.x/RESOLUTION.y;\n  vec3 col = effect(p);\n  fragColor = vec4(col,1.0);\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}