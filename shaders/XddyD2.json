{
    "Shader": {
        "info": {
            "date": "1520264161",
            "description": "Testing for loop vs. preprocessor for smaller iteration count than before, but where iteration involves nontrivial work.\nMakes the compiler of Mesa on Intel not look too good!",
            "flags": 0,
            "hasliked": 0,
            "id": "XddyD2",
            "likes": 0,
            "name": "Compiler: preproc. vs. loop2 #2",
            "published": 3,
            "tags": [
                "glsl",
                "compiler",
                "preprocessor",
                "macros"
            ],
            "usePreview": 0,
            "username": "ttg",
            "viewed": 502
        },
        "renderpass": [
            {
                "code": "/*\nTesting for loop vs. preprocessor for smaller iteration count than before,\n  but where iteration involves nontrivial work.\n\nIntel (Mesa 17.3.1):\n  USE_LOOP:\n    Faster compilation\n    Worse performance (~18 fps)\n  ITERx100000:\n    Slower compilation\n    Better performance (~30 fps)\n  Visual outputs DIFFER (lossy optimizations occur)\n\nNvidia (Nvidia 390.25):\n  No discernable difference in either compile times or runtime performance (~53 fps)\n  Visual outputs agree\n*/\n\n// toggle me:\n#define USE_LOOP\n\n#define ITER fragColor = fract(fragColor+sin(fragColor + 0.01*fragCoord.xyxy));\n#define ITERx10 ITER ITER ITER ITER ITER ITER ITER ITER ITER ITER\n#define ITERx100 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10 ITERx10\n#define ITERx1000 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100 ITERx100\n#define ITERx10000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000 ITERx1000\n#define ITERx100000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000 ITERx10000\n\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n\n    fragColor = vec4(0.);\n#ifdef USE_LOOP\n    for (int i = 0; i<1000; i++) {\n        ITER\n    }\n#else\n    ITERx1000\n#endif\n}\n",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}