{
    "Shader": {
        "info": {
            "date": "1586110662",
            "description": "Visualization of a geometric proof of the associativity of the operation\non an elliptic curve as constructed in https://www.shadertoy.com/view/Wd2cR1\n\nMove mouse to animate\n\nSee header comment for verbose explanation",
            "flags": 0,
            "hasliked": 0,
            "id": "3djyz1",
            "likes": 5,
            "name": "Elliptic curve associativity",
            "published": 3,
            "tags": [
                "2d",
                "math",
                "group",
                "ellipticcurve"
            ],
            "usePreview": 1,
            "username": "NinjaKoala",
            "viewed": 390
        },
        "renderpass": [
            {
                "code": "/*\nProof of associativity of the group operation on elliptic curves\nfrom\nhttps://www.mathematik.uni-marburg.de/~tbauer/Barth_Ebene_Algebraische_Kurven.pdf\n(which is german, so i translate it here)\n\nSee https://www.shadertoy.com/view/Wd2cR1 for notes on the definition of this operation.\n\nLet p,q,r be points on the curve.\nDefine:\n\nL  := pq\t\t    a := p * q\nM  := 0a\t\tp + q := 0 * a\nN  := (p+q)r\t    b := (p+q) * r\n----------------------------------\nL' := qr\t\t   a' := q * r\nM' := a'0\t\tq + r := a' * 0\nN' := (q+r)p\t   b' := (q+r) * p\n\nThen (p + q) + r = 0 * b and\np + (q + r) = 0 * b'\n\nSo it suffices to show that b = b',\nor equivalently, that p, b and q + r are collinear.\nWe consider the pencil of cubics defined by\n\nλC + μLM'N\n\n(where we identify the pairs (λ',μ') and (λ,μ)\niff there is an real number a such that λ'=aλ and μ'=aμ)\n( <=> (λ:μ) is an element of the projective line )\n\nIf you intersect the curve C with the curve LM'N\nyou get the 9 points:\n\np,q,a in L\nq+r,0,a' in M'\np+q,r,b in N\n\nEvery cubic curve in the pencil goes through this 9 points.\nThere is a cubic curve in the pencil such that\nthe curve intersects L' in q,r,a'\n(which belong to the 9 points above)\nand in a fourth point.\n\nBy Bezout's Theorem, this is only possible when\nC' is the union of L' and a conic section Q.\n\n(https://en.wikipedia.org/wiki/B%C3%A9zout%27s_theorem)\n\nNone of the remaining 6 Points lie on L'.\nSo they must lie on Q. Because p+q,0,a on M\nare collinear, Q must be the union of two lines, say\nQ is the union of M and L''.\nThe remaining 3 points p,q+r,b not lying on M\nmust then lie on L'', which means they are\ncollinear, which proofs associativity.\n\nThe letters are from the Latin Modern font (https://en.wikipedia.org/wiki/Computer_Modern#Latin_Modern)\nconverted to shader with https://gist.github.com/Ninja-Koala/74fa7652fb4de248949ce1e27b989c14\n\n*/\n\n//#define ZERO 0\n#define ZERO min(0,iFrame)\n\nfloat border;\n\n// Modified from http://tog.acm.org/resources/GraphicsGems/gems/Roots3And4.c\n// Credits to Doublefresh for hinting there\nint solve_quadric(vec2 coeffs, inout vec2 roots){\n\n\t// normal form: x^2 + px + q = 0\n\tfloat p = coeffs[1] / 2.;\n\tfloat q = coeffs[0];\n\n\tfloat D = p * p - q;\n\n\tif (D < 0.){\n\t\treturn 0;\n\t}\n\telse{\n\t\troots[0] = -sqrt(D) - p;\n\t\troots[1] = sqrt(D) - p;\n\n\t\treturn 2;\n\t}\n}\n\n//From Trisomie21\n//But instead of his cancellation fix i'm using a newton iteration\nint solve_cubic(vec3 coeffs, inout vec3 r){\n\n\tfloat a = coeffs[2];\n\tfloat b = coeffs[1];\n\tfloat c = coeffs[0];\n\n\tfloat p = b - a*a / 3.0;\n\tfloat q = a * (2.0*a*a - 9.0*b) / 27.0 + c;\n\tfloat p3 = p*p*p;\n\tfloat d = q*q + 4.0*p3 / 27.0;\n\tfloat offset = -a / 3.0;\n\tif(d >= 0.0) { // Single solution\n\t\tfloat z = sqrt(d);\n\t\tfloat u = (-q + z) / 2.0;\n\t\tfloat v = (-q - z) / 2.0;\n\t\tu = sign(u)*pow(abs(u),1.0/3.0);\n\t\tv = sign(v)*pow(abs(v),1.0/3.0);\n\t\tr[0] = offset + u + v;\t\n\n\t\t//Single newton iteration to account for cancellation\n\t\tfloat f = ((r[0] + a) * r[0] + b) * r[0] + c;\n\t\tfloat f1 = (3. * r[0] + 2. * a) * r[0] + b;\n\n\t\tr[0] -= f / f1;\n\n\t\treturn 1;\n\t}\n\tfloat u = sqrt(-p / 3.0);\n\tfloat v = acos(-sqrt( -27.0 / p3) * q / 2.0) / 3.0;\n\tfloat m = cos(v), n = sin(v)*1.732050808;\n\n\t//Single newton iteration to account for cancellation\n\t//(once for every root)\n\tr[0] = offset + u * (m + m);\n\tr[1] = offset - u * (n + m);\n\tr[2] = offset + u * (n - m);\n\n\tvec3 f = ((r + a) * r + b) * r + c;\n\tvec3 f1 = (3. * r + 2. * a) * r + b;\n\n\tr -= f / f1;\n\n\treturn 3;\n}\n\nfloat cubic_bezier_normal_iteration(float t, vec2 a0, vec2 a1, vec2 a2, vec2 a3){\n\t//horner's method\n\tvec2 a_2=a2+t*a3;\n\tvec2 a_1=a1+t*a_2;\n\tvec2 b_2=a_2+t*a3;\n\n\tvec2 uv_to_p=a0+t*a_1;\n\tvec2 tang=a_1+t*b_2;\n\n\tfloat l_tang=dot(tang,tang);\n\treturn t-dot(tang,uv_to_p)/l_tang;\n}\n\nfloat cubic_bezier_dis_approx_sq(vec2 uv, vec2 p0, vec2 p1, vec2 p2, vec2 p3){\n\tvec2 a3 = (-p0 + 3. * p1 - 3. * p2 + p3);\n\tvec2 a2 = (3. * p0 - 6. * p1 + 3. * p2);\n\tvec2 a1 = (-3. * p0 + 3. * p1);\n\tvec2 a0 = p0 - uv;\n\n\tfloat d0 = 1e38;\n\n\tfloat t;\n\tvec3 params=vec3(0,.5,1);\n\n\tif(all(lessThan(uv,max(max(p0,p1),max(p2,p3))+border)) && all(greaterThan(uv,min(min(p0,p1),min(p2,p3))-border))){\n\t\tfor(int i=ZERO;i<3;i++){\n\t\t\tt=params[i];\n\t\t\tfor(int j=ZERO;j<3;j++){\n\t\t\t\tt=cubic_bezier_normal_iteration(t,a0,a1,a2,a3);\n\t\t\t}\n\t\t\tt=clamp(t,0.,1.);\n\t\t\tvec2 uv_to_p=((a3*t+a2)*t+a1)*t+a0;\n\t\t\td0=min(d0,dot(uv_to_p,uv_to_p));\n\t\t}\n\t}\n\n\treturn d0;\n}\n\n//segment_dis_sq by iq\nfloat length2( vec2 v ) { return dot(v,v); }\n\nfloat segment_dis_sq( vec2 p, vec2 a, vec2 b ){\n\tvec2 pa = p-a, ba = b-a;\n\tfloat h = clamp( dot(pa,ba)/dot(ba,ba), 0.0, 1.0 );\n\treturn length2( pa - ba*h );\n}\n\nint segment_int_test(vec2 uv, vec2 p0, vec2 p1){\n\tp0-=uv;\n\tp1-=uv;\n\n\tint ret;\n\t\n\tif(p0.y*p1.y<0.){\n\t\tvec2 nor=p0-p1;\n\t\tnor=vec2(nor.y,-nor.x);\n\t\t\n\t\tfloat sgn;\n\t\t\n\t\tif(p0.y>p1.y){\n\t\t\tsgn=1.;\n\t\t}\n\t\telse{\n\t\t\tsgn=-1.;\n\t\t}\n\n\t\tif(dot(nor,p0)*sgn<0.){\n\t\t\tret=0;\n\t\t}\n\t\telse{\n\t\t\tret=1;\n\t\t}\n\t}\n\telse{\n\t\tret=0;\n\t}\n\n\treturn ret;\n}\n\nint cubic_bezier_int_test(vec2 uv, vec2 p0, vec2 p1, vec2 p2, vec2 p3){\n\n\tfloat cu = (-p0.y + 3. * p1.y - 3. * p2.y + p3.y);\n\tfloat qu = (3. * p0.y - 6. * p1.y + 3. * p2.y);\n\tfloat li = (-3. * p0.y + 3. * p1.y);\n\tfloat co = p0.y - uv.y;\n\n\tvec3 roots = vec3(1e38);\n\tint n_roots;\n\n\tint n_ints=0;\n\n\tif(uv.x<min(min(p0.x,p1.x),min(p2.x,p3.x))){\n\t\tif(uv.y>=min(p0.y,p3.y) && uv.y<=max(p0.y,p3.y)){\n\t\t\tn_ints=1;\n\t\t}\n\t}\n\telse{\n\t\tif(abs(cu) < .0001){\n\t\t\tn_roots = solve_quadric(vec2(co/qu,li/qu),roots.xy);\n\t\t}\n\t\telse{\n\t\t\tn_roots = solve_cubic(vec3(co/cu,li/cu,qu/cu),roots);\n\t\t}\n\n\t\tfor(int i=ZERO;i<n_roots;i++){\n\t\t\tif(roots[i] >= 0. && roots[i] <= 1.){\n\t\t\t\tfloat x_pos = -p0.x + 3. * p1.x - 3. * p2.x + p3.x;\n\t\t\t\tx_pos = x_pos * roots[i] + 3. * p0.x - 6. * p1.x + 3. * p2.x;\n\t\t\t\tx_pos = x_pos * roots[i] + -3. * p0.x + 3. * p1.x;\n\t\t\t\tx_pos = x_pos * roots[i] + p0.x;\n\n\t\t\t\tif(x_pos > uv.x){\n\t\t\t\t\tn_ints++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn n_ints;\n}\n\nvec3 line(vec2 p_0, vec2 p_1){\n\tvec2 tan1 = p_1-p_0;\n\tvec2 nor1 = normalize(vec2(tan1.y,-tan1.x));\n\treturn vec3(nor1,-dot(nor1,p_0));\n}\n\nvec2 third_intersection(vec2 p0, vec2 p1, float g_2, float g_3){\n\tvec2 tang=p1-p0;\n\tfloat p0_val = p0.y*p0.y - (( 4.*p0.x*p0.x - g_2 ) * p0.x - g_3);\n\n\tfloat co=p0_val;\n\tfloat li=-12.*p0.x*p0.x*tang.x + g_2*tang.x + 2.*p0.y*tang.y;\n\tfloat qu=-12.*p0.x*tang.x*tang.x+tang.y*tang.y;\n\tfloat cu=-4.*tang.x*tang.x*tang.x;\n\n\tvec3 roots = vec3(1e38);\n\tint n_roots = solve_cubic(vec3(co/cu,li/cu,qu/cu),roots);\n\n\tvec2 p2=vec2(1e38);\n\n\tfor(int i=ZERO;i<n_roots;i++){\n\t\tvec2 tmp=p0+roots[i]*tang;\n\t\tif(distance(tmp,p0)>0.0001 && distance(tmp,p1)>0.0001){\n\t\t\tp2=tmp;\n\t\t}\n\t}\n\n\treturn p2;\n}\n\nfloat L_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[61] p=vec2[](vec2(0.0217975,-0.00740799),\n\t                  vec2(0.0217975,-0.00647717),\n\t                  vec2(0.0208666,-0.00647717),\n\t                  vec2(0.0206339,-0.00647717),\n\t                  vec2(0.019703,-0.00647717),\n\t                  vec2(0.0196255,-0.00670981),\n\t                  vec2(0.0190825,-0.0081837),\n\t                  vec2(0.0166002,-0.0150875),\n\t                  vec2(0.0132647,-0.0240857),\n\t                  vec2(0.00116365,-0.0240857),\n\t                  vec2(-0.00511958,-0.0240857),\n\t                  vec2(-0.0075243,-0.0240857),\n\t                  vec2(-0.0075243,-0.0238531),\n\t                  vec2(-0.0075243,-0.02331),\n\t                  vec2(-0.0075243,-0.0228446),\n\t                  vec2(-0.00729166,-0.0220689),\n\t                  vec2(-0.00721382,-0.0216035),\n\t                  vec2(0.00333581,0.020595),\n\t                  vec2(0.00403395,0.02331),\n\t                  vec2(0.0044994,0.0240857),\n\t                  vec2(0.0107826,0.0240857),\n\t                  vec2(0.0115583,0.0240857),\n\t                  vec2(0.012877,0.0240857),\n\t                  vec2(0.0137303,0.0240857),\n\t                  vec2(0.0137303,0.0255596),\n\t                  vec2(0.0137303,0.0264904),\n\t                  vec2(0.012877,0.0264904),\n\t                  vec2(0.0125667,0.0264904),\n\t                  vec2(0.00907606,0.0264904),\n\t                  vec2(0.00543022,0.0262578),\n\t                  vec2(0.00186196,0.0262578),\n\t                  vec2(-0.00131842,0.0262578),\n\t                  vec2(-0.00457642,0.0264904),\n\t                  vec2(-0.00767923,0.0264904),\n\t                  vec2(-0.00814464,0.0264904),\n\t                  vec2(-0.00915308,0.0264904),\n\t                  vec2(-0.00915308,0.0250166),\n\t                  vec2(-0.00915308,0.0240857),\n\t                  vec2(-0.00853252,0.0240857),\n\t                  vec2(-0.00705867,0.0240857),\n\t                  vec2(-0.00465395,0.0240857),\n\t                  vec2(-0.00255954,0.0240857),\n\t                  vec2(-0.00255954,0.022767),\n\t                  vec2(-0.00255954,0.0225344),\n\t                  vec2(-0.00255954,0.0223791),\n\t                  vec2(-0.00286958,0.0212932),\n\t                  vec2(-0.0133416,-0.0208277),\n\t                  vec2(-0.0139622,-0.0234651),\n\t                  vec2(-0.0144277,-0.0240857),\n\t                  vec2(-0.0197024,-0.0240857),\n\t                  vec2(-0.0209436,-0.0240857),\n\t                  vec2(-0.0217969,-0.0240857),\n\t                  vec2(-0.0217969,-0.0255596),\n\t                  vec2(-0.0217969,-0.0264904),\n\t                  vec2(-0.0210987,-0.0264904),\n\t                  vec2(-0.0198576,-0.0264904),\n\t                  vec2(0.0133427,-0.0264904),\n\t                  vec2(0.0150493,-0.0264904),\n\t                  vec2(0.0151268,-0.026413),\n\t                  vec2(0.0155922,-0.0250941),\n\t                  vec2(0.0214876,-0.00841643));\n\n\tivec2[7] seg=ivec2[](ivec2(9,10),\n\t                     ivec2(16,17),\n\t                     ivec2(20,21),\n\t                     ivec2(45,46),\n\t                     ivec2(55,56),\n\t                     ivec2(59,60),\n\t                     ivec2(60,0));\n\n\tivec4[18] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(10,11,12,13),\n\t                        ivec4(13,14,15,16),\n\t                        ivec4(17,18,19,20),\n\t                        ivec4(21,22,23,24),\n\t                        ivec4(24,25,26,27),\n\t                        ivec4(27,28,29,30),\n\t                        ivec4(30,31,32,33),\n\t                        ivec4(33,34,35,36),\n\t                        ivec4(36,37,38,39),\n\t                        ivec4(39,40,41,42),\n\t                        ivec4(42,43,44,45),\n\t                        ivec4(46,47,48,49),\n\t                        ivec4(49,50,51,52),\n\t                        ivec4(52,53,54,55),\n\t                        ivec4(56,57,58,59));\n\n\tif(all(lessThan(uv,vec2(0.0217975,0.0264904)+border)) && all(greaterThan(uv,vec2(-0.0217969,-0.0264904)-border))){\n\t\tfor(int i=ZERO;i<7;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<18;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat M_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[99] p=vec2[](vec2(0.0236592,-0.0250941),\n\t                  vec2(0.0236592,-0.0240857),\n\t                  vec2(0.0231162,-0.0240857),\n\t                  vec2(0.0215648,-0.0240857),\n\t                  vec2(0.0170657,-0.0240857),\n\t                  vec2(0.0170657,-0.0234652),\n\t                  vec2(0.0170657,-0.022767),\n\t                  vec2(0.0170657,-0.022767),\n\t                  vec2(0.0170657,-0.0221465),\n\t                  vec2(0.0173757,-0.0209829),\n\t                  vec2(0.0278478,0.0209829),\n\t                  vec2(0.0284683,0.0234651),\n\t                  vec2(0.0290889,0.0240857),\n\t                  vec2(0.0339759,0.0240857),\n\t                  vec2(0.0356049,0.0240857),\n\t                  vec2(0.036303,0.0240857),\n\t                  vec2(0.036303,0.025482),\n\t                  vec2(0.036303,0.0264904),\n\t                  vec2(0.0356824,0.0264904),\n\t                  vec2(0.0343637,0.0264904),\n\t                  vec2(0.0244347,0.0264904),\n\t                  vec2(0.0227281,0.0264904),\n\t                  vec2(0.0224954,0.0264904),\n\t                  vec2(0.0216421,0.0250941),\n\t                  vec2(-0.00473192,-0.0187333),\n\t                  vec2(-0.0090759,0.0247838),\n\t                  vec2(-0.00923114,0.0264904),\n\t                  vec2(-0.00938638,0.0264904),\n\t                  vec2(-0.0112479,0.0264904),\n\t                  vec2(-0.0215648,0.0264904),\n\t                  vec2(-0.0228059,0.0264904),\n\t                  vec2(-0.0236592,0.0264904),\n\t                  vec2(-0.0236592,0.0250166),\n\t                  vec2(-0.0236592,0.0240857),\n\t                  vec2(-0.0230386,0.0240857),\n\t                  vec2(-0.0215648,0.0240857),\n\t                  vec2(-0.0191601,0.0240857),\n\t                  vec2(-0.0170657,0.0240857),\n\t                  vec2(-0.0170657,0.022767),\n\t                  vec2(-0.0170657,0.0225344),\n\t                  vec2(-0.0170657,0.0223791),\n\t                  vec2(-0.0173757,0.0212932),\n\t                  vec2(-0.0273048,-0.0186558),\n\t                  vec2(-0.0283908,-0.0229997),\n\t                  vec2(-0.0313385,-0.0239306),\n\t                  vec2(-0.0348292,-0.0240857),\n\t                  vec2(-0.0354497,-0.0240857),\n\t                  vec2(-0.036303,-0.0241631),\n\t                  vec2(-0.036303,-0.0255596),\n\t                  vec2(-0.036303,-0.0262577),\n\t                  vec2(-0.0358376,-0.0264904),\n\t                  vec2(-0.0352946,-0.0264904),\n\t                  vec2(-0.0329675,-0.0264904),\n\t                  vec2(-0.0303301,-0.0262578),\n\t                  vec2(-0.0279254,-0.0262578),\n\t                  vec2(-0.0254431,-0.0262578),\n\t                  vec2(-0.0227281,-0.0264904),\n\t                  vec2(-0.0203234,-0.0264904),\n\t                  vec2(-0.019858,-0.0264904),\n\t                  vec2(-0.0189272,-0.0264904),\n\t                  vec2(-0.0189272,-0.0250941),\n\t                  vec2(-0.0189272,-0.0241633),\n\t                  vec2(-0.0194702,-0.0240857),\n\t                  vec2(-0.020401,-0.0240857),\n\t                  vec2(-0.0248225,-0.0239305),\n\t                  vec2(-0.0249777,-0.0219138),\n\t                  vec2(-0.0249777,-0.0207502),\n\t                  vec2(-0.0249777,-0.0205176),\n\t                  vec2(-0.0249777,-0.0200521),\n\t                  vec2(-0.0246674,-0.0188109),\n\t                  vec2(-0.0143505,0.0223792),\n\t                  vec2(-0.0142731,0.0223792),\n\t                  vec2(-0.00954126,-0.0246287),\n\t                  vec2(-0.00938602,-0.0259474),\n\t                  vec2(-0.00938602,-0.0264904),\n\t                  vec2(-0.00822257,-0.0264904),\n\t                  vec2(-0.00721417,-0.0264904),\n\t                  vec2(-0.00682629,-0.0259474),\n\t                  vec2(-0.00636088,-0.0250941),\n\t                  vec2(0.022573,0.0230773),\n\t                  vec2(0.0226504,0.0230773),\n\t                  vec2(0.0117129,-0.0208277),\n\t                  vec2(0.0110924,-0.0234652),\n\t                  vec2(0.010627,-0.0240857),\n\t                  vec2(0.00535212,-0.0240857),\n\t                  vec2(0.004111,-0.0240857),\n\t                  vec2(0.00325771,-0.0240857),\n\t                  vec2(0.00325771,-0.0255596),\n\t                  vec2(0.00325771,-0.0264904),\n\t                  vec2(0.004111,-0.0264904),\n\t                  vec2(0.00434372,-0.0264904),\n\t                  vec2(0.00721385,-0.0264904),\n\t                  vec2(0.0102391,-0.0262578),\n\t                  vec2(0.0131868,-0.0262578),\n\t                  vec2(0.0161345,-0.0262578),\n\t                  vec2(0.0193149,-0.0264904),\n\t                  vec2(0.022185,-0.0264904),\n\t                  vec2(0.022728,-0.0264904),\n\t                  vec2(0.0236588,-0.0264904));\n\n\tivec2[12] seg=ivec2[](ivec2(9,10),\n\t                      ivec2(19,20),\n\t                      ivec2(23,24),\n\t                      ivec2(24,25),\n\t                      ivec2(28,29),\n\t                      ivec2(41,42),\n\t                      ivec2(69,70),\n\t                      ivec2(70,71),\n\t                      ivec2(71,72),\n\t                      ivec2(78,79),\n\t                      ivec2(79,80),\n\t                      ivec2(80,81));\n\n\tivec4[29] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(10,11,12,13),\n\t                        ivec4(13,14,15,16),\n\t                        ivec4(16,17,18,19),\n\t                        ivec4(20,21,22,23),\n\t                        ivec4(25,26,27,28),\n\t                        ivec4(29,30,31,32),\n\t                        ivec4(32,33,34,35),\n\t                        ivec4(35,36,37,38),\n\t                        ivec4(38,39,40,41),\n\t                        ivec4(42,43,44,45),\n\t                        ivec4(45,46,47,48),\n\t                        ivec4(48,49,50,51),\n\t                        ivec4(51,52,53,54),\n\t                        ivec4(54,55,56,57),\n\t                        ivec4(57,58,59,60),\n\t                        ivec4(60,61,62,63),\n\t                        ivec4(63,64,65,66),\n\t                        ivec4(66,67,68,69),\n\t                        ivec4(72,73,74,75),\n\t                        ivec4(75,76,77,78),\n\t                        ivec4(81,82,83,84),\n\t                        ivec4(84,85,86,87),\n\t                        ivec4(87,88,89,90),\n\t                        ivec4(90,91,92,93),\n\t                        ivec4(93,94,95,96),\n\t                        ivec4(96,97,98,0));\n\n\tif(all(lessThan(uv,vec2(0.036303,0.0264904)+border)) && all(greaterThan(uv,vec2(-0.036303,-0.0264904)-border))){\n\t\tfor(int i=ZERO;i<12;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<29;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat N_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[82] p=vec2[](vec2(0.0306406,0.025482),\n\t                  vec2(0.0306406,0.0261026),\n\t                  vec2(0.0303302,0.0264904),\n\t                  vec2(0.0296322,0.0264904),\n\t                  vec2(0.0272275,0.0264904),\n\t                  vec2(0.0246677,0.0262578),\n\t                  vec2(0.0221854,0.0262578),\n\t                  vec2(0.0197031,0.0262578),\n\t                  vec2(0.0170657,0.0264904),\n\t                  vec2(0.014661,0.0264904),\n\t                  vec2(0.0142731,0.0264904),\n\t                  vec2(0.0132648,0.0264904),\n\t                  vec2(0.0132648,0.0250166),\n\t                  vec2(0.0132648,0.0241633),\n\t                  vec2(0.0139629,0.0240857),\n\t                  vec2(0.014661,0.0240857),\n\t                  vec2(0.0186947,0.0239305),\n\t                  vec2(0.0193153,0.0223792),\n\t                  vec2(0.0193153,0.0207502),\n\t                  vec2(0.0193153,0.0200521),\n\t                  vec2(0.01916,0.0195091),\n\t                  vec2(0.0190048,0.0188885),\n\t                  vec2(0.0104719,-0.0151651),\n\t                  vec2(-0.00403374,0.0251717),\n\t                  vec2(-0.00449915,0.0264129),\n\t                  vec2(-0.00457673,0.0264904),\n\t                  vec2(-0.00620573,0.0264904),\n\t                  vec2(-0.015902,0.0264904),\n\t                  vec2(-0.0171432,0.0264904),\n\t                  vec2(-0.0179964,0.0264904),\n\t                  vec2(-0.0179964,0.0250166),\n\t                  vec2(-0.0179964,0.0240857),\n\t                  vec2(-0.0173759,0.0240857),\n\t                  vec2(-0.015902,0.0240857),\n\t                  vec2(-0.015359,0.0240857),\n\t                  vec2(-0.0111702,0.0240857),\n\t                  vec2(-0.0111702,0.0234652),\n\t                  vec2(-0.0111702,0.0234652),\n\t                  vec2(-0.0111702,0.0232325),\n\t                  vec2(-0.0114029,0.0224567),\n\t                  vec2(-0.0216422,-0.0186558),\n\t                  vec2(-0.0227282,-0.0229222),\n\t                  vec2(-0.0255983,-0.0239306),\n\t                  vec2(-0.0291666,-0.0240857),\n\t                  vec2(-0.0297872,-0.0240857),\n\t                  vec2(-0.0306405,-0.0241631),\n\t                  vec2(-0.0306405,-0.0255596),\n\t                  vec2(-0.0306405,-0.0262577),\n\t                  vec2(-0.030175,-0.0264904),\n\t                  vec2(-0.029632,-0.0264904),\n\t                  vec2(-0.0273049,-0.0264904),\n\t                  vec2(-0.0246675,-0.0262578),\n\t                  vec2(-0.0222628,-0.0262578),\n\t                  vec2(-0.0197805,-0.0262578),\n\t                  vec2(-0.0170655,-0.0264904),\n\t                  vec2(-0.0146609,-0.0264904),\n\t                  vec2(-0.0141954,-0.0264904),\n\t                  vec2(-0.0132646,-0.0264904),\n\t                  vec2(-0.0132646,-0.0250941),\n\t                  vec2(-0.0132646,-0.0241633),\n\t                  vec2(-0.0138076,-0.0240857),\n\t                  vec2(-0.0147384,-0.0240857),\n\t                  vec2(-0.0191599,-0.0239305),\n\t                  vec2(-0.0193151,-0.0219137),\n\t                  vec2(-0.0193151,-0.0207502),\n\t                  vec2(-0.0193151,-0.0205175),\n\t                  vec2(-0.0193151,-0.020052),\n\t                  vec2(-0.0190046,-0.0188109),\n\t                  vec2(-0.00899801,0.021138),\n\t                  vec2(0.0076797,-0.0251717),\n\t                  vec2(0.00806758,-0.0263353),\n\t                  vec2(0.00814515,-0.0264904),\n\t                  vec2(0.00923112,-0.0264904),\n\t                  vec2(0.0100844,-0.0264904),\n\t                  vec2(0.0103947,-0.026413),\n\t                  vec2(0.0107825,-0.024939),\n\t                  vec2(0.0216424,0.018811),\n\t                  vec2(0.0228836,0.0237754),\n\t                  vec2(0.0272275,0.0240082),\n\t                  vec2(0.0294771,0.0240857),\n\t                  vec2(0.0297097,0.0240857),\n\t                  vec2(0.0306407,0.0241631));\n\n\tivec2[7] seg=ivec2[](ivec2(21,22),\n\t                     ivec2(22,23),\n\t                     ivec2(26,27),\n\t                     ivec2(39,40),\n\t                     ivec2(67,68),\n\t                     ivec2(68,69),\n\t                     ivec2(75,76));\n\n\tivec4[25] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(9,10,11,12),\n\t                        ivec4(12,13,14,15),\n\t                        ivec4(15,16,17,18),\n\t                        ivec4(18,19,20,21),\n\t                        ivec4(23,24,25,26),\n\t                        ivec4(27,28,29,30),\n\t                        ivec4(30,31,32,33),\n\t                        ivec4(33,34,35,36),\n\t                        ivec4(36,37,38,39),\n\t                        ivec4(40,41,42,43),\n\t                        ivec4(43,44,45,46),\n\t                        ivec4(46,47,48,49),\n\t                        ivec4(49,50,51,52),\n\t                        ivec4(52,53,54,55),\n\t                        ivec4(55,56,57,58),\n\t                        ivec4(58,59,60,61),\n\t                        ivec4(61,62,63,64),\n\t                        ivec4(64,65,66,67),\n\t                        ivec4(69,70,71,72),\n\t                        ivec4(72,73,74,75),\n\t                        ivec4(76,77,78,79),\n\t                        ivec4(79,80,81,0));\n\n\tif(all(lessThan(uv,vec2(0.0306407,0.0264904)+border)) && all(greaterThan(uv,vec2(-0.0306405,-0.0264904)-border))){\n\t\tfor(int i=ZERO;i<7;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<25;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat prime_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[9] p=vec2[](vec2(0.00421962,0.00845522),\n\t                 vec2(0.0046075,0.00985149),\n\t                 vec2(0.00375421,0.0109375),\n\t                 vec2(0.00235794,0.0109375),\n\t                 vec2(0.000961663,0.0109375),\n\t                 vec2(-0.000512186,0.00985149),\n\t                 vec2(-0.000744913,0.00845522),\n\t                 vec2(-0.00431317,-0.0109375),\n\t                 vec2(-0.00198604,-0.0109375));\n\n\tivec2[3] seg=ivec2[](ivec2(6,7),\n\t                     ivec2(7,8),\n\t                     ivec2(8,0));\n\n\tivec4[2] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                       ivec4(3,4,5,6));\n\n\tif(all(lessThan(uv,vec2(0.0046075,0.0109375)+border)) && all(greaterThan(uv,vec2(-0.00431317,-0.0109375)-border))){\n\t\tfor(int i=ZERO;i<3;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<2;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat plus_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[32] p=vec2[](vec2(0.0257924,-0.0),\n\t                  vec2(0.0257924,0.00155143),\n\t                  vec2(0.0243185,0.00155143),\n\t                  vec2(0.0232326,0.00155143),\n\t                  vec2(0.00159032,0.00155143),\n\t                  vec2(0.00159032,0.0232712),\n\t                  vec2(0.00159032,0.0243572),\n\t                  vec2(0.00159032,0.0258311),\n\t                  vec2(3.88912e-05,0.0258311),\n\t                  vec2(-0.00151253,0.0258311),\n\t                  vec2(-0.00151253,0.0243572),\n\t                  vec2(-0.00151253,0.0232712),\n\t                  vec2(-0.00151253,0.00155143),\n\t                  vec2(-0.0232323,0.00155143),\n\t                  vec2(-0.0243183,0.00155143),\n\t                  vec2(-0.0257922,0.00155143),\n\t                  vec2(-0.0257922,-0.0),\n\t                  vec2(-0.0257922,-0.00155143),\n\t                  vec2(-0.0243183,-0.00155143),\n\t                  vec2(-0.0232323,-0.00155143),\n\t                  vec2(-0.00151253,-0.00155143),\n\t                  vec2(-0.00151253,-0.0232712),\n\t                  vec2(-0.00151253,-0.0243572),\n\t                  vec2(-0.00151253,-0.0258311),\n\t                  vec2(3.88912e-05,-0.0258311),\n\t                  vec2(0.00159032,-0.0258311),\n\t                  vec2(0.00159032,-0.0243572),\n\t                  vec2(0.00159032,-0.0232712),\n\t                  vec2(0.00159032,-0.00155143),\n\t                  vec2(0.0232326,-0.00155143),\n\t                  vec2(0.0243185,-0.00155143),\n\t                  vec2(0.0257924,-0.00155143));\n\n\tivec2[8] seg=ivec2[](ivec2(3,4),\n\t                     ivec2(4,5),\n\t                     ivec2(11,12),\n\t                     ivec2(12,13),\n\t                     ivec2(19,20),\n\t                     ivec2(20,21),\n\t                     ivec2(27,28),\n\t                     ivec2(28,29));\n\n\tivec4[8] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                       ivec4(5,6,7,8),\n\t                       ivec4(8,9,10,11),\n\t                       ivec4(13,14,15,16),\n\t                       ivec4(16,17,18,19),\n\t                       ivec4(21,22,23,24),\n\t                       ivec4(24,25,26,27),\n\t                       ivec4(29,30,31,0));\n\n\tif(all(lessThan(uv,vec2(0.0257924,0.0258311)+border)) && all(greaterThan(uv,vec2(-0.0257922,-0.0258311)-border))){\n\t\tfor(int i=ZERO;i<8;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<8;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat zero_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[48] p=vec2[](vec2(0.0163288,-0.000155151),\n\t                  vec2(0.0163288,0.00605055),\n\t                  vec2(0.0159409,0.0122562),\n\t                  vec2(0.013226,0.0179964),\n\t                  vec2(0.0096577,0.0254432),\n\t                  vec2(0.00329689,0.0266843),\n\t                  vec2(3.89352e-05,0.0266843),\n\t                  vec2(-0.00461534,0.0266843),\n\t                  vec2(-0.010278,0.0246675),\n\t                  vec2(-0.0134584,0.0174534),\n\t                  vec2(-0.0159407,0.012101),\n\t                  vec2(-0.0163286,0.00605055),\n\t                  vec2(-0.0163286,-0.000155151),\n\t                  vec2(-0.0163286,-0.00597297),\n\t                  vec2(-0.0160181,-0.0129543),\n\t                  vec2(-0.0128379,-0.0188497),\n\t                  vec2(-0.00950234,-0.0251329),\n\t                  vec2(-0.00383967,-0.0266843),\n\t                  vec2(-3.86845e-05,-0.0266843),\n\t                  vec2(0.00415014,-0.0266843),\n\t                  vec2(0.0100455,-0.0250554),\n\t                  vec2(0.0134586,-0.0176862),\n\t                  vec2(0.0159409,-0.0123337),\n\t                  vec2(0.0163287,-0.00628323),\n\t                  vec2(0.00989038,0.000775669),\n\t                  vec2(0.00989038,-0.00504211),\n\t                  vec2(0.00989038,-0.0103169),\n\t                  vec2(0.00903714,-0.0152815),\n\t                  vec2(0.00787359,-0.0226507),\n\t                  vec2(0.003452,-0.0249778),\n\t                  vec2(-3.86405e-05,-0.0249778),\n\t                  vec2(-0.00306392,-0.0249778),\n\t                  vec2(-0.00764062,-0.0230385),\n\t                  vec2(-0.00903685,-0.0155917),\n\t                  vec2(-0.00989013,-0.0109375),\n\t                  vec2(-0.00989013,-0.00380099),\n\t                  vec2(-0.00989013,0.000775669),\n\t                  vec2(-0.00989013,0.00574025),\n\t                  vec2(-0.00989013,0.0108599),\n\t                  vec2(-0.00926957,0.0150488),\n\t                  vec2(-0.00779577,0.0242797),\n\t                  vec2(-0.0019779,0.0249778),\n\t                  vec2(-3.86405e-05,0.0249778),\n\t                  vec2(0.00252114,0.0249778),\n\t                  vec2(0.00764087,0.0235816),\n\t                  vec2(0.00911472,0.015902),\n\t                  vec2(0.00989038,0.0115581),\n\t                  vec2(0.00989038,0.00566267));\n\n\tivec4[16] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(9,10,11,12),\n\t                        ivec4(12,13,14,15),\n\t                        ivec4(15,16,17,18),\n\t                        ivec4(18,19,20,21),\n\t                        ivec4(21,22,23,0),\n\t                        ivec4(24,25,26,27),\n\t                        ivec4(27,28,29,30),\n\t                        ivec4(30,31,32,33),\n\t                        ivec4(33,34,35,36),\n\t                        ivec4(36,37,38,39),\n\t                        ivec4(39,40,41,42),\n\t                        ivec4(42,43,44,45),\n\t                        ivec4(45,46,47,24));\n\n\tif(all(lessThan(uv,vec2(0.0163288,0.0266843)+border)) && all(greaterThan(uv,vec2(-0.0163286,-0.0266843)-border))){\n\t\tfor(int i=ZERO;i<16;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat a_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[65] p=vec2[](vec2(0.0165615,-0.00562388),\n\t                  vec2(0.0165615,-0.00484817),\n\t                  vec2(0.0159409,-0.00484817),\n\t                  vec2(0.0153979,-0.00484817),\n\t                  vec2(0.014467,-0.00484817),\n\t                  vec2(0.0143895,-0.00492557),\n\t                  vec2(0.0139241,-0.00663228),\n\t                  vec2(0.012838,-0.0109763),\n\t                  vec2(0.0113642,-0.0158632),\n\t                  vec2(0.00872679,-0.0158632),\n\t                  vec2(0.00670996,-0.0158632),\n\t                  vec2(0.00670996,-0.0137688),\n\t                  vec2(0.00670996,-0.0126828),\n\t                  vec2(0.00670996,-0.0121398),\n\t                  vec2(0.00670996,-0.0108987),\n\t                  vec2(0.00725294,-0.00872669),\n\t                  vec2(0.0125278,0.0123726),\n\t                  vec2(0.0128383,0.0134585),\n\t                  vec2(0.0128383,0.0136137),\n\t                  vec2(0.0128383,0.0140015),\n\t                  vec2(0.0128383,0.0156305),\n\t                  vec2(0.0115195,0.0160184),\n\t                  vec2(0.0107438,0.0160184),\n\t                  vec2(0.00826156,0.0160184),\n\t                  vec2(0.00771857,0.013381),\n\t                  vec2(0.007641,0.0129931),\n\t                  vec2(0.00616715,0.0163287),\n\t                  vec2(0.0036849,0.0175698),\n\t                  vec2(0.00120261,0.0175698),\n\t                  vec2(-0.00740776,0.0175698),\n\t                  vec2(-0.0165611,0.00577904),\n\t                  vec2(-0.0165611,-0.00554631),\n\t                  vec2(-0.0165611,-0.0121398),\n\t                  vec2(-0.0129928,-0.0175698),\n\t                  vec2(-0.00717503,-0.0175698),\n\t                  vec2(-0.00438248,-0.0175698),\n\t                  vec2(-0.000969373,-0.0159408),\n\t                  vec2(0.00213348,-0.0121398),\n\t                  vec2(0.00298677,-0.0159408),\n\t                  vec2(0.00585689,-0.0175698),\n\t                  vec2(0.00857186,-0.0175698),\n\t                  vec2(0.011442,-0.0175698),\n\t                  vec2(0.0130709,-0.0156305),\n\t                  vec2(0.0142345,-0.0132258),\n\t                  vec2(0.0156308,-0.0102781),\n\t                  vec2(0.0165616,-0.00562388),\n\t                  vec2(0.00267629,-0.00709773),\n\t                  vec2(0.00205573,-0.00957998),\n\t                  vec2(-0.00275366,-0.0158632),\n\t                  vec2(-0.00702005,-0.0158632),\n\t                  vec2(-0.0106659,-0.0158632),\n\t                  vec2(-0.0112865,-0.0112866),\n\t                  vec2(-0.0112865,-0.00895942),\n\t                  vec2(-0.0112865,-0.00508085),\n\t                  vec2(-0.00888178,0.00399493),\n\t                  vec2(-0.00748551,0.00725288),\n\t                  vec2(-0.00554625,0.0119847),\n\t                  vec2(-0.00197799,0.0158632),\n\t                  vec2(0.00120244,0.0158632),\n\t                  vec2(0.00461555,0.0158632),\n\t                  vec2(0.00655481,0.0118295),\n\t                  vec2(0.00655481,0.00857158),\n\t                  vec2(0.00655481,0.00857158),\n\t                  vec2(0.00647741,0.0080286),\n\t                  vec2(0.00632217,0.00756314));\n\n\tivec2[2] seg=ivec2[](ivec2(15,16),\n\t                     ivec2(64,46));\n\n\tivec4[21] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(9,10,11,12),\n\t                        ivec4(12,13,14,15),\n\t                        ivec4(16,17,18,19),\n\t                        ivec4(19,20,21,22),\n\t                        ivec4(22,23,24,25),\n\t                        ivec4(25,26,27,28),\n\t                        ivec4(28,29,30,31),\n\t                        ivec4(31,32,33,34),\n\t                        ivec4(34,35,36,37),\n\t                        ivec4(37,38,39,40),\n\t                        ivec4(40,41,42,43),\n\t                        ivec4(43,44,45,0),\n\t                        ivec4(46,47,48,49),\n\t                        ivec4(49,50,51,52),\n\t                        ivec4(52,53,54,55),\n\t                        ivec4(55,56,57,58),\n\t                        ivec4(58,59,60,61),\n\t                        ivec4(61,62,63,64));\n\n\tif(all(lessThan(uv,vec2(0.0165616,0.0175698)+border)) && all(greaterThan(uv,vec2(-0.0165611,-0.0175698)-border))){\n\t\tfor(int i=ZERO;i<2;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<21;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat b_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[60] p=vec2[](vec2(0.0133423,-0.00430514),\n\t                  vec2(0.0133423,0.00399493),\n\t                  vec2(0.00868805,0.00779591),\n\t                  vec2(0.00403377,0.00779591),\n\t                  vec2(0.00108607,0.00779591),\n\t                  vec2(-0.00155132,0.00616691),\n\t                  vec2(-0.00418872,0.00368467),\n\t                  vec2(0.00124123,0.0254044),\n\t                  vec2(0.00131863,0.0256371),\n\t                  vec2(0.00147387,0.0264129),\n\t                  vec2(0.00147387,0.0264129),\n\t                  vec2(0.00147387,0.027111),\n\t                  vec2(0.00100846,0.0273438),\n\t                  vec2(0.000387894,0.0273438),\n\t                  vec2(0.000155255,0.0273438),\n\t                  vec2(-0.000620546,0.0272664),\n\t                  vec2(-0.000853229,0.0271885),\n\t                  vec2(-0.00853274,0.0265679),\n\t                  vec2(-0.0094636,0.0264905),\n\t                  vec2(-0.0103169,0.0264127),\n\t                  vec2(-0.0103169,0.0249389),\n\t                  vec2(-0.0103169,0.0240857),\n\t                  vec2(-0.00954118,0.0240857),\n\t                  vec2(-0.0084552,0.0240857),\n\t                  vec2(-0.00473179,0.0240857),\n\t                  vec2(-0.00457664,0.0235427),\n\t                  vec2(-0.00457664,0.022767),\n\t                  vec2(-0.00457664,0.0225343),\n\t                  vec2(-0.00480928,0.0214483),\n\t                  vec2(-0.00480928,0.0214483),\n\t                  vec2(-0.0124888,-0.00919219),\n\t                  vec2(-0.0125662,-0.00942483),\n\t                  vec2(-0.0133421,-0.0126053),\n\t                  vec2(-0.0133421,-0.015553),\n\t                  vec2(-0.0133421,-0.022069),\n\t                  vec2(-0.0100841,-0.0273437),\n\t                  vec2(-0.00442145,-0.0273437),\n\t                  vec2(0.0042665,-0.0273437),\n\t                  vec2(0.0133423,-0.0157081),\n\t                  vec2(0.00380109,-0.0182679),\n\t                  vec2(0.00287023,-0.0202071),\n\t                  vec2(-0.000465307,-0.0256371),\n\t                  vec2(-0.00442145,-0.0256371),\n\t                  vec2(-0.00636071,-0.0256371),\n\t                  vec2(-0.00892053,-0.0240081),\n\t                  vec2(-0.00892053,-0.0181903),\n\t                  vec2(-0.00892053,-0.0147772),\n\t                  vec2(-0.00822239,-0.0120622),\n\t                  vec2(-0.00597283,-0.00321917),\n\t                  vec2(-0.00542984,-0.00135744),\n\t                  vec2(-0.00542984,-0.00120229),\n\t                  vec2(-0.00426629,0.00034909),\n\t                  vec2(-0.00201673,0.00345194),\n\t                  vec2(0.000930967,0.00608934),\n\t                  vec2(0.00387867,0.00608934),\n\t                  vec2(0.00736931,0.00608934),\n\t                  vec2(0.00814502,0.00166779),\n\t                  vec2(0.00814502,-0.000814457),\n\t                  vec2(0.00814502,-0.00407241),\n\t                  vec2(0.00605061,-0.0133033));\n\n\tivec2[3] seg=ivec2[](ivec2(6,7),\n\t                     ivec2(16,17),\n\t                     ivec2(29,30));\n\n\tivec4[19] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(7,8,9,10),\n\t                        ivec4(10,11,12,13),\n\t                        ivec4(13,14,15,16),\n\t                        ivec4(17,18,19,20),\n\t                        ivec4(20,21,22,23),\n\t                        ivec4(23,24,25,26),\n\t                        ivec4(26,27,28,29),\n\t                        ivec4(30,31,32,33),\n\t                        ivec4(33,34,35,36),\n\t                        ivec4(36,37,38,0),\n\t                        ivec4(39,40,41,42),\n\t                        ivec4(42,43,44,45),\n\t                        ivec4(45,46,47,48),\n\t                        ivec4(48,49,50,51),\n\t                        ivec4(51,52,53,54),\n\t                        ivec4(54,55,56,57),\n\t                        ivec4(57,58,59,39));\n\n\tif(all(lessThan(uv,vec2(0.0133423,0.0273438)+border)) && all(greaterThan(uv,vec2(-0.0133421,-0.0273437)-border))){\n\t\tfor(int i=ZERO;i<3;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<19;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat p_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[84] p=vec2[](vec2(0.0192376,0.0125665),\n\t                  vec2(0.0192376,0.0208666),\n\t                  vec2(0.0145834,0.0246675),\n\t                  vec2(0.00992917,0.0246675),\n\t                  vec2(0.00612818,0.0246675),\n\t                  vec2(0.00279265,0.021875),\n\t                  vec2(0.000543133,0.0192375),\n\t                  vec2(-0.000387731,0.0237367),\n\t                  vec2(-0.00387846,0.0246675),\n\t                  vec2(-0.00581768,0.0246675),\n\t                  vec2(-0.00861022,0.0246675),\n\t                  vec2(-0.0101616,0.0228834),\n\t                  vec2(-0.0114028,0.0205563),\n\t                  vec2(-0.0128766,0.0174535),\n\t                  vec2(-0.013885,0.0127216),\n\t                  vec2(-0.013885,0.0127216),\n\t                  vec2(-0.013885,0.0119459),\n\t                  vec2(-0.0131093,0.0119459),\n\t                  vec2(-0.0127215,0.0119459),\n\t                  vec2(-0.0117131,0.0119459),\n\t                  vec2(-0.0116355,0.0120233),\n\t                  vec2(-0.0112477,0.0137301),\n\t                  vec2(-0.00985139,0.01916),\n\t                  vec2(-0.0083775,0.022961),\n\t                  vec2(-0.00597287,0.022961),\n\t                  vec2(-0.00395599,0.022961),\n\t                  vec2(-0.00395599,0.0207114),\n\t                  vec2(-0.00395599,0.0198581),\n\t                  vec2(-0.00395599,0.0193927),\n\t                  vec2(-0.00395599,0.0181516),\n\t                  vec2(-0.00449902,0.0159796),\n\t                  vec2(-0.0133421,-0.0195478),\n\t                  vec2(-0.0139626,-0.0219525),\n\t                  vec2(-0.0145832,-0.0221852),\n\t                  vec2(-0.0176085,-0.0222628),\n\t                  vec2(-0.0183066,-0.0222628),\n\t                  vec2(-0.0192375,-0.0222628),\n\t                  vec2(-0.0192375,-0.0237366),\n\t                  vec2(-0.0192375,-0.0242796),\n\t                  vec2(-0.0188496,-0.0246675),\n\t                  vec2(-0.0183066,-0.0246675),\n\t                  vec2(-0.0162122,-0.0246675),\n\t                  vec2(-0.0139626,-0.0244348),\n\t                  vec2(-0.0117906,-0.0244348),\n\t                  vec2(-0.0093084,-0.0244348),\n\t                  vec2(-0.00667101,-0.0246675),\n\t                  vec2(-0.00426629,-0.0246675),\n\t                  vec2(-0.00380088,-0.0246675),\n\t                  vec2(-0.00279244,-0.0246675),\n\t                  vec2(-0.00279244,-0.0231936),\n\t                  vec2(-0.00279244,-0.0222628),\n\t                  vec2(-0.00356816,-0.0222628),\n\t                  vec2(-0.00465413,-0.0222628),\n\t                  vec2(-0.00861027,-0.0222628),\n\t                  vec2(-0.00861027,-0.0217974),\n\t                  vec2(-0.00861027,-0.0210216),\n\t                  vec2(-0.00861027,-0.0205562),\n\t                  vec2(-0.00806728,-0.0185394),\n\t                  vec2(-0.00775698,-0.0172983),\n\t                  vec2(-0.00496443,-0.00597293),\n\t                  vec2(-0.00442145,-0.00729163),\n\t                  vec2(-0.00248219,-0.010472),\n\t                  vec2(0.00155153,-0.010472),\n\t                  vec2(0.0100067,-0.010472),\n\t                  vec2(0.0192376,0.00100844),\n\t                  vec2(0.00969645,-0.00139623),\n\t                  vec2(0.00876563,-0.00333553),\n\t                  vec2(0.00543005,-0.00876552),\n\t                  vec2(0.00147395,-0.00876552),\n\t                  vec2(-0.00302517,-0.00876552),\n\t                  vec2(-0.00380088,-0.00217194),\n\t                  vec2(-0.00380088,-0.00155138),\n\t                  vec2(-0.00380088,-0.00131874),\n\t                  vec2(-0.00372348,-0.00108597),\n\t                  vec2(-0.00356825,-0.000465454),\n\t                  vec2(7.75911e-05,0.0141955),\n\t                  vec2(0.000698152,0.0168328),\n\t                  vec2(0.00550754,0.022961),\n\t                  vec2(0.00977393,0.022961),\n\t                  vec2(0.0132646,0.022961),\n\t                  vec2(0.0140403,0.0185394),\n\t                  vec2(0.0140403,0.0160572),\n\t                  vec2(0.0140403,0.0127992),\n\t                  vec2(0.011946,0.00356826));\n\n\tivec2[3] seg=ivec2[](ivec2(30,31),\n\t                     ivec2(58,59),\n\t                     ivec2(74,75));\n\n\tivec4[27] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(9,10,11,12),\n\t                        ivec4(12,13,14,15),\n\t                        ivec4(15,16,17,18),\n\t                        ivec4(18,19,20,21),\n\t                        ivec4(21,22,23,24),\n\t                        ivec4(24,25,26,27),\n\t                        ivec4(27,28,29,30),\n\t                        ivec4(31,32,33,34),\n\t                        ivec4(34,35,36,37),\n\t                        ivec4(37,38,39,40),\n\t                        ivec4(40,41,42,43),\n\t                        ivec4(43,44,45,46),\n\t                        ivec4(46,47,48,49),\n\t                        ivec4(49,50,51,52),\n\t                        ivec4(52,53,54,55),\n\t                        ivec4(55,56,57,58),\n\t                        ivec4(59,60,61,62),\n\t                        ivec4(62,63,64,0),\n\t                        ivec4(65,66,67,68),\n\t                        ivec4(68,69,70,71),\n\t                        ivec4(71,72,73,74),\n\t                        ivec4(75,76,77,78),\n\t                        ivec4(78,79,80,81),\n\t                        ivec4(81,82,83,65));\n\n\tif(all(lessThan(uv,vec2(0.0192376,0.0246675)+border)) && all(greaterThan(uv,vec2(-0.0192375,-0.0246675)-border))){\n\t\tfor(int i=ZERO;i<3;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<27;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat q_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[74] p=vec2[](vec2(0.00981294,-0.0231936),\n\t                  vec2(0.00981294,-0.0222628),\n\t                  vec2(0.00903727,-0.0222628),\n\t                  vec2(0.00795126,-0.0222628),\n\t                  vec2(0.00399516,-0.0222628),\n\t                  vec2(0.00399516,-0.0217974),\n\t                  vec2(0.00399516,-0.0210216),\n\t                  vec2(0.00399516,-0.0204787),\n\t                  vec2(0.0041504,-0.0200908),\n\t                  vec2(0.0042278,-0.0196254),\n\t                  vec2(0.014855,0.0227283),\n\t                  vec2(0.0149324,0.0229609),\n\t                  vec2(0.0150876,0.0237367),\n\t                  vec2(0.0150876,0.0237367),\n\t                  vec2(0.0150876,0.0244348),\n\t                  vec2(0.0144671,0.02459),\n\t                  vec2(0.0142344,0.02459),\n\t                  vec2(0.0133811,0.02459),\n\t                  vec2(0.0105885,0.021875),\n\t                  vec2(0.00934736,0.019703),\n\t                  vec2(0.00841654,0.0219525),\n\t                  vec2(0.0063997,0.0246675),\n\t                  vec2(0.00267629,0.0246675),\n\t                  vec2(-0.00593408,0.0246675),\n\t                  vec2(-0.0150874,0.0128768),\n\t                  vec2(-0.0150874,0.00155143),\n\t                  vec2(-0.0150874,-0.00504211),\n\t                  vec2(-0.0115192,-0.010472),\n\t                  vec2(-0.00570136,-0.010472),\n\t                  vec2(-0.00252097,-0.010472),\n\t                  vec2(0.000349194,-0.00845522),\n\t                  vec2(0.00252114,-0.00636081),\n\t                  vec2(0.000969711,-0.0124113),\n\t                  vec2(0.00104729,-0.0124113),\n\t                  vec2(-0.000504094,-0.0185394),\n\t                  vec2(-0.00135738,-0.0218749),\n\t                  vec2(-0.00143491,-0.0221852),\n\t                  vec2(-0.00639949,-0.0222628),\n\t                  vec2(-0.00740793,-0.0222628),\n\t                  vec2(-0.00826122,-0.0222628),\n\t                  vec2(-0.00826122,-0.0237366),\n\t                  vec2(-0.00826122,-0.0244348),\n\t                  vec2(-0.00779577,-0.0246675),\n\t                  vec2(-0.00725278,-0.0246675),\n\t                  vec2(-0.00477054,-0.0246675),\n\t                  vec2(-0.00205552,-0.0244348),\n\t                  vec2(0.000504345,-0.0244348),\n\t                  vec2(0.00306412,-0.0244348),\n\t                  vec2(0.00585671,-0.0246675),\n\t                  vec2(0.008339,-0.0246675),\n\t                  vec2(0.00880441,-0.0246675),\n\t                  vec2(0.00981277,-0.0246675),\n\t                  vec2(0.00407269,-0.000155107),\n\t                  vec2(0.00345218,-0.00255978),\n\t                  vec2(-0.00127972,-0.00876548),\n\t                  vec2(-0.00554612,-0.00876548),\n\t                  vec2(-0.00919191,-0.00876548),\n\t                  vec2(-0.00981247,-0.00418878),\n\t                  vec2(-0.00981247,-0.00186164),\n\t                  vec2(-0.00981247,0.00201688),\n\t                  vec2(-0.0074078,0.0110927),\n\t                  vec2(-0.00601153,0.0143506),\n\t                  vec2(-0.00407227,0.0190825),\n\t                  vec2(-0.000504007,0.022961),\n\t                  vec2(0.00267642,0.022961),\n\t                  vec2(0.00329698,0.022961),\n\t                  vec2(0.00508109,0.0228836),\n\t                  vec2(0.00647736,0.0207114),\n\t                  vec2(0.00725308,0.0194703),\n\t                  vec2(0.00802879,0.0172207),\n\t                  vec2(0.00802879,0.0157469),\n\t                  vec2(0.00802879,0.0155143),\n\t                  vec2(0.00795139,0.0152039),\n\t                  vec2(0.00779615,0.0147385));\n\n\tivec2[2] seg=ivec2[](ivec2(9,10),\n\t                     ivec2(73,52));\n\n\tivec4[24] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(10,11,12,13),\n\t                        ivec4(13,14,15,16),\n\t                        ivec4(16,17,18,19),\n\t                        ivec4(19,20,21,22),\n\t                        ivec4(22,23,24,25),\n\t                        ivec4(25,26,27,28),\n\t                        ivec4(28,29,30,31),\n\t                        ivec4(31,32,33,34),\n\t                        ivec4(34,35,36,37),\n\t                        ivec4(37,38,39,40),\n\t                        ivec4(40,41,42,43),\n\t                        ivec4(43,44,45,46),\n\t                        ivec4(46,47,48,49),\n\t                        ivec4(49,50,51,0),\n\t                        ivec4(52,53,54,55),\n\t                        ivec4(55,56,57,58),\n\t                        ivec4(58,59,60,61),\n\t                        ivec4(61,62,63,64),\n\t                        ivec4(64,65,66,67),\n\t                        ivec4(67,68,69,70),\n\t                        ivec4(70,71,72,73));\n\n\tif(all(lessThan(uv,vec2(0.0150876,0.0246675)+border)) && all(greaterThan(uv,vec2(-0.0150874,-0.0246675)-border))){\n\t\tfor(int i=ZERO;i<2;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<24;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nfloat r_dis_sq(vec2 uv){\n\tfloat dis_sq=1e38;\n\n\tint num_its=0;\n\n\tvec2[56] p=vec2[](vec2(0.015747,0.0126828),\n\t                  vec2(0.015747,0.0167165),\n\t                  vec2(0.0107048,0.0175698),\n\t                  vec2(0.00814502,0.0175698),\n\t                  vec2(0.00279261,0.0175698),\n\t                  vec2(5.93691e-08,0.0136913),\n\t                  vec2(-0.00124106,0.0119847),\n\t                  vec2(-0.00209435,0.0160959),\n\t                  vec2(-0.00511958,0.0175698),\n\t                  vec2(-0.00767945,0.0175698),\n\t                  vec2(-0.010472,0.0175698),\n\t                  vec2(-0.0120234,0.0157857),\n\t                  vec2(-0.0132646,0.0134585),\n\t                  vec2(-0.0147383,0.0103557),\n\t                  vec2(-0.0157468,0.00562388),\n\t                  vec2(-0.0157468,0.00562388),\n\t                  vec2(-0.0157468,0.00484822),\n\t                  vec2(-0.0149711,0.00484822),\n\t                  vec2(-0.0145832,0.00484822),\n\t                  vec2(-0.0135748,0.00484822),\n\t                  vec2(-0.0134972,0.00492561),\n\t                  vec2(-0.0131094,0.00663232),\n\t                  vec2(-0.0117132,0.0120623),\n\t                  vec2(-0.0102393,0.0158633),\n\t                  vec2(-0.00783455,0.0158633),\n\t                  vec2(-0.00581772,0.0158633),\n\t                  vec2(-0.00581772,0.0136137),\n\t                  vec2(-0.00581772,0.0127604),\n\t                  vec2(-0.00581772,0.0115193),\n\t                  vec2(-0.00605036,0.0100454),\n\t                  vec2(-0.00636075,0.00880431),\n\t                  vec2(-0.0121786,-0.0144669),\n\t                  vec2(-0.0123338,-0.0149323),\n\t                  vec2(-0.0124112,-0.0153202),\n\t                  vec2(-0.0124112,-0.0155529),\n\t                  vec2(-0.0124112,-0.0164062),\n\t                  vec2(-0.0117907,-0.0175697),\n\t                  vec2(-0.0102393,-0.0175697),\n\t                  vec2(-0.00791213,-0.0175697),\n\t                  vec2(-0.00736914,-0.0153202),\n\t                  vec2(-0.00721399,-0.0146996),\n\t                  vec2(-0.00217193,0.00562388),\n\t                  vec2(-0.00209453,0.00585652),\n\t                  vec2(0.00139633,0.0158633),\n\t                  vec2(0.00806744,0.0158633),\n\t                  vec2(0.00845532,0.0158633),\n\t                  vec2(0.0106273,0.0158633),\n\t                  vec2(0.0121787,0.0147772),\n\t                  vec2(0.00946372,0.013924),\n\t                  vec2(0.00923099,0.0114417),\n\t                  vec2(0.00923099,0.0110539),\n\t                  vec2(0.00923099,0.0100454),\n\t                  vec2(0.00992913,0.00857158),\n\t                  vec2(0.011946,0.00857158),\n\t                  vec2(0.0133422,0.00857158),\n\t                  vec2(0.015747,0.0096576));\n\n\tivec2[2] seg=ivec2[](ivec2(30,31),\n\t                     ivec2(40,41));\n\n\tivec4[18] c_bez=ivec4[](ivec4(0,1,2,3),\n\t                        ivec4(3,4,5,6),\n\t                        ivec4(6,7,8,9),\n\t                        ivec4(9,10,11,12),\n\t                        ivec4(12,13,14,15),\n\t                        ivec4(15,16,17,18),\n\t                        ivec4(18,19,20,21),\n\t                        ivec4(21,22,23,24),\n\t                        ivec4(24,25,26,27),\n\t                        ivec4(27,28,29,30),\n\t                        ivec4(31,32,33,34),\n\t                        ivec4(34,35,36,37),\n\t                        ivec4(37,38,39,40),\n\t                        ivec4(41,42,43,44),\n\t                        ivec4(44,45,46,47),\n\t                        ivec4(47,48,49,50),\n\t                        ivec4(50,51,52,53),\n\t                        ivec4(53,54,55,0));\n\n\tif(all(lessThan(uv,vec2(0.015747,0.0175698)+border)) && all(greaterThan(uv,vec2(-0.0157468,-0.0175697)-border))){\n\t\tfor(int i=ZERO;i<2;i++){\n\t\t\tdis_sq=min(dis_sq,segment_dis_sq(uv,p[seg[i][0]],p[seg[i][1]]));\n\t\t\tnum_its+=segment_int_test(uv,p[seg[i][0]],p[seg[i][1]]);\n\t\t}\n\t\tfor(int i=ZERO;i<18;i++){\n\t\t\tdis_sq=min(dis_sq,cubic_bezier_dis_approx_sq(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]));\n\t\t\tnum_its+=cubic_bezier_int_test(uv,p[c_bez[i][0]],p[c_bez[i][1]],p[c_bez[i][2]],p[c_bez[i][3]]);\n\t\t}\n\t}\n\n\tfloat sgn=1.;\n\n\tif(num_its%2==1){\n\t\tsgn=-1.;\n\t}\n\n\treturn sgn*dis_sq;\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord){\n\tfloat aspect_ratio = iResolution.x / iResolution.y;\n\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n\tuv-=.5;\n\tuv.x *= aspect_ratio;\n\n\tvec2 mouse = (iMouse.xy+1.) / iResolution.xy;\n\n\tconst float line_width = .001;\n\tconst float curve_width = .001;\n\tconst float dot_size = .005;\n\n\tconst float axis_width = .005;\n\n\tconst vec3 bg_col = vec3(1,1,1);\n\tconst vec3 axis_col = vec3(0,0,0);\n\tconst vec3 line_col = vec3(0,1,0);\n\tconst vec3 second_line_col = vec3(1,1,0);\n\tconst vec3 curve_col = vec3(0,0,1);\n\tconst vec3 second_curve_col = vec3(0,1,1);\n\tconst vec3 dot_col = vec3(1,0,0);\n\tconst vec3 text_col = vec3(0,0,0);\n\n    border = 2./iResolution.y;\n\n\tfloat curve_dis = 1e38;\n\tfloat second_curve_dis = 1e38;\n\tfloat dot_dis = 1e38;\n\tfloat axis_dis = 1e38;\n\tfloat line_dis = 1e38;\n\tfloat second_line_dis = 1e38;\n\tfloat text_dis_sq = 1e38;\n\tfloat text_dis = 1e38;\n\n\tconst float pi=3.14159265358979;\n\tfloat anim=smoothstep(0.,1.,mouse.y);\n\n\t//elliptic curve parameters (weierstrass normal form)\n\tfloat g_2 = .3+anim*.04;\n\tfloat g_3 = -.05-anim*.01;\n\t//float g_2 = .3;\n\t//float g_3 = -.05;\n\n\t//initial approximations for various points (not exactly lying on the curve)\n\t//you can play around with these values, but the gradient descent\n\t//can get unstable if the points are too far away from the curve\n\n\tvec2 p0=vec2(0.043,-0.193); //0: the inflection point\n\tvec2 p1=vec2(-.2,.12); //p\n\tvec2 p2=vec2(.0189,.2106); //q\n\tvec2 p3=vec2(.42,.32); //r\n\n\t//compute points lying exactly on the curve by gradient descent\n\tconst int grad_descent_iterations=7;\n\tfloat p0_val, hesse_p0_val, p1_val, p2_val, p3_val;\n\tvec2 p0_grad, hesse_p0_grad, p1_grad, p2_grad, p3_grad;\n\n\tfor(int i=ZERO;i<grad_descent_iterations;i++){\n\t\tp0_val = p0.y*p0.y - (( 4.*p0.x*p0.x - g_2 ) * p0.x - g_3);\n\t\tp0_grad = vec2(-12.*p0.x*p0.x+g_2,2.*p0.y);\n\t\tp0-=(p0_grad*p0_val)/dot(p0_grad,p0_grad);\n\n\t\t//compute inflection point by alternately gradient descenting to curve and hessian of curve\n\t\thesse_p0_val = -96.*g_2*p0.x*p0.x + 96.*p0.x*p0.y*p0.y - 8.*g_2*g_2 - 288.*g_3*p0.x;\n\t\thesse_p0_grad = vec2(-192.*g_2*p0.x + 96.*p0.y*p0.y - 288.*g_3,192.*p0.x*p0.y);\n\t\tp0-=(hesse_p0_grad*hesse_p0_val)/dot(hesse_p0_grad,hesse_p0_grad);\n\n\t\tp1_val = p1.y*p1.y - (( 4.*p1.x*p1.x - g_2 ) * p1.x - g_3);\n\t\tp1_grad = vec2(-12.*p1.x*p1.x+g_2,2.*p1.y);\n\t\tp1-=(p1_grad*p1_val)/dot(p1_grad,p1_grad);\n\n\t\tp2_val = p2.y*p2.y - (( 4.*p2.x*p2.x - g_2 ) * p2.x - g_3);\n\t\tp2_grad = vec2(-12.*p2.x*p2.x+g_2,2.*p2.y);\n\t\tp2-=(p2_grad*p2_val)/dot(p2_grad,p2_grad);\n\n\t\tp3_val = p3.y*p3.y - (( 4.*p3.x*p3.x - g_2 ) * p3.x - g_3);\n\t\tp3_grad = vec2(-12.*p3.x*p3.x+g_2,2.*p3.y);\n\t\tp3-=(p3_grad*p3_val)/dot(p3_grad,p3_grad);\n\t}\n\n\tvec2 p4=third_intersection(p2,p3,g_2,g_3);\n\tvec2 p5=third_intersection(p1,p2,g_2,g_3);\n\tvec2 p6=third_intersection(p0,p5,g_2,g_3);\n\tvec2 p7=third_intersection(p0,p4,g_2,g_3);\n\tvec2 p8=third_intersection(p1,p7,g_2,g_3);\n\n\tdot_dis=min(dot_dis,distance(p0,uv)-dot_size); //0\n\tdot_dis=min(dot_dis,distance(p1,uv)-dot_size); //p\n\tdot_dis=min(dot_dis,distance(p2,uv)-dot_size); //q\n\tdot_dis=min(dot_dis,distance(p3,uv)-dot_size); //r\n\tdot_dis=min(dot_dis,distance(p4,uv)-dot_size); //a'\n\tdot_dis=min(dot_dis,distance(p5,uv)-dot_size); //a\n\n\t//dot_dis=min(dot_dis,distance(p6,uv)-dot_size); //p+q\n\n\tdot_dis=min(dot_dis,distance(p7,uv)-dot_size); //q+r\n\tdot_dis=min(dot_dis,distance(p8,uv)-dot_size); //b/b'\n\n\tvec3 l0=line(p1,p2); //L\n\tvec3 l1=line(p0,p4); //M'\n\tvec3 l2=line(p6,p3); //N\n\n\tvec3 l3=line(p0,p5); //M\n\tvec3 l4=line(p2,p3); //L'\n\tvec3 l5=line(p1,p7); //N'\n\n\tline_dis=min(line_dis,abs(dot(vec3(uv,1),l0))); //L\n\tline_dis=min(line_dis,abs(dot(vec3(uv,1),l1))); //M'\n\tline_dis=min(line_dis,abs(dot(vec3(uv,1),l2))); //N\n\n\tsecond_line_dis=min(second_line_dis,abs(dot(vec3(uv,1),l3))); //M\n\tsecond_line_dis=min(second_line_dis,abs(dot(vec3(uv,1),l4))); //L'\n\tsecond_line_dis=min(second_line_dis,abs(dot(vec3(uv,1),l5))); //N'\n\n\tfloat uv_val = uv.y*uv.y - (( 4.*uv.x*uv.x - g_2 ) * uv.x - g_3);\n\tvec2 uv_grad = vec2(-12.*uv.x*uv.x+g_2,2.*uv.y);\n\n\tcurve_dis=min(curve_dis, abs(uv_val)/length(uv_grad)-curve_width);\n\n\tfloat d0=dot(vec3(uv,1),l0);\n\tfloat d1=dot(vec3(uv,1),l1);\n\tfloat d2=dot(vec3(uv,1),l2);\n\n\tfloat uv_val2=d0*d1*d2;\n\tvec2 uv_grad2=d0*d1*l2.xy+d0*l1.xy*d2+l0.xy*d1*d2;\n\n\tfloat t0=mouse.x;\n\n\tsecond_curve_dis=min(second_curve_dis,abs(mix(uv_val,uv_val2,t0))/length(mix(uv_grad,uv_grad2,vec2(t0)))-curve_width);\n\n\taxis_dis=min(axis_dis, abs(uv.x));\n\taxis_dis=min(axis_dis, abs(uv.y));\n\n\t//compute reference points for line labels\n\tvec3 L0_point = cross(l0,vec3(1.,0.,-aspect_ratio/2.));\n\tL0_point/=L0_point.z;\n\tL0_point.xy+=l0.yx*vec2(1.,-1.)*.085;\n\n\tvec3 L1_point = cross(l4,vec3(1.,0.,aspect_ratio/2.));\n\tL1_point/=L1_point.z;\n\tL1_point.xy+=l4.yx*vec2(-1.,1.)*.085;\n\n\tvec3 M0_point = cross(l3,vec3(0.,1.,.5));\n\tM0_point/=M0_point.z;\n\tM0_point.xy+=l3.yx*vec2(-1.,1.)*.085;\n\n\tvec3 M1_point = cross(l1,vec3(1.,0.,aspect_ratio/2.));\n\tM1_point/=M1_point.z;\n\tM1_point.xy+=l1.yx*vec2(1.,-1.)*.085;\n\n\tvec3 N0_point = cross(l2,vec3(0.,1.,.5));\n\tN0_point/=N0_point.z;\n\tN0_point.xy+=l2.yx*vec2(1.,-1.)*.085;\n\n\tvec3 N1_point = cross(l5,vec3(0.,1.,-.5));\n\tN1_point/=N1_point.z;\n\tN1_point.xy+=l5.yx*vec2(-1.,1.)*.085;\n\n\tvec2[2] L_positions=vec2[](vec2(-.01,-.05)-L0_point.xy,vec2(.0,.05)-L1_point.xy);\n\tvec2[2] M_positions=vec2[](vec2(.07,.0)-M0_point.xy,vec2(-.06,-.03)-M1_point.xy);\n\tvec2[2] N_positions=vec2[](vec2(-.08,-.06)-N0_point.xy,vec2(-.08,.0)-N1_point.xy);\n\n\tvec2[2] a_positions=vec2[](vec2(.022,-.037)-p5,vec2(.035,.042)-p4);\n\tvec2[2] q_positions=vec2[](vec2(-.003,.042)-p2,vec2(-.04,-.03)-p7);\n\tvec2[2] r_positions=vec2[](vec2(-.03,.03)-p3,q_positions[1]+vec2(-.1,0.));\n\n\tvec2[4] prime_positions=vec2[](L_positions[1]+vec2(-.035,-.025),M_positions[1]+vec2(-.05,-.025),N_positions[1]+vec2(-.043,-.025),a_positions[1]+vec2(-.023,-.023));\n\n\tvec2 plus_position=q_positions[1]+vec2(-.05,1e-7);\n\tvec2 zero_position=vec2(.003,.0425)-p0;\n\tvec2 b_position=vec2(-.03,-.045)-p8;\n\tvec2 p_position=vec2(-.022,.031)-p1;\n\n\ttext_dis_sq=min(text_dis_sq,plus_dis_sq(uv+plus_position));\n\ttext_dis_sq=min(text_dis_sq,zero_dis_sq(uv+zero_position));\n\ttext_dis_sq=min(text_dis_sq,b_dis_sq(uv+b_position));\n\ttext_dis_sq=min(text_dis_sq,p_dis_sq(uv+p_position));\n\n\tfor(int i=ZERO;i<2;i++){\n\t\ttext_dis_sq=min(text_dis_sq,L_dis_sq(uv+L_positions[i]));\n\t\ttext_dis_sq=min(text_dis_sq,M_dis_sq(uv+M_positions[i]));\n\t\ttext_dis_sq=min(text_dis_sq,N_dis_sq(uv+N_positions[i]));\n\n\t\ttext_dis_sq=min(text_dis_sq,a_dis_sq(uv+a_positions[i]));\n\t\ttext_dis_sq=min(text_dis_sq,q_dis_sq(uv+q_positions[i]));\n\t\ttext_dis_sq=min(text_dis_sq,r_dis_sq(uv+r_positions[i]));\n\t}\n\tfor(int i=ZERO;i<4;i++){\n\t\ttext_dis_sq=min(text_dis_sq,prime_dis_sq(uv+prime_positions[i]));\n\t}\n\n\ttext_dis=sign(text_dis_sq)*sqrt(abs(text_dis_sq));\n\n\tvec3 color = bg_col;\n\n\tcolor=vec3(mix(axis_col,color,smoothstep(0., border, axis_dis)));\n\tcolor=vec3(mix(line_col,color,smoothstep(0., border, line_dis)));\n\tcolor=vec3(mix(second_line_col,color,smoothstep(0., border, second_line_dis)));\n\tcolor=vec3(mix(second_curve_col,color,smoothstep(0., border, second_curve_dis)));\n\tcolor=vec3(mix(curve_col,color,smoothstep(0., border, curve_dis)));\n\tcolor=vec3(mix(dot_col,color,smoothstep(0., border, dot_dis)));\n\tcolor=vec3(mix(text_col,color,smoothstep(-border/2., border/2., text_dis)));\n\n\tfragColor = vec4(color,1);\n}",
                "description": "",
                "inputs": [],
                "name": "Image",
                "outputs": [
                    {
                        "channel": 0,
                        "id": 37
                    }
                ],
                "type": "image"
            }
        ],
        "ver": "0.1"
    }
}